<?xml version="1.0" encoding="ISO-8859-1"?>

<bugs>
	<bug>
		<id>9336</id>
		<title>NullPointerException in OrientdbBaseGraph#getVertices if using remote connection</title>
		<body>### OrientDB Version: 3.1.0 ### OrientDB Version: 3.1.1 ### Java Version: openjdk version "11.0.7" 2020-04-14 ### OS: 5.3.18-050318-generic x86_64 GNU/Linux   ## Expected behavior   Orientdb returns the vertexes.  ## Actual behavior   NullPointerException in OrientdbBaseGraph#getVertices at line 921. ```           try (final Stream&lt;ORID&gt; stream = idx.getInternal().getRids(key)) {             return new OrientClassVertexIterable(this, stream.collect(Collectors.toList()), label);           } ```  ## Steps to reproduce    ```  import org.junit.jupiter.api.Test  import com.orientechnologies.orient.core.sql.OCommandSQL import com.tinkerpop.blueprints.Vertex import com.tinkerpop.blueprints.impls.orient.OrientGraphFactory  class OrientdbGetVertexIndexTest {      final static String CLASS_NAME = "TestV"      final static String INDEX_BY_Z = "byZ"      @Test     void "getVertex, with index"() {         OrientGraphFactory o2 = new OrientGraphFactory("remote:localhost/testdb", "admin", "admin").setUseLightweightEdges(true).setupPool(1,10)         def t2 = o2.getNoTx();         try {             def z = 5             // throws NullPointerException             def vertices = t2.getVertices(CLASS_NAME,  ["Z"] as String[], [z] as Object[])             for (Vertex v : vertices) {             }         } finally {             t2.shutdown();         }     }      static void createDb() {         def path = "/home/devent/Projects/dwarf-hustle/db/testdb"         new File(path).deleteDir()         OrientGraphFactory o1 = new OrientGraphFactory("plocal:$path").setUseLightweightEdges(true).setupPool(1,10)         def g = o1.getNoTx()         g.command(new OCommandSQL("CREATE CLASS ${CLASS_NAME} IF NOT EXISTS EXTENDS V")).execute()         g.command(new OCommandSQL("CREATE PROPERTY ${CLASS_NAME}.Z INTEGER")).execute()         g.command(new OCommandSQL("CREATE INDEX ${CLASS_NAME}.${INDEX_BY_Z} ON ${CLASS_NAME}(Z) NOTUNIQUE_HASH_INDEX")).execute()         g.shutdown()         def t1 = o1.getTx()         try {             t1.addVertex(CLASS_NAME, "Z", 5)             t1.commit()         } finally {             t1.shutdown()         }         o1.close()     } } ```  This is related to the commit "Manual indexes and dictionary index are deprecated in Java API." https://github.com/orientechnologies/orientdb/commit/fa7ed950c6fb9583582bcf3c4f7ac6ca4f3d5acc  Under Orientdb Version 3.0.32 the above code runs fine.</body>
		<created>2020-07-10 21:00:27</created>
		<closed>2020-08-07 05:57:32</closed>
	</bug>
	<bug>
		<id>9314</id>
		<title>OrientDB 3.1.0 suddenly stops working indicating Error in data flush background thread, please restart database and send full stack trace inside of bug report</title>
		<body>### OrientDB Version: 3.1 ### Java Version: 1.8.0_201  ### OS: macOS Mojave 10.14.6   ## Actual behavior   ` 2020-06-24 10:54:03:256 WARNI Received signal: SIGINT [OSignalHandler] 2020-06-24 10:54:03:257 INFO  OrientDB Server is shutting down... [OServer] 2020-06-24 10:54:03:257 INFO  Shutting down listeners: [OServer] 2020-06-24 10:54:03:257 INFO  - ONetworkProtocolBinary /0.0.0.0:2424: [OServer] 2020-06-24 10:54:03:257 INFO  - ONetworkProtocolHttpDb /0.0.0.0:2480: [OServer] 2020-06-24 10:54:03:257 INFO  Shutting down protocols [OServer] 2020-06-24 10:54:03:258 INFO  Shutting down plugins: [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  - studio [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  - teleporter [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  - custom-sql-functions-manager [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  - script-interpreter [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  - etl [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  - neo4j-importer [OServerPluginManager] 2020-06-24 10:54:03:258 INFO  Shutting down databases: [OServer] 2020-06-24 10:54:03:258 INFO  Orient Engine is shutting down... [Orient] 2020-06-24 10:54:03:260 INFO  - shutdown storage: OSystem... [OrientDBDistributed] 2020-06-24 10:54:03:269 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:297 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:313 INFO  - shutdown storage: MAPP... [OrientDBDistributed] 2020-06-24 10:54:03:314 SEVER Can not flush file data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$FileFlushTask]Exception `2EC9DD4F` in storage `plocal:/Users/florentinosalazar/Downloads/orientdb-3.1.0/databases/MAPP`: 3.1.0 - Veloce (build da09ce5af52267b70035d8600551a5032065807a, branch develop) com.orientechnologies.orient.core.exception.OStorageException: Error in data flush background thread, please restart database and send full stack trace inside of bug report at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkReadOnlyConditions(OAbstractPaginatedStorage.java:5719) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.checkReadOnlyConditions(OAtomicOperationsManager.java:142) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:135) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.executeInsideAtomicOperation(OAtomicOperationsManager.java:173) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:5029) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:680) at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:214) at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:777) at com.orientechnologies.orient.core.Orient$OShutdownOrientDBInstancesHandler.shutdown(Orient.java:799) at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:373) at com.orientechnologies.orient.server.OServer.deinit(OServer.java:581) at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:500) at com.orientechnologies.orient.server.OServerShutdownHook.run(OServerShutdownHook.java:40) Caused by: com.orientechnologies.common.io.OIOException: You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 at com.orientechnologies.orient.core.storage.fs.OFileClassic.checkRegions(OFileClassic.java:307) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:214) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:228) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPages(OWOWCache.java:2871) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushWriteCacheFromMinLSN(OWOWCache.java:2779) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$2300(OWOWCache.java:109) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicFlushTask.run(OWOWCache.java:2546) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) -- error on shutdown storage com.orientechnologies.orient.core.exception.OStorageException: Error in data flush background thread, please restart database and send full stack trace inside of bug report at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkReadOnlyConditions(OAbstractPaginatedStorage.java:5719) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.checkReadOnlyConditions(OAtomicOperationsManager.java:142) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:135) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.executeInsideAtomicOperation(OAtomicOperationsManager.java:173) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:5029) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:680) at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:214) at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:777) at com.orientechnologies.orient.core.Orient$OShutdownOrientDBInstancesHandler.shutdown(Orient.java:799) at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:373) at com.orientechnologies.orient.server.OServer.deinit(OServer.java:581) at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:500) at com.orientechnologies.orient.server.OServerShutdownHook.run(OServerShutdownHook.java:40) Caused by: com.orientechnologies.common.io.OIOException: You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 at com.orientechnologies.orient.core.storage.fs.OFileClassic.checkRegions(OFileClassic.java:307) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:214) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:228) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPages(OWOWCache.java:2871) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushWriteCacheFromMinLSN(OWOWCache.java:2779) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$2300(OWOWCache.java:109) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicFlushTask.run(OWOWCache.java:2546) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  2020-06-24 10:54:03:324 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask]Exception during calling of shutdown handler OShutdownOrientDBInstancesHandler com.orientechnologies.orient.core.exception.OStorageException: Error during closing the storages at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:794) at com.orientechnologies.orient.core.Orient$OShutdownOrientDBInstancesHandler.shutdown(Orient.java:799) at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:373) at com.orientechnologies.orient.server.OServer.deinit(OServer.java:581) at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:500) at com.orientechnologies.orient.server.OServerShutdownHook.run(OServerShutdownHook.java:40) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Error in data flush background thread, please restart database and send full stack trace inside of bug report at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkReadOnlyConditions(OAbstractPaginatedStorage.java:5719) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.checkReadOnlyConditions(OAtomicOperationsManager.java:142) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:135) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.executeInsideAtomicOperation(OAtomicOperationsManager.java:173) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:5029) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:680) at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:214) at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:777) ... 5 more Caused by: com.orientechnologies.common.io.OIOException: You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 at com.orientechnologies.orient.core.storage.fs.OFileClassic.checkRegions(OFileClassic.java:307) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:214) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:228) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPages(OWOWCache.java:2871) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushWriteCacheFromMinLSN(OWOWCache.java:2779) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$2300(OWOWCache.java:109) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicFlushTask.run(OWOWCache.java:2546) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  2020-06-24 10:54:03:447 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:447 INFO  Clearing byte buffer pool [Orient] 2020-06-24 10:54:03:475 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:505 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:533 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:561 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:591 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:619 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:647 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:673 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] 2020-06-24 10:54:03:699 SEVER Can not flush data because of issue during data write, You cannot access outside the file size (65536 bytes). You have requested portion from 0-131072 bytes. File: File: keydok_2_2759850.cpm os-size=66560, stored=65536 [OWOWCache$PeriodicFlushTask] `  ## Steps to reproduce   The error suddenly appears. I haven't identify any pattern or conditions in order to this exception appears. </body>
		<created>2020-06-24 17:22:14</created>
		<closed>2020-06-26 08:43:01</closed>
	</bug>
	<bug>
		<id>9308</id>
		<title>StringIndexOutOfBoundsException after migrating from 3.0.22 to 3.1.0</title>
		<body>### OrientDB Version: 3.1.0 ### Java Version: 11.0.7+10 ### OS: Linux - Ubuntu 20.04  ## Expected behavior   Can migrate to 3.1.0 and use database.  ## Actual behavior   Migration goes fine, upon restart DB fails with StringIndexOutOfBoundsException  ## Steps to reproduce    * Create new database on 3.0.22 * Add some documents * Stop database * Switch to 3.1.0 * Start database * Add/edit some documents * Stop database * Restart database ** Issue will occur while opening the database  Stack trace: `Caused by: com.orientechnologies.orient.core.exception.OStorageException: Exception during execution of atomic operation inside of storage hedge at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.executeInsideAtomicOperation(OAtomicOperationsManager.java:179) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:307) at com.orientechnologies.orient.core.db.OrientDBEmbedded.open(OrientDBEmbedded.java:412) ... 22 common frames omitted Caused by: java.lang.StringIndexOutOfBoundsException: offset 22, count 16777216, length 147 at java.base/java.lang.String.checkBoundsOffCount(String.java:3304) at java.base/java.lang.String.&lt;init&gt;(String.java:505) at com.orientechnologies.orient.core.storage.config.OClusterBasedStorageConfiguration.deserializeStringValue(OClusterBasedStorageConfiguration.java:1588) at com.orientechnologies.orient.core.storage.config.OClusterBasedStorageConfiguration.deserializeIndexEngineProperty(OClusterBasedStorageConfiguration.java:1421) at com.orientechnologies.orient.core.storage.config.OClusterBasedStorageConfiguration.getIndexEngine(OClusterBasedStorageConfiguration.java:1183) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.openIndexes(OAbstractPaginatedStorage.java:433) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.lambda$open$1(OAbstractPaginatedStorage.java:329) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.executeInsideAtomicOperation(OAtomicOperationsManager.java:175) ... 24 common frames omitted` </body>
		<created>2020-06-23 02:12:49</created>
		<closed>2020-06-24 08:45:00</closed>
	</bug>
	<bug>
		<id>9300</id>
		<title>Restore Database Hangs on "Uncompressing file dirty.fl..."</title>
		<body>### OrientDB Version: Orientdb 3.1.0; Orientdb 3.1.1-SNAPSHOT ### Java Version: openjdk version "1.8.0_191" ### OS: CentOS Linux release 7.6.1810 (Core)   ## Expected behavior   Restore completes in roughly 15 seconds.  ## Actual behavior   Restore hangs on this line until I kill the process. ``` - Uncompressing file dirty.fl... ``` The whole restore takes about 15 seconds when restoring into Orientdb-3.0.25. As far as I can tell from successful restores, this is the final file to uncompress before the restore completes.  ## Steps to reproduce   1. Create a backup from our production environment ``` /opt/orientdb-3.0.22/bin/console.sh "connect plocal:/opt/orientdb-3.0.22/databases/production $user $pw ; backup database /path/to/backupdir/production-$(date +%Y-%m-%d-%T).zip"  ``` 2. Drop the old database and create a new database in our dev environment ``` /opt/orientdb-community-3.1.1-SNAPSHOT/bin/console.sh "drop database plocal:/opt/orientdb-community-3.1.1-SNAPSHOT/databases/prod-sync-dev $user $pw" /opt/orientdb-community-3.1.1-SNAPSHOT/bin/console.sh "create database plocal:/opt/orientdb-community-3.1.1-SNAPSHOT/databases/prod-sync-dev $user $pw"  ``` 3. Connect to the new dev database and restore from the backup file ``` /opt/orientdb-community-3.1.1-SNAPSHOT/bin/console.sh "connect plocal:/opt/orientdb-community-3.1.1-SNAPSHOT/databases/prod-sync-dev $user $pw ; restore database /path/to/latest_backup" ```</body>
		<created>2020-06-15 19:11:23</created>
		<closed>2020-08-26 00:45:48</closed>
	</bug>
	<bug>
		<id>9283</id>
		<title>database doesn't start on restore when database is not closed properly</title>
		<body>### OrientDB Version: 3.1.0 ### Java Version: 1.8 ### OS: linux  ## Expected behavior   OrientDB in distributed mode starts  ## Actual behavior  After a restart of a node in an OrientDB in distributed mode the node doesn't start  All CPU cores from the machine use 100% cpu and orientdb doesn't start  2020-06-07 16:41:41:650 WARNI Storage 'xxx' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2020-06-07 16:41:41:650 INFO  Looking for last checkpoint... [OLocalPaginatedStorage] 2020-06-07 16:41:41:652 INFO  FULL checkpoint found. [OLocalPaginatedStorage] 2020-06-07 16:41:41:653 INFO  Data restore procedure from full checkpoint is started. Restore is performed from LSN OLogSequenceNumber{segment=5, position=18} [OLocalPaginatedStorage]    ## Steps to reproduce   Thread dump attached  Full thread dump OpenJDK 64-Bit Server VM (25.252-b09 mixed mode):  "hz._hzInstance_1_orientdb.cached.thread-44" #131 prio=5 os_prio=0 tid=0x00007f9eb804a800 nid=0x5db8 waiting on condition [0x00007f9e207c8000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-43" #130 prio=5 os_prio=0 tid=0x00007f9eb8048800 nid=0x5db7 waiting on condition [0x00007f9e208c9000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-42" #129 prio=5 os_prio=0 tid=0x00007f9eb8047000 nid=0x5db6 waiting on condition [0x00007f9e209ca000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-41" #128 prio=5 os_prio=0 tid=0x00007f9eb8045000 nid=0x5db5 waiting on condition [0x00007f9e20acb000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-40" #127 prio=5 os_prio=0 tid=0x00007f9cdc001000 nid=0x5db4 waiting on condition [0x00007f9e20bcc000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-39" #126 prio=5 os_prio=0 tid=0x00007f9eb8043000 nid=0x5db3 waiting on condition [0x00007f9e20ccd000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-38" #125 prio=5 os_prio=0 tid=0x00007f9eb8041800 nid=0x5db2 waiting on condition [0x00007f9e20dce000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-37" #124 prio=5 os_prio=0 tid=0x00007f9eb803f800 nid=0x5db1 waiting on condition [0x00007f9e20ecf000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-36" #123 prio=5 os_prio=0 tid=0x00007f9eb803e000 nid=0x5db0 waiting on condition [0x00007f9e20fd0000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-35" #122 prio=5 os_prio=0 tid=0x00007f9eb803c000 nid=0x5daf waiting on condition [0x00007f9e210d1000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-34" #121 prio=5 os_prio=0 tid=0x00007f9eb803a800 nid=0x5dae waiting on condition [0x00007f9e211d2000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-33" #120 prio=5 os_prio=0 tid=0x00007f9eb8038800 nid=0x5dad waiting on condition [0x00007f9e212d3000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-32" #119 prio=5 os_prio=0 tid=0x00007f9eb8037000 nid=0x5dac waiting on condition [0x00007f9e213d4000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-31" #118 prio=5 os_prio=0 tid=0x00007f9eb8035000 nid=0x5dab waiting on condition [0x00007f9e214d5000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-30" #117 prio=5 os_prio=0 tid=0x00007f9eb8033800 nid=0x5daa waiting on condition [0x00007f9e215d6000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-29" #116 prio=5 os_prio=0 tid=0x00007f9eb8031800 nid=0x5da9 waiting on condition [0x00007f9e216d7000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-28" #115 prio=5 os_prio=0 tid=0x00007f9eb802f800 nid=0x5da8 waiting on condition [0x00007f9e217d8000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-27" #114 prio=5 os_prio=0 tid=0x00007f9eb802d800 nid=0x5da7 waiting on condition [0x00007f9e218d9000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-26" #113 prio=5 os_prio=0 tid=0x00007f9eb802b800 nid=0x5da6 waiting on condition [0x00007f9e219da000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-25" #112 prio=5 os_prio=0 tid=0x00007f9eb802a000 nid=0x5da5 waiting on condition [0x00007f9e21adb000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-24" #111 prio=5 os_prio=0 tid=0x00007f9eb8028000 nid=0x5da4 waiting on condition [0x00007f9e21bdc000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-23" #110 prio=5 os_prio=0 tid=0x00007f9eb8026000 nid=0x5da3 waiting on condition [0x00007f9e21cdd000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-22" #109 prio=5 os_prio=0 tid=0x00007f9eb8024800 nid=0x5da2 waiting on condition [0x00007f9e21dde000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-21" #108 prio=5 os_prio=0 tid=0x00007f9eb8022800 nid=0x5da1 waiting on condition [0x00007f9e21edf000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-20" #107 prio=5 os_prio=0 tid=0x00007f9eb8020800 nid=0x5da0 waiting on condition [0x00007f9e21fe0000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-19" #106 prio=5 os_prio=0 tid=0x00007f9eb801f000 nid=0x5d9f waiting on condition [0x00007f9e220e1000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-18" #105 prio=5 os_prio=0 tid=0x00007f9eb801d800 nid=0x5d9e waiting on condition [0x00007f9e221e2000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-17" #104 prio=5 os_prio=0 tid=0x00007f9eb801b800 nid=0x5d9d waiting on condition [0x00007f9e222e3000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-16" #103 prio=5 os_prio=0 tid=0x00007f9eb8019800 nid=0x5d9c waiting on condition [0x00007f9e223e4000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-15" #102 prio=5 os_prio=0 tid=0x00007f9eb8017800 nid=0x5d9b waiting on condition [0x00007f9e224e5000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-14" #101 prio=5 os_prio=0 tid=0x00007f9eb8016000 nid=0x5d9a waiting on condition [0x00007f9e225e6000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-13" #100 prio=5 os_prio=0 tid=0x00007f9eb8014000 nid=0x5d99 waiting on condition [0x00007f9e226e7000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-12" #99 prio=5 os_prio=0 tid=0x00007f9eb8012800 nid=0x5d98 waiting on condition [0x00007f9e227e8000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-11" #98 prio=5 os_prio=0 tid=0x00007f9eb8010800 nid=0x5d62 waiting on condition [0x00007f9e228e9000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-10" #97 prio=5 os_prio=0 tid=0x00007f9eb800f000 nid=0x5d61 waiting on condition [0x00007f9e229ea000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-9" #96 prio=5 os_prio=0 tid=0x00007f9eb800d000 nid=0x5d60 waiting on condition [0x00007f9e22aeb000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-8" #95 prio=5 os_prio=0 tid=0x00007f9eb800b800 nid=0x5d5f waiting on condition [0x00007f9e22bec000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-7" #94 prio=5 os_prio=0 tid=0x00007f9eb800a000 nid=0x5d5e waiting on condition [0x00007f9e22ced000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-6" #93 prio=5 os_prio=0 tid=0x00007f9eb8008000 nid=0x5d5d waiting on condition [0x00007f9e22dee000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-5" #92 prio=5 os_prio=0 tid=0x00007f9eb8006800 nid=0x5d5c waiting on condition [0x00007f9e22eef000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-4" #91 prio=5 os_prio=0 tid=0x00007f9eb8004800 nid=0x5d5b waiting on condition [0x00007f9e22ff0000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "OrientDB (/172.25.1.198:2424) &lt;- BinaryClient (/172.25.1.74:38468)" #90 daemon prio=5 os_prio=0 tid=0x00007f9ec0001000 nid=0x5d56 runnable [0x00007f9e232f1000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x000000070c5f1648&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:176) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)  "OrientDB (/172.25.1.198:2424) &lt;- BinaryClient (/172.25.1.74:38466)" #89 daemon prio=5 os_prio=0 tid=0x00007f9ec0002800 nid=0x5d55 runnable [0x00007f9e233f2000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x000000070c61da28&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:176) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=7" #88 prio=5 os_prio=0 tid=0x00007fac7835a800 nid=0x5d54 runnable [0x00007f9e234f3000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54a1f0&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=6" #87 prio=5 os_prio=0 tid=0x00007fac781cc000 nid=0x5d53 runnable [0x00007f9e235f4000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c866600&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=5" #86 prio=5 os_prio=0 tid=0x00007fac781ca000 nid=0x5d52 runnable [0x00007f9e236f5000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54a610&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=4" #85 prio=5 os_prio=0 tid=0x00007fac781c8800 nid=0x5d51 runnable [0x00007f9e237f6000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c866a00&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=3" #84 prio=5 os_prio=0 tid=0x00007fac781c6800 nid=0x5d50 runnable [0x00007f9e238f7000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6224b8&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=2" #83 prio=5 os_prio=0 tid=0x00007fac781c5000 nid=0x5d4f runnable [0x00007f9e239f8000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54aa20&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=1" #82 prio=5 os_prio=0 tid=0x00007fac788a0000 nid=0x5d4e runnable [0x00007f9e23af9000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c866e00&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=0" #81 prio=5 os_prio=0 tid=0x00007fac7889e800 nid=0x5d4d runnable [0x00007f9e23bfa000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c5833e0&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=-4" #80 prio=5 os_prio=0 tid=0x00007fac7889c800 nid=0x5d4c runnable [0x00007f9e23cfb000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54ae30&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=esoc___OOO___iac id=-3" #79 prio=5 os_prio=0 tid=0x00007fac7889a800 nid=0x5d4b runnable [0x00007f9e23dfc000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6228c8&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=15" #78 prio=5 os_prio=0 tid=0x00007fac7843b800 nid=0x5d4a runnable [0x00007f9e23efd000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c8e16c8&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=14" #77 prio=5 os_prio=0 tid=0x00007fac7843a000 nid=0x5d49 runnable [0x00007f9e1befd000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c8e1a70&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=13" #76 prio=5 os_prio=0 tid=0x00007f9f61197800 nid=0x5d48 runnable [0x00007f9e23ffe000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c583800&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=12" #75 prio=5 os_prio=0 tid=0x00007f9f61195800 nid=0x5d47 runnable [0x00007f9ed0114000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c90b688&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=11" #74 prio=5 os_prio=0 tid=0x00007f9f61194000 nid=0x5d46 runnable [0x00007f9ed0215000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54b298&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=10" #73 prio=5 os_prio=0 tid=0x00007f9f61192000 nid=0x5d45 runnable [0x00007f9ed0316000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c8e1e60&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=9" #72 prio=5 os_prio=0 tid=0x00007f9f61368800 nid=0x5d44 runnable [0x00007f9ed0417000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c583c00&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=8" #71 prio=5 os_prio=0 tid=0x00007f9f61366800 nid=0x5d43 runnable [0x00007f9ed0518000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c90ba98&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=7" #70 prio=5 os_prio=0 tid=0x00007f9f61365000 nid=0x5d42 runnable [0x00007f9ed0619000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c948c68&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=6" #69 prio=5 os_prio=0 tid=0x00007f9f61363000 nid=0x5d41 runnable [0x00007f9ed071a000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54b698&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=5" #68 prio=5 os_prio=0 tid=0x00007f9f61361800 nid=0x5d40 runnable [0x00007f9ed081b000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c8e2250&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=4" #67 prio=5 os_prio=0 tid=0x00007fac78518800 nid=0x5d3f runnable [0x00007f9ed091c000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c90bea8&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=3" #66 prio=5 os_prio=0 tid=0x00007fac78517000 nid=0x5d3e runnable [0x00007f9ed0a1d000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c54ba98&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=2" #65 prio=5 os_prio=0 tid=0x00007fac78515800 nid=0x5d3d runnable [0x00007f9ed0b1e000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c584000&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=1" #64 prio=5 os_prio=0 tid=0x00007fac78513800 nid=0x5d3c runnable [0x00007f9ed0c1f000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c609970&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=0" #63 prio=5 os_prio=0 tid=0x00007fac78512800 nid=0x5d3b runnable [0x00007f9ed0d20000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c949040&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=-4" #62 prio=5 os_prio=0 tid=0x00007fac7844a000 nid=0x5d3a runnable [0x00007f9ed0e21000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c5ac1e0&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "OrientDB DistributedWorker node=orientdb-3-pro-cloud-seceng-aws-us-east-1 db=OSystem id=-3" #61 prio=5 os_prio=0 tid=0x00007fac78448800 nid=0x5d39 runnable [0x00007f9ed0f22000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c8e2640&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.nextMessage(ODistributedWorker.java:284) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.readRequest(ODistributedWorker.java:261) at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:117)  "hz._hzInstance_1_orientdb.async.thread-2" #60 prio=5 os_prio=0 tid=0x00007f9e68002000 nid=0x5d38 runnable [0x00007f9ed1023000]    java.lang.Thread.State: RUNNABLE at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.async.thread-1" #59 prio=5 os_prio=0 tid=0x00007f9e88002000 nid=0x5d37 runnable [0x00007f9ed1124000]    java.lang.Thread.State: RUNNABLE at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1065) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.HealthMonitor" #45 daemon prio=5 os_prio=0 tid=0x00007f9f60e9f800 nid=0x5d36 runnable [0x00007f9ed1225000]    java.lang.Thread.State: RUNNABLE at java.lang.Runtime.availableProcessors(Native Method) at com.hazelcast.internal.metrics.metricsets.RuntimeMetricSet$5.get(RuntimeMetricSet.java:87) at com.hazelcast.internal.metrics.metricsets.RuntimeMetricSet$5.get(RuntimeMetricSet.java:84) at com.hazelcast.internal.metrics.impl.LongGaugeImpl.read(LongGaugeImpl.java:52) at com.hazelcast.internal.diagnostics.HealthMonitor$HealthMetrics.renderProcessors(HealthMonitor.java:371) at com.hazelcast.internal.diagnostics.HealthMonitor$HealthMetrics.render(HealthMonitor.java:317) at com.hazelcast.internal.diagnostics.HealthMonitor$HealthMonitorThread.run(HealthMonitor.java:155)  "hz._hzInstance_1_orientdb.IO.thread-Acceptor" #55 prio=5 os_prio=0 tid=0x00007f9f6145e000 nid=0x5d2d runnable [0x00007f9ed1526000]    java.lang.Thread.State: RUNNABLE at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method) at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269) at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93) at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86) - locked &lt;0x000000070c90c308&gt; (a sun.nio.ch.Util$3) - locked &lt;0x000000070c90c318&gt; (a java.util.Collections$UnmodifiableSet) - locked &lt;0x000000070c90c2c0&gt; (a sun.nio.ch.EPollSelectorImpl) at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97) at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:101) at com.hazelcast.nio.tcp.TcpIpAcceptor$AcceptorIOThread.acceptLoop(TcpIpAcceptor.java:164) at com.hazelcast.nio.tcp.TcpIpAcceptor$AcceptorIOThread.run(TcpIpAcceptor.java:150)  "hz._hzInstance_1_orientdb.IO.thread-out-0" #54 prio=5 os_prio=0 tid=0x00007f9f61459000 nid=0x5d2c runnable [0x00007f9ed1627000]    java.lang.Thread.State: RUNNABLE at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method) at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269) at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93) at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86) - locked &lt;0x000000070c612790&gt; (a com.hazelcast.internal.networking.nio.SelectorOptimizer$SelectionKeysSet) - locked &lt;0x000000070c612be0&gt; (a java.util.Collections$UnmodifiableSet) - locked &lt;0x000000070c6126f8&gt; (a sun.nio.ch.EPollSelectorImpl) at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97) at com.hazelcast.internal.networking.nio.NioThread.selectLoop(NioThread.java:273) at com.hazelcast.internal.networking.nio.NioThread.run(NioThread.java:230)  "hz._hzInstance_1_orientdb.IO.thread-in-0" #53 prio=5 os_prio=0 tid=0x00007f9f61425000 nid=0x5d2b runnable [0x00007f9ed1728000]    java.lang.Thread.State: RUNNABLE at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method) at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269) at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93) at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86) - locked &lt;0x000000070c610ab0&gt; (a com.hazelcast.internal.networking.nio.SelectorOptimizer$SelectionKeysSet) - locked &lt;0x000000070c610ce0&gt; (a java.util.Collections$UnmodifiableSet) - locked &lt;0x000000070c610a18&gt; (a sun.nio.ch.EPollSelectorImpl) at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97) at com.hazelcast.internal.networking.nio.NioThread.selectLoop(NioThread.java:273) at com.hazelcast.internal.networking.nio.NioThread.run(NioThread.java:230)  "hz._hzInstance_1_orientdb.cached.thread-3" #52 prio=5 os_prio=0 tid=0x00007f9eb8003000 nid=0x5d2a waiting on condition [0x00007f9ed1829000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.cached.thread-2" #51 prio=5 os_prio=0 tid=0x00007f9f61417800 nid=0x5d29 waiting on condition [0x00007f9ed192a000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.SlowOperationDetectorThread" #42 prio=5 os_prio=0 tid=0x00007f9f61402800 nid=0x5d28 sleeping[0x00007f9ed1a2b000]    java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at java.lang.Thread.sleep(Thread.java:340) at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386) at com.hazelcast.spi.impl.operationexecutor.slowoperationdetector.SlowOperationDetector$DetectorThread.sleepInterval(SlowOperationDetector.java:290) at com.hazelcast.spi.impl.operationexecutor.slowoperationdetector.SlowOperationDetector$DetectorThread.run(SlowOperationDetector.java:154)  "hz._hzInstance_1_orientdb.response-1" #38 prio=5 os_prio=0 tid=0x00007f9f61401000 nid=0x5d27 waiting on condition [0x00007f9ed1b2c000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:304) at com.hazelcast.internal.util.concurrent.MPSCQueue.takeAll(MPSCQueue.java:231) at com.hazelcast.internal.util.concurrent.MPSCQueue.take(MPSCQueue.java:153) at com.hazelcast.spi.impl.operationservice.impl.InboundResponseHandlerSupplier$ResponseThread.doRun(InboundResponseHandlerSupplier.java:281) at com.hazelcast.spi.impl.operationservice.impl.InboundResponseHandlerSupplier$ResponseThread.run(InboundResponseHandlerSupplier.java:270)  "hz._hzInstance_1_orientdb.response-0" #37 prio=5 os_prio=0 tid=0x00007f9f613ff800 nid=0x5d26 waiting on condition [0x00007f9ed1c2d000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:304) at com.hazelcast.internal.util.concurrent.MPSCQueue.takeAll(MPSCQueue.java:231) at com.hazelcast.internal.util.concurrent.MPSCQueue.take(MPSCQueue.java:153) at com.hazelcast.spi.impl.operationservice.impl.InboundResponseHandlerSupplier$ResponseThread.doRun(InboundResponseHandlerSupplier.java:281) at com.hazelcast.spi.impl.operationservice.impl.InboundResponseHandlerSupplier$ResponseThread.run(InboundResponseHandlerSupplier.java:270)  "hz._hzInstance_1_orientdb.generic-operation.thread-0" #41 prio=5 os_prio=0 tid=0x00007f9f613fd800 nid=0x5d25 waiting on condition [0x00007f9ed1d2e000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c7a73f8&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442) at com.hazelcast.spi.impl.operationexecutor.impl.DefaultOperationQueue.take(DefaultOperationQueue.java:85) at com.hazelcast.spi.impl.operationexecutor.impl.OperationThread.run(OperationThread.java:95)  "hz._hzInstance_1_orientdb.priority-generic-operation.thread-0" #40 prio=5 os_prio=0 tid=0x00007f9f613fc000 nid=0x5d24 waiting on condition [0x00007f9ed1e2f000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c7a79b8&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442) at com.hazelcast.spi.impl.operationexecutor.impl.DefaultOperationQueue.take(DefaultOperationQueue.java:76) at com.hazelcast.spi.impl.operationexecutor.impl.OperationThread.run(OperationThread.java:95)  "hz._hzInstance_1_orientdb.partition-operation.thread-0" #39 prio=5 os_prio=0 tid=0x00007f9f613f9800 nid=0x5d23 waiting on condition [0x00007f9ed1f30000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:304) at com.hazelcast.internal.util.concurrent.MPSCQueue.takeAll(MPSCQueue.java:231) at com.hazelcast.internal.util.concurrent.MPSCQueue.take(MPSCQueue.java:153) at com.hazelcast.spi.impl.operationexecutor.impl.DefaultOperationQueue.take(DefaultOperationQueue.java:85) at com.hazelcast.spi.impl.operationexecutor.impl.OperationThread.run(OperationThread.java:95)  "hz._hzInstance_1_orientdb.InvocationMonitorThread" #50 prio=5 os_prio=0 tid=0x00007f9f613f6000 nid=0x5d22 runnable [0x00007f9ed2031000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c90d908&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "hz._hzInstance_1_orientdb.cached.thread-1" #49 prio=5 os_prio=0 tid=0x00007f9eb8002000 nid=0x5d21 waiting on condition [0x00007f9ed2132000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c6c35c8&gt; (a java.util.concurrent.SynchronousQueue$TransferStack) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460) at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362) at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.migration" #46 prio=5 os_prio=0 tid=0x00007f9f613f1800 nid=0x5d20 sleeping[0x00007f9ed28ca000]    java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at com.hazelcast.internal.partition.impl.MigrationThread.doRun(MigrationThread.java:108) at com.hazelcast.internal.partition.impl.MigrationThread.run(MigrationThread.java:67)  "hz._hzInstance_1_orientdb.MetricsRegistry.thread-2" #48 prio=5 os_prio=0 tid=0x00007f9ea4001000 nid=0x5d1f waiting on condition [0x00007f9ed2233000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c9cc658&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1088) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "hz._hzInstance_1_orientdb.MetricsRegistry.thread-1" #47 prio=5 os_prio=0 tid=0x00007f9f6119b000 nid=0x5d1e runnable [0x00007f9ed2334000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c9cc658&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "hz._hzInstance_1_orientdb.operation-parker" #44 prio=5 os_prio=0 tid=0x00007fa87fff4800 nid=0x5d1b runnable [0x00007f9ed2bcb000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c541420&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.DelayQueue.poll(DelayQueue.java:259) at com.hazelcast.spi.impl.operationparker.impl.OperationParkerImpl$ExpirationTask.doRun(OperationParkerImpl.java:225) at com.hazelcast.spi.impl.operationparker.impl.OperationParkerImpl$ExpirationTask.run(OperationParkerImpl.java:208) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "hz._hzInstance_1_orientdb.event-1" #43 prio=5 os_prio=0 tid=0x00007fa9bfff4800 nid=0x5d1a waiting on condition [0x00007f9ed2ccc000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c541888&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442) at com.hazelcast.util.executor.StripedExecutor$Worker.run(StripedExecutor.java:208)  "hz._hzInstance_1_orientdb.scheduled.thread-" #36 prio=5 os_prio=0 tid=0x00007f9f97ff4800 nid=0x5d19 runnable [0x00007f9ed2dcd000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x000000070c9cc9a0&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) at com.hazelcast.util.executor.HazelcastManagedThread.executeRun(HazelcastManagedThread.java:64) at com.hazelcast.util.executor.HazelcastManagedThread.run(HazelcastManagedThread.java:80)  "OrientDB ONetworkProtocolHttpDb listen at 0.0.0.0:2480-2490" #33 prio=5 os_prio=0 tid=0x00007fa393ff4800 nid=0x5d18 runnable [0x00007f9ed36ce000]    java.lang.Thread.State: RUNNABLE at java.net.PlainSocketImpl.socketAccept(Native Method) at java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:409) at java.net.ServerSocket.implAccept(ServerSocket.java:560) at java.net.ServerSocket.accept(ServerSocket.java:528) at com.orientechnologies.orient.server.network.OServerNetworkListener.run(OServerNetworkListener.java:189)  "OrientDB ONetworkProtocolBinary listen at 0.0.0.0:2424-2430" #31 prio=5 os_prio=0 tid=0x00007fa3abff4800 nid=0x5d17 runnable [0x00007f9ed37cf000]    java.lang.Thread.State: RUNNABLE at java.net.PlainSocketImpl.socketAccept(Native Method) at java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:409) at java.net.ServerSocket.implAccept(ServerSocket.java:560) at java.net.ServerSocket.accept(ServerSocket.java:528) at com.orientechnologies.orient.server.network.OServerNetworkListener.run(OServerNetworkListener.java:189)  "pool-2-thread-1" #30 prio=5 os_prio=0 tid=0x00007fa457ff4800 nid=0x5d15 waiting for monitor entry [0x00007facc01d2000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthorization(OrientDBEmbedded.java:384) - waiting to lock &lt;0x000000064001e5b8&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.core.db.OrientDBEmbedded.lambda$executeNoAuthorization$9(OrientDBEmbedded.java:917) at com.orientechnologies.orient.core.db.OrientDBEmbedded$$Lambda$101/1047390601.call(Unknown Source) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "OrientDB Write Cache Flush Task" #27 daemon prio=5 os_prio=0 tid=0x00007fa9efff4800 nid=0x5d14 runnable [0x00007facc04d3000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x0000000646ea57b0&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "OrientDB WAL Write Task Thread)" #26 daemon prio=5 os_prio=0 tid=0x00007f9ecc004000 nid=0x5d13 waiting on condition [0x00007facc05d4000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x0000000646ecc098&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "OrientDB WAL Flush Task" #25 daemon prio=5 os_prio=0 tid=0x00007faa27ff4800 nid=0x5d12 runnable [0x00007facc06d5000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x0000000646e99e18&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "Thread-6" #24 daemon prio=5 os_prio=0 tid=0x00007faac3ff4800 nid=0x5d11 waiting on condition [0x00007facc07d6000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x0000000646ea0998&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)  "Timer-1" #23 prio=5 os_prio=0 tid=0x00007fac07ff4800 nid=0x5d0f in Object.wait() [0x00007facc0ce4000]    java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x00000006400164e0&gt; (a java.util.TaskQueue) at java.util.TimerThread.mainLoop(Timer.java:552) - locked &lt;0x00000006400164e0&gt; (a java.util.TaskQueue) at java.util.TimerThread.run(Timer.java:505)  "Timer-0" #19 daemon prio=5 os_prio=0 tid=0x00007fac782e3000 nid=0x5d09 in Object.wait() [0x00007facc2073000]    java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x0000000640023998&gt; (a java.util.TaskQueue) at java.util.TimerThread.mainLoop(Timer.java:552) - locked &lt;0x0000000640023998&gt; (a java.util.TaskQueue) at java.util.TimerThread.run(Timer.java:505)  "Thread-0" #18 prio=5 os_prio=0 tid=0x00007fad181c8800 nid=0x5d08 runnable [0x00007facc2423000]    java.lang.Thread.State: RUNNABLE at java.util.HashMap.put(HashMap.java:612) at com.orientechnologies.orient.core.storage.cache.local.doublewritelog.DoubleWriteLogGL.restoreModeOn(DoubleWriteLogGL.java:350) - locked &lt;0x000000070c949540&gt; (a java.lang.Object) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.restoreModeOn(OWOWCache.java:1001) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.restoreFrom(OAbstractPaginatedStorage.java:5493) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.restoreFromFullCheckPoint(OAbstractPaginatedStorage.java:5466) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.restoreFromCheckPoint(OAbstractPaginatedStorage.java:5455) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.restoreFromWAL(OAbstractPaginatedStorage.java:5371) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.recoverIfNeeded(OAbstractPaginatedStorage.java:4571) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:305) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthenticate(OrientDBEmbedded.java:361) - locked &lt;0x000000064001e5b8&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthenticate(OrientDBEmbedded.java:58) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:907) at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.getDatabaseInstance(ODistributedDatabaseImpl.java:695) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.requestNewDatabaseDelta(ODistributedAbstractPlugin.java:1028) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.access$000(ODistributedAbstractPlugin.java:99) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$4.call(ODistributedAbstractPlugin.java:944) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$4.call(ODistributedAbstractPlugin.java:887) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1569) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.installDatabase(ODistributedAbstractPlugin.java:886) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installNewDatabasesFromCluster(OHazelcastPlugin.java:1407) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:253) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1178) at com.orientechnologies.orient.server.OServer.activate(OServer.java:465) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:48)  "Service Thread" #17 daemon prio=9 os_prio=0 tid=0x00007fad180e6000 nid=0x5d06 runnable [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C1 CompilerThread11" #16 daemon prio=9 os_prio=0 tid=0x00007fad180e3000 nid=0x5d05 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C1 CompilerThread10" #15 daemon prio=9 os_prio=0 tid=0x00007fad180e1000 nid=0x5d04 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C1 CompilerThread9" #14 daemon prio=9 os_prio=0 tid=0x00007fad180df000 nid=0x5d03 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C1 CompilerThread8" #13 daemon prio=9 os_prio=0 tid=0x00007fad180dd000 nid=0x5d02 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread7" #12 daemon prio=9 os_prio=0 tid=0x00007fad180db800 nid=0x5d01 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread6" #11 daemon prio=9 os_prio=0 tid=0x00007fad180d9800 nid=0x5d00 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread5" #10 daemon prio=9 os_prio=0 tid=0x00007fad180d7800 nid=0x5cff waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread4" #9 daemon prio=9 os_prio=0 tid=0x00007fad180d5800 nid=0x5cfe runnable [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread3" #8 daemon prio=9 os_prio=0 tid=0x00007fad180d4000 nid=0x5cfd waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread2" #7 daemon prio=9 os_prio=0 tid=0x00007fad180d2000 nid=0x5cfc waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread1" #6 daemon prio=9 os_prio=0 tid=0x00007fad180d0000 nid=0x5cfb waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "C2 CompilerThread0" #5 daemon prio=9 os_prio=0 tid=0x00007fad180cd000 nid=0x5cfa waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "Signal Dispatcher" #4 daemon prio=9 os_prio=0 tid=0x00007fad180cb800 nid=0x5cf9 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE  "Finalizer" #3 daemon prio=8 os_prio=0 tid=0x00007fad1809b800 nid=0x5cf8 in Object.wait() [0x00007facc39f8000]    java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x000000064002cc90&gt; (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:144) - locked &lt;0x000000064002cc90&gt; (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:165) at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:216)  "Reference Handler" #2 daemon prio=10 os_prio=0 tid=0x00007fad18097000 nid=0x5cf7 in Object.wait() [0x00007facc3af9000]    java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x000000064003b940&gt; (a java.lang.ref.Reference$Lock) at java.lang.Object.wait(Object.java:502) at java.lang.ref.Reference.tryHandlePending(Reference.java:191) - locked &lt;0x000000064003b940&gt; (a java.lang.ref.Reference$Lock) at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)  "main" #1 prio=5 os_prio=0 tid=0x00007fad1800d800 nid=0x5ce8 in Object.wait() [0x00007fad20acc000]    java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x000000064001e1e8&gt; (a com.orientechnologies.orient.server.OServerMain$1) at java.lang.Thread.join(Thread.java:1252) - locked &lt;0x000000064001e1e8&gt; (a com.orientechnologies.orient.server.OServerMain$1) at java.lang.Thread.join(Thread.java:1326) at com.orientechnologies.orient.server.OServerMain.main(OServerMain.java:59)  "VM Thread" os_prio=0 tid=0x00007fad1808d000 nid=0x5cf6 runnable   "GC task thread#0 (ParallelGC)" os_prio=0 tid=0x00007fad18022800 nid=0x5ce9 runnable   "GC task thread#1 (ParallelGC)" os_prio=0 tid=0x00007fad18024000 nid=0x5cea runnable   "GC task thread#2 (ParallelGC)" os_prio=0 tid=0x00007fad18026000 nid=0x5ceb runnable   "GC task thread#3 (ParallelGC)" os_prio=0 tid=0x00007fad18027800 nid=0x5cec runnable   "GC task thread#4 (ParallelGC)" os_prio=0 tid=0x00007fad18029800 nid=0x5ced runnable   "GC task thread#5 (ParallelGC)" os_prio=0 tid=0x00007fad1802b000 nid=0x5cee runnable   "GC task thread#6 (ParallelGC)" os_prio=0 tid=0x00007fad1802d000 nid=0x5cef runnable   "GC task thread#7 (ParallelGC)" os_prio=0 tid=0x00007fad1802e800 nid=0x5cf0 runnable   "GC task thread#8 (ParallelGC)" os_prio=0 tid=0x00007fad18030800 nid=0x5cf1 runnable   "GC task thread#9 (ParallelGC)" os_prio=0 tid=0x00007fad18032000 nid=0x5cf2 runnable   "GC task thread#10 (ParallelGC)" os_prio=0 tid=0x00007fad18034000 nid=0x5cf3 runnable   "GC task thread#11 (ParallelGC)" os_prio=0 tid=0x00007fad18035800 nid=0x5cf4 runnable   "GC task thread#12 (ParallelGC)" os_prio=0 tid=0x00007fad18037800 nid=0x5cf5 runnable   "VM Periodic Task Thread" os_prio=0 tid=0x00007fad180e8800 nid=0x5d07 waiting on condition   JNI global references: 1831  Heap  PSYoungGen      total 1835008K, used 1542873K [0x0000000740000000, 0x00000007c0000000, 0x00000007c0000000)   eden space 1572864K, 98% used [0x0000000740000000,0x000000079e2b6408,0x00000007a0000000)   from space 262144K, 0% used [0x00000007a0000000,0x00000007a0000000,0x00000007b0000000)   to   space 262144K, 0% used [0x00000007b0000000,0x00000007b0000000,0x00000007c0000000)  ParOldGen       total 4194304K, used 4194192K [0x0000000640000000, 0x0000000740000000, 0x0000000740000000)   object space 4194304K, 99% used [0x0000000640000000,0x000000073ffe40c8,0x0000000740000000)  Metaspace       used 50732K, capacity 51783K, committed 51968K, reserved 1095680K   class space    used 6301K, capacity 6641K, committed 6656K, reserved 1048576K  </body>
		<created>2020-06-07 17:08:00</created>
		<closed>2020-07-08 11:05:52</closed>
	</bug>
	<bug>
		<id>9281</id>
		<title>Can't find nearly inserted record by unique field within transaction</title>
		<body>### OrientDB Version: 3.1.0   ### Java Version: 1.8  ### OS: Windows 10  ## Expected behavior   in transaction:  --insert record in the class with unique index --select this record by indexed field expected: nearly inserted record is found  ## Actual behavior   no records found  ## Steps to reproduce   ``` drop class TestClass if exists unsafe; create class TestClass extends V; create property TestClass.name STRING; create index TestClass.name on TestClass(name) unique; begin; let b = CREATE VERTEX TestClass SET name = 'b'; let last = (select * from TestClass where name='b'); commit; return $last.size(); ``` This code returns 0. If we comment out 'create index' statement, we got 1.    </body>
		<created>2020-06-05 11:08:03</created>
		<closed>2020-06-05 16:05:56</closed>
	</bug>
	<bug>
		<id>9278</id>
		<title>v3.1.0 and v3.0.30: Unable to use zfs for databases</title>
		<body>### OrientDB Version: 3.1.0 (also with 3.0.30 and 3.0.31)   ### Java Version: Oracle JDK 1.8.0_212 ### OS: CentOS 7  ## Expected behavior   place orientdb databases on a zfs filesystem to take advantages of native compression  ## Actual behavior   OrientDB crashes on startup   ## Steps to reproduce   I'm using OrientDB to store datas with a good compression trend. I've tested the internal compression and I'm gaining around 45% of space. Because internal compression is on record level I want to move databases into a zfs filesystem which will provide more space gain.  To reproduce * install zfs-on-linux * create a zfs filesystem and mount it as "/mnt/datas" * move the "databases" subdir inside "/mnt/datas/orientdb" and symlink it * start orientdb using "server.sh" command * exception occurs  ``` Exception `269A1467` in storage `plocal:/mnt/datas/orientdb/databases/OSystem`: 3.1.0 - Veloce (build da09ce5af52267b70035d8600551a5032065807a, branch develop) com.orientechnologies.common.jnr.LastErrorException: Error during execution of native call, error code 95         at com.orientechnologies.common.jnr.ONative.checkLastError(ONative.java:270)         at com.orientechnologies.common.jnr.ONative.fallocate(ONative.java:245)         at com.orientechnologies.orient.core.storage.fs.AsyncFile.allocateSpace(AsyncFile.java:273)  ``` [orient-server.log](https://github.com/orientechnologies/orientdb/files/4724658/orient-server.log)  Same error with "-Dstorage.wal.allowDirectIO=false"  This is the content of OSystem folder [osystem-files.txt](https://github.com/orientechnologies/orientdb/files/4724694/osystem-files.txt)   </body>
		<created>2020-06-03 16:23:05</created>
		<closed>2020-06-26 08:41:41</closed>
	</bug>
	<bug>
		<id>9270</id>
		<title>Exception in thread 'OrientDB WAL Flush Task'</title>
		<body>### OrientDB Version: 3.0.31   ### Java Version: java version "1.8.0_211"   ### OS: ubuntu  ## Expected behavior   Upsert success, not raise any error  ## Actual behavior   ``` Exception in thread 'OrientDB WAL Flush Task' java.nio.BufferOverflowException at java.nio.Buffer.nextPutIndex(Buffer.java:527) at java.nio.DirectByteBuffer.putInt(DirectByteBuffer.java:706) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1920) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) ``` Can not  update/insert data any more  ## Steps to reproduce   My OrientDB system has over 100 classes with over 50GB data, setup in cluster mode with 6 node, on 6 different IP. When I upsert big data into 1 master node orientdb in distributed ,  Error appear in logs  ``` Exception in thread 'OrientDB WAL Flush Task' java.nio.BufferOverflowException at java.nio.Buffer.nextPutIndex(Buffer.java:527) at java.nio.DirectByteBuffer.putInt(DirectByteBuffer.java:706) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1920) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) ```  </body>
		<created>2020-05-28 03:40:12</created>
		<closed>2020-08-05 12:29:24</closed>
	</bug>
	<bug>
		<id>9264</id>
		<title>Direct memory violation exception on RIDs</title>
		<body>### OrientDB Version: 2.1.19 ### Java Version: 1.8 ### OS: Linux, Cent OS  ## Expected behaviour Expecting data to be returned when I perform the following query:  ``` select from #11:123 ```  ## Actual behaviour  The following exceptions are thrown:  ``` 2020-05-25 15:26:51:315 SEVER Internal server error: com.orientechnologies.common.directmemory.ODirectMemoryViolationException: Last position of provided data interval [1919308488] is more than size of allocated area [65552] [ONetworkProtocolHttpDb] ```  What does the above exactly mean to you?  Which led me to think that I have some sort of corrupted data, attempting to hide that particular rid with the `hide` command does not seem to affect this at all and I still get the same exception over and over again. Also running a `repair database` does not seem to have much effect either.  Following are the JVM settings that the mentioned orient db is running with:  - Xms: 1GB - Xmx: 1GB - MaxDirectMemorySize: 70G  Can someone please shed some lights on how do we go from here, knowing that upgrading to a more recent version is not an option at the moment due to the size of the DB and the fact that we've failed on more than one occasion to do so.  Is there a way that we can load up the cpm file and somehow have that mapping fixed or cleared ?  Cheers  </body>
		<created>2020-05-26 10:44:06</created>
		<closed>2020-07-03 17:14:11</closed>
	</bug>
	<bug>
		<id>9242</id>
		<title>[Bug] using $parent in sub-select in where clause result in NPE</title>
		<body>### OrientDB Version: 3.1.0-M3   ### Java Version: 1.8.0_211  ### OS: Windows 10  ## Expected behavior Not an NPE  ## Actual behavior   NPE    ## Steps to reproduce   Make a query with an inner sub select and use $parent in it.  For example: ``` select from user where userId = (select from user where userId != $parent.userId) ```  The NPE comes from this: https://github.com/orientechnologies/orientdb/blob/3.1.0-M3/core/src/main/java/com/orientechnologies/orient/core/sql/executor/OSelectExecutionPlanner.java#L1454   This is null: `this.statement.getLetClause()` That is, the let clause of the statement is null (since there is no actual let). There is `info.perRecordLetClause` since the code made the sub select a record, and it uses $parent which makes it a per record let clause (rather than a global clause). </body>
		<created>2020-05-07 03:43:09</created>
		<closed>2020-06-01 10:52:05</closed>
	</bug>
	<bug>
		<id>9229</id>
		<title>Many just plain wrong assumptions in ONative#findMemoryGCRoot</title>
		<body>### OrientDB Version: 3.0.3 ### Java Version: 1.8 ### OS: linux (various distributions)    ## Expected behavior   Many things are not working as expected:  - The `DEFAULT_MEMORY_CGROUP_PATH` should be a sensible default for most modern linux systems: `/sys/fs/cgroup/memory` - The `fstype` field should be looked for in the *3rd* field of `/proc/mounts` - The logic in `findMemoryGCRoot` should help prevent OOM errors in dockerized Java installations, not be the root cause of them.  ## Actual behavior    - The `DEFAULT_MEMORY_CGROUP_PATH` is an ancient default: `/sys/fs/memory` - The `fstype` field is *incorrectly* looked for in the *1st* field of `/proc/mounts` - The logic in `findMemoryGCRoot` causes OOM errors in dockerized Java installations.  ## Steps to reproduce   ``` - Path to 'memory' cgroup is '/kubepods/burstable/pode5c1e1d9-9a54-490b-bd41-4f6bc3c375c1/92732085684eb5b85725b9fab1d9417802e0e295f073e0efac7cb2f3178fd878'  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,849+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.common.jna.ONative - Mounting path for memory cgroup controller is '/sys/fs/memory'  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,849+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.common.jna.ONative - Can not find '/sys/fs/memory/kubepods/burstable/pode5c1e1d9-9a54-490b-bd41-4f6bc3c375c1/92732085684eb5b85725b9fab1d9417802e0e295f073e0efac7cb2f3178fd878' path for memory cgroup, it is supposed that process is running in container, will try to read root '/sys/fs/memory' memory cgroup data  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,849+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.common.jna.ONative - Can not read memory soft limit for cgroup '/sys/fs/memory'  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,850+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.common.jna.ONative - Can not read memory hard limit for cgroup '/sys/fs/memory'  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,850+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.common.jna.ONative - Detected memory limit for current process is 33734660096 B/32171 MB/31 GB  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,852+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer - OrientDB auto-config DISKCACHE=2,048MB (heap=1,135MB direct=2,048MB os=32,171MB)  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,855+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.orient.core.config.OGlobalConfiguration - Lowering disk cache size from 2,048MB to 2,046MB.  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:09,927+0000 INFO  [FelixStartLevel] *SYSTEM org.sonatype.nexus.internal.orient.DatabaseServerImpl$1 - Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,073+0000 INFO  [FelixStartLevel] *SYSTEM com.orientechnologies.orient.server.handler.OJMXPlugin - JMX plugin installed and active: profilerManaged=true  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,075+0000 INFO  [FelixStartLevel] *SYSTEM org.sonatype.nexus.internal.orient.DatabaseServerImpl$1 - OrientDB Studio available at $ANSI{blue http://localhost:2480/studio/index.html}  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,075+0000 INFO  [FelixStartLevel] *SYSTEM org.sonatype.nexus.internal.orient.DatabaseServerImpl$1 - $ANSI{green:italic OrientDB Server is active} v2.2.36 (build d3beb772c02098ceaea89779a7afd4b7305d3788, branch 2.2.x).  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,075+0000 INFO  [FelixStartLevel] *SYSTEM org.sonatype.nexus.internal.orient.DatabaseServerImpl - Activated  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,135+0000 INFO  [FelixStartLevel] *SYSTEM org.sonatype.nexus.extender.NexusLifecycleManager - Start RESTORE  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,244+0000 WARN  [ForkJoinPool.commonPool-worker-1] *SYSTEM com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=config}} Storage 'config' was not closed properly. Will try to recover from write ahead log...  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,245+0000 INFO  [ForkJoinPool.commonPool-worker-1] *SYSTEM com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=config}} Looking for last checkpoint...  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,247+0000 INFO  [ForkJoinPool.commonPool-worker-1] *SYSTEM com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=config}} Found FUZZY checkpoint.  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,247+0000 INFO  [ForkJoinPool.commonPool-worker-1] *SYSTEM com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=config}} Data restore procedure from FUZZY checkpoint is started.  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,249+0000 INFO  [ForkJoinPool.commonPool-worker-1] *SYSTEM com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=config}} 1 operations were processed, current LSN is LSN{segment=29, position=3781445} last LSN is LSN{segment=29, position=4285092}  [nexus-688dc7bd98-mcl9w nexus] 2020-04-26 20:33:10,645+0000 ERROR [ForkJoinPool.commonPool-worker-1] *SYSTEM com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - Exception `7C6D6C6D` in storage `plocal:/nexus-data/db/config`: 2.2.36 (build d3beb772c02098ceaea89779a7afd4b7305d3788, branch 2.2.x)  [nexus-688dc7bd98-mcl9w nexus] java.lang.OutOfMemoryError: Java heap space  ``` </body>
		<created>2020-04-26 21:23:50</created>
		<closed>2020-06-12 09:47:40</closed>
	</bug>
	<bug>
		<id>9226</id>
		<title>Infinite db restoration</title>
		<body>### OrientDB Version: 3.1-SNAPSHOT ### Java Version: 8 ### OS: win10  After crash on non-production (yet) environment, orientDB was trying to recover db. Latest from logs:  ``` 2020-04-22 20:52:54:530 INFO  Looking for last checkpoint... [OLocalPaginatedStorage] 2020-04-22 20:52:54:530 INFO  FULL checkpoint found. [OLocalPaginatedStorage] 2020-04-22 20:52:54:535 INFO  Data restore procedure from full checkpoint is started. Restore is performed from LSN OLogSequenceNumber{segment=5, position=18} [OLocalPaginatedStorage] ```  And after such logs - process just stuck - nothing happening. Moreover: DB is small and was created from scratch by 3.1-SNAPSHOT version.  Any ideas what's going on? </body>
		<created>2020-04-23 04:05:15</created>
		<closed>2020-07-17 08:41:33</closed>
	</bug>
	<bug>
		<id>9217</id>
		<title>Database is not distributed after restore</title>
		<body>### OrientDB Version: 2.2.37 ### Java Version: 8.0 ### OS: Debian 9  We are running OrientDB 2.2.37 in Kubernetes with distributed mode. There are node01 and node02:  ## Expected behavior    After restoring database via Restore / Import on one node01, database should be distributed to other nodes when they start.  ## Actual behavior   After restore without error, we start node01 and under ONLINE column, restored database is not visible. And when second node02 starts, node01 requests from node02 to get old database which is before restore and it is overwritten somehow.   In OrientDB 3.0.x there is no such behavior.  ## Steps to reproduce   1. Create newDB in distributed mode with 2 nodes running. 2. Create test class inside newDB 3. Take backup via Export. 4. Delete Database then create again without test class. 5. Shut down server and import gz file. 6. Start node01  ### Here are logs when only node01 started. ```shell 2020-04-14 16:15:05:164 INFO  Loading configuration from: /orientdb/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml] 2020-04-14 16:15:05:382 INFO  OrientDB Server v2.2.37 (build a7541e7ceeabf592dd9a7b2928b6c023cbc73193, branch 2.2.x) is starting up... [OServer] 2020-04-14 16:15:05:387 INFO  Databases directory: /orientdb/databases [OServer] 2020-04-14 16:15:05:435 INFO  Configuration of usage of soft references inside of containers of results of SQL execution [OMemoryAndLocalPaginatedEnginesInitializer] 2020-04-14 16:15:05:438 INFO  Initial and maximum values of heap memory usage are equal, containers of results of SQL executors will use soft references by default [OMemoryAndLocalPaginatedEnginesInitializer] 2020-04-14 16:15:05:439 INFO  Auto configuration of disk cache size. [OMemoryAndLocalPaginatedEnginesInitializer] 2020-04-14 16:15:05:509 INFO  33735544832 B/32172 MB/31 GB of physical memory were detected on machine [ONative] 2020-04-14 16:15:05:516 INFO  Soft memory limit for this process is set to -1 B/-1 MB/-1 GB [ONative] 2020-04-14 16:15:05:516 INFO  Hard memory limit for this process is set to -1 B/-1 MB/-1 GB [ONative] 2020-04-14 16:15:05:517 INFO  Path to 'memory' cgroup is '/kubepods/burstable/pod0e74c283-7e6b-11ea-95d6-42010a800172/d9906ba4da673a994f19182d5e77239ac2bc4ddf9b113e5027c2e99588fec3ea' [ONative] 2020-04-14 16:15:05:519 INFO  Mounting path for memory cgroup controller is '/sys/fs/cgroup/memory' [ONative] 2020-04-14 16:15:05:520 INFO  Can not find '/sys/fs/cgroup/memory/kubepods/burstable/pod0e74c283-7e6b-11ea-95d6-42010a800172/d9906ba4da673a994f19182d5e77239ac2bc4ddf9b113e5027c2e99588fec3ea' path for memory cgroup, it is supposed that process is running in container, will try to read root '/sys/fs/cgroup/memory' memory cgroup data [ONative] 2020-04-14 16:15:05:520 INFO  cgroup soft memory limit is 9223372036854771712 B/8796093022207 MB/8589934591 GB [ONative] 2020-04-14 16:15:05:521 INFO  cgroup hard memory limit is 9223372036854771712 B/8796093022207 MB/8589934591 GB [ONative] 2020-04-14 16:15:05:521 INFO  Detected memory limit for current process is 33735544832 B/32172 MB/31 GB [ONative] 2020-04-14 16:15:05:522 INFO  OrientDB auto-config DISKCACHE=27,701MB (heap=3,959MB direct=524,288MB os=32,172MB) [OMemoryAndLocalPaginatedEnginesInitializer] 2020-04-14 16:15:05:657 INFO  Listening binary connections on 0.0.0.0:2424 (protocol v.36, socket=default) [OServerNetworkListener] 2020-04-14 16:15:05:661 INFO  Listening http connections on 0.0.0.0:2480 (protocol v.10, socket=default) [OServerNetworkListener] 2020-04-14 16:15:05:665 INFO  Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] 2020-04-14 16:15:06:130 INFO  Installing dynamic plugin 'orientdb-etl-2.2.37.jar'... [OServerPluginManager] 2020-04-14 16:15:06:136 INFO  Installing dynamic plugin 'orientdb-studio-2.2.37.zip'... [OServerPluginManager] 2020-04-14 16:15:06:138 INFO  ODefaultPasswordAuthenticator is active [ODefaultPasswordAuthenticator] 2020-04-14 16:15:06:139 INFO  OServerConfigAuthenticator is active [OServerConfigAuthenticator] 2020-04-14 16:15:06:140 INFO  OSystemUserAuthenticator is active [OSystemUserAuthenticator] 2020-04-14 16:15:06:160 INFO  Installed GREMLIN language v.2.6.0 - graph.pool.max=50 [OGraphServerHandler] 2020-04-14 16:15:07:342 INFO  Storage 'plocal:/orientdb/databases/OSystem' is opened under OrientDB distribution : 2.2.37 (build a7541e7ceeabf592dd9a7b2928b6c023cbc73193, branch 2.2.x) [OLocalPaginatedStorage] 2020-04-14 16:15:07:630 WARNI Assigning distributed node name: orientdb2-orientdb-0 [OHazelcastPlugin] 2020-04-14 16:15:07:684 INFO  Configuring Hazelcast from '/orientdb/config/hazelcast.xml'. [FileSystemXmlConfig] 2020-04-14 16:15:07:731 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2020-04-14 16:15:07:940 WARNI [LOCAL] [orientdb] [3.8.4] Cannot resolve hostname: 'orientdb2-orientdb-1.orientdb2-orientdb-headless.default.svc.cluster.local' [DefaultAddressPicker] 2020-04-14 16:15:07:955 WARNI [LOCAL] [orientdb] [3.8.4] Cannot resolve hostname: 'orientdb2-orientdb-2.orientdb2-orientdb-headless.default.svc.cluster.local' [DefaultAddressPicker] 2020-04-14 16:15:07:955 WARNI [LOCAL] [orientdb] [3.8.4] You configured your member address as host name. Please be aware of that your dns can be spoofed. Make sure that your dns configurations are correct. [DefaultAddressPicker] 2020-04-14 16:15:07:956 INFO  [LOCAL] [orientdb] [3.8.4] Resolving domain name 'orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local' to address(es): [10.40.2.104] [DefaultAddressPicker] 2020-04-14 16:15:07:957 INFO  [LOCAL] [orientdb] [3.8.4] Interfaces is disabled, trying to pick one address from TCP-IP config addresses: [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104] [DefaultAddressPicker] 2020-04-14 16:15:07:957 INFO  [LOCAL] [orientdb] [3.8.4] Prefer IPv4 stack is true. [DefaultAddressPicker] 2020-04-14 16:15:07:962 INFO  [LOCAL] [orientdb] [3.8.4] Picked [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434, using socket ServerSocket[addr=/0.0.0.0,localport=2434], bind any local is true [DefaultAddressPicker] 2020-04-14 16:15:07:971 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Hazelcast 3.8.4 (20170809 - 297a77e) starting at [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [system] 2020-04-14 16:15:07:971 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system] 2020-04-14 16:15:07:971 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Configured Hazelcast Serialization version : 1 [system] 2020-04-14 16:15:08:156 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Backpressure is disabled [BackpressureRegulator] 2020-04-14 16:15:08:612 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Creating TcpIpJoiner [Node] 2020-04-14 16:15:08:730 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Starting 1 partition threads [OperationExecutorImpl] 2020-04-14 16:15:08:731 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Starting 2 generic threads (1 dedicated for priority tasks) [OperationExecutorImpl] 2020-04-14 16:15:08:736 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 is STARTING [LifecycleService] 2020-04-14 16:15:08:747 WARNI [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Cannot resolve hostname 'orientdb2-orientdb-1.orientdb2-orientdb-headless.default.svc.cluster.local'. Please make sure host is valid and reachable. [TcpIpJoiner] 2020-04-14 16:15:08:747 WARNI [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Cannot resolve hostname 'orientdb2-orientdb-2.orientdb2-orientdb-headless.default.svc.cluster.local'. Please make sure host is valid and reachable. [TcpIpJoiner] 2020-04-14 16:15:08:757 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Connecting to orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104:2436, timeout: 0, bind-any: true [InitConnectionTask] 2020-04-14 16:15:08:757 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Connecting to orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104:2435, timeout: 0, bind-any: true [InitConnectionTask] 2020-04-14 16:15:08:758 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Could not connect to: orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104:2436. Reason: SocketException[Connection refused to address orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104:2436] [InitConnectionTask] 2020-04-14 16:15:08:758 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Could not connect to: orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104:2435. Reason: SocketException[Connection refused to address orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local/10.40.2.104:2435] [InitConnectionTask] 2020-04-14 16:15:08:758 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2435 is added to the blacklist. [TcpIpJoiner] 2020-04-14 16:15:08:758 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2436 is added to the blacklist. [TcpIpJoiner] 2020-04-14 16:15:09:755 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Cluster version set to 3.8 [system] 2020-04-14 16:15:09:756 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4]    Members [1] { Member [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 - 41ed2df6-3d0c-4506-a27f-1af2428adeca this }  [TcpIpJoiner] 2020-04-14 16:15:09:776 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 is STARTED [LifecycleService] 2020-04-14 16:15:09:777 INFO  Starting distributed server 'orientdb2-orientdb-0' (hzID=41ed2df6-3d0c-4506-a27f-1af2428adeca)... [OHazelcastPlugin] 2020-04-14 16:15:09:780 INFO  Distributed cluster time=Tue Apr 14 16:15:09 UTC 2020 (delta from local node=0)... [OHazelcastPlugin] 2020-04-14 16:15:09:804 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Initializing cluster partition table arrangement... [PartitionStateManager] 2020-04-14 16:15:09:873 INFO  [orientdb2-orientdb-0] Registered local server with nodeId=0 [OHazelcastPlugin] 2020-04-14 16:15:09:893 INFO  Distributed lockManager='orientdb2-orientdb-0' [OHazelcastPlugin] 2020-04-14 16:15:09:902 INFO  [orientdb2-orientdb-0] Loaded configuration for database 'OSystem' from disk: /orientdb/config/default-distributed-db-config.json [ODistributedStorage] 2020-04-14 16:15:09:911 INFO  [orientdb2-orientdb-0] Servers in cluster: [orientdb2-orientdb-0] [OHazelcastPlugin] 2020-04-14 16:15:09:920 INFO  [orientdb2-orientdb-0] Updated node status to 'ONLINE' [OHazelcastPlugin] 2020-04-14 16:15:09:929 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+------+---------+-----+---------+----------------+----------------+-----------------------+ |Name                      |Status|Databases|Conns|StartedOn|Binary          |HTTP            |UsedMemory             | +--------------------------+------+---------+-----+---------+----------------+----------------+-----------------------+ |orientdb2-orientdb-0(*)(@)|ONLINE|         |0    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|190.53MB/3.87GB (4.81%)| +--------------------------+------+---------+-----+---------+----------------+----------------+-----------------------+  [OHazelcastPlugin] 2020-04-14 16:15:09:931 WARNI Authenticated clients can execute any kind of code into the server by using the following allowed languages: [sql] [OServerSideScriptInterpreter] 2020-04-14 16:15:09:931 INFO  OrientDB Studio available at http://10.40.2.104:2480/studio/index.html [OServer] 2020-04-14 16:15:09:932 INFO  OrientDB Server is active v2.2.37 (build a7541e7ceeabf592dd9a7b2928b6c023cbc73193, branch 2.2.x). [OServer]  ```  ### And here logs after node02 joined.  ```shell 2020-04-14 16:51:24:801 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Established socket connection between /10.40.2.104:2434 and /10.40.0.16:47449 [TcpIpConnectionManager] 2020-04-14 16:51:31:799 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4]   Members [2] { Member [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 - 41ed2df6-3d0c-4506-a27f-1af2428adeca this Member [orientdb2-orientdb-1.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 - f9a21e00-d2d3-4dfe-858c-ae97d09a19fe }  [ClusterService] 2020-04-14 16:51:31:800 INFO  [orientdb2-orientdb-0] Added new node id=Member [orientdb2-orientdb-1.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 - f9a21e00-d2d3-4dfe-858c-ae97d09a19fe name=ext:f9a21e00-d2d3-4dfe-858c-ae97d09a19fe [OHazelcastPlugin] 2020-04-14 16:51:32:071 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] Re-partitioning cluster data... Migration queue size: 271 [MigrationManager] 2020-04-14 16:51:33:871 INFO  [orientdb2-orientdb-0]&lt;-[ext:f9a21e00-d2d3-4dfe-858c-ae97d09a19fe] Received updated about registered nodes [OHazelcastPlugin] 2020-04-14 16:51:33:912 INFO  [orientdb2-orientdb-0.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 [orientdb] [3.8.4] All migration tasks have been completed, queues are empty. [MigrationThread] 2020-04-14 16:51:33:964 INFO  [orientdb2-orientdb-0] Setting new distributed configuration for database: OSystem (version=1)  CLUSTER CONFIGURATION [wQuorum: true] (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+ |CLUSTER |writeQuorum|readQuorum| +--------+-----------+----------+ |*       |     1     |    1     | |internal|     1     |    1     | +--------+-----------+----------+   [ODistributedStorage] 2020-04-14 16:51:33:996 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Added node configuration id=Member [orientdb2-orientdb-1.orientdb2-orientdb-headless.default.svc.cluster.local]:2434 - f9a21e00-d2d3-4dfe-858c-ae97d09a19fe name=orientdb2-orientdb-1, now 2 nodes are configured [OHazelcastPlugin] 2020-04-14 16:51:33:997 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+------+---------+-----+---------+----------------+----------------+------------------------+ |Name                      |Status|Databases|Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +--------------------------+------+---------+-----+---------+----------------+----------------+------------------------+ |orientdb2-orientdb-1      |      |         |     |         |                |                |                        | |orientdb2-orientdb-0(*)(@)|ONLINE|         |0    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|587.07MB/3.87GB (14.83%)| +--------------------------+------+---------+-----+---------+----------------+----------------+------------------------+  [OHazelcastPlugin] 2020-04-14 16:51:33:999 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+--------+---------+-----+---------+----------------+----------------+------------------------+ |Name                      |Status  |Databases|Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +--------------------------+--------+---------+-----+---------+----------------+----------------+------------------------+ |orientdb2-orientdb-1      |STARTING|         |0    |16:51:19 |10.40.0.16:2424 |10.40.0.16:2480 |319.42MB/3.87GB (8.07%) | |orientdb2-orientdb-0(*)(@)|ONLINE  |         |0    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|587.07MB/3.87GB (14.83%)| +--------------------------+--------+---------+-----+---------+----------------+----------------+------------------------+  [OHazelcastPlugin] 2020-04-14 16:51:34:107 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Received new status orientdb2-orientdb-1.newDB=ONLINE [OHazelcastPlugin] 2020-04-14 16:51:34:117 INFO  [orientdb2-orientdb-0] Downloaded configuration for database 'newDB' from the cluster [ODistributedStorage] 2020-04-14 16:51:34:121 INFO  [orientdb2-orientdb-0] Setting new distributed configuration for database: newDB (version=1)  CLUSTER CONFIGURATION [wQuorum: false] (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+--------------------+--------------------+--------------------+ |        |           |          |       MASTER       |       MASTER       |       MASTER       | |        |           |          |   NOT_AVAILABLE    |       ONLINE       |   NOT_AVAILABLE    | |        |           |          |       static       |       static       |       static       | +--------+-----------+----------+--------------------+--------------------+--------------------+ |CLUSTER |writeQuorum|readQuorum|orientdb2-orientdb-0|orientdb2-orientdb-1|orientdb2-orientdb-2| +--------+-----------+----------+--------------------+--------------------+--------------------+ |*       |     2     |    1     |         X          |         o          |         o          | |internal|     2     |    1     |                    |                    |                    | +--------+-----------+----------+--------------------+--------------------+--------------------+   [ODistributedStorage] 2020-04-14 16:51:34:136 INFO  [orientdb2-orientdb-0] Current node is a MASTER for database 'newDB' [ODistributedAbstractPlugin$3] 2020-04-14 16:51:34:137 INFO  [orientdb2-orientdb-0] Requesting full sync for database 'newDB'... [OHazelcastPlugin] 2020-04-14 16:51:34:138 INFO  [orientdb2-orientdb-0]-&gt;[[orientdb2-orientdb-1]] Requesting deploy of database 'newDB' on local server... [OHazelcastPlugin] 2020-04-14 16:51:34:476 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Copying remote database 'newDB' to: /tmp/orientdb/install_newDB_server0.zip [OHazelcastPlugin] 2020-04-14 16:51:34:477 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Installing database 'newDB' to: /orientdb/databases/newDB... [OHazelcastPlugin] 2020-04-14 16:51:34:478 INFO  [orientdb2-orientdb-0] - writing chunk #1 offset=0 size=48.35KB [OHazelcastPlugin] 2020-04-14 16:51:34:479 INFO  [orientdb2-orientdb-0] Database copied correctly, size=48.35KB [ODistributedAbstractPlugin$5] 2020-04-14 16:51:34:572 INFO  Storage 'plocal:/orientdb/databases/newDB' is opened under OrientDB distribution : 2.2.37 (build a7541e7ceeabf592dd9a7b2928b6c023cbc73193, branch 2.2.x) [OLocalPaginatedStorage] 2020-04-14 16:51:34:587 INFO  {db=newDB} [orientdb2-orientdb-0] Downloaded configuration for database 'newDB' from the cluster [ODistributedStorage] 2020-04-14 16:51:34:591 INFO  {db=newDB} [orientdb2-orientdb-0] Setting new distributed configuration for database: newDB (version=1)  CLUSTER CONFIGURATION [wQuorum: true] (LEGEND: X = Owner, o = Copy) +--------+----+-----------+----------+--------------------+--------------------+--------------------+ |        |    |           |          |       MASTER       |       MASTER       |       MASTER       | |        |    |           |          |   SYNCHRONIZING    |       ONLINE       |   NOT_AVAILABLE    | |        |    |           |          |       static       |       static       |       static       | +--------+----+-----------+----------+--------------------+--------------------+--------------------+ |CLUSTER |  id|writeQuorum|readQuorum|orientdb2-orientdb-0|orientdb2-orientdb-1|orientdb2-orientdb-2| +--------+----+-----------+----------+--------------------+--------------------+--------------------+ |*       |    |     2     |    1     |         X          |         o          |         o          | |internal|   0|     2     |    1     |                    |                    |                    | +--------+----+-----------+----------+--------------------+--------------------+--------------------+   [ODistributedStorage] 2020-04-14 16:51:34:607 INFO  [orientdb2-orientdb-0] Installed database 'newDB' (LSN=LSN{segment=12, position=52}) [OHazelcastPlugin] 2020-04-14 16:51:34:609 INFO  [orientdb2-orientdb-0] Publishing ONLINE status for database orientdb2-orientdb-0.newDB... [ODistributedDatabaseImpl] 2020-04-14 16:51:34:613 INFO  [orientdb2-orientdb-0] Reassigning ownership of clusters for database newDB... [OHazelcastPlugin] 2020-04-14 16:51:34:620 INFO  [orientdb2-orientdb-0] Reassignment of clusters for database 'newDB' completed (classes=10) [OHazelcastPlugin] 2020-04-14 16:51:34:626 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |Name                      |Status|Databases            |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |orientdb2-orientdb-1      |ONLINE|newDB=ONLINE (MASTER)|4    |16:51:19 |10.40.0.16:2424 |10.40.0.16:2480 |381.32MB/3.87GB (9.63%) | |orientdb2-orientdb-0(*)(@)|ONLINE|                     |0    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|587.07MB/3.87GB (14.83%)| +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+  [OHazelcastPlugin] 2020-04-14 16:51:34:627 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Received new status orientdb2-orientdb-0.newDB=SYNCHRONIZING [OHazelcastPlugin] 2020-04-14 16:51:34:627 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Received updated status orientdb2-orientdb-1.newDB=BACKUP [OHazelcastPlugin] 2020-04-14 16:51:34:628 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |Name                      |Status|Databases            |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |orientdb2-orientdb-1      |ONLINE|newDB=BACKUP (MASTER)|4    |16:51:19 |10.40.0.16:2424 |10.40.0.16:2480 |381.32MB/3.87GB (9.63%) | |orientdb2-orientdb-0(*)(@)|ONLINE|                     |0    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|587.07MB/3.87GB (14.83%)| +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+  [OHazelcastPlugin] 2020-04-14 16:51:34:629 INFO  [orientdb2-orientdb-0]&lt;-[orientdb2-orientdb-1] Received updated status orientdb2-orientdb-1.newDB=ONLINE [OHazelcastPlugin] 2020-04-14 16:51:34:630 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |Name                      |Status|Databases            |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |orientdb2-orientdb-1      |ONLINE|newDB=ONLINE (MASTER)|4    |16:51:19 |10.40.0.16:2424 |10.40.0.16:2480 |381.32MB/3.87GB (9.63%) | |orientdb2-orientdb-0(*)(@)|ONLINE|                     |0    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|587.07MB/3.87GB (14.83%)| +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+  [OHazelcastPlugin] 2020-04-14 16:51:34:630 INFO  [orientdb2-orientdb-0] Received updated status orientdb2-orientdb-0.newDB=ONLINE [OHazelcastPlugin] 2020-04-14 16:51:39:948 INFO  [orientdb2-orientdb-0] Distributed servers status (*=current @=lockManager[orientdb2-orientdb-0]):  +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |Name                      |Status|Databases            |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ |orientdb2-orientdb-1      |ONLINE|newDB=ONLINE (MASTER)|4    |16:51:19 |10.40.0.16:2424 |10.40.0.16:2480 |381.32MB/3.87GB (9.63%) | |orientdb2-orientdb-0(*)(@)|ONLINE|newDB=ONLINE (MASTER)|2    |16:15:06 |10.40.2.104:2424|10.40.2.104:2480|671.90MB/3.87GB (16.97%)| +--------------------------+------+---------------------+-----+---------+----------------+----------------+------------------------+ ``` </body>
		<created>2020-04-14 16:53:13</created>
		<closed>2020-06-01 10:42:08</closed>
	</bug>
	<bug>
		<id>9216</id>
		<title>Live Queries issue with cluster target</title>
		<body>https://community.orientdb.org/t/listen-to-events-from-cluster-default/1095 </body>
		<created>2020-04-14 08:16:13</created>
		<closed>2020-04-14 08:24:31</closed>
	</bug>
	<bug>
		<id>9212</id>
		<title>Any console.sh command involving plocal does not work</title>
		<body>### OrientDB Version: 3.0.30 and 3.0.18  ### Java Version: 1.8 ### OS: Linux  ## Expected behavior   `CONNECT` &amp; `CREATE DATABASE` command to respond with status `OK`  Actually since the database is running, `CONNECT` should respond with the 'already in use' error ``` Connecting to database [plocal:../../databases/test] with user 'admin'... Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database 'test'  Error: com.orientechnologies.orient.core.exception.OStorageException: Database is locked by another process, please shutdown process and try again ```  ## Actual behavior   **On 3.0.30:** - `CONNECT PLOCAL` results in  ``` Connecting to database [plocal:/Orient/databases/test] with user 'admin'... Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database 'knol'  Error: java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.NullPointerException  Error: java.util.concurrent.ExecutionException: java.lang.NullPointerException  Error: java.lang.NullPointerException ``` - `CONNECT REMOTE:LOCALHOST` results in `Connecting to database [remote:localhost/test] with user 'admin'...OK` - `CREATE DATABASE PLOCAL` results in same error message as `CONNECT PLOCAL`  **On 3.0.18** - `CONNECT PLOCAL` results in  ``` Connecting to database [plocal:/Orient/databases/test] with user 'admin'... Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database 'test'  Error: java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Orient/databases/test/test.473.wal  Error: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Orient/databases/test/test.473.wal  Error: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Orient/databases/test/test.473.wal  Error: java.nio.file.FileAlreadyExistsException: /Orient/databases/test/test.473.wal ``` - `CREATE DATABASE PLOCAL` results in  ``` Creating database [plocal:/Orient/tester] using the storage type [PLOCAL]... Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot create database 'tester'  Error: java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Orient/tester/tester.1.wal  Error: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Orient/tester/tester.1.wal  Error: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Orient/tester/tester.1.wal  Error: java.nio.file.FileAlreadyExistsException: /Orient/tester/tester.1.wal ```  ## More info - This is in a distributed set up with 2 nodes - dserver starts up fine and all works well as far as transactions go - Creating a database from studio works as expected, same with connecting - 3.0.30 was meant as an upgrade from 3.0.18, all binaries and configs are seperate, but they share the same directories for databases (has been abstracted out of the orientdb directory) - This only occurs in one of our 3 environments (with same binary/configs minor tweaks for hostnames and such), the other two are able to use all plocal functionality in console without issue - This is not only console.sh, backup.sh also does not work when using a plocal url - File permissions are not the issue as far as I know, user has rw access to all db files - Binaries have been deleted and reinserted multiple times - Server logs don't mention a thing of any of this - These commands fail for all databases (there are multiple) not just this one test - Repair database has been run through remote:localhost connection - Doesn't matter if server is running or not  ## Steps to reproduce   - Navigate to bin folder of orientdb - Run console.sh - Execute any command that utilizes plocal - 3.0.30 &gt; NPE, 3.0.18 FileAlreadyExistsException  I am assuming this is something specific with this environment thats causing orientdb plocal to not work, any ideas?  </body>
		<created>2020-04-07 00:34:34</created>
		<closed>2020-07-03 17:13:53</closed>
	</bug>
	<bug>
		<id>9206</id>
		<title>Invalid JSON response generated with NaN (not a number)</title>
		<body>### OrientDB Version: 3.0.30 ### Java Version: 1.8.0-222 ### OS: Linux   ## Expected behavior   A valid JSON response is generated. I don't know what is the expected behavior of serializing a NaN value into a JSON response.  ## Actual behavior   The JSON generated with an HTTP response has a vertex with a property/value "doubleColum" : NaN . The NaN doesn't have quotes so it generates an invalid json.  ## Steps to reproduce   - Create a class with a property of type double. - Assign a NaN value to this property (In my case I don't know how I generated a NaN when I make the calculation.) - Try to read the vertex using OrientDB browser.  Also this invalid JSON lead to breaking my application that uses OrientDB, I would expect that a valid JSON is generated as part of an http response.  Thanks!</body>
		<created>2020-04-02 20:45:55</created>
		<closed>2020-04-03 09:45:06</closed>
	</bug>
	<bug>
		<id>9198</id>
		<title>NullPointerException when comitting tx after deleting a document</title>
		<body>We are migrating one of our applications from OrientDB 2.2.37 to 3.0.30.  We have several integration tests failing, all of them follow the same pattern:  1. A transaction is begun 2. A document is created and saved 3. The document is deleted 4. The transaction is committed  All the tests pass with 2.2.37, but with 3.0.30 the commit throws a NullPointerException.   The stacktrace:  `Caused by: java.lang.NullPointerException at com.orientechnologies.orient.core.index.OIndexUnique.lambda$new$0(OIndexUnique.java:56) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1235) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.lambda$put$5(OLocalHashTable.java:1166) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.calculateInsideComponentOperation(OAtomicOperationsManager.java:217) ... 72 more`  `SEVERE: $ANSI{green {db=AbstractOrientDBResourceRepositoryWithRealResourcesIT}} Error on transaction commit `594131F2` com.orientechnologies.orient.core.exception.OStorageException: Exception during execution of component operation inside of storage AbstractOrientDBResourceRepositoryWithRealResourcesIT DB name="AbstractOrientDBResourceRepositoryWithRealResourcesIT" at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.calculateInsideComponentOperation(OAtomicOperationsManager.java:220) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.calculateInsideComponentOperation(OAtomicOperationsManager.java:209) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.calculateInsideComponentOperation(ODurableComponent.java:99) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:1148) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.validatedPut(OLocalHashTable.java:256) at com.orientechnologies.orient.core.storage.index.engine.OHashTableIndexEngine.validatedPut(OHashTableIndexEngine.java:183) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doValidatedPutIndexValue(OAbstractPaginatedStorage.java:3344) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.validatedPutIndexValue(OAbstractPaginatedStorage.java:3308) at com.orientechnologies.orient.core.index.OIndexUnique.doPut(OIndexUnique.java:91) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.applyTxChanges(OAbstractPaginatedStorage.java:2541) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:2523) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2453) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2274) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2702) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:533) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:103) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2183) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2153) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:729)`  </body>
		<created>2020-04-01 11:46:04</created>
		<closed>2020-06-05 14:57:24</closed>
	</bug>
	<bug>
		<id>9196</id>
		<title>Deadlock and 2 CPU at 100% usage</title>
		<body>### OrientDB Version: 3.0.29   ### Java Version: 1.8.0 update 222 ### OS: Linux    ## Expected behavior   OrientDB doesn't deadlock.  ## Actual behavior   OrientDB doesn't reply to any request and it's using   ## Steps to reproduce   I'm writing with a high throughput upserts into OrientDB 3.0.29, after a few hours I found that OrientDB was unresponsive and deadlocked. I have identified thread nid=0x1e7f as using 100% CPU. thread nid=0x1e63 is using 15% cpu constantly.  Here is a thread dump, please let me know how can I help to solve this issue. Thanks a lot for the support.  ``` 2020-03-31 13:03:04 Full thread dump OpenJDK 64-Bit Server VM (25.222-b10 mixed mode):  "Attach Listener" #7733 daemon prio=9 os_prio=0 tid=0x00007f9fcc002800 nid=0x1f70 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48104)" #7732 daemon prio=5 os_prio=0 tid=0x00007f9950027800 nid=0x1ecf waiting on condition [0x00007fa04a2e1000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006ca6d3ce8&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48070)" #7731 daemon prio=5 os_prio=0 tid=0x00007f9950025800 nid=0x1ece waiting on condition [0x00007fa04a3e2000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006ca6d6ce8&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48068)" #7730 daemon prio=5 os_prio=0 tid=0x00007f9950023800 nid=0x1ecd waiting on condition [0x00007fa04a4e3000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006ca6e9d70&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48064)" #7729 daemon prio=5 os_prio=0 tid=0x00007f9950022000 nid=0x1ecc waiting on condition [0x00007fa04a5e4000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006cb5ae568&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48062)" #7728 daemon prio=5 os_prio=0 tid=0x00007f9950021000 nid=0x1ecb waiting on condition [0x00007fa04a6e5000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006ca6fadd0&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48058)" #7727 daemon prio=5 os_prio=0 tid=0x00007f995001f800 nid=0x1eca waiting on condition [0x00007fa04a7e6000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006ca6dce10&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:48052)" #7726 daemon prio=5 os_prio=0 tid=0x00007f995001e000 nid=0x1ec9 waiting on condition [0x00007fa04a8e7000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006ca6de150&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199) at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209) at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285) at com.orientechnologies.orient.server.OClientConnection.acquire(OClientConnection.java:87) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:461) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:266) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:53292" #7725 daemon prio=5 os_prio=0 tid=0x00007f9944053000 nid=0x1ec4 waiting for monitor entry [0x00007fa04abea000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54854" #7724 daemon prio=5 os_prio=0 tid=0x00007f9944050000 nid=0x1ea3 waiting for monitor entry [0x00007fa050298000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54852" #7723 daemon prio=5 os_prio=0 tid=0x00007f9944032800 nid=0x1ea2 waiting for monitor entry [0x00007fa04b9f8000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54850" #7722 daemon prio=5 os_prio=0 tid=0x00007f994402b800 nid=0x1ea1 waiting for monitor entry [0x00007fa04bffe000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54848" #7721 daemon prio=5 os_prio=0 tid=0x00007f994402d800 nid=0x1ea0 waiting for monitor entry [0x00007fa04b4f3000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54846" #7720 daemon prio=5 os_prio=0 tid=0x00007f994406e000 nid=0x1e9f waiting for monitor entry [0x00007fa04b6f5000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54818" #7710 daemon prio=5 os_prio=0 tid=0x00007f9944040800 nid=0x1e95 waiting for monitor entry [0x00007fa050399000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:53184" #7709 daemon prio=5 os_prio=0 tid=0x00007f9944020000 nid=0x1e94 waiting for monitor entry [0x00007fa05069c000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:52916" #7708 daemon prio=5 os_prio=0 tid=0x00007f9944031000 nid=0x1e93 waiting for monitor entry [0x00007fa050ba1000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:52814" #7707 daemon prio=5 os_prio=0 tid=0x00007f9944039800 nid=0x1e92 waiting for monitor entry [0x00007fa050da3000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:52544" #7706 daemon prio=5 os_prio=0 tid=0x00007f9944068800 nid=0x1e91 waiting for monitor entry [0x00007fa0516ac000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:52446" #7705 daemon prio=5 os_prio=0 tid=0x00007f9944055000 nid=0x1e90 waiting for monitor entry [0x00007fa050ea4000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:52184" #7704 daemon prio=5 os_prio=0 tid=0x00007f9944067000 nid=0x1e8f waiting for monitor entry [0x00007fa050fa5000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:52090" #7703 daemon prio=5 os_prio=0 tid=0x00007f9944062800 nid=0x1e8e waiting for monitor entry [0x00007fa04b3f2000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:51820" #7702 daemon prio=5 os_prio=0 tid=0x00007f9944016000 nid=0x1e8d waiting for monitor entry [0x00007fa05059b000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:51720" #7701 daemon prio=5 os_prio=0 tid=0x00007f9944065800 nid=0x1e8c waiting for monitor entry [0x00007fa0519af000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:51448" #7700 daemon prio=5 os_prio=0 tid=0x00007f994401e800 nid=0x1e8b waiting for monitor entry [0x00007fa050aa0000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:51354" #7699 daemon prio=5 os_prio=0 tid=0x00007f994401c800 nid=0x1e8a waiting for monitor entry [0x00007fa05079d000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthenticate(OrientDBEmbedded.java:235) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthenticate(OrientDBEmbedded.java:56) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:936) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:908) at com.orientechnologies.orient.server.network.protocol.http.command.OServerCommandAuthenticatedDbAbstract.authenticate(OServerCommandAuthenticatedDbAbstract.java:162) at com.orientechnologies.orient.server.network.protocol.http.command.OServerCommandAuthenticatedDbAbstract.beforeExecute(OServerCommandAuthenticatedDbAbstract.java:122) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:225) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54614" #7698 daemon prio=5 os_prio=0 tid=0x00007f994406a800 nid=0x1e89 waiting for monitor entry [0x00007fa05049a000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54612" #7697 daemon prio=5 os_prio=0 tid=0x00007f994402f000 nid=0x1e88 waiting for monitor entry [0x00007fa04b1f0000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54610" #7696 daemon prio=5 os_prio=0 tid=0x00007f9944021800 nid=0x1e87 waiting for monitor entry [0x00007fa04aceb000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54608" #7695 daemon prio=5 os_prio=0 tid=0x00007f9944051800 nid=0x1e86 waiting for monitor entry [0x00007fa0515ab000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54606" #7694 daemon prio=5 os_prio=0 tid=0x00007f9944010800 nid=0x1e85 waiting for monitor entry [0x00007fa04befd000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:54920)" #7693 daemon prio=5 os_prio=0 tid=0x00007f995001d000 nid=0x1e84 waiting on condition [0x00007fa04aeed000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:271) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthenticate(OrientDBEmbedded.java:238) - locked &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.core.db.OrientDBEmbedded.openNoAuthenticate(OrientDBEmbedded.java:56) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:936) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:913) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeDatabaseOpen37(OConnectionBinaryExecutor.java:1082) at com.orientechnologies.orient.client.remote.message.OOpen37Request.execute(OOpen37Request.java:77) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000007be70c198&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:54834)" #7692 daemon prio=5 os_prio=0 tid=0x00007f995001b800 nid=0x1e83 waiting on condition [0x00007fa050196000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.hasIndexRangeQuerySupport(OAbstractPaginatedStorage.java:3690) at com.orientechnologies.orient.core.index.OIndexNotUnique.supportsOrderedIterations(OIndexNotUnique.java:47) at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.supportsOrderedIterations(OIndexAbstractDelegate.java:232) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.allowsRangeQueries(OSelectExecutionPlanner.java:2534) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.buildIndexSearchDescriptor(OSelectExecutionPlanner.java:2266) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.lambda$findBestIndexFor$26(OSelectExecutionPlanner.java:2146) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner$$Lambda$97/1148799539.apply(Unknown Source) at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175) at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556) at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708) at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.findBestIndexFor(OSelectExecutionPlanner.java:2147) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleClassAsTargetWithIndexedFunction(OSelectExecutionPlanner.java:1618) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleClassAsTarget(OSelectExecutionPlanner.java:1565) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleClassAsTarget(OSelectExecutionPlanner.java:1559) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleFetchFromTarger(OSelectExecutionPlanner.java:1079) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:87) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.handleTarget(OUpdateExecutionPlanner.java:183) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.createExecutionPlan(OUpdateExecutionPlanner.java:58) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:175) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:19) at com.orientechnologies.orient.core.sql.parser.OStatement.createExecutionPlanNoCache(OStatement.java:119) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:167) at com.orientechnologies.orient.core.sql.parser.OLetStatement.executeSimple(OLetStatement.java:36) at com.orientechnologies.orient.core.sql.executor.OSingleOpExecutionPlan.executeInternal(OSingleOpExecutionPlan.java:99) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:37) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215) at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:114) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:60) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:638) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6e9d70&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:54830)" #7691 daemon prio=5 os_prio=0 tid=0x00007f995001a800 nid=0x1e82 waiting on condition [0x00007fa04bcfb000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getClusterNames(OAbstractPaginatedStorage.java:2125) at com.orientechnologies.orient.core.db.ODatabaseInternal.getActiveClusterMap(ODatabaseInternal.java:120) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.calculateShardingStrategy(OSelectExecutionPlanner.java:207) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:85) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.handleTarget(OUpdateExecutionPlanner.java:183) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.createExecutionPlan(OUpdateExecutionPlanner.java:58) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:175) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:19) at com.orientechnologies.orient.core.sql.parser.OStatement.createExecutionPlanNoCache(OStatement.java:119) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:167) at com.orientechnologies.orient.core.sql.parser.OLetStatement.executeSimple(OLetStatement.java:36) at com.orientechnologies.orient.core.sql.executor.OSingleOpExecutionPlan.executeInternal(OSingleOpExecutionPlan.java:99) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:37) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215) at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:114) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:60) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:638) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6de150&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:54828)" #7690 daemon prio=5 os_prio=0 tid=0x00007f9950019800 nid=0x1e81 waiting on condition [0x00007fa04b5f4000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getClusterNames(OAbstractPaginatedStorage.java:2125) at com.orientechnologies.orient.core.db.ODatabaseInternal.getActiveClusterMap(ODatabaseInternal.java:120) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.calculateShardingStrategy(OSelectExecutionPlanner.java:207) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:85) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.handleTarget(OUpdateExecutionPlanner.java:183) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.createExecutionPlan(OUpdateExecutionPlanner.java:58) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:175) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:19) at com.orientechnologies.orient.core.sql.parser.OStatement.createExecutionPlanNoCache(OStatement.java:119) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:167) at com.orientechnologies.orient.core.sql.parser.OLetStatement.executeSimple(OLetStatement.java:36) at com.orientechnologies.orient.core.sql.executor.OSingleOpExecutionPlan.executeInternal(OSingleOpExecutionPlan.java:99) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:37) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215) at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:114) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:60) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:638) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6fadd0&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:54826)" #7689 daemon prio=5 os_prio=0 tid=0x00007f9950018800 nid=0x1e80 waiting on condition [0x00007fa0513a9000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.pauseConfigurationUpdateNotifications(OAbstractPaginatedStorage.java:6064) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:636) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6d3ce8&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB HTTP Connection /10.69.9.207:2480&lt;-/10.69.1.72:51090" #7688 daemon prio=5 os_prio=0 tid=0x00007f994405f000 nid=0x1e7f runnable [0x00007fa04afed000]    java.lang.Thread.State: RUNNABLE at java.lang.Thread.yield(Native Method) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireWriteLock(OReadersWriterSpinLock.java:197) at com.orientechnologies.orient.core.index.OIndexAbstract.acquireExclusiveLock(OIndexAbstract.java:949) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.lockIndexes(OAbstractPaginatedStorage.java:6114) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2444) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2270) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2702) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:533) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:103) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2183) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2153) at com.orientechnologies.orient.core.sql.executor.DeleteStep$1.next(DeleteStep.java:46) at com.orientechnologies.orient.core.sql.executor.CountStep.syncPull(CountStep.java:53) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.parser.ODeleteVertexStatement.execute(ODeleteVertexStatement.java:68) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:79) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:567) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:189) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:95) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006c3e026e8&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006c3e056a0&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006c3e073a8&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006c3e084d0&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006c46a8918&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006ca638b60&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006ca83e8a8&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb1ffe08&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb1fff28&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb201a10&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb201c20&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb201d50&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb202028&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb202150&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync) - &lt;0x00000006cb4c8f08&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)  "OrientDB HTTP Connection /10.0.0.153:2480&lt;-/10.0.0.18:54494" #7686 daemon prio=5 os_prio=0 tid=0x00007f994401b800 nid=0x1e7d waiting for monitor entry [0x00007fa051fb1000]    java.lang.Thread.State: BLOCKED (on object monitor) at com.orientechnologies.orient.core.db.OrientDBEmbedded.listDatabases(OrientDBEmbedded.java:495) - waiting to lock &lt;0x00000006c0042048&gt; (a com.orientechnologies.orient.core.db.OrientDBDistributed) at com.orientechnologies.orient.server.OServer.listDatabases(OServer.java:1240) at com.orientechnologies.orient.server.OServer.getAvailableStorageNames(OServer.java:627) at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:53622)" #7674 daemon prio=5 os_prio=0 tid=0x00007f9950017800 nid=0x1e71 waiting on condition [0x00007fa051aaf000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.hasIndexRangeQuerySupport(OAbstractPaginatedStorage.java:3690) at com.orientechnologies.orient.core.index.OIndexNotUnique.supportsOrderedIterations(OIndexNotUnique.java:47) at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.supportsOrderedIterations(OIndexAbstractDelegate.java:232) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.allowsRangeQueries(OSelectExecutionPlanner.java:2534) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.buildIndexSearchDescriptor(OSelectExecutionPlanner.java:2266) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.lambda$findBestIndexFor$26(OSelectExecutionPlanner.java:2146) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner$$Lambda$97/1148799539.apply(Unknown Source) at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175) at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556) at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708) at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.findBestIndexFor(OSelectExecutionPlanner.java:2147) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleClassAsTargetWithIndexedFunction(OSelectExecutionPlanner.java:1618) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleClassAsTarget(OSelectExecutionPlanner.java:1565) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleClassAsTarget(OSelectExecutionPlanner.java:1559) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.handleFetchFromTarger(OSelectExecutionPlanner.java:1079) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:87) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.handleTarget(OUpdateExecutionPlanner.java:183) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.createExecutionPlan(OUpdateExecutionPlanner.java:58) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:175) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:19) at com.orientechnologies.orient.core.sql.parser.OStatement.createExecutionPlanNoCache(OStatement.java:119) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:167) at com.orientechnologies.orient.core.sql.parser.OLetStatement.executeSimple(OLetStatement.java:36) at com.orientechnologies.orient.core.sql.executor.OSingleOpExecutionPlan.executeInternal(OSingleOpExecutionPlan.java:99) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:37) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215) at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:114) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:60) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:638) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006cb5ae568&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52814)" #7664 daemon prio=5 os_prio=0 tid=0x00007f9950016800 nid=0x1e67 runnable [0x00007fa0512a8000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca6ced98&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52810)" #7663 daemon prio=5 os_prio=0 tid=0x00007f9950015000 nid=0x1e66 waiting on condition [0x00007fa0520b2000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.pauseConfigurationUpdateNotifications(OAbstractPaginatedStorage.java:6064) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:636) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6ddc28&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52808)" #7662 daemon prio=5 os_prio=0 tid=0x00007f9950014000 nid=0x1e65 runnable [0x00007fa0514aa000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca6905e0&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52806)" #7661 daemon prio=5 os_prio=0 tid=0x00007f9950013000 nid=0x1e64 runnable [0x00007fa04b7f6000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca6f6380&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52802)" #7660 daemon prio=5 os_prio=0 tid=0x00007f9950011800 nid=0x1e63 waiting on condition [0x00007fa0511a7000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getClusterNames(OAbstractPaginatedStorage.java:2125) at com.orientechnologies.orient.core.db.ODatabaseInternal.getActiveClusterMap(ODatabaseInternal.java:120) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.calculateShardingStrategy(OSelectExecutionPlanner.java:207) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:85) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.handleTarget(OUpdateExecutionPlanner.java:183) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlanner.createExecutionPlan(OUpdateExecutionPlanner.java:58) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:175) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.createExecutionPlan(OUpdateStatement.java:19) at com.orientechnologies.orient.core.sql.parser.OStatement.createExecutionPlanNoCache(OStatement.java:119) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:167) at com.orientechnologies.orient.core.sql.parser.OLetStatement.executeSimple(OLetStatement.java:36) at com.orientechnologies.orient.core.sql.executor.OSingleOpExecutionPlan.executeInternal(OSingleOpExecutionPlan.java:99) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:37) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215) at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:114) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:60) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:638) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6d6ce8&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52800)" #7659 daemon prio=5 os_prio=0 tid=0x00007f9950010800 nid=0x1e62 runnable [0x00007fa050ca2000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca649b88&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52804)" #7658 daemon prio=5 os_prio=0 tid=0x00007f995000f800 nid=0x1e61 runnable [0x00007fa04b0ef000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca67adc0&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52796)" #7657 daemon prio=5 os_prio=0 tid=0x00007f995000e800 nid=0x1e60 runnable [0x00007fa04bdfc000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca652278&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52798)" #7656 daemon prio=5 os_prio=0 tid=0x00007f995000d800 nid=0x1e5f waiting on condition [0x00007fa04baf9000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.pauseConfigurationUpdateNotifications(OAbstractPaginatedStorage.java:6064) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:636) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca703c68&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52786)" #7655 daemon prio=5 os_prio=0 tid=0x00007f995000c800 nid=0x1e5e waiting on condition [0x00007fa0510a6000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:2966) at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:58) at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:45) at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.get(OIndexAbstractDelegate.java:59) at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:231) at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:38) at com.orientechnologies.orient.core.sql.executor.CreateEdgesStep.getExistingEdge(CreateEdgesStep.java:234) at com.orientechnologies.orient.core.sql.executor.CreateEdgesStep.loadNextFromTo(CreateEdgesStep.java:214) at com.orientechnologies.orient.core.sql.executor.CreateEdgesStep$1.hasNext(CreateEdgesStep.java:73) at com.orientechnologies.orient.core.sql.executor.SaveElementStep$1.hasNext(SaveElementStep.java:32) at com.orientechnologies.orient.core.sql.executor.OInsertExecutionPlan.executeInternal(OInsertExecutionPlan.java:47) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:29) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215) at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:114) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:60) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:638) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1192) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - &lt;0x00000006ca6dce10&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52784)" #7654 daemon prio=5 os_prio=0 tid=0x00007f995000b000 nid=0x1e5d runnable [0x00007fa04b2f1000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca6c8e10&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.0.238:52780)" #7653 daemon prio=5 os_prio=0 tid=0x00007f995000a000 nid=0x1e5c runnable [0x00007fa04bbfa000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca6831b8&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:35830)" #2630 daemon prio=5 os_prio=0 tid=0x00007f9950009000 nid=0xabd runnable [0x00007fa04b8f7000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca49a750&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:35828)" #2629 daemon prio=5 os_prio=0 tid=0x00007f9950008000 nid=0xabc runnable [0x00007fa04adec000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca494b38&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:39146)" #2294 daemon prio=5 os_prio=0 tid=0x00007f9950007000 nid=0x955 runnable [0x00007fa0517ad000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca48bc30&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:34730)" #2133 daemon prio=5 os_prio=0 tid=0x00007f9950006000 nid=0x8b4 runnable [0x00007fa0525b5000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca485110&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:34728)" #2132 daemon prio=5 os_prio=0 tid=0x00007f9950005000 nid=0x8b3 runnable [0x00007fa04a9e8000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca485a38&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:46310)" #2066 daemon prio=5 os_prio=0 tid=0x00007f9950004800 nid=0x85a runnable [0x00007fa0518ae000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca4329e0&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB (/10.69.9.207:2424) &lt;- BinaryClient (/10.69.1.72:46308)" #2065 daemon prio=5 os_prio=0 tid=0x00007f9950003800 nid=0x859 runnable [0x00007fa04aae9000]    java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) at java.io.BufferedInputStream.read(BufferedInputStream.java:265) - locked &lt;0x00000006ca4380f0&gt; (a java.io.BufferedInputStream) at java.io.DataInputStream.readByte(DataInputStream.java:265) at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:183) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)     Locked ownable synchronizers: - None  "OrientDB ONetworkProtocolHttpDb listen at 0.0.0.0:2480-2490" #38 prio=5 os_prio=0 tid=0x00007f99eb74a800 nid=0x55 runnable [0x00007fa0526b6000]    java.lang.Thread.State: RUNNABLE at java.net.PlainSocketImpl.socketAccept(Native Method) at java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:409) at java.net.ServerSocket.implAccept(ServerSocket.java:545) at java.net.ServerSocket.accept(ServerSocket.java:513) at com.orientechnologies.orient.server.network.OServerNetworkListener.run(OServerNetworkListener.java:188)     Locked ownable synchronizers: - None  "OrientDB ONetworkProtocolBinary listen at 0.0.0.0:2424-2430" #36 prio=5 os_prio=0 tid=0x00007f99eb743800 nid=0x54 runnable [0x00007fa0527b7000]    java.lang.Thread.State: RUNNABLE at java.net.PlainSocketImpl.socketAccept(Native Method) at java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:409) at java.net.ServerSocket.implAccept(ServerSocket.java:545) at java.net.ServerSocket.accept(ServerSocket.java:513) at com.orientechnologies.orient.server.network.OServerNetworkListener.run(OServerNetworkListener.java:188)     Locked ownable synchronizers: - None  "OrientDB Write Cache Flush Task" #33 daemon prio=5 os_prio=0 tid=0x00007f9d53ff4800 nid=0x53 runnable [0x00007fa0530e4000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c0015948&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)     Locked ownable synchronizers: - None  "OrientDB WAL Write Task Thread)" #32 daemon prio=5 os_prio=0 tid=0x00007f99e0004000 nid=0x52 waiting on condition [0x00007fa0531e5000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c00251b0&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)     Locked ownable synchronizers: - None  "OrientDB WAL Flush Task" #31 daemon prio=5 os_prio=0 tid=0x00007f9d7fff4800 nid=0x51 runnable [0x00007fa0532e6000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c001d730&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809) at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)     Locked ownable synchronizers: - None  "Thread-5" #30 daemon prio=5 os_prio=0 tid=0x00007f9df7ff4800 nid=0x50 runnable [0x00007fa0537f4000]    java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c3dfe160&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock) at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.tryAcquireReadLock(OReadersWriterSpinLock.java:91) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFuzzyCheckpoint(OAbstractPaginatedStorage.java:4488) at com.orientechnologies.orient.core.storage.disk.OLocalPaginatedStorage.access$200(OLocalPaginatedStorage.java:76) at com.orientechnologies.orient.core.storage.disk.OLocalPaginatedStorage$PeriodicFuzzyCheckpoint.run(OLocalPaginatedStorage.java:667) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)     Locked ownable synchronizers: - &lt;0x00000006c002b5c0&gt; (a java.util.concurrent.ThreadPoolExecutor$Worker)  "Timer-0" #26 daemon prio=5 os_prio=0 tid=0x00007f9f80517000 nid=0x4d runnable [0x00007fa05b780000]    java.lang.Thread.State: RUNNABLE at java.lang.Thread.yield(Native Method) at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireWriteLock(OReadersWriterSpinLock.java:197) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage$2.run(OAbstractPaginatedStorage.java:4581) at com.orientechnologies.orient.core.Orient$3.run(Orient.java:419) at java.util.TimerThread.mainLoop(Timer.java:555) at java.util.TimerThread.run(Timer.java:505)     Locked ownable synchronizers: - None  "Thread-0" #24 prio=5 os_prio=0 tid=0x00007fa0d81b4000 nid=0x4c waiting on condition [0x00007fa05bcfb000]    java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  &lt;0x00000006c0041670&gt; (a java.util.concurrent.CountDownLatch$Sync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304) at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231) at com.orientechnologies.orient.server.OServer.waitForShutdown(OServer.java:620) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:49)     Locked ownable synchronizers: - None  "Service Thread" #23 daemon prio=9 os_prio=0 tid=0x00007fa0d812e000 nid=0x4a runnable [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C1 CompilerThread17" #22 daemon prio=9 os_prio=0 tid=0x00007fa0d812b000 nid=0x49 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C1 CompilerThread16" #21 daemon prio=9 os_prio=0 tid=0x00007fa0d8129000 nid=0x48 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C1 CompilerThread15" #20 daemon prio=9 os_prio=0 tid=0x00007fa0d8127000 nid=0x47 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C1 CompilerThread14" #19 daemon prio=9 os_prio=0 tid=0x00007fa0d8125000 nid=0x46 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C1 CompilerThread13" #18 daemon prio=9 os_prio=0 tid=0x00007fa0d8123000 nid=0x45 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C1 CompilerThread12" #17 daemon prio=9 os_prio=0 tid=0x00007fa0d8121000 nid=0x44 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread11" #16 daemon prio=9 os_prio=0 tid=0x00007fa0d811f000 nid=0x43 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread10" #15 daemon prio=9 os_prio=0 tid=0x00007fa0d811d000 nid=0x42 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread9" #14 daemon prio=9 os_prio=0 tid=0x00007fa0d811b000 nid=0x41 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread8" #13 daemon prio=9 os_prio=0 tid=0x00007fa0d8119000 nid=0x40 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread7" #12 daemon prio=9 os_prio=0 tid=0x00007fa0d8117800 nid=0x3f waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread6" #11 daemon prio=9 os_prio=0 tid=0x00007fa0d8115800 nid=0x3e waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread5" #10 daemon prio=9 os_prio=0 tid=0x00007fa0d8113800 nid=0x3d waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread4" #9 daemon prio=9 os_prio=0 tid=0x00007fa0d8111800 nid=0x3c waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread3" #8 daemon prio=9 os_prio=0 tid=0x00007fa0d810f800 nid=0x3b waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread2" #7 daemon prio=9 os_prio=0 tid=0x00007fa0d810d800 nid=0x3a waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread1" #6 daemon prio=9 os_prio=0 tid=0x00007fa0d810c000 nid=0x39 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "C2 CompilerThread0" #5 daemon prio=9 os_prio=0 tid=0x00007fa0d8109000 nid=0x38 waiting on condition [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "Signal Dispatcher" #4 daemon prio=9 os_prio=0 tid=0x00007fa0d8107800 nid=0x37 runnable [0x0000000000000000]    java.lang.Thread.State: RUNNABLE     Locked ownable synchronizers: - None  "Finalizer" #3 daemon prio=8 os_prio=0 tid=0x00007fa0d80d6000 nid=0x36 in Object.wait() [0x00007fa0613d2000]    java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:144) - locked &lt;0x00000006c0045ba8&gt; (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:165) at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:216)     Locked ownable synchronizers: - None  "Reference Handler" #2 daemon prio=10 os_prio=0 tid=0x00007fa0d80d3800 nid=0x35 in Object.wait() [0x00007fa0614d3000]    java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) at java.lang.Object.wait(Object.java:502) at java.lang.ref.Reference.tryHandlePending(Reference.java:191) - locked &lt;0x00000006c004c008&gt; (a java.lang.ref.Reference$Lock) at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)     Locked ownable synchronizers: - None  "main" #1 prio=5 os_prio=0 tid=0x00007fa0d800d000 nid=0x8 in Object.wait() [0x00007fa0e1698000]    java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x00000006c003da88&gt; (a com.orientechnologies.orient.server.OServerMain$1) at java.lang.Thread.join(Thread.java:1252) - locked &lt;0x00000006c003da88&gt; (a com.orientechnologies.orient.server.OServerMain$1) at java.lang.Thread.join(Thread.java:1326) at com.orientechnologies.orient.server.OServerMain.main(OServerMain.java:59)     Locked ownable synchronizers: - None  "VM Thread" os_prio=0 tid=0x00007fa0d80ca000 nid=0x34 runnable   "GC task thread#0 (ParallelGC)" os_prio=0 tid=0x00007fa0d8022800 nid=0x9 runnable   "GC task thread#1 (ParallelGC)" os_prio=0 tid=0x00007fa0d8024800 nid=0xa runnable   "GC task thread#2 (ParallelGC)" os_prio=0 tid=0x00007fa0d8026000 nid=0xb runnable   "GC task thread#3 (ParallelGC)" os_prio=0 tid=0x00007fa0d8028000 nid=0xc runnable   "GC task thread#4 (ParallelGC)" os_prio=0 tid=0x00007fa0d8029800 nid=0xd runnable   "GC task thread#5 (ParallelGC)" os_prio=0 tid=0x00007fa0d802b800 nid=0xe runnable   "GC task thread#6 (ParallelGC)" os_prio=0 tid=0x00007fa0d802d000 nid=0xf runnable   "GC task thread#7 (ParallelGC)" os_prio=0 tid=0x00007fa0d802f000 nid=0x10 runnable   "GC task thread#8 (ParallelGC)" os_prio=0 tid=0x00007fa0d8030800 nid=0x11 runnable   "GC task thread#9 (ParallelGC)" os_prio=0 tid=0x00007fa0d8032800 nid=0x12 runnable   "GC task thread#10 (ParallelGC)" os_prio=0 tid=0x00007fa0d8034000 nid=0x13 runnable   "GC task thread#11 (ParallelGC)" os_prio=0 tid=0x00007fa0d8036000 nid=0x14 runnable   "GC task thread#12 (ParallelGC)" os_prio=0 tid=0x00007fa0d8037800 nid=0x15 runnable   "GC task thread#13 (ParallelGC)" os_prio=0 tid=0x00007fa0d8039000 nid=0x16 runnable   "GC task thread#14 (ParallelGC)" os_prio=0 tid=0x00007fa0d803b000 nid=0x17 runnable   "GC task thread#15 (ParallelGC)" os_prio=0 tid=0x00007fa0d803c800 nid=0x18 runnable   "GC task thread#16 (ParallelGC)" os_prio=0 tid=0x00007fa0d803e800 nid=0x19 runnable   "GC task thread#17 (ParallelGC)" os_prio=0 tid=0x00007fa0d8040000 nid=0x1a runnable   "GC task thread#18 (ParallelGC)" os_prio=0 tid=0x00007fa0d8042000 nid=0x1b runnable   "GC task thread#19 (ParallelGC)" os_prio=0 tid=0x00007fa0d8043800 nid=0x1c runnable   "GC task thread#20 (ParallelGC)" os_prio=0 tid=0x00007fa0d8045800 nid=0x1d runnable   "GC task thread#21 (ParallelGC)" os_prio=0 tid=0x00007fa0d8047000 nid=0x1e runnable   "GC task thread#22 (ParallelGC)" os_prio=0 tid=0x00007fa0d8049000 nid=0x1f runnable   "GC task thread#23 (ParallelGC)" os_prio=0 tid=0x00007fa0d804a800 nid=0x20 runnable   "GC task thread#24 (ParallelGC)" os_prio=0 tid=0x00007fa0d804c800 nid=0x21 runnable   "GC task thread#25 (ParallelGC)" os_prio=0 tid=0x00007fa0d804e000 nid=0x22 runnable   "GC task thread#26 (ParallelGC)" os_prio=0 tid=0x00007fa0d8050000 nid=0x23 runnable   "GC task thread#27 (ParallelGC)" os_prio=0 tid=0x00007fa0d8051800 nid=0x24 runnable   "GC task thread#28 (ParallelGC)" os_prio=0 tid=0x00007fa0d8053800 nid=0x25 runnable   "GC task thread#29 (ParallelGC)" os_prio=0 tid=0x00007fa0d8055000 nid=0x26 runnable   "GC task thread#30 (ParallelGC)" os_prio=0 tid=0x00007fa0d8057000 nid=0x27 runnable   "GC task thread#31 (ParallelGC)" os_prio=0 tid=0x00007fa0d8058800 nid=0x28 runnable   "GC task thread#32 (ParallelGC)" os_prio=0 tid=0x00007fa0d805a800 nid=0x29 runnable   "GC task thread#33 (ParallelGC)" os_prio=0 tid=0x00007fa0d805c000 nid=0x2a runnable   "GC task thread#34 (ParallelGC)" os_prio=0 tid=0x00007fa0d805e000 nid=0x2b runnable   "GC task thread#35 (ParallelGC)" os_prio=0 tid=0x00007fa0d805f800 nid=0x2c runnable   "GC task thread#36 (ParallelGC)" os_prio=0 tid=0x00007fa0d8061800 nid=0x2d runnable   "GC task thread#37 (ParallelGC)" os_prio=0 tid=0x00007fa0d8063000 nid=0x2e runnable   "GC task thread#38 (ParallelGC)" os_prio=0 tid=0x00007fa0d8065000 nid=0x2f runnable   "GC task thread#39 (ParallelGC)" os_prio=0 tid=0x00007fa0d8066800 nid=0x30 runnable   "GC task thread#40 (ParallelGC)" os_prio=0 tid=0x00007fa0d8068800 nid=0x31 runnable   "GC task thread#41 (ParallelGC)" os_prio=0 tid=0x00007fa0d806a000 nid=0x32 runnable   "GC task thread#42 (ParallelGC)" os_prio=0 tid=0x00007fa0d806c000 nid=0x33 runnable   "VM Periodic Task Thread" os_prio=0 tid=0x00007fa0d8131000 nid=0x4b waiting on condition   JNI global references: 1864 ```</body>
		<created>2020-03-31 13:17:34</created>
		<closed>2020-06-12 10:15:44</closed>
	</bug>
	<bug>
		<id>9185</id>
		<title>Create+delete vertex with unique index inside transaction causes NPE</title>
		<body>### OrientDB Version: 3.0.30   ### Java Version: 1.8   ### OS: Windows 10    ## Expected behavior   batch executes without errors    ## Actual behavior   NPE occures    ## Steps to reproduce   drop class _Object if exists unsafe; create class _Object extends V; create property _Object.name STRING; CREATE INDEX _Object.name UNIQUE; begin; insert into _Object(name) values ('c'); let top = (select from _Object where name='c'); delete vertex $top; commit; return $top; </body>
		<created>2020-03-25 13:19:03</created>
		<closed>2020-06-05 14:56:39</closed>
	</bug>
	<bug>
		<id>9169</id>
		<title>NPE due to incorrect condition in java</title>
		<body>Hello,  Please check the following 2 lines of code https://github.com/orientechnologies/orientdb/blob/add35f9de6cc3f50f630a15d96e1a5df32007aeb/core/src/main/java/com/orientechnologies/orient/core/storage/impl/local/statistic/OSessionStoragePerformanceStatistic.java#L1197-L1198  As you can see: you can get easily NPE if walCountersHolder==null (our case).  Full exception: ``` Uncaught exception in thread 'OrientDB Write Cache Flush Task (Orienteer)' java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.statistic.OSessionStoragePerformanceStatistic.makeSnapshotIfNeeded(OSessionStoragePerformanceStatistic.java:1236)         at com.orientechnologies.orient.core.storage.impl.local.statistic.OSessionStoragePerformanceStatistic.stopWriteCacheFlushTimer(OSessionStoragePerformanceStatistic.java:716)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicFlushTask.run(OWOWCache.java:1931)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) ```</body>
		<created>2020-03-17 00:41:20</created>
		<closed>2020-06-12 13:34:28</closed>
	</bug>
	<bug>
		<id>9161</id>
		<title>Index silently got corrupted</title>
		<body>### OrientDB Version: 3.0.28 ### Java Version: openjdk version "11" 2018-09-25 ### OS: Ubuntu 19.10  I have an index on an integer property. In some moment, it got corrupted; when I do a query using the index, the same vertex (same RID) is returned twice:  ![Captura de pantalla de 2020-03-05 08-19-27](https://user-images.githubusercontent.com/5256776/75977846-04772080-5ebc-11ea-9aa2-ed42902ab170.png)  After rebuilding the index, the query returns the correct result:  ![Captura de pantalla de 2020-03-05 08-19-35](https://user-images.githubusercontent.com/5256776/75977912-22448580-5ebc-11ea-96ae-90d1255020a5.png)  It's not the first time that my indexes got corrupted, the problem is that I have no way of knowing that, only when I see incorrect results of a query I'm doing myself. In this case, I discovered the problem because an edge was created twice between two vertices:  ``` let $a = select from #some:rid; let $b = select from V where indexed_property = some_value; /* this returned the same vertex twice */ create edge from $a to $b; /* as $b is a collection with the same vertex repeated, the edge is created twice between the vertices */ </body>
		<created>2020-03-05 11:35:36</created>
		<closed>2020-06-12 09:30:00</closed>
	</bug>
	<bug>
		<id>9144</id>
		<title>IndexOutOfBoundsException inserting data with "scripts"</title>
		<body>### OrientDB Version: 3.0.25 ### Java Version: 1.8 ### OS: linux  ## Expected behavior   There are no exceptions when inserting  ## Actual behavior   `Exception `76F1BE16` in storage `plocal:/opt/orientdb/databases/test`: 3.0.25 - Veloce (build ac37bbb108b048fa9a8fb17d094fc614cb61dce4, branch 3.0.x) java.lang.IndexOutOfBoundsException: Index: 0, Size: 0         at java.util.ArrayList.rangeCheck(ArrayList.java:657)         at java.util.ArrayList.get(ArrayList.java:433)         at com.orientechnologies.orient.core.storage.index.sbtree.multivalue.v2.Bucket.shrink(Bucket.java:954)         at com.orientechnologies.orient.core.storage.index.sbtree.multivalue.v2.OCellBTreeMultiValueV2.splitNonRootBucket(OCellBTreeMultiValueV2.java:1325)         at com.orientechnologies.orient.core.storage.index.sbtree.multivalue.v2.OCellBTreeMultiValueV2.splitBucket(OCellBTreeMultiValueV2.java:1262)         at com.orientechnologies.orient.core.storage.index.sbtree.multivalue.v2.OCellBTreeMultiValueV2.put(OCellBTreeMultiValueV2.java:323)         at com.orientechnologies.orient.core.index.engine.v1.OCellBTreeMultiValueIndexEngine.put(OCellBTreeMultiValueIndexEngine.java:175)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doPutRidIndexEntry(OAbstractPaginatedStorage.java:2785)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.putRidIndexEntry(OAbstractPaginatedStorage.java:2751)         at com.orientechnologies.orient.core.index.OIndexMultiValues.doPutV1(OIndexMultiValues.java:200)         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:130)         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:53)         at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:847)         at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:693)         at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:665)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:2153)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2081)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1904)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2721)         at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:363)         at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:166)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.endMicroTransaction(ODatabaseDocumentEmbedded.java:797)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.executeSaveRecord(ODatabaseDocumentEmbedded.java:787)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:184)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2088)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2050)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:1940)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:86)         at com.orientechnologies.orient.core.sql.executor.SaveElementStep$1.next(SaveElementStep.java:40)         at com.orientechnologies.orient.core.sql.executor.ConvertToResultInternalStep$1.fetchNextItem(ConvertToResultInternalStep.java:62)         at com.orientechnologies.orient.core.sql.executor.ConvertToResultInternalStep$1.hasNext(ConvertToResultInternalStep.java:88)         at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:47)         at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:169)         at com.orientechnologies.orient.core.sql.parser.OLetStatement.executeSimple(OLetStatement.java:36)         at com.orientechnologies.orient.core.sql.executor.OSingleOpExecutionPlan.executeInternal(OSingleOpExecutionPlan.java:99)         at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:37)         at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.executeFull(OScriptExecutionPlan.java:215)         at com.orientechnologies.orient.core.sql.executor.ForEachStep.syncPull(ForEachStep.java:47)         at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37)         at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46)         at com.orientechnologies.orient.core.sql.executor.ScriptLineStep.syncPull(ScriptLineStep.java:33)         at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89)         at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:50)         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:39)         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:30)         at com.orientechnologies.orient.core.command.OSqlScriptExecutor.executeInternal(OSqlScriptExecutor.java:109)         at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:55)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:637)         at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1297)         at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:136)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:310)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:212)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)`  ## Steps to reproduce   My setup is that I'm running an scheduled process that inserts periodically into orientdb using "scripts" using multiple threads. I've been running this for a few days and I found these exceptions. Let me know what info could be helpful to fix this issue. Thanks!  </body>
		<created>2020-02-18 14:15:49</created>
		<closed>2020-08-09 22:21:38</closed>
	</bug>
	<bug>
		<id>9140</id>
		<title>Migrating from 2.2.20 orient to 3.0.26 but orient building got struck.</title>
		<body>### OrientDB Version: 3.0.26 ### Java Version:  jdk1.8.0_121 ### OS: Centos 7  ## Expected behavior   Current orient version using 2.2.20. Now trying to migrating to 3.0.26 Adding new orient jars in my application server and trying to build new orient database.  ## Actual behavior  We are adding various objectTypes of ODocument into orient database.  During addition, observing following jstack and hence orient threads in waiting state.  "InventoryDataBuilderMaster_CircuitPlugInventoryDataBuilder" #848 prio=5 os_prio=0 tid=0x00007fc15ec8c800 nid=0x4df6 waiting on condition [0x00007fc0d 7944000]    java.lang.Thread.State: WAITING (parking)         at sun.misc.Unsafe.park(Native Method)         - parking to wait for  &lt;0x0000000724854388&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock)         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:143)         at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.acquireSchemaReadLock(OSchemaShared.java:335)         at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.countClasses(OSchemaShared.java:178)         at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.countClasses(OSchemaProxy.java:57)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPooled.internalOpen(OPartitionedDatabasePool.java:445)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.openDatabase(OPartitionedDatabasePool.java:306)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.acquire(OPartitionedDatabasePool.java:246)         at in.co.nmsworks.documenttdb.spi.impl.orient.OrientInternal.getDatabase(OrientInternal.java:521)         at in.co.nmsworks.documenttdb.db.DocDB.createDB(DocDB.java:390)         at in.co.nmsworks.documenttdb.db.DocDB.&lt;init&gt;(DocDB.java:77)         at in.co.nmsworks.documenttdb.db.DocDB.&lt;init&gt;(DocDB.java:82)         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.store.InvWriter.addObjectsToOrientDB(InvWriter.java:980)         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.builder.CircuitPlugInventoryDataPersister.addObjectsToOrientDB(CircuitPlugInventoryDat aPersister.java:777)         - locked &lt;0x000000070b88aad0&gt; (a in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.builder.CircuitPlugInventoryDataPersister)         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.builder.CircuitPlugInventoryDataPersister.storeStatus(CircuitPlugInventoryDataPersiste r.java:768)         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.queue.InventoryDataBuilderMaster.getInventoryDataBuilderJobs(InventoryDataBuilderMaste r.java:310)         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.queue.InventoryDataBuilderMaster.process(InventoryDataBuilderMaster.java:273)         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.queue.InventoryDataBuilderMaster.run(InventoryDataBuilderMaster.java:211)         at in.co.nmsworks.util.ShutdownAwareJobFactory$ShutdownAwareRunnable.run(ShutdownAwareJobFactory.java:162)         at java.lang.Thread.run(Thread.java:745)   Please suggest for the above mentioned issue.  Is there  anything I have to add to my application server please suggest..  Post here for any more information needed.</body>
		<created>2020-02-15 07:32:05</created>
		<closed>2020-06-01 11:44:07</closed>
	</bug>
	<bug>
		<id>9134</id>
		<title>[SEARCH] Error on highlight query with empty value</title>
		<body>### OrientDB Version: 3.0.27 ### OS: linux (docker image)  ## Expected behavior   Using highlight in SEARCH_CLASS should work even if a value is null.  ## Actual behavior   Using highlight in SEARCH_CLASS return an error if an indexed field has null/empty value.       `java.lang.IllegalArgumentException: Field title in document is not stored and cannot be analyzed`  ## Steps to reproduce   ```SQL CREATE CLASS MyClass EXTENDS V; CREATE PROPERTY MyClass.title STRING; CREATE PROPERTY MyClass.description STRING;  CREATE INDEX MyClass.fulltxtindex ON MyClass(title, description) FULLTEXT ENGINE LUCENE;  INSERT INTO MyClass (description) VALUES ("Test 1 !");  SELECT $title_hl, $description_hl FROM MyClass WHERE SEARCH_CLASS("test", {     "highlight": {         "fields": ["title", "description"]     } }) = true  ```  </body>
		<created>2020-02-11 10:25:34</created>
		<closed>2020-02-12 08:54:53</closed>
	</bug>
	<bug>
		<id>9118</id>
		<title>Fulltext Index with Lucene: boost option does not work</title>
		<body>### OrientDB Version: 3.0.27   ### Java Version: 1.8   ### OS: Windows 7 x64    ## Expected behavior   `SELECT FROM City WHERE SEARCH_CLASS("+name:cas*  +description:beautiful", { "allowLeadingWildcard": true , "boost": {     "name": 2 } } ) = true`    ## Actual behavior   Error: java.lang.ClassCastException: **java.lang.Integer** cannot be cast to **java.lang.Float**    ## Steps to reproduce   `SELECT FROM City WHERE SEARCH_CLASS("+name:cas*  +description:beautiful", { "allowLeadingWildcard": true , "boost": {     "name": 2.0f } } ) = true`  ## Returns: Error: java.lang.ClassCastException: **java.lang.Double** cannot be cast to **java.lang.Float** </body>
		<created>2020-01-29 10:03:57</created>
		<closed>2020-01-29 10:51:26</closed>
	</bug>
	<bug>
		<id>9105</id>
		<title>NPE in geospatial query with subquery</title>
		<body>### OrientDB Version: 3.0.27   ### Java Version: jdk1.8.0_231   ### OS: windows 10   ## Expected behavior   Batch executes without errors    ## Actual behavior   NPE thrown    ## Steps to reproduce   ``` drop class Country if exists unsafe; create class Country extends V; create property Country.name STRING; create property Country.geometry EMBEDDED OMultiPolygon; drop class POI if exists unsafe; create class POI extends V; create property POI.name STRING; create property POI.location EMBEDDED OPoint; insert into POI(name, location) values(zeropoint, St_GeomFromText(Point(0 0))); insert into Country(name, geometry) values(zeroland, St_GeomFromText(MultiPolygon(((1 1, 1 -1, -1 -1, -1 1, 1 1))))); CREATE INDEX POI.location ON POI(location) SPATIAL ENGINE LUCENE; CREATE INDEX Country.geometry ON Country(geometry) SPATIAL ENGINE LUCENE; let name = select name from Country where ST_Contains(geometry, (select location from POI)) = true; return $name;  ``` Throws exception: ``` java.lang.NullPointerException at com.orientechnologies.orient.core.sql.executor.FetchFromIndexedFunctionStep.init(FetchFromIndexedFunctionStep.java:100) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexedFunctionStep.syncPull(FetchFromIndexedFunctionStep.java:38) at com.orientechnologies.orient.core.sql.executor.FilterByClustersStep$1.fetchNextItem(FilterByClustersStep.java:57) at com.orientechnologies.orient.core.sql.executor.FilterByClustersStep$1.hasNext(FilterByClustersStep.java:93) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.fetchNextItem(FilterByClassStep.java:50) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.hasNext(FilterByClassStep.java:88) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.hasNext(ProjectionCalculationStep.java:33) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:40) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.(OLocalResultSet.java:30) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:276) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:79) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:567) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:189) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:95) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:228) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:707) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)  ``` Query  `select name from Country where ST_Contains(geometry, POINT(0 0)) = true` executes without errors. </body>
		<created>2020-01-10 06:48:34</created>
		<closed>2020-01-10 12:10:33</closed>
	</bug>
	<bug>
		<id>9096</id>
		<title>Cant traverse hierarchy of just created objects untill transaction is commited</title>
		<body>### OrientDB Version: OrientDB Server v3.0.26   ### Java Version: jdk1.8.0_231   ### OS: windows 10    ## Expected behavior   batch executes without errors    ## Actual behavior   exception thrown: java.lang.IllegalArgumentException: Invalid property value for OResult: [#1982:-3] - com.orientechnologies.orient.core.db.record.ridbag.ORidBag    ## Steps to reproduce   ``` drop class _Object if exists unsafe; create class _Object extends V; create property _Object.name STRING; drop class _Contains if exists unsafe; create class _Contains extends E; begin; insert into _Object(name) values (a), (b), (c); create edge _Contains from (select from _Object where name = a) to (select from _Object where name = b); create edge _Contains from (select from _Object where name = b) to (select from _Object where name = c); let top = (select * from (traverse in(_Contains) from (select from _Object where name=c)) where in(_Contains).size() == 0); commit; return $top ```</body>
		<created>2019-12-26 19:25:15</created>
		<closed>2019-12-27 10:53:51</closed>
	</bug>
	<bug>
		<id>9092</id>
		<title>create index error when property names are numbers</title>
		<body>### OrientDB Version: 3.0.26, 3.1.0-M3 ### Java Version: 1.8 ### OS: OSX  ## Expected behavior   As a user I need to be able to create an index on properties of a class that a numbers, e.g. "1" or "2"  ## Actual behavior   When I use create index with property names that are numbers I the following exception.  com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: create index _idx_me on IndexMe ( 1, 2 ) UNIQUE STRING, STRING  ## Steps to reproduce This snippet of code reproduces the issue. The properties are created without issue however the call to "createIndex" fails with the exception mentioned above.   try (ODatabaseDocument connection = getConnection()) {             ODocument doc = new ODocument("IndexMe");             doc.setProperty("1", "one");             doc.setProperty("2", "two");             doc.save();              OClass oclass = connection.getMetadata().getSchema().getClass("IndexMe");             oclass.createProperty("1", OType.STRING).setMandatory(false);             oclass.createProperty("2", OType.STRING).setMandatory(false);              oclass.createIndex("_idx_me", INDEX_TYPE.UNIQUE, "1", "2");         }     </body>
		<created>2019-12-12 21:33:21</created>
		<closed>2019-12-13 11:20:10</closed>
	</bug>
	<bug>
		<id>9087</id>
		<title>dropClass fails when class name contains dash</title>
		<body>### OrientDB Version: 3.0.26, 3.1.0-M3 ### Java Version: 1.8  ### OS: OSX  ## Expected behavior   Expected that when "dropClass" is called for a class name that contains a dash that it succeeds.  ## Actual behavior   Actual behavior is that an exception is thrown that the command cannot be parsed.     ## Steps to reproduce   1. Use OSchema to create a new class named "test-class"  2. OSchema method "dropClass" with the same name. An exception is thrown.  The same behavior is observed trying to use SQL to execute the drop class. See attached junit 4 test where "dropClass" throws an exception when a dash is in the class name. [UnitTestClasses.zip](https://github.com/orientechnologies/orientdb/files/3952793/UnitTestClasses.zip)  </body>
		<created>2019-12-11 21:58:22</created>
		<closed>2019-12-16 11:04:40</closed>
	</bug>
	<bug>
		<id>9066</id>
		<title>OrientGraphFactory graph connection leakI think it is fatal error</title>
		<body>### maven depend `&lt;dependency&gt;       &lt;groupId&gt;com.orientechnologies&lt;/groupId&gt;       &lt;artifactId&gt;orientdb-gremlin&lt;/artifactId&gt;       &lt;version&gt;3.0.24&lt;/version&gt;     &lt;/dependency&gt;` ### Java Version: 1.8     ## Steps to reproduce   1 config `OrientGraphBaseFactory factory = new OrientGraphFactory(config.getUrl(), config.getUsername(), config.getPassword())                     .setupPool(config.getMaxConnection());             return new OrientDBGraphDataSource(factory);` 2use GraphTraversalSource to addVertex when throw ORecordDuplicatedException, ![image](https://user-images.githubusercontent.com/8341790/69038428-bcbfac80-0a24-11ea-87c7-6e02ac6a3e91.png)  ![image](https://user-images.githubusercontent.com/8341790/69037758-69009380-0a23-11ea-8c03-2448e80d3339.png)  3Multiple loop calls reporting errors  ![image](https://user-images.githubusercontent.com/8341790/69037940-cbf22a80-0a23-11ea-9304-a9d832a212e3.png)  4When multithreaded requests occur, this error will immediately deplete connection pool resources then throw   &gt; com.orientechnologies.common.concur.lock.OLockException: No more resources available in pool (max=xx). Requested resource: null  I think this is bugwhen cause exception pool connection was not close and open new  this error cause I can't use orientdb to project</body>
		<created>2019-11-18 09:00:11</created>
		<closed>2019-11-19 12:35:12</closed>
	</bug>
	<bug>
		<id>9061</id>
		<title>hangs with OutOfMemoryError: Java Heap space when trying to create an edge</title>
		<body>### OrientDB Version: 3.0.12   ### Java Version: 10.0.2 ### OS: Windows   ## Expected behavior   Should be able to create an edge with no error.  ## Actual behavior   OrientDB hangs and throws OutofmemoryError: Java Heap space when trying to create an edge.  ## Steps to reproduce   Adding the sample database with three vertex, one edge and one function. Please execute the function vertex_job_create to reproduce the issue.   [db1.gz](https://github.com/orientechnologies/orientdb/files/3831189/db1.gz) </body>
		<created>2019-11-11 11:57:06</created>
		<closed>2020-07-03 17:13:35</closed>
	</bug>
	<bug>
		<id>9048</id>
		<title>CONTAINSANY bug with subquery</title>
		<body>### OrientDB Version: 3.0.22 ### Java Version:  openjdk version "1.8.0_191" OpenJDK Runtime Environment (build 1.8.0_191-b12) OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode  ### OS: centos07  ## Expected behavior   The query should always return the same results. Should not change if there is no index  ## Actual behavior   Unless the index is added the query does not return any results  ## Steps to reproduce    ```sql create class Main extends V create property Main.linksetprop linkset V  create vertex V set name = 'bob' /* 9:0 */ create vertex V set name = 'dudley' /* 9:1 */ create vertex V set name = 'alice' /* 10:0 */ create vertex V set name = 'marc' /* 11:0 */ create vertex V set name = 'harry' /* 12:0 */  create vertex Main set linksetprop = [#9:0, #10:0] create vertex Main set linksetprop = [#9:0, #11:0] create vertex Main set linksetprop = [#9:0, #12:0]  select * from Main where linksetprop containsany [#9:0]  /* 3 results*/  select * from V where name = 'bob' /* 1 result (9:0) */  select * from Main where linksetprop containsany (select * from V where name = 'bob')  /* no results */  create index Main.linksetprop on Main (linksetprop) NOTUNIQUE  select * from Main where linksetprop containsany (select * from V where name = 'bob')  /* 3 results */ ```  </body>
		<created>2019-10-23 17:42:46</created>
		<closed>2019-10-28 16:36:37</closed>
	</bug>
	<bug>
		<id>9020</id>
		<title>[Lucene] Cannot Insert large data into a indexed field</title>
		<body>### OrientDB Version: 3.0.23 ### OS: Linux  ## Expected behavior   Lucene Index works with all content size OR is configurable to work with all string data.  ## Actual behavior   OrientDB throw an error with large indexed content.     - If index exists, cannot Insert large content.     - If index do not exists but a large content is set, cannot create an index.      ## Steps to reproduce   ```sql CREATE CLASS Luindex EXTENDS V; CREATE PROPERTY Luindex.afield STRING; INSERT INTO Luindex SET afield="verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylongverylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong  verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong verylong";  CREATE INDEX Luindex.afield ON Luindex(afield) FULLTEXT ENGINE LUCENE; ```  The index creation will fail with the following message :  ```bash Error: com.orientechnologies.orient.core.index.OIndexException: Cannot create the index 'Luindex.afield' Error: java.lang.IllegalArgumentException: DocValuesField "afield" is too large, must be &lt;= 32766 ```  Also if we create the index when the Luindex vertex is empty, index will be created, but the `INSERT` statement will fail with the same error.</body>
		<created>2019-09-25 13:09:54</created>
		<closed>2019-10-02 08:27:36</closed>
	</bug>
	<bug>
		<id>9005</id>
		<title>Unknown checkpoint record type</title>
		<body>### OrientDB Version: 3.0.23 [olddb.zip](https://github.com/orientechnologies/orientdb/files/3577721/olddb.zip)  ## Expected behavior   Database was created with version 2.2.37.  ## Actual behavior    ``` 2019-09-05 16:46:21 t.c.s.a.d.Services [DEB 2.2.37.UG] error:stop:com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database 'archiva' com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database 'archiva' at com.orientechnologies.orient.core.db.OrientDBEmbedded.open(OrientDBEmbedded.java:300) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:904) at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPooled.internalOpen(OPartitionedDatabasePool.java:440) at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.openDatabase(OPartitionedDatabasePool.java:303) at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.acquire(OPartitionedDatabasePool.java:261) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:172) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:78) at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:137) at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory$1.getGraph(OrientGraphFactory.java:87) at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getTx(OrientGraphFactory.java:224) at com.stimulus.archiva.database.blueprints.BluePrintDatabaseUtil.dropOldIndexes(BluePrintDatabaseUtil.java:112) at com.stimulus.archiva.database.blueprints.BluePrintDatabaseUtil.initGraphFactory(BluePrintDatabaseUtil.java:171) at com.stimulus.archiva.database.blueprints.BluePrintDatabase.connect(BluePrintDatabase.java:96) at com.stimulus.archiva.database.DatabaseService.startup(DatabaseService.java:186) at com.stimulus.archiva.domain.Services$ServiceController.lambda$startStop$0(Services.java:142) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Unknown checkpoint record type com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OEmptyWALRecord at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.restoreFromWAL(OAbstractPaginatedStorage.java:5289) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.recoverIfNeeded(OAbstractPaginatedStorage.java:4512) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:376) at com.orientechnologies.orient.core.db.OrientDBEmbedded.open(OrientDBEmbedded.java:281) ... 17 common frames omitted ```  ## Steps to reproduce    Open the attached database (it was created using 2.2.37 and I believe it was shutdown correctly) </body>
		<created>2019-09-05 06:27:15</created>
		<closed>2020-06-12 11:56:21</closed>
	</bug>
	<bug>
		<id>9000</id>
		<title>Endless loop when updating a record after creation in batch mode</title>
		<body>### OrientDB Version: 3.0.22 ### Java Version: 1.8 ### OS: Linux  ## Expected behavior   The record should be updated just once.    ## Actual behavior   There is an endless loop. The record is updated multiple times.  ## Steps to reproduce   Use the following SQL script in batch mode : `let a = CREATE VERTEX V SET test = 0; UPDATE $a SET test = $a.@rid;`  Hope this helps. Cheers. </body>
		<created>2019-08-27 11:58:50</created>
		<closed>2019-10-01 09:22:59</closed>
	</bug>
	<bug>
		<id>8973</id>
		<title>CONTAINSANY fails when used filtering against edge collection</title>
		<body>### OrientDB Version: 3.0.22 ### Java Version: openjdk version "1.8.0_191" OpenJDK Runtime Environment (build 1.8.0_191-b12) OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode) ### OS: centos07  ## Behavior    I can use CONTAINSANY to filter against a linkset ok, but when I try to filter against edges, none of the operators work  ## Steps to reproduce    Using the demodb, say I were to search for all castles a specific set of customers has visited  I make a query to find the customers, for example ```sql select * from customers where Phone like '+141%' ```  Then I want to see what castles these customers have visited. I've tried a couple different queries for this  ```sql select * from castles where in('HasVisited') containsany (select * from customers where Phone like '+141%')  select * from castles where in('HasVisited') containsany (select @rid from customers where Phone like '+141%')  select * from castles where inE('HasVisited').outV() containsany (select * from customers where Phone like '+141%')  select * from castles where inE('HasVisited').outV() containsany (select @rid from customers where Phone like '+141%')  select * from castles where in('HasVisited') containsany (Phone like '+141%') ```  But none of the above return anything even tho we can verify that there are castles where customers with this phone pattern have visited  ```sql select count(*)  from (select in('HasVisited').Phone as customerPhone, @rid, Name from castles unwind customerPhone) where customerPhone like '+141%' ``` returns 26 records   note: this used to be possible in 2.2.X using `edgeCollection in otherCollection`</body>
		<created>2019-08-01 18:57:49</created>
		<closed>2019-08-13 15:49:04</closed>
	</bug>
	<bug>
		<id>8965</id>
		<title>Rebuilding Indexes results in java.util.IllegalFormatConversionException: d != java.util.ArrayList</title>
		<body>### OrientDB Version: 3.0.22 ### Java Version:  openjdk version "1.8.0_191" OpenJDK Runtime Environment (build 1.8.0_191-b12) OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode)   ### OS: Centos 7  ## Expected behavior   Successful rebuilding of indexes   ## Actual behavior   ``` Rebuilding index(es)... Rebuilt index(es). Found  Error: java.util.IllegalFormatConversionException: d != java.util.ArrayList ```  ## Steps to reproduce  After a database crash, I ran a `CHECK DATABASE` in console which gave me  ``` Total errors found on indexes: 65590 ``` So I try a `REBUILD INDEX` on any index and it throws the error message above. </body>
		<created>2019-07-24 22:14:33</created>
		<closed>2020-07-03 17:13:25</closed>
	</bug>
	<bug>
		<id>8955</id>
		<title>Unable to store result of unionall in let query variable</title>
		<body>### OrientDB Version: 3.0.20   ### Java Version openjdk version "1.8.0_191" OpenJDK Runtime Environment (build 1.8.0_191-b12) OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode) ### OS: centos07  ## Expected behavior   Using the demodb I expected the following queries to both return the same result  ```sql select expand($d)    let $a = (select * from Countries where Name like 'A%'),         $b = (select * from Countries where Name like 'B%'),         $c = UNIONALL($a, $b),         $d = (select * from (select expand($c)) where Name like '%a'); ```  ```sql select expand($d)    let $a = (select * from Countries where Name like 'A%'),         $b = (select * from Countries where Name like 'B%'),         $d = (select * from (select expand(UNIONALL($a, $b))) where Name like '%a'); ```  ## Actual behavior   The first query returns nothing, The second query returns the expected 18 records  ## Steps to reproduce    Run the queries outlined above  </body>
		<created>2019-07-11 16:25:23</created>
		<closed>2019-08-13 15:22:23</closed>
	</bug>
	<bug>
		<id>8954</id>
		<title>sql output</title>
		<body>### OrientDB Version: 2.23  ### Java Version: 1.8   ### OS: windows    ## Expected behavior   select myfield from someclass should just bring back myfield's data and not the rid,type,version    ## Actual behavior   you always get these in your http rest call before the property in the select statement output ## Steps to reproduce   just create a simple SQL against a class  </body>
		<created>2019-07-11 15:40:58</created>
		<closed>2020-06-03 16:08:09</closed>
	</bug>
	<bug>
		<id>8950</id>
		<title>filehandles leak</title>
		<body>### OrientDB Version: 3.0.21   ### Java Version: java version "1.8.0_181" Java(TM) SE Runtime Environment (build 1.8.0_181-b13) Java HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode) ### OS: Linux mailarchivadb 4.15.0-54-generic #58-Ubuntu SMP Mon Jun 24 10:55:24 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux    ## Expected behavior   No leak of filehandles   ## Actual behavior   filehandles are leaking from orientdb    ## Steps to reproduce   Add many databases with such pattern plocal:/path/to/db/random/$db_name and start database.  some of file leaks stacktrace  ``` #3 /var/opt/mailarchiva/portman/database/archiva/portman/orole.cpm by thread:service-4 on Tue Jul 09 08:29:26 UTC 2019         at java.io.RandomAccessFile.&lt;init&gt;(RandomAccessFile.java:244)         at com.orientechnologies.orient.core.storage.fs.OFileClassic.openChannel(OFileClassic.java:805)         at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:625)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.readNameIdMapV1(OWOWCache.java:1962)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.initNameIdMapping(OWOWCache.java:1766)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.loadRegisteredFiles(OWOWCache.java:479)         at com.orientechnologies.orient.core.storage.disk.OLocalPaginatedStorage.initWalAndDiskCache(OLocalPaginatedStorage.java:632)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:371)         at com.orientechnologies.orient.core.db.OrientDBEmbedded.open(OrientDBEmbedded.java:281)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:903)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPooled.internalOpen(OPartitionedDatabasePool.java:440)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.openDatabase(OPartitionedDatabasePool.java:300)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.acquire(OPartitionedDatabasePool.java:261)         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:172)         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:78)         at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:137)         at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory$1.getGraph(OrientGraphFactory.java:87)         at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getTx(OrientGraphFactory.java:224)         at com.stimulus.archiva.hp.c(MailArchiva:116)         at com.stimulus.archiva.hp.a(MailArchiva:168)         at com.stimulus.archiva.hn.a(MailArchiva:89)         at com.stimulus.archiva.database.DatabaseService.c(MailArchiva:188)         at com.stimulus.archiva.domain.bv$a.a(MailArchiva:142)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) ```   [fileleaks.tar.gz](https://yadi.sk/d/Lnnp3R3EuxaeCg)  </body>
		<created>2019-07-09 09:05:02</created>
		<closed>2019-07-10 14:21:57</closed>
	</bug>
	<bug>
		<id>8949</id>
		<title>[Bug] Java Api .command(query) result in a temporary RID</title>
		<body>### OrientDB Version: 3.0.21 ### Java Version: 1.8.0_211   ### OS: Windows 10  ## Expected behavior The result of a create query will include a positive (real) RID  ## Actual behavior   The result of a create query includes a negative (temporary) RID  ## Steps to reproduce   ``` // ODatabase session = ... // obtain a session to the database OResultSet result = session.command("CREATE VERTEX User SET name=\"bla1\""); // RID: result.next().getRecord().get().getIdentity() ```</body>
		<created>2019-07-08 14:24:07</created>
		<closed>2019-07-09 09:59:13</closed>
	</bug>
	<bug>
		<id>8940</id>
		<title>Error on using custom JS Function: OCommandScriptException</title>
		<body>### OrientDB Version: 3.0.20 ### Java Version:  openjdk version "1.8.0_191" OpenJDK Runtime Environment (build 1.8.0_191-b12) OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode) ### OS: centos07  ## Behavior   - References to deleted or renamed functions do not throw errors - previously the function I am trying to call worked. However after editing and deleting unrelated functions, now any custom function will throw an error - Stack trace shows functions that have been deleted  I'm not sure I can reproduce this reliably b/c I am unsure how I got here since the functions causing the issues have been deleted and no longer exist  ``` com.orientechnologies.orient.core.command.script.OCommandScriptException: ScriptManager: error &lt;eval&gt;:220:7 Expected ; but found displayRecord select displayRecord(*) from (select expand(out('ImpliedBy')) from 83:2775) ^ in &lt;eval&gt; at line number 220 at column number 7. Function previewStatement(ridParam):  215: return 'name';  216: }  217:  218: function previewStatement(ridParam) {  219: // format the conditions  220: &gt;&gt;&gt; select displayRecord(*) from (select expand(out('ImpliedBy')) from 83:2775)  221: SELECT [] as conditions,  222: previewOntology(relevance.sourceId, relevance.name)[0].preview as relevance,  223: previewOntology(appliesTo.sourceId, appliesTo.name)[0].preview as object,  224: previewEvidenceList(:ridParam)[0].evidence as evidence  225: FROM (SELECT expand(:ridParam)) DB name="development" ``` I tried renaming the functions instead of editing the old ones to test if it just wasn't updating the functions. but it appears no matter what I do, the invalid function is called instead of the current one. despite the fact that it has been deleted  ## Steps to Reproduce Related? Problem But I can reproduce what I think might be related to the problem?  ```sql create function calledByOtherFunction 'return 1;' IDEMPOTENT TRUE LANGUAGE JavaScript create function callsOtherFunction 'return calledByOtherFunction();' IDEMPOTENT TRUE LANGUAGE JavaScript  select callsOtherFunction() // works  // go to the function editor page /studio/index.html#/database/&lt;DBNAME&gt;/browse // rename calledByOtherFunction to calledByOtherFunctionRenamed  select callsOtherFunction() // still works.... ```  the code does not update the reference so I am unsure as to why this doesn't cause a reference error to be thrown  ```json {     "result": [         {             "@type": "d",             "@rid": "#6:0",             "@version": 3,             "@class": "OFunction",             "idempotent": true,             "code": "return 1;",             "name": "calledByOtherFunctionRenamed",             "language": "JavaScript"         },         {             "@type": "d",             "@rid": "#6:1",             "@version": 2,             "@class": "OFunction",             "idempotent": true,             "code": "return calledByOtherFunction();",             "name": "callsOtherFunction",             "language": "JavaScript"         }     ], } ```  Note that I couldn't figure out how to rename the function with SQL only and not using the function editor page</body>
		<created>2019-07-03 22:52:05</created>
		<closed>2019-07-08 08:44:52</closed>
	</bug>
	<bug>
		<id>8932</id>
		<title>Magic number verification failed for page</title>
		<body>### OrientDB Version: 3.0.21   ### Java Version: 1.8.0_144 ### OS: windows 10  ## Expected behavior      ## Actual behavior    &gt; Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: Windows OS is detected, 262144 limit of open files will be set for the disk cache. Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: 17118322688 B/16325 MB/15 GB of physical memory were detected on machine Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: Detected memory limit for current process is 17118322688 B/16325 MB/15 GB Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: JVM can use maximum 3628MB of heap memory Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: Because OrientDB is running outside a container 12% of memory will be left unallocated according to the setting 'memory.leftToOS' not taking into account heap memory Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: OrientDB auto-config DISKCACHE=10,737MB (heap=3,628MB os=16,325MB) Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: System is started under an effective user : `test` Jun 30, 2019 1:29:32 PM com.orientechnologies.common.log.OLogManager log INFO: Allocation of 163202 pages. Jun 30, 2019 1:29:33 PM com.orientechnologies.common.log.OLogManager log INFO: WAL maximum segment size is set to 6,144 MB Jun 30, 2019 1:29:33 PM com.orientechnologies.common.log.OLogManager log INFO: Page size for WAL located in Z:\PortableApps\eclipse-oxygen-2\workspace\orientdbtest\.\db\test is set to 4096 bytes. Jun 30, 2019 1:29:33 PM com.orientechnologies.common.log.OLogManager log WARNING: Storage 'test' was not closed properly. Will try to recover from write ahead log Jun 30, 2019 1:29:33 PM com.orientechnologies.common.log.OLogManager log INFO: Looking for last checkpoint... Jun 30, 2019 1:29:33 PM com.orientechnologies.common.log.OLogManager log INFO: Checkpoints are absent, the restore will start from the beginning. Jun 30, 2019 1:29:33 PM com.orientechnologies.common.log.OLogManager log INFO: Data restore procedure is started. Jun 30, 2019 1:29:34 PM com.orientechnologies.common.log.OLogManager log WARNING: Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OEmptyWALRecord{lsn=OLogSequenceNumber{segment=1, position=18}} will be skipped during data restore Jun 30, 2019 1:29:34 PM com.orientechnologies.common.log.OLogManager log INFO: 1 operations were processed, current LSN is OLogSequenceNumber{segment=1, position=18} last LSN is OLogSequenceNumber{segment=2, position=18} Jun 30, 2019 1:29:34 PM com.orientechnologies.common.log.OLogManager log WARNING: Non tx operation was used during data modification we will need index rebuild. Jun 30, 2019 1:29:36 PM com.orientechnologies.common.log.OLogManager log WARNING: Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OEmptyWALRecord{lsn=OLogSequenceNumber{segment=2, position=18}} will be skipped during data restore Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: Storage data recover was completed Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: Storage 'plocal:Z:\PortableApps\eclipse-oxygen-2\workspace\orientdbtest\.\db/test' is opened under OrientDB distribution : 3.0.21 - Veloce (build 1d8b0c01ca8fe12a516bba355681e3ec8b218d1d, branch 3.0.x) Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Wait till indexes restore after crash was finished. Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'ORole.name' is a durable automatic index and will be added as is without rebuilding Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'ORole.name' was added in DB index list Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'OUser.name' is a durable automatic index and will be added as is without rebuilding Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'OUser.name' was added in DB index list Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'dictionary' is a durable non-automatic index and will be added as is without rebuilding Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'dictionary' was added in DB index list Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'OFunction.name' is a durable automatic index and will be added as is without rebuilding Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Index 'OFunction.name' was added in DB index list Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} 4 indexes were restored successfully, 0 errors Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log INFO: $ANSI{green {db=test}} Indexes restore after crash was finished. size: 675 Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: $ANSI{green {db=test}} Magic number verification failed for page `1425` of `pupil.pcl`. Jun 30, 2019 1:29:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: $ANSI{green {db=test}} Magic number verification failed for page `1425` of `pupil.pcl`. java.lang.Exception at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.dumpStackTrace(OWOWCache.java:2306) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.verifyMagicAndChecksum(OWOWCache.java:2264) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.loadFileContent(OWOWCache.java:2164) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:1137) at com.orientechnologies.orient.core.storage.cache.chm.AsyncReadCache.lambda$doLoad$0(AsyncReadCache.java:150) at java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1853) at com.orientechnologies.orient.core.storage.cache.chm.AsyncReadCache.doLoad(AsyncReadCache.java:147) at com.orientechnologies.orient.core.storage.cache.chm.AsyncReadCache.loadForRead(AsyncReadCache.java:115) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.loadPageForWrite(OAtomicOperation.java:111) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPageForWrite(ODurableComponent.java:129) at com.orientechnologies.orient.core.storage.cluster.v1.OPaginatedClusterV1.addEntry(OPaginatedClusterV1.java:1720) at com.orientechnologies.orient.core.storage.cluster.v1.OPaginatedClusterV1.createRecord(OPaginatedClusterV1.java:502) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:4547) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:5133) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2161) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1993) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2732) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:363) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:166) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.endMicroTransaction(ODatabaseDocumentEmbedded.java:799) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.executeSaveRecord(ODatabaseDocumentEmbedded.java:789) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:244) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2099) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2064) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:85) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2169) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2160) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:118) at test.Test.main(Test.java:34)    ## Steps to reproduce    &gt; public static void main(String[] args) { try (OrientDB odb = new OrientDB("embedded:./db", OrientDBConfig.defaultConfig())) {     odb.createIfNotExists("test", ODatabaseType.PLOCAL);      ODatabaseSession db = odb.open("test", "admin", "admin");     db.getMetadata().getSchema().getOrCreateClass("pupil");     long size = db.countClass("pupil");     System.out.println("size: "+size);     long t = System.currentTimeMillis();     db.declareIntent(new OIntentMassiveInsert());     for (int i=0; i&lt;1000000; i++)     {     OElement doc = db.newElement("pupil");     doc.setProperty("id",size+i);     doc.setProperty("json", randomString());     doc.save();     if (i % 100 == 0)     {     System.out.println(System.currentTimeMillis()-t);     t = System.currentTimeMillis();     db.commit();     }     } }  }   force stop the JVM while the program is running. then restart  </body>
		<created>2019-06-30 11:39:33</created>
		<closed>2019-07-05 05:19:18</closed>
	</bug>
	<bug>
		<id>8926</id>
		<title>Cannot select "@class" in projection of embedded property</title>
		<body>### OrientDB Version: 3.0.20 ### Java Version:  openjdk version "1.8.0_191" OpenJDK Runtime Environment (build 1.8.0_191-b12) OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode) ### OS: centos07  ## Expected behavior    Expected the `@class` attribute to be select-able like it is for non-embedded properties  ## Actual behavior   Always returns null  ## Steps to reproduce    ```sql create class Parent extends V create class Child extends V create property Parent.child EMBEDDED Child create vertex parent set child = {"@class": "child", "name": "alice"} ```  Now when we select the record without explicitly accessing child.@class everything looks as expected  ```sql select * from parent ```  ```json {     "result": [         {             "@type": "d",             "@rid": "#15:0",             "@version": 1,             "@class": "Parent",             "child": {                 "@type": "d",                 "@version": 0,                 "@class": "child",                 "name": "alice"             }         }     ], } ```  But when we try to filter on child.@class or just retrieve the value at the top level it is always null  ```sql select child.@class from parent ```  ```json {     "result": [         {             "child.@class": null         }     ], } ``` </body>
		<created>2019-06-26 23:35:24</created>
		<closed>2019-06-28 12:44:41</closed>
	</bug>
	<bug>
		<id>8904</id>
		<title>matches filter doesn't work when using match deep traversal</title>
		<body>### OrientDB Version: 2.2.23   (using yet this version because of https://github.com/orientechnologies/spring-data-orientdb/issues/82#issuecomment-440965157 not yet answered and I cannot find a way to complete my porting to more recent versions) ### Java Version: 1.8.0_171 Java(TM) SE Runtime Environment (build 1.8.0_171-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)  ### OS: Windows 10 Home    ## Expected behavior   I have a database from which I can get this (correct) result : ![image](https://user-images.githubusercontent.com/6826606/59110256-0157ff80-893f-11e9-92ca-03817abeb064.png) SQL: match {class:Knowledge, as:knowledge, where: (name like '%Napoleone%')}.out('ISA'){class:Knowledge, as:isa, where: (purePOS = 'RD APs noun')} return knowledge, isa  But this one doesn't (just changed the '=' in the where clause  with 'matches' - this is not my real match, but it's simpler to show the difference in behaviour, matching the same string as when using the '=' operator): ![image](https://user-images.githubusercontent.com/6826606/59110346-349a8e80-893f-11e9-8a05-b1d42c2979b6.png) SQL: match {class:Knowledge, as:knowledge, where: (name like '%Napoleone%')}.out('ISA'){class:Knowledge, as:isa, where: (purePOS matches 'RD APs noun')} return knowledge, isa  **There is no error in the log.**  And the matches clause is not wrong (just matching at the first level, to see if the sintax was uncorrect - but it isn't) ![image](https://user-images.githubusercontent.com/6826606/59110397-572ca780-893f-11e9-80b5-37d11db65e20.png) SQL: match {class:Knowledge, as:knowledge, where: (purePOS matches 'RD APs noun')} return knowledge  The expected behaviour was that the same match with '=' and 'matches' in the same match subquery, in the conditions shown above, returned the same result.  ## Actual behavior   The matches clause seems not to work in a deep (well, 1 level...) traversal match clause, while it works in the first level.  ## Steps to reproduce   See above  </body>
		<created>2019-06-07 14:27:59</created>
		<closed>2019-06-10 15:20:14</closed>
	</bug>
	<bug>
		<id>8895</id>
		<title>WAL native memory is not released after massive inserts.</title>
		<body>WAL native memory is not released after massive inserts. As part of a volume test simulating long time usage of OrientDB in production, disabling WAL is not an option. Java Heap allocation is fine.   ### OrientDB Version: 3.0.19   ### Java Version: OpenJDK (build 1.8.0_212-b04) ### OS: Red Hat Enterprise Linux Server release 7.6 (Maipo) ### OrinetDB params: default with installation.  ## Expected behavior   Allocated native memory (used by WAL) should be released after finished massive insert. ## Actual behavior   Native memory allocation is not released.   Eventually server log reports: 2019-05-31 10:16:39:960 SEVER Can not flush data because of issue during data write,  java.util.concurrent.ExecutionException: com.sun.jna.LastErrorException: [12] Cannot allocate memory [OWOWCache$PeriodicFlushTask]   Exception in thread 'OrientDB WAL Flush Task' com.sun.jna.LastErrorException: [12] Cannot allocate memory         at com.sun.jna.Native.invokeInt(Native Method)         at com.sun.jna.Function.invoke(Function.java:419)         at com.sun.jna.Function.invoke(Function.java:354)         at com.sun.jna.Library$Handler.invoke(Library.java:244)         at com.sun.proxy.$Proxy2.posix_memalign(Unknown Source)         at com.orientechnologies.common.jna.ONative.posix_memalign(ONative.java:250)         at com.orientechnologies.common.directmemory.ODirectMemoryAllocator.allocate(ODirectMemoryAllocator.java:141)   Client log reports: Caused by: com.sun.jna.LastErrorException: [12] Cannot allocate memory  at com.sun.jna.Native.invokeInt(Native Method)  at com.sun.jna.Function.invoke(Function.java:419)  at com.sun.jna.Function.invoke(Function.java:354)  at com.sun.jna.Library$Handler.invoke(Library.java:244)  at com.sun.proxy.$Proxy4.posix_memalign(Unknown Source)  at com.orientechnologies.common.jna.ONative.posix_memalign(ONative.java:250)  at com.orientechnologies.common.directmemory.ODirectMemoryAllocator.allocate(ODirectMemoryAllocator.java:141)  at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1882)  ... 7 more  [CIRCULAR REFERENCE:com.orientechnologies.orient.core.exception.OStorageException:   Error in data flush background thread, please restart database and send full stack trace inside of bug report  ## Steps to reproduce   A java-program (not publishable due to NDA) was written to simulate production like data and generate large amount of data. The program was run with out transactions and mostly doing the following in pseudo code:  1. session.query("SELECT FROM Person where id=?", p.getId()) 2. if not exist       OVertex res = session.newVertex("Person"); 3. res.save(); 4.try (OResultSet resultSet = session.query("SELECT FROM " + link + " where in=? and out=?", oVertexB.getIdentity(), oVertexA.getIdentity())) { if (!resultSet.hasNext()) { OEdge edge = oVertexA.addEdge(oVertexB, link); edge.setProperty("from", new Date()); edge.setProperty("to", new Date()); edge.save(); } )  ![visualvm](https://user-images.githubusercontent.com/51361510/58875862-e8e0ae80-86cc-11e9-861b-98be3df19854.png) ![top1](https://user-images.githubusercontent.com/51361510/58879253-8d66ee80-86d5-11e9-8f01-cead919778b5.png) ![top2](https://user-images.githubusercontent.com/51361510/58879267-91930c00-86d5-11e9-98d1-b0dad46487b2.png) </body>
		<created>2019-06-04 11:39:00</created>
		<closed>2019-07-05 04:27:35</closed>
	</bug>
	<bug>
		<id>8893</id>
		<title>Paginated Queries fail with ROUND_ROBIN_REQUEST</title>
		<body>### OrientDB Version: 3.0.13 ### Java Version: jdk 8 v191 ### OS: &lt;Any&gt;  ## Expected behavior   Should send request for OResultSet.hasNext() back to the original server.  ## Actual behavior   Sends request to a new server who can't find the 'query ' as it has been made on the server from which the first page has been fetched.  </body>
		<created>2019-06-03 06:33:42</created>
		<closed>2020-06-03 16:46:17</closed>
	</bug>
	<bug>
		<id>8882</id>
		<title>Exception in thread 'OrientDB WAL Flush Task', ODirectMemoryAllocationFailedException</title>
		<body>### OrientDB Version: orientdb-3.0.18 ### Java Version: 1.8.0_152 ### OS: linux  ## Expected behavior   No error during high concurrent writing  ## Actual behavior   crashes after around 3 hours  ## Steps to reproduce   adding vertex and edges with Spark, around 15000 records writing per second.  Config: ORIENTDB_OPTS_MEMORY="-Xms2G -Xmx4G" JAVA_OPTS_SCRIPT="-Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=512G -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9" ORIENTDB_SETTINGS="-Dstorage.wal.syncOnPageFlush=false -Dstorage.wal.allowDirectIO=false"   Error during WAL writing com.orientechnologies.common.exception.ODirectMemoryAllocationFailedException: Can not allocate direct memory chunk of size 134217728 at com.orientechnologies.common.directmemory.ODirectMemoryAllocator.allocate(ODirectMemoryAllocator.java:131) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1882) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) Exception in thread 'OrientDB WAL Flush Task' com.orientechnologies.common.exception.ODirectMemoryAllocationFailedException: Can not allocate direct memory chunk of size 134217728 at com.orientechnologies.common.directmemory.ODirectMemoryAllocator.allocate(ODirectMemoryAllocator.java:131) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1882) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748)   </body>
		<created>2019-05-28 11:30:13</created>
		<closed>2020-06-04 10:39:47</closed>
	</bug>
	<bug>
		<id>8875</id>
		<title>Error on loading of index by configuration, java.lang.IllegalArgumentException: COLLATE cannot be null</title>
		<body>### OrientDB Version: &lt;version here&gt;   orientdb-3.0.18 ### Java Version: &lt;version here&gt;   1.8.0_152 ### OS: &lt;os here&gt;   linux ## Expected behavior   connect to database without ERROR  ## Actual behavior   ERROR is reported  ## Steps to reproduce   - launch origenDb, no database. - create a database 'abc' on Console. - In scala code, trying to connect the database. ` val graph = new OrientGraphNoTx(Settings.getOrientDbUrl)       if (graph.getVertexType("EiffelEvent") == null) {         graph.command(new OCommandSQL("ALTER DATABASE DATETIMEFORMAT \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\"")).execute()          val eType = graph.createVertexType("EiffelEvent")          eType.createProperty("eventId", OType.STRING)         eType.createProperty("eventType", OType.STRING)         eType.createProperty("eventTime", OType.DATETIME)         eType.createProperty("rawEiffel", OType.STRING)         eType.createProperty("stage", OType.STRING)          graph.createKeyIndex("eventId", classOf[Vertex], new Parameter("type", "UNIQUE"), new Parameter("class", "EiffelEvent"))         graph.createKeyIndex("stage", classOf[Vertex], new Parameter("type", "NOTUNIQUE"), new Parameter("class", "EiffelEvent"))       }        if (graph.getEdgeType("inputEventId") == null) {         graph.createEdgeType("inputEventId")       } `  - Every time I uses 'OrientGraphNoTx' to connect the database, it will reports lot of below errors. ` 2019-05-21 13:24:22 ERROR OIndexManagerRemote:188 - Error on loading of index by configuration: {type:UNIQUE_HASH_INDEX,name:OFunction.name,indexVersion:2,indexDefinition:{className:OFunction,field:name,keyType:STRING,collate:default,nullValuesIgnored:false},indexDefinitionClass:com.orientechnologies.orient.core.index.OPropertyIndexDefinition,clusters:[1],algorithm:HASH_INDEX,valueContainerAlgorithm:NONE} java.lang.IllegalArgumentException: COLLATE cannot be null at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:47) at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:55) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.serializeFromStream(OPropertyIndexDefinition.java:174) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.fromStream(OPropertyIndexDefinition.java:139) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.fromStream(ODocumentWrapperNoClass.java:44) at com.orientechnologies.orient.core.index.OIndexAbstract.loadMetadataInternal(OIndexAbstract.java:127) at com.orientechnologies.orient.core.index.OIndexManagerRemote.fromStream(OIndexManagerRemote.java:162) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.reload(ODocumentWrapperNoClass.java:59) at com.orientechnologies.orient.core.index.OIndexManagerAbstract.reload(OIndexManagerAbstract.java:116) at com.orientechnologies.orient.core.db.document.OSharedContextRemote.reload(OSharedContextRemote.java:59) at com.orientechnologies.orient.core.metadata.OMetadataDefault.reload(OMetadataDefault.java:147) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.reload(ODatabaseDocumentAbstract.java:247) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.command(ODatabaseDocumentRemote.java:413) at com.orientechnologies.orient.core.metadata.schema.OSchemaRemote.createClass(OSchemaRemote.java:123) at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:232) at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.createClass(OSchemaProxy.java:88) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1362) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1359) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1868) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1359) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1328) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1301) at jobleadtime.util.GraphDb.init(GraphDb.scala:29) at jobleadtime.util.Global$.&lt;init&gt;(Global.scala:27) at jobleadtime.util.Global$.&lt;clinit&gt;(Global.scala) at Main$.main(Main.scala:16) at Main.main(Main.scala) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52) at org.apache.spark.deploy.SparkSubmit$.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:894) at org.apache.spark.deploy.SparkSubmit$.doRunMain$1(SparkSubmit.scala:198) at org.apache.spark.deploy.SparkSubmit$.submit(SparkSubmit.scala:228) at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:137) at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala) 2019-05-21 13:24:22 ERROR OIndexManagerRemote:188 - Error on loading of index by configuration: {type:UNIQUE,name:ORole.name,indexVersion:2,indexDefinition:{className:ORole,field:name,keyType:STRING,collate:ci,nullValuesIgnored:false},indexDefinitionClass:com.orientechnologies.orient.core.index.OPropertyIndexDefinition,clusters:[1],algorithm:CELL_BTREE,valueContainerAlgorithm:NONE} java.lang.IllegalArgumentException: COLLATE cannot be null at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:47) at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:55) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.serializeFromStream(OPropertyIndexDefinition.java:174) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.fromStream(OPropertyIndexDefinition.java:139) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.fromStream(ODocumentWrapperNoClass.java:44) at com.orientechnologies.orient.core.index.OIndexAbstract.loadMetadataInternal(OIndexAbstract.java:127) at com.orientechnologies.orient.core.index.OIndexManagerRemote.fromStream(OIndexManagerRemote.java:162) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.reload(ODocumentWrapperNoClass.java:59) at com.orientechnologies.orient.core.index.OIndexManagerAbstract.reload(OIndexManagerAbstract.java:116) at com.orientechnologies.orient.core.db.document.OSharedContextRemote.reload(OSharedContextRemote.java:59) at com.orientechnologies.orient.core.metadata.OMetadataDefault.reload(OMetadataDefault.java:147) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.reload(ODatabaseDocumentAbstract.java:247) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.command(ODatabaseDocumentRemote.java:413) at com.orientechnologies.orient.core.metadata.schema.OSchemaRemote.createClass(OSchemaRemote.java:123) at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:232) at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.createClass(OSchemaProxy.java:88) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1362) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1359) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1868) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1359) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1328) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1301) at jobleadtime.util.GraphDb.init(GraphDb.scala:29) at jobleadtime.util.Global$.&lt;init&gt;(Global.scala:27) at jobleadtime.util.Global$.&lt;clinit&gt;(Global.scala) at Main$.main(Main.scala:16) at Main.main(Main.scala) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52) at org.apache.spark.deploy.SparkSubmit$.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:894) at org.apache.spark.deploy.SparkSubmit$.doRunMain$1(SparkSubmit.scala:198) at org.apache.spark.deploy.SparkSubmit$.submit(SparkSubmit.scala:228) at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:137) at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala) 2019-05-21 13:24:22 ERROR OIndexManagerRemote:188 - Error on loading of index by configuration: {type:UNIQUE,name:OUser.name,indexVersion:2,indexDefinition:{className:OUser,field:name,keyType:STRING,collate:ci,nullValuesIgnored:false},indexDefinitionClass:com.orientechnologies.orient.core.index.OPropertyIndexDefinition,clusters:[1],algorithm:CELL_BTREE,valueContainerAlgorithm:NONE} java.lang.IllegalArgumentException: COLLATE cannot be null at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:47) at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:55) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.serializeFromStream(OPropertyIndexDefinition.java:174) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.fromStream(OPropertyIndexDefinition.java:139) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.fromStream(ODocumentWrapperNoClass.java:44) at com.orientechnologies.orient.core.index.OIndexAbstract.loadMetadataInternal(OIndexAbstract.java:127) at com.orientechnologies.orient.core.index.OIndexManagerRemote.fromStream(OIndexManagerRemote.java:162) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.reload(ODocumentWrapperNoClass.java:59) at com.orientechnologies.orient.core.index.OIndexManagerAbstract.reload(OIndexManagerAbstract.java:116) at com.orientechnologies.orient.core.db.document.OSharedContextRemote.reload(OSharedContextRemote.java:59) at com.orientechnologies.orient.core.metadata.OMetadataDefault.reload(OMetadataDefault.java:147) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.reload(ODatabaseDocumentAbstract.java:247) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.command(ODatabaseDocumentRemote.java:413) at com.orientechnologies.orient.core.metadata.schema.OSchemaRemote.createClass(OSchemaRemote.java:123) at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:232) at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.createClass(OSchemaProxy.java:88) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1362) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1359) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1868) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1359) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1328) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1301) at jobleadtime.util.GraphDb.init(GraphDb.scala:29) at jobleadtime.util.Global$.&lt;init&gt;(Global.scala:27) at jobleadtime.util.Global$.&lt;clinit&gt;(Global.scala) at Main$.main(Main.scala:16) at Main.main(Main.scala) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52) at org.apache.spark.deploy.SparkSubmit$.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:894) at org.apache.spark.deploy.SparkSubmit$.doRunMain$1(SparkSubmit.scala:198) at org.apache.spark.deploy.SparkSubmit$.submit(SparkSubmit.scala:228) at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:137) at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)  2019-05-21 13:24:35 ERROR OIndexManagerRemote:188 - Error on loading of index by configuration: {type:NOTUNIQUE,name:EiffelEvent.stage,indexVersion:2,indexDefinition:{className:EiffelEvent,field:stage,keyType:STRING,collate:default,nullValuesIgnored:false},indexDefinitionClass:com.orientechnologies.orient.core.index.OPropertyIndexDefinition,clusters:[8],algorithm:CELL_BTREE,valueContainerAlgorithm:SBTREEBONSAISET} java.lang.IllegalArgumentException: COLLATE cannot be null at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:47) at com.orientechnologies.orient.core.index.OAbstractIndexDefinition.setCollate(OAbstractIndexDefinition.java:55) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.serializeFromStream(OPropertyIndexDefinition.java:174) at com.orientechnologies.orient.core.index.OPropertyIndexDefinition.fromStream(OPropertyIndexDefinition.java:139) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.fromStream(ODocumentWrapperNoClass.java:44) at com.orientechnologies.orient.core.index.OIndexAbstract.loadMetadataInternal(OIndexAbstract.java:127) at com.orientechnologies.orient.core.index.OIndexManagerRemote.fromStream(OIndexManagerRemote.java:162) at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.reload(ODocumentWrapperNoClass.java:59) at com.orientechnologies.orient.core.index.OIndexManagerAbstract.reload(OIndexManagerAbstract.java:116) at com.orientechnologies.orient.core.index.OIndexManagerRemote.createIndex(OIndexManagerRemote.java:73) at com.orientechnologies.orient.core.index.OIndexManagerRemote.createIndex(OIndexManagerRemote.java:86) at com.orientechnologies.orient.core.index.OIndexManagerProxy.createIndex(OIndexManagerProxy.java:80) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$12.call(OrientBaseGraph.java:1710) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$12.call(OrientBaseGraph.java:1666) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1868) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createKeyIndex(OrientBaseGraph.java:1666) at jobleadtime.util.GraphDb.init(GraphDb.scala:38) at jobleadtime.util.Global$.&lt;init&gt;(Global.scala:27) at jobleadtime.util.Global$.&lt;clinit&gt;(Global.scala) at Main$.main(Main.scala:16) at Main.main(Main.scala) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52) at org.apache.spark.deploy.SparkSubmit$.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:894) at org.apache.spark.deploy.SparkSubmit$.doRunMain$1(SparkSubmit.scala:198) at org.apache.spark.deploy.SparkSubmit$.submit(SparkSubmit.scala:228) at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:137) at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala) `   &lt;An SQL script to reproduce the problem or a JUnit test case will increase **A LOT** the chance to have a quick fix&gt;  </body>
		<created>2019-05-21 13:02:03</created>
		<closed>2020-06-15 09:36:07</closed>
	</bug>
	<bug>
		<id>8871</id>
		<title>exited with code 137</title>
		<body>### OrientDB Version: 3.1.0 from develop branch ### Java Version: docker openjdk:8-jdk-alpine ### OS: docker openjdk:8-jdk-alpine    Hi! I have an issue about out of memory (I hope) on the machine without any activity. Seems like a memory leak The base has few rows in the single table and nobody works with it. And every 2-3 weeks orientdb is in down. The server has 3.7Gb ram. And the same situation on the prod server with 7.6Gb ram.  Lines in log: ``` orientdb-develop | 2019-05-06 11:54:34:764 INFO  Detected limit of amount of simultaneously open files is 1048576,  limit of open files for disk cache will be set to 523776 [ONative] orientdb-develop | 2019-05-06 11:54:34:792 INFO  Loading configuration from: /orientdb/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml] orientdb-develop | 2019-05-06 11:54:35:114 INFO  OrientDB Server v3.1.0-SNAPSHOT - Veloce (build d970b12033f0462f0239ea0ad8ed41207e6e26f1, branch develop) is starting up... [OServer] orientdb-develop | 2019-05-06 11:54:35:208 INFO  4035751936 B/3848 MB/3 GB of physical memory were detected on machine [ONative] orientdb-develop | 2019-05-06 11:54:35:209 INFO  Soft memory limit for this process is set to -1 B/-1 MB/-1 GB [ONative] orientdb-develop | 2019-05-06 11:54:35:209 INFO  Hard memory limit for this process is set to -1 B/-1 MB/-1 GB [ONative] orientdb-develop | 2019-05-06 11:54:35:210 INFO  Path to 'memory' cgroup is '/docker/4421acd5770caa5c74227e89876331b09d3c1cddd58f25c200368d7895ae9192' [ONative] orientdb-develop | 2019-05-06 11:54:35:215 INFO  Mounting path for memory cgroup controller is '/sys/fs/cgroup/memory' [ONative] orientdb-develop | 2019-05-06 11:54:35:216 INFO  Can not find '/sys/fs/cgroup/memory/docker/4421acd5770caa5c74227e89876331b09d3c1cddd58f25c200368d7895ae9192' path for memory cgroup, it is supposed that process is running in container, will try to read root '/sys/fs/cgroup/memory' memory cgroup data [ONative] orientdb-develop | 2019-05-06 11:54:35:216 INFO  cgroup soft memory limit is 9223372036854771712 B/8796093022207 MB/8589934591 GB [ONative] orientdb-develop | 2019-05-06 11:54:35:217 INFO  cgroup hard memory limit is 9223372036854771712 B/8796093022207 MB/8589934591 GB [ONative] orientdb-develop | 2019-05-06 11:54:35:218 INFO  Detected memory limit for current process is 4035751936 B/3848 MB/3 GB [ONative] orientdb-develop | 2019-05-06 11:54:35:219 INFO  JVM can use maximum 1963MB of heap memory [OMemoryAndLocalPaginatedEnginesInitializer] orientdb-develop | 2019-05-06 11:54:35:219 INFO  Because OrientDB is running inside a container 256m of memory will be left unallocated according to the setting 'memory.leftToContainer' not taking into account heap memory [OMemoryAndLocalPaginatedEnginesInitializer] orientdb-develop | 2019-05-06 11:54:35:220 INFO  OrientDB auto-config DISKCACHE=1,629MB (heap=1,963MB os=3,848MB) [orientechnologies] orientdb-develop | 2019-05-06 11:54:35:225 INFO  System is started under an effective user : `root` [OEngineLocalPaginated] orientdb-develop | 2019-05-06 11:54:35:267 INFO  WAL maximum segment size is set to 6,144 MB [OrientDBDistributed] orientdb-develop | 2019-05-06 11:54:35:271 INFO  Databases directory: /orientdb/databases [OServer] orientdb-develop | 2019-05-06 11:54:35:399 INFO  Direct IO for WAL located in /orientdb/databases/OSystem is allowed with block size 4096 bytes. [OCASDiskWriteAheadLog] orientdb-develop | 2019-05-06 11:54:35:400 INFO  Page size for WAL located in /orientdb/databases/OSystem is set to 4096 bytes. [OCASDiskWriteAheadLog] orientdb-develop | 2019-05-06 11:54:36:071 INFO  Storage 'plocal:/orientdb/databases/OSystem' is opened under OrientDB distribution : 3.1.0-SNAPSHOT - Veloce (build d970b12033f0462f0239ea0ad8ed41207e6e26f1, branch develop) [OLocalPaginatedStorage] orientdb-develop | 2019-05-06 11:54:36:548 INFO  Listening binary connections on 0.0.0.0:2424 (protocol v.37, socket=default) [OServerNetworkListener] orientdb-develop | 2019-05-06 11:54:36:555 INFO  Listening http connections on 0.0.0.0:2480 (protocol v.10, socket=default) [OServerNetworkListener] orientdb-develop | 2019-05-06 11:54:36:563 INFO  Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] orientdb-develop | 2019-05-06 11:54:37:394 INFO  Installing dynamic plugin 'orientdb-etl-3.1.0-SNAPSHOT.jar'... [OServerPluginManager] orientdb-develop | 2019-05-06 11:54:37:402 INFO  Installing dynamic plugin 'orientdb-studio-3.1.0-20181211.100617-23.zip'... [OServerPluginManager] orientdb-develop | 2019-05-06 11:54:37:407 INFO  ODefaultPasswordAuthenticator is active [ODefaultPasswordAuthenticator] orientdb-develop | 2019-05-06 11:54:37:408 INFO  OServerConfigAuthenticator is active [OServerConfigAuthenticator] orientdb-develop | 2019-05-06 11:54:37:409 INFO  OSystemUserAuthenticator is active [OSystemUserAuthenticator] orientdb-develop | 2019-05-06 11:54:37:411 INFO  [OVariableParser.resolveVariables] Property not found: distributed [orientechnologies] orientdb-develop | 2019-05-06 11:54:37:420 WARNI Authenticated clients can execute any kind of code into the server by using the following allowed languages: [sql] [OServerSideScriptInterpreter] orientdb-develop | 2019-05-06 11:54:37:424 INFO  OrientDB Studio available at http://x.x.x.x:2480/studio/index.html [OServer] orientdb-develop | 2019-05-06 11:54:37:424 INFO  OrientDB Server is active v3.1.0-SNAPSHOT - Veloce (build d970b12033f0462f0239ea0ad8ed41207e6e26f1, branch develop). [OServer] orientdb-develop | 2019-05-06 11:55:22:321 INFO  Direct IO for WAL located in /orientdb/databases/shsh is allowed with block size 4096 bytes. [OCASDiskWriteAheadLog] orientdb-develop | 2019-05-06 11:55:22:322 INFO  Page size for WAL located in /orientdb/databases/shsh is set to 4096 bytes. [OCASDiskWriteAheadLog] orientdb-develop | 2019-05-06 11:55:22:522 INFO  Storage 'plocal:/orientdb/databases/shsh' is opened under OrientDB distribution : 3.1.0-SNAPSHOT - Veloce (build d970b12033f0462f0239ea0ad8ed41207e6e26f1, branch develop) [OLocalPaginatedStorage] orientdb-develop | 2019-05-06 11:59:35:375 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-06 12:00:22:321 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-06 13:15:22:336 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-07 14:25:22:495 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-07 14:55:22:507 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-07 15:35:22:519 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 07:25:23:125 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 07:55:23:137 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 08:30:23:145 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 09:10:23:157 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 10:15:23:169 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 10:30:23:177 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 11:15:23:187 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 12:35:23:199 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 13:05:23:207 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 13:40:23:217 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-13 14:50:23:230 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-14 08:50:23:319 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-14 12:10:23:351 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-15 13:15:23:488 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-15 13:55:23:498 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-15 14:25:23:510 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-15 14:55:23:520 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-16 07:55:23:611 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-16 09:20:23:624 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-16 09:55:23:647 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-16 10:45:23:655 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-16 13:00:23:679 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-16 19:04:39:108 WARNI -&gt;x.x.x.x: Error on invalid content: orientdb-develop | /*Cookie: mstshash=Administr [ONetworkProtocolHttpDb] orientdb-develop | 2019-05-17 08:15:23:779 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop | 2019-05-17 08:50:23:787 INFO  Making fuzzy checkpoint [OLocalPaginatedStorage] orientdb-develop exited with code 137 ``` ```sh journalctl -k | grep -i -e memory -e oom ``` Shows ``` May 17 11:52:18 prod1 kernel: node invoked oom-killer: gfp_mask=0x14200ca(GFP_HIGHUSER_MOVABLE), nodemask=(null), order=0, oom_score_adj=0 May 17 11:52:19 prod1 kernel:  oom_kill_process+0x220/0x440 May 17 11:52:19 prod1 kernel:  out_of_memory+0x2d1/0x4f0 May 17 11:52:19 prod1 kernel: [ pid ]   uid  tgid total_vm      rss pgtables_bytes swapents oom_score_adj name May 17 11:52:19 prod1 kernel: Out of memory: Kill process 17414 (java) score 425 or sacrifice child May 17 11:52:19 prod1 kernel: oom_reaper: reaped process 17414 (java), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB ```</body>
		<created>2019-05-17 10:20:03</created>
		<closed>2019-07-12 09:36:38</closed>
	</bug>
	<bug>
		<id>8858</id>
		<title>v3.0.18 Import database. Notice for error "Error Cannot create the index" and "DocValuesField is too large"</title>
		<body>### OrientDB Version: 3.0.18 ### Java Version: JDK8 ### OS: Ubuntu  ## Expected behavior   Continue import Databases via console.  ## Actual behavior   ``` orientdb {db=ps_prod}&gt; IMPORT DATABASE /root/ps-db-backup/ps-db_05052019.export.gz -preserveClusterIDs=true  Importing database DATABASE /root/ps-db-backup/ps-db_05052019.export.gz -preserveClusterIDs=true... Error: com.orientechnologies.orient.core.exception.OStorageException: Error sending import request DB name="ps_prod"  Error: com.orientechnologies.orient.core.db.tool.ODatabaseExportException: Error on importing database 'ps_prod' from file: /tmp/import5870417359011157425ps-db_05052019.export.gz  Error: com.orientechnologies.orient.core.index.OIndexException: Cannot create the index 'Post.title_content' DB name="ps_prod"  Error: java.lang.IllegalArgumentException: DocValuesField "content" is too large, must be &lt;= 32766 ```   </body>
		<created>2019-05-05 12:59:06</created>
		<closed>2020-07-03 17:12:41</closed>
	</bug>
	<bug>
		<id>8855</id>
		<title>v3.0.18 : insert of JSON via REST api suddenly fails on indexes</title>
		<body>### OrientDB Version: 3.0.18 ### Java Version: &lt;version here&gt;   ### OS: &lt;os here&gt;    ## Expected behavior   Continue inserting records as JSON batches, via REST api  ## Actual behavior   I send a new batch of JSON insert requests, and get the following error back from the server: ``` java.lang.ClassCastException: com.orientechnologies.orient.core.index.engine.v1.OCellBTreeSingleValueIndexEngine cannot be cast to com.orientechnologies.lucene.engine.OLuceneIndexEngine ``` The class has 2 indexes: - one unique SBtree index - another Lucene index  -&gt; what information do you need from me to help you diagnose this problem ?   ## Steps to reproduce   &lt;add here&gt;   &lt;An SQL script to reproduce the problem or a JUnit test case will increase **A LOT** the chance to have a quick fix&gt;  </body>
		<created>2019-05-03 08:20:10</created>
		<closed>2020-07-03 17:12:31</closed>
	</bug>
	<bug>
		<id>8839</id>
		<title>[3.0.18] WAL issues during shutdown</title>
		<body>### OrientDB Version: 3.0.18 ### Java Version: 1.8 u202   ### OS: McOS   @laa , @tglman     When shutting down ODB 3.0.18 (earlier versions too) server with Ctrl-C the below exceptions occur. Just like #8672, this is incredibly nasty issue - the database can no longer be used and I have to rebuild it completely, potentially losing data.   ``` 2019-04-13 18:00:42:136 INFO  Storage 'plocal:/Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db' is opened under OrientDB distribution : 3.0.18 - Veloce (build 747595e790a081371496f3bb9c57cec395644d82, branch 3.0.x) [OLocalPaginatedStorage]^C 2019-04-13 20:58:36:268 WARNI Received signal: SIGINT [OSignalHandler] 2019-04-13 20:58:36:269 INFO  OrientDB Server is shutting down... [OServer] 2019-04-13 20:58:36:270 INFO  Shutting down listeners: [OServer] 2019-04-13 20:58:36:270 INFO  - ONetworkProtocolBinary /0.0.0.0:2424: [OServer] 2019-04-13 20:58:36:271 INFO  - ONetworkProtocolHttpDb /0.0.0.0:2480: [OServer] 2019-04-13 20:58:36:271 INFO  Shutting down protocols [OServer] 2019-04-13 20:58:36:271 INFO  Shutting down plugins: [OServerPluginManager] 2019-04-13 20:58:36:271 INFO  - studio [OServerPluginManager] 2019-04-13 20:58:36:271 INFO  - teleporter [OServerPluginManager] 2019-04-13 20:58:36:272 INFO  - custom-sql-functions-manager [OServerPluginManager] 2019-04-13 20:58:36:272 INFO  - script-interpreter [OServerPluginManager] 2019-04-13 20:58:36:272 INFO  - etl [OServerPluginManager] 2019-04-13 20:58:36:272 INFO  - neo4j-importer [OServerPluginManager] 2019-04-13 20:58:36:272 INFO  Shutting down databases: [OServer] 2019-04-13 20:58:36:273 INFO  Orient Engine is shutting down... [Orient] 2019-04-13 20:58:36:273 INFO  - shutdown storage: rehabowner.db... [OrientDBDistributed]Error during WAL writing java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)         at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)         at java.nio.channels.FileChannel.open(FileChannel.java:287)         at java.nio.channels.FileChannel.open(FileChannel.java:335)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1856)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Exception during WAL flush java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.doFlush(OCASDiskWriteAheadLog.java:1498)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.flush(OCASDiskWriteAheadLog.java:1359)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:4321)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:4909)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:682)         at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:235)         at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:536)         at com.orientechnologies.orient.core.Orient$OShutdownOrientDBInstancesHandler.shutdown(Orient.java:824)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:394)         at com.orientechnologies.orient.server.OServer.deinit(OServer.java:597)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:516)         at com.orientechnologies.orient.server.OServerShutdownHook.run(OServerShutdownHook.java:40) Caused by: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2054)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)         at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)         at java.nio.channels.FileChannel.open(FileChannel.java:287)         at java.nio.channels.FileChannel.open(FileChannel.java:335)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1856)         ... 7 more Exception in thread 'OrientDB WAL Flush Task' java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2054)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)         at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)         at java.nio.channels.FileChannel.open(FileChannel.java:287)         at java.nio.channels.FileChannel.open(FileChannel.java:335)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1856)         ... 7 more Exception `2010CB74` in storage `plocal:/Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db`: 3.0.18 - Veloce (build 747595e790a081371496f3bb9c57cec395644d82, branch 3.0.x) java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.doFlush(OCASDiskWriteAheadLog.java:1501)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.flush(OCASDiskWriteAheadLog.java:1359)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:4321)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:4909)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:682)         at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:235)         at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:536)         at com.orientechnologies.orient.core.Orient$OShutdownOrientDBInstancesHandler.shutdown(Orient.java:824)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:394)         at com.orientechnologies.orient.server.OServer.deinit(OServer.java:597)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:516)         at com.orientechnologies.orient.server.OServerShutdownHook.run(OServerShutdownHook.java:40) Caused by: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.doFlush(OCASDiskWriteAheadLog.java:1498)         ... 11 more Caused by: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2054)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)         at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)         at java.nio.channels.FileChannel.open(FileChannel.java:287)         at java.nio.channels.FileChannel.open(FileChannel.java:335)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1856)         ... 7 more -- error on shutdown storage java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.doFlush(OCASDiskWriteAheadLog.java:1501)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.flush(OCASDiskWriteAheadLog.java:1359)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:4321)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:4909)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:682)         at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:235)         at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:536)         at com.orientechnologies.orient.core.Orient$OShutdownOrientDBInstancesHandler.shutdown(Orient.java:824)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:394)         at com.orientechnologies.orient.server.OServer.deinit(OServer.java:597)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:516)         at com.orientechnologies.orient.server.OServerShutdownHook.run(OServerShutdownHook.java:40) Caused by: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.doFlush(OCASDiskWriteAheadLog.java:1498)         ... 11 more Caused by: java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2054)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.nio.file.FileAlreadyExistsException: /Users/hristostoyanov/projects/orientdb-3.0.18/databases/rehabowner.db/rehabowner.db.2.wal         at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)         at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)         at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)         at java.nio.channels.FileChannel.open(FileChannel.java:287)         at java.nio.channels.FileChannel.open(FileChannel.java:335)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1856)         ... 7 more  2019-04-13 20:58:36:289 INFO  - shutdown storage: OSystem... [OrientDBDistributed] 2019-04-13 20:58:36:399 INFO  Clearing byte buffer pool [Orient] 2019-04-13 20:58:36:401 INFO  OrientDB Engine shutdown complete [Orient] 2019-04-13 20:58:36:401 INFO  OrientDB Server shutdown complete  [OServer]%                                                                                                                                                                                           orientdb-3.0.18  ```  </body>
		<created>2019-04-14 19:23:33</created>
		<closed>2019-05-27 10:45:18</closed>
	</bug>
	<bug>
		<id>8833</id>
		<title>EMBEDDEDMAP data type not working as expected in WHERE part of a MATCH query </title>
		<body>OrientDB Version: 3.0.18 Java Version: 1.8.0_181 OS: Ubuntu 16.04  It seems the SQL query parse for MATCH cant work with embeddedmap in WHERE clause  Simple test database:  ``` create class NNode extends V; create class EEdge extends E;  create property EEdge.series embeddedmap; create property EEdge.name string;  let N1 = create vertex NNode set id=1; let N2 = create vertex NNode set id=2;  create edge EEdge from $N1 to $N2 set series={"1":"one","2":"two"},name="Mike"; ``` The following query throws an exception: `MATCH {class:NNode,as:BaseNode, where:(id=1)}.outE(){as:MyEdge,where:($currentMatch.series["1"]="one")} return $matches;`    while the following working as expected: `MATCH {class:NNode,as:BaseNode, where:(id=1)}.outE(){as:MyEdge,where:($currentMatch.name="Mike")} return $matches;`  The first query (embeddedmap stuff involved) throws the following server exception:   &gt; java.lang.NullPointerException &gt;         at com.orientechnologies.orient.core.sql.parser.OArraySingleValuesSelector.execute(OArraySingleValuesSelector.java:56) &gt;         at com.orientechnologies.orient.core.sql.parser.OModifier.execute(OModifier.java:89) &gt;         at com.orientechnologies.orient.core.sql.parser.OModifier.execute(OModifier.java:94) &gt;         at com.orientechnologies.orient.core.sql.parser.OBaseExpression.execute(OBaseExpression.java:109) &gt;         at com.orientechnologies.orient.core.sql.parser.OExpression.execute(OExpression.java:68) &gt;         at com.orientechnologies.orient.core.sql.parser.OBinaryCondition.evaluate(OBinaryCondition.java:44) &gt;         at com.orientechnologies.orient.core.sql.parser.ONotBlock.evaluate(ONotBlock.java:33) &gt;         at com.orientechnologies.orient.core.sql.parser.OAndBlock.evaluate(OAndBlock.java:34) &gt;         at com.orientechnologies.orient.core.sql.parser.OOrBlock.evaluate(OOrBlock.java:36) &gt;         at com.orientechnologies.orient.core.sql.parser.OAndBlock.evaluate(OAndBlock.java:34) &gt;         at com.orientechnologies.orient.core.sql.parser.OWhereClause.matchesFilters(OWhereClause.java:54) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser.matchesFilters(MatchEdgeTraverser.java:302) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser$1.fetchNext(MatchEdgeTraverser.java:172) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser$1.hasNext(MatchEdgeTraverser.java:148) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser.hasNext(MatchEdgeTraverser.java:41) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchStep.fetchNext(MatchStep.java:108) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchStep.access$000(MatchStep.java:13) &gt;         at com.orientechnologies.orient.core.sql.executor.MatchStep$1.hasNext(MatchStep.java:45) &gt;         at com.orientechnologies.orient.core.sql.executor.ReturnMatchPatternsStep$1.hasNext(ReturnMatchPatternsStep.java:24) &gt;         at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:89) &gt;         at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:49) &gt;         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:35) &gt;         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:29) &gt;         at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:55) &gt;         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:619) &gt;         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostBatch.execute(OServerCommandPostBatch.java:203) &gt;         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:223) &gt;         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:702) &gt;         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69) &gt;        </body>
		<created>2019-04-01 23:18:45</created>
		<closed>2019-04-02 12:25:44</closed>
	</bug>
	<bug>
		<id>8832</id>
		<title>Error on get searcher from Lucene index. java.lang.IllegalStateException: The managed reference has already closed - this is likely a bug when the reference count is modified outside of the ReferenceManager</title>
		<body>### OrientDB Version: v3.0.17 ### Java Version: "11" 2018-09-25 ### OS: MacOS 10.14.3  ## Actual behavior   OrientDB server restart required to solve the issue. ``` $ANSI{green {db=some}} Error on get searcher from Lucene index java.lang.IllegalStateException: The managed reference has already closed - this is likely a bug when the reference count is modified outside of the ReferenceManager at org.apache.lucene.search.ReferenceManager.acquire(ReferenceManager.java:114) at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.searcher(OLuceneIndexEngineAbstract.java:422) at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.getResults(OLuceneFullTextIndexEngine.java:191) at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.getInTx(OLuceneFullTextIndexEngine.java:280) at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.get(OLuceneFullTextIndexEngine.java:140) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:2684) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:2665) at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.get(OLuceneIndexNotUnique.java:275) at com.orientechnologies.lucene.functions.OLuceneSearchOnClassFunction.searchFromTarget(OLuceneSearchOnClassFunction.java:128) at com.orientechnologies.orient.core.sql.parser.OFunctionCall.executeIndexedFunction(OFunctionCall.java:169) at com.orientechnologies.orient.core.sql.parser.OLevelZeroIdentifier.executeIndexedFunction(OLevelZeroIdentifier.java:96) at com.orientechnologies.orient.core.sql.parser.OBaseIdentifier.executeIndexedFunction(OBaseIdentifier.java:104) at com.orientechnologies.orient.core.sql.parser.OBaseExpression.executeIndexedFunction(OBaseExpression.java:165) at com.orientechnologies.orient.core.sql.parser.OExpression.executeIndexedFunction(OExpression.java:299) at com.orientechnologies.orient.core.sql.parser.OBinaryCondition.executeIndexedFunction(OBinaryCondition.java:137) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexedFunctionStep.init(FetchFromIndexedFunctionStep.java:100) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexedFunctionStep.syncPull(FetchFromIndexedFunctionStep.java:38) at com.orientechnologies.orient.core.sql.executor.FilterByClustersStep$1.fetchNextItem(FilterByClustersStep.java:57) at com.orientechnologies.orient.core.sql.executor.FilterByClustersStep$1.hasNext(FilterByClustersStep.java:93) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.fetchNextItem(FilterByClassStep.java:50) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.hasNext(FilterByClassStep.java:88) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.hasNext(ProjectionCalculationStep.java:33) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:36) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:29) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:285) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:71) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:634) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1297) at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:133) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:304) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:206) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69) ```  ## Steps to reproduce   It occurs randomly. I am not able to share the query with you but interesting thing is that it does not contain "SEARCH CLASS" so I don't understand why is it happening.  </body>
		<created>2019-04-01 16:53:26</created>
		<closed>2019-04-04 13:39:31</closed>
	</bug>
	<bug>
		<id>8831</id>
		<title>NullPointerException in OrientJdbcStatement.mayCleanForSpark</title>
		<body>### OrientDB Version: 3.0.18 ### Java Version: 8 ### OS: Ubuntu 18.04   ## Expected behavior   No exception  ## Actual behavior   ```java java.lang.NullPointerException at com.orientechnologies.orient.jdbc.OrientJdbcStatement.mayCleanForSpark(OrientJdbcStatement.java:363) at com.orientechnologies.orient.jdbc.OrientJdbcStatement.execute(OrientJdbcStatement.java:94) at com.orientechnologies.orient.jdbc.OrientJdbcStatement.executeQuery(OrientJdbcStatement.java:121) ```  ## Steps to reproduce   ```java package com.test;  import com.orientechnologies.orient.core.db.ODatabaseType; import com.orientechnologies.orient.core.db.OrientDB; import com.orientechnologies.orient.core.db.OrientDBConfig; import com.orientechnologies.orient.jdbc.OrientDataSource; import org.testng.annotations.Test;  import java.sql.Connection; import java.sql.SQLException; import java.sql.Statement;  public class OrientMemDbTest {      @Test     public void testJdbcStatement() throws SQLException {         final String serverUser = "admin";         final String serverPassword = "admin";         final String dbName = "test";          OrientDB orientDB = new OrientDB("embedded:.", serverUser, serverPassword, OrientDBConfig.defaultConfig());         orientDB.create(dbName, ODatabaseType.MEMORY);          OrientDataSource ods = new OrientDataSource(orientDB, dbName);         Connection connection = ods.getConnection(serverUser, serverPassword);         Statement statement = connection.createStatement();         statement.executeQuery("SELECT FROM V");     } } ```</body>
		<created>2019-04-01 13:58:39</created>
		<closed>2019-04-03 09:44:29</closed>
	</bug>
	<bug>
		<id>8829</id>
		<title>Lucene Spatial Indexes</title>
		<body>### OrientDB Version: 3.0.18  ### Java Version: 1.8.0_201 ### OS: Ubuntu Linux  ## Expected behavior   Lucene Spatial Index functions as normal  ## Actual behavior   Periodically - lucene index gets into a non-working state. Orientdb server restart required to solve the issue.   &gt; $ANSI{green {db=Cardiff}} Error on getting entry against Lucene index &gt; com.orientechnologies.lucene.exception.OLuceneIndexException: Error on get searcher from Lucene index &gt;         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.searcher(OLuceneIndexEngineAbstract.java:425) &gt;         at com.orientechnologies.spatial.strategy.SpatialQueryBuilderWithin.build(SpatialQueryBuilderWithin.java:59) &gt;         at com.orientechnologies.spatial.strategy.SpatialQueryBuilder.build(SpatialQueryBuilder.java:58) &gt;         at com.orientechnologies.spatial.engine.OLuceneGeoSpatialIndexEngine.newGeoSearch(OLuceneGeoSpatialIndexEngine.java:84) &gt;         at com.orientechnologies.spatial.engine.OLuceneGeoSpatialIndexEngine.getInTx(OLuceneGeoSpatialIndexEngine.java:70) &gt;         at com.orientechnologies.spatial.engine.OLuceneGeoSpatialIndexEngine.get(OLuceneGeoSpatialIndexEngine.java:61) &gt;         at com.orientechnologies.spatial.engine.OLuceneSpatialIndexEngineDelegator.get(OLuceneSpatialIndexEngineDelegator.java:141) &gt;         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:2674) &gt;         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:2655) &gt;         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.get(OLuceneIndexNotUnique.java:275) &gt;         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.get(OLuceneIndexNotUnique.java:52) &gt;         at com.orientechnologies.spatial.functions.OSpatialFunctionAbstractIndexable.results(OSpatialFunctionAbstractIndexable.java:123) &gt;         at com.orientechnologies.spatial.functions.OSTWithinFunction.searchFromTarget(OSTWithinFunction.java:62) &gt;         at com.orientechnologies.orient.core.sql.parser.OFunctionCall.executeIndexedFunction(OFunctionCall.java:169) &gt;         at com.orientechnologies.orient.core.sql.parser.OLevelZeroIdentifier.executeIndexedFunction(OLevelZeroIdentifier.java:96) &gt;         at com.orientechnologies.orient.core.sql.parser.OBaseIdentifier.executeIndexedFunction(OBaseIdentifier.java:104) &gt;         at com.orientechnologies.orient.core.sql.parser.OBaseExpression.executeIndexedFunction(OBaseExpression.java:165) &gt;         at com.orientechnologies.orient.core.sql.parser.OExpression.executeIndexedFunction(OExpression.java:299) &gt;         at com.orientechnologies.orient.core.sql.parser.OBinaryCondition.executeIndexedFunction(OBinaryCondition.java:137) &gt;         at com.orientechnologies.orient.core.sql.executor.FetchFromIndexedFunctionStep.init(FetchFromIndexedFunctionStep.java:100) &gt;         at com.orientechnologies.orient.core.sql.executor.FetchFromIndexedFunctionStep.syncPull(FetchFromIndexedFunctionStep.java:38) &gt;         at com.orientechnologies.orient.core.sql.executor.FilterByClustersStep$1.fetchNextItem(FilterByClustersStep.java:57) &gt;         at com.orientechnologies.orient.core.sql.executor.FilterByClustersStep$1.hasNext(FilterByClustersStep.java:93) &gt;         at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.fetchNextItem(FilterByClassStep.java:50) &gt;         at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.hasNext(FilterByClassStep.java:88) &gt;         at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.hasNext(ProjectionCalculationStep.java:33) &gt;         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:36) &gt;         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:29) &gt;         at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:276) &gt;         at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:79) &gt;         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:568) &gt;         at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeQuery(OConnectionBinaryExecutor.java:1293) &gt;         at com.orientechnologies.orient.client.remote.message.OQueryRequest.execute(OQueryRequest.java:133) &gt;         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:304) &gt;         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:206) &gt;         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69) &gt; Caused by: java.lang.IllegalStateException: The managed reference has already closed - this is likely a bug when the reference count is modified outside of the ReferenceManager &gt;         at org.apache.lucene.search.ReferenceManager.acquire(ReferenceManager.java:114) &gt;         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.searcher(OLuceneIndexEngineAbstract.java:422) &gt;         ... 35 more   ## Steps to reproduce   None - occurs randomly.  </body>
		<created>2019-03-30 14:44:40</created>
		<closed>2019-04-04 13:41:31</closed>
	</bug>
	<bug>
		<id>8809</id>
		<title>create edge with same subquery between from and to use position params, result is wrong</title>
		<body>### OrientDB Version: &lt;3.0.17&gt;   ### Java Version: &lt;1.8.0_172&gt;   ### OS: &lt;windows 10&gt;    ## Expected behavior   ```java public class TestOrientClient {     public static void main(String[] args){         OrientDB orientDB = new OrientDB("remote:localhost/test", OrientDBConfig.defaultConfig());         try(ODatabaseSession db = orientDB.open("test","root","root");) {             // Enter your code here...             db.begin(OTransaction.TXTYPE.OPTIMISTIC);             db.command("create edge friends from (select from person where name=?) to (select from person where name=?)","tom","green");             db.commit();         }     } } ```  exist data in person class ```code +----+-----+------+-----+----+----+ |#   |@RID |@CLASS|name |age |id  | +----+-----+------+-----+----+----+ |0   |#45:0|person|tom  |16  |1   | |1   |#46:0|person|green|16  |1   | +----+-----+------+-----+----+----+ ``` result  should be: ```code +----+-----+-------+-----+-----+ |#   |@RID |@CLASS |out  |in   | +----+-----+-------+-----+-----+ |0   |#49:0|friends|#45:0|#46:0| +----+-----+-------+-----+-----+ ``` ## Actual behavior   ```code +----+-----+-------+-----+-----+ |#   |@RID |@CLASS |out  |in   | +----+-----+-------+-----+-----+ |0   |#49:0|friends|#45:0|#45:0| +----+-----+-------+-----+-----+ ``` ## this is  a wrong result ## I think this is due to command caching ## Steps to reproduce   &lt;add here&gt;   &lt;An SQL script to reproduce the problem or a JUnit test case will increase **A LOT** the chance to have a quick fix&gt;  ```code  orientdb {db=test}&gt; create class person extends V; orientdb {db=test}&gt; create class friends extends E; orientdb {db=test}&gt; insert into person (name,age,id) values ('tom',16,1); orientdb {db=test}&gt; insert into person (name,age,id) values ('green',16,1); ```  ```java  try(ODatabaseSession db = orientDB.open("test","root","root");) {             // Enter your code here...             db.begin(OTransaction.TXTYPE.OPTIMISTIC);             db.command("create edge friends from (select from person where name=?) to (select from person where name=?)","tom","green");             db.commit();         } ```</body>
		<created>2019-03-10 11:57:49</created>
		<closed>2019-03-11 11:39:49</closed>
	</bug>
	<bug>
		<id>8788</id>
		<title>Error with spacial functions in projection</title>
		<body>### OrientDB Version: 3.0.15 ### Java Version: 1.8 ### OS: Windows 8  ## Expected behavior   Some result with the distance value  ## Actual behavior   java.lang.NullPointerException   ## Steps to reproduce   Code similar to #8051 ``` CREATE class Restaurant; CREATE PROPERTY Restaurant.name STRING; CREATE PROPERTY Restaurant.location EMBEDDED OPoint;  INSERT INTO  Restaurant SET name = 'London', location = St_GeomFromText("POINT (-0.1277583 51.5073509)"); INSERT INTO  Restaurant SET name = 'Trafalgar', location = St_GeomFromText("POINT (-0.1280688 51.5080388)"); INSERT INTO  Restaurant SET name = 'Lambeth North Station', location = St_GeomFromText("POINT (-0.1120681 51.4989103)"); INSERT INTO  Restaurant SET name = 'Montreal', location = St_GeomFromText("POINT (-73.567256 45.5016889)");  CREATE INDEX bla ON Restaurant (location) SPATIAL ENGINE LUCENE;  /* should return values*/ SELECT  ST_Distance_Sphere(location, St_GeomFromText("POINT (-0.1277583 51.5073509)")) as dist from Restaurant; ``` Works well without using fields in the function  ```SELECT  ST_Distance_Sphere(St_GeomFromText("POINT (-0.1277583 51.5073509)")), St_GeomFromText("POINT (-0.1277583 51.5073509)")) as dist from Restaurant```  Similar probleme with ST_Distance but response is different ```SELECT  ST_Distance(location, St_GeomFromText("POINT (-0.1277583 51.5073509)")) as dist from Restaurant```  Response   &gt; org.locationtech.spatial4j.exception.InvalidShapeException: can't make Geometry from: null  ### Stacktrace &gt; java.lang.NullPointerException &gt; at com.orientechnologies.spatial.functions.OSTDistanceSphereFunction.execute(OSTDistanceSphereFunction.java:52) &gt; at com.orientechnologies.orient.core.sql.parser.OFunctionCall.execute(OFunctionCall.java:136) &gt; at com.orientechnologies.orient.core.sql.parser.OFunctionCall.execute(OFunctionCall.java:90) &gt; at com.orientechnologies.orient.core.sql.parser.OLevelZeroIdentifier.execute(OLevelZeroIdentifier.java:60) &gt; at com.orientechnologies.orient.core.sql.parser.OBaseIdentifier.execute(OBaseIdentifier.java:70) &gt; at com.orientechnologies.orient.core.sql.parser.OBaseExpression.execute(OBaseExpression.java:120) &gt; at com.orientechnologies.orient.core.sql.parser.OExpression.execute(OExpression.java:110) &gt; at com.orientechnologies.orient.core.sql.parser.OProjectionItem.execute(OProjectionItem.java:147) &gt; at com.orientechnologies.orient.core.sql.parser.OProjection.calculateSingle(OProjection.java:115) &gt; at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep.calculateProjections(ProjectionCalculationStep.java:66) &gt; at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep.access$000(ProjectionCalculationStep.java:13) &gt; at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.next(ProjectionCalculationStep.java:41) &gt; at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.next(OLocalResultSet.java:69) &gt; at com.orientechnologies.orient.core.sql.parser.OLocalResultSetLifecycleDecorator.next(OLocalResultSetLifecycleDecorator.java:56) &gt; at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:97) &gt; at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) &gt; at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:223) &gt; at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:702) &gt; at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)  </body>
		<created>2019-02-26 10:36:40</created>
		<closed>2020-01-20 11:20:09</closed>
	</bug>
	<bug>
		<id>8779</id>
		<title>SELECT with WHERE clause containing variables that match multiple indexes returns duplicate records.</title>
		<body>### OrientDB Version: 3.0.12 ### Java Version: 11.0.1 ### OS: macOS Mojave 10.14.3    ## Expected behavior   SELECT should return a single vertex when a single vertex matches the WHERE clause.  ## Actual behavior   SELECT returns duplicate vertices.  ## Steps to reproduce   In a graph DB (demodb works for this):  CREATE CLASS Test IF NOT EXISTS EXTENDS V;  CREATE PROPERTY Test.A IF NOT EXISTS INTEGER; CREATE PROPERTY Test.B IF NOT EXISTS INTEGER; CREATE PROPERTY Test.C IF NOT EXISTS STRING; CREATE PROPERTY Test.D IF NOT EXISTS INTEGER;  INSERT INTO Test (A, B, C, D) VALUES (1, 2, NULL, 2); INSERT INTO Test (A, B, C, D) VALUES (2, 3, NULL, 1); INSERT INTO Test (A, B, C, D) VALUES (3, 1, NULL, 1);  -- At this point, everything works fine, adding the indexes below causes the issue: CREATE INDEX Test.A_B_C IF NOT EXISTS ON Test (A, B, C) UNIQUE; CREATE INDEX Test.B_C_D IF NOT EXISTS ON Test (B, C, D) NOTUNIQUE; CREATE INDEX Test.A_C_D IF NOT EXISTS ON Test (A, C, D) NOTUNIQUE;   Create a function (or anything that allows the use of variables) containing the statements below: LET $a = 1; LET $c = NULL;  SELECT B,D FROM Test WHERE A = $a AND (C = $c OR ($c IS NULL AND C IS NULL));   Before the indexes are created, the single record with A = 1 is returned.  After the indexes are created, two copies of the record with A = 1 are returned by the query.  If the query is written without variables (replacing $a with 1 and $c with NULL in the query), the correct result (1 record) is returned.  It appears that the query is being executed against the two indexes and the results from each are merged without detecting that they returned the same record. </body>
		<created>2019-02-21 21:49:39</created>
		<closed>2019-02-25 14:48:55</closed>
	</bug>
	<bug>
		<id>8778</id>
		<title>Range on in() using nested projection fails</title>
		<body>### OrientDB Version: 3.0.15  ### OS: Windows 10  ## Steps to reproduce   The Document class has 3 vertices, 2 of which have an edge called IsA and 1 with no edge.  The following 3 queries all return the correct data. `select Name.Default as Name,in('IsA'):{@class as Label,Name.Default as Name} as All_in from Document limit 3` `select Name.Default as Name,in('IsA')[0]:{@class as Label,Name.Default as Name} as All_in from Document limit 3` `select Name.Default as Name,in('IsA')[1]:{@class as Label,Name.Default as Name} as All_in from Document limit 3`  however  `select Name.Default as Name,in('IsA')[0..2]:{@class as Label,Name.Default as Name} as All_in from Document limit 3` causes the following error `java.lang.UnsupportedOperationException: Cannot convert [Ljava.lang.Object;@8461eaa - class [Ljava.lang.Object; to JSON`</body>
		<created>2019-02-21 16:03:17</created>
		<closed>2019-03-08 15:56:44</closed>
	</bug>
	<bug>
		<id>8776</id>
		<title>Getting "Internal server error" when record ID does not exist in DB.</title>
		<body>### OrientDB Version: 3.0.14 ### Java Version: "11" 2018-09-25 ### OS: Mac OS X 10.14.3  Running query : `SELECT * FROM #1543243:18;` `#1543243:18` does not exists in my DB.  ## Expected behavior   0 records found.  ## Actual behavior   ``` Internal server error:  java.lang.NullPointerException at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.lambda$getMinimalSetOfNodesForShardedQuery$0(OSelectExecutionPlanner.java:306) at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195) at java.base/java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1603) at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484) at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474) at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913) at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:578) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.getMinimalSetOfNodesForShardedQuery(OSelectExecutionPlanner.java:306) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.calculateShardingStrategy(OSelectExecutionPlanner.java:272) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:137) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.createExecutionPlan(OSelectStatement.java:291) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:269) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:62) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:540) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:178) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:85) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:223) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:702) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69)  ```</body>
		<created>2019-02-20 16:16:55</created>
		<closed>2019-03-05 08:31:34</closed>
	</bug>
	<bug>
		<id>8772</id>
		<title>"missing session and token" after a period of time without interacting with OrientDB</title>
		<body>### OrientDB Version: 3.0.14 ### Java Version: 1.8 ### OS: Red Hat Enterprise Linux  ## Actual behavior   We are getting the following exception consistently when our system is not being used for while and a new request comes in that requires querying OrientDB. Before that all idle time the queries work fine. The exception is:  ``` ! com.orientechnologies.orient.enterprise.channel.binary.OTokenSecurityException: missing session and token ! DB name="map" ! DB name="map" ! at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ! at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ! at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ... ```  Not sure if this is a bug or I am confused about the java Document API described: [here](http://orientdb.com/docs/3.0.x/java/Document-API-Database.html)  The current usage of the Document API looks like this:  1. When our product starts up I create a singleton instance of OrientDB and another of ODatabasePool.  2. User requests comes in, I build up a query based on the user needs 3. perform `session = odbPool.acquire();` to get a ODatabaseSession 4. perform `session.execute("SQL", command)` to get the results 5. read necessary data from results 6. perform `session.close();` 7. return results  I thought the ODatabasePool was a pool of connections to a database. But looking at the javadoc on ODatabasePool says that it is "A Pool of databases". The documentation also mentions that we should close the database and it goes back to the pool. So I am not sure if I am hitting a bug or misusing the API.  Should I be creating a new ODatabasePool per request instead of having it as a singleton?    My goal is to have the equivalent of the `factory.setupPool(10, 30);` of the OrientGraphFactory in 2.2.X.   </body>
		<created>2019-02-15 14:31:25</created>
		<closed>2019-03-08 10:17:52</closed>
	</bug>
	<bug>
		<id>8765</id>
		<title>[Question] Indexing in/out edges in OrientDB 3.0.x</title>
		<body>### OrientDB Version: 3.0  Hi,  Is it still possible to index in/out attributes in edges?  I have created an `in` `LINK` attribute on a specific edge that we have. However, querying that class of edges did not seem to gain me any speed. Is there anything that I am doing wrong here?  ``` create index has_a.in on has_a (in) notunique select from has_a where in = #125:1443671 ```</body>
		<created>2019-02-13 11:45:49</created>
		<closed>2019-02-14 09:46:13</closed>
	</bug>
	<bug>
		<id>8763</id>
		<title>java.lang.NullPointerException in ALTER PROPERTY</title>
		<body>### OrientDB Version: 3.0.12   ### Java Version: OpenJDK 64-Bit Server VM 18.9   ### OS: CentOS Linux release 7.2.1511    ## Expected behavior   Property type is altered  ## Actual behavior   java.lang.NullPointerException  ## Steps to reproduce   Create a class X with property y of type STRING Enter ALTER PROPERTY X.Y TYPE LINK in Studio The response is a java.lang.NullPointerException </body>
		<created>2019-02-11 08:23:08</created>
		<closed>2019-02-14 11:06:49</closed>
	</bug>
	<bug>
		<id>8761</id>
		<title>Index cannot be created for properties with non-simplified identifier names</title>
		<body>### OrientDB Version: 3.0.14   ### Java Version: 11 ### OS: Windows 10  ## Expected behavior   It is possible to create properties with non-simplified identifier names, such as names containing spaces. Such names are surrounded by back-ticks, e.g. \`First Name\`. It should also be possible to create indexes on such properties.  ## Actual behavior   When attempting to create an index on a property which has spaces in its names, the OrientDB engine throws an exception whether or not the back-ticks are added:  java.lang.IllegalArgumentException: Illegal field name format, should be '&lt;property&gt; [by key|value]' but was '\`First Name\`'  ## Steps to reproduce   CREATE VERTEX Customer CREATE PROPERTY  Customer.\`First Name\` STRING CREATE PROPERTY Customer.\`Last Name\` STRING CREATE INDEX Name ON Customer( \`First Name\`, \`Last Name\` ) UNIQUE  </body>
		<created>2019-02-10 03:24:35</created>
		<closed>2019-03-08 09:36:51</closed>
	</bug>
	<bug>
		<id>8750</id>
		<title>Problem with WAL after updateing from 3.0.6 to 3.0.14</title>
		<body>### OrientDB Version: 3.0.14 ### Java Version: jre 10 ### OS: Win10    ## Expected behavior   We usind Orientdb for years now after update from 3.0.6 to 3.0.14 we see the following errors on shutting down. (Database is broken afterwards....)  ## Actual behavior   see below    ## Steps to reproduce   Feb. 01, 2019 3:32:57 NACHM. com.orientechnologies.common.log.OLogManager log SCHWERWIEGEND: Error during WAL writing java.nio.file.FileAlreadyExistsException: C:\Users\Eric\.picapport.cc\db\db.3.0.14\db.3.0.14.2.wal at java.base/sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:87) at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:103) at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:108) at java.base/sun.nio.fs.WindowsFileSystemProvider.newFileChannel(WindowsFileSystemProvider.java:116) at java.base/java.nio.channels.FileChannel.open(FileChannel.java:292) at java.base/java.nio.channels.FileChannel.open(FileChannel.java:340) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1862) at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:514) at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at java.base/java.lang.Thread.run(Thread.java:844)  Feb. 01, 2019 3:32:57 NACHM. com.orientechnologies.common.log.OLogManager log SCHWERWIEGEND: Exception in thread 'OrientDB WAL Flush Task' java.lang.IllegalStateException: java.nio.file.FileAlreadyExistsException: C:\Users\Eric\.picapport.cc\db\db.3.0.14\db.3.0.14.2.wal at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2060) at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:514) at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at java.base/java.lang.Thread.run(Thread.java:844) Caused by: java.nio.file.FileAlreadyExistsException: C:\Users\Eric\.picapport.cc\db\db.3.0.14\db.3.0.14.2.wal at java.base/sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:87) at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:103) at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:108) at java.base/sun.nio.fs.WindowsFileSystemProvider.newFileChannel(WindowsFileSystemProvider.java:116) at java.base/java.nio.channels.FileChannel.open(FileChannel.java:292) at java.base/java.nio.channels.FileChannel.open(FileChannel.java:340) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALFile.createWriteWALFile(OWALFile.java:38) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1862) ... 6 more  Feb. 01, 2019 3:32:57 NACHM. com.orientechnologies.common.log.OLogManager log SCHWERWIEGEND: Error during FSync of WAL data java.nio.channels.ClosedChannelException at java.base/sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:158) at java.base/sun.nio.ch.FileChannelImpl.force(FileChannelImpl.java:452) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALChannelFile.force(OWALChannelFile.java:33) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$run$0(OCASDiskWriteAheadLog.java:2030) at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at java.base/java.lang.Thread.run(Thread.java:844)  Feb. 01, 2019 3:32:57 NACHM. com.orientechnologies.common.log.OLogManager log SCHWERWIEGEND: Exception in thread 'OrientDB WAL Write Task Thread)' java.nio.channels.ClosedChannelException at java.base/sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:158) at java.base/sun.nio.ch.FileChannelImpl.force(FileChannelImpl.java:452) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALChannelFile.force(OWALChannelFile.java:33) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$run$0(OCASDiskWriteAheadLog.java:2030) at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at java.base/java.lang.Thread.run(Thread.java:844)  Feb. 01, 2019 3:32:57 NACHM. com.orientechnologies.common.log.OLogManager log SCHWERWIEGEND: Exception `560E1BF3` in storage `plocal:C:\Users\Eric\.picapport.cc\db/db.3.0.14`: 3.0.14 - Veloce (build ac128c5a9ba4c6dc9d25a32b92962d8863774423, branch 3.0.x) com.orientechnologies.orient.core.exception.OStorageException: Error during WAL write for storage db.3.0.14 DB name="db.3.0.14" at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.waitTillWriteWillBeFinished(OCASDiskWriteAheadLog.java:657) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.flush(OCASDiskWriteAheadLog.java:1366) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:4343) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:4942) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:669) at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:236) at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:486) at com.orientechnologies.orient.core.db.OrientDBEmbedded.close(OrientDBEmbedded.java:475) at com.orientechnologies.orient.core.db.OrientDB.close(OrientDB.java:292) at de.contecon.picapport.db.PicApportDBService.closeOrientDb(PicApportDBService.java:423) at de.contecon.picapport.db.PicApportDBService.stopDatabase(PicApportDBService.java:278) at de.contecon.picapport.db.PicApportDBService.stopDatabase(PicApportDBService.java:250) at de.contecon.picapport.PicApport.shutdown(PicApport.java:1624) at de.contecon.picapport.PicApport.doCmd_exit(PicApport.java:1744) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:564) at de.contecon.picapport.PicApportCmdQueue.consumeCommand(PicApportCmdQueue.java:126) at de.contecon.picapport.PicApportCmdQueue.access$1(PicApportCmdQueue.java:108) at de.contecon.picapport.PicApportCmdQueue$CommandConsumer.run(PicApportCmdQueue.java:160) at java.base/java.lang.Thread.run(Thread.java:844) Caused by: java.util.concurrent.ExecutionException: java.nio.channels.ClosedChannelException at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122) at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.waitTillWriteWillBeFinished(OCASDiskWriteAheadLog.java:653) ... 21 more Caused by: java.nio.channels.ClosedChannelException at java.base/sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:158) at java.base/sun.nio.ch.FileChannelImpl.force(FileChannelImpl.java:452) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALChannelFile.force(OWALChannelFile.java:33) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$run$0(OCASDiskWriteAheadLog.java:2030) at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ... 1 more  Feb. 01, 2019 3:32:57 NACHM. com.orientechnologies.common.log.OLogManager log WARNUNG: $ANSI{green {db=db.3.0.14}} -- error on shutdown storage com.orientechnologies.orient.core.exception.OStorageException: Error during WAL write for storage db.3.0.14 DB name="db.3.0.14" at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.waitTillWriteWillBeFinished(OCASDiskWriteAheadLog.java:657) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.flush(OCASDiskWriteAheadLog.java:1366) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:4343) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:4942) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:669) at com.orientechnologies.orient.core.storage.OStorageAbstract.shutdown(OStorageAbstract.java:236) at com.orientechnologies.orient.core.db.OrientDBEmbedded.internalClose(OrientDBEmbedded.java:486) at com.orientechnologies.orient.core.db.OrientDBEmbedded.close(OrientDBEmbedded.java:475) at com.orientechnologies.orient.core.db.OrientDB.close(OrientDB.java:292) at de.contecon.picapport.db.PicApportDBService.closeOrientDb(PicApportDBService.java:423) at de.contecon.picapport.db.PicApportDBService.stopDatabase(PicApportDBService.java:278) at de.contecon.picapport.db.PicApportDBService.stopDatabase(PicApportDBService.java:250) at de.contecon.picapport.PicApport.shutdown(PicApport.java:1624) at de.contecon.picapport.PicApport.doCmd_exit(PicApport.java:1744) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:564) at de.contecon.picapport.PicApportCmdQueue.consumeCommand(PicApportCmdQueue.java:126) at de.contecon.picapport.PicApportCmdQueue.access$1(PicApportCmdQueue.java:108) at de.contecon.picapport.PicApportCmdQueue$CommandConsumer.run(PicApportCmdQueue.java:160) at java.base/java.lang.Thread.run(Thread.java:844) Caused by: java.util.concurrent.ExecutionException: java.nio.channels.ClosedChannelException at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122) at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog.waitTillWriteWillBeFinished(OCASDiskWriteAheadLog.java:653) ... 21 more Caused by: java.nio.channels.ClosedChannelException at java.base/sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:158) at java.base/sun.nio.ch.FileChannelImpl.force(FileChannelImpl.java:452) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OWALChannelFile.force(OWALChannelFile.java:33) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$run$0(OCASDiskWriteAheadLog.java:2030) at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ... 1 more  </body>
		<created>2019-02-01 14:38:08</created>
		<closed>2019-06-18 12:35:17</closed>
	</bug>
	<bug>
		<id>8745</id>
		<title>Problem with SQl Where IN clause and subselect</title>
		<body>### OrientDB Version: 3.0.14 ### Java Version: 1.8.x ### OS: Windows    ## Expected behavior   See attached Screenshot from Orientdb studio  ## Actual behavior   See attached Screenshot from Orientdb studio  ## Steps to reproduce   See attached Screenshot from Orientdb studio  ![select](https://user-images.githubusercontent.com/4680347/51913423-b9e0c600-23d6-11e9-8868-88f4185a23bb.jpg)  </body>
		<created>2019-01-29 14:02:10</created>
		<closed>2019-02-04 15:44:01</closed>
	</bug>
	<bug>
		<id>8739</id>
		<title>How to use variable more times in batch ?</title>
		<body>### OrientDB Version: 3.0.10 ### OS: Mac OS X 10.14.2  ## Actual behavior    ### This runs without issues: ``` BEGIN; LET createTestValue = CREATE vertex Table1 SET field = "testValue"; LET testResult = UPDATE #185:0 SET link1=[$createTestValue]; COMMIT; RETURN $testResult; ```  ### But this , returns error :   ``` BEGIN; LET createTestValue = CREATE vertex Table1 SET field = "testValue"; LET testResult = UPDATE #185:0 SET link1=[$createTestValue],link2=[$createTestValue]; COMMIT; RETURN $testResult; ``` Returns :  com.orientechnologies.orient.core.exception.OValidationException: The field 'Table2.link2' has been declared as LINK but the value is not a record or a record-id DB name="testdb" Error Code="4"  Everytime, I use variable more times in the same line I get error.  How can I make this work please ? Thank you  ## Steps to reproduce   ``` CREATE CLASS Table1 IF NOT EXISTS EXTENDS V; CREATE PROPERTY Table1.field STRING;  CREATE CLASS Table2 IF NOT EXISTS EXTENDS V; CREATE PROPERTY Table2.someTextfield STRING; CREATE PROPERTY Table2.link1 LINK Table1; CREATE PROPERTY Table2.link2 LINK Table1;  CREATE VERTEX Table2 SET someTextfield = 'text'; ``` </body>
		<created>2019-01-25 20:35:41</created>
		<closed>2019-02-06 16:38:34</closed>
	</bug>
	<bug>
		<id>8724</id>
		<title>Fetchplan issue in v3+</title>
		<body>### OrientDB Version: 3.0.6 ### Java Version:  openjdk version "1.8.0_151" OpenJDK Runtime Environment (build 1.8.0_151-b12) OpenJDK 64-Bit Server VM (build 25.151-b12, mixed mode)  ### OS: centos06   ## Expected behavior   fetch all linked records  ## Actual behavior   no change to the query result when the fetch plan was given  ## Steps to reproduce    create a new db and a single record  ```SQL create vertex v content {"name": "bob"} ```  returns `#9:0` use this as a link in the new record  ```SQL create vertex v content {"name": "alice", "brother": #9:0} ```  select alice with a fetch plan (any of the following)  ```SQL select * from v where name = 'alice' fetchPlan *:-1 select * from v where name = 'alice' fetchPlan *:1 select * from v where name = 'alice' fetchPlan brother:1 ```  None of these return the linked record contents. For this simple example a nested project could be used which does work. I realize fetchPlans are deprecated, but I am building my queries dynamically and won't be able to use nested projections for the more complex examples  This works in 2.2.X but not 3.0.X. I am trying to migrate to the 3.0.X version  </body>
		<created>2019-01-10 21:41:10</created>
		<closed>2019-01-17 10:37:43</closed>
	</bug>
	<bug>
		<id>8714</id>
		<title>SQL map functions not working anymore</title>
		<body>### OrientDB Version: 3.0.11 ### Java Version: 1.8  ### OS:  Docker   This is the command I use ``` select calc.@class as calc_class, map(diag, diag.Flag) as diags  FROM (match {class: diagnostics, as: diag, where : (Store = 'IGA_Auteuil' and End_Date = '2018-10-01 00:00:00' and Timespan in ['Monthly','Weekly','Daily']) }.out(EHasDiagnostics) {as: calc} return calc , diag ) group by calc.@class ```  ## Expected behavior   In orientdb 2.2.37, the diag records where grouped in a new map of the categories  like this   ``` {     "result": [         {             "@type": "d",             "@rid": "#-2:0",             "@version": 0,             "calc_class": "VHotte",             "diags": {                 "#185:1469": "Yellow",                 "#187:1042": "Red",                 "#188:1042": "Green",                 "#187:619": "Green",                 "#187:190": "Red",                 "#188:1468": "Red"             }         },         {             "@type": "d",             "@rid": "#-2:2",             "@version": 0,             "calc_class": "VLighting",             "diags": {                 "#228:1101": "Green",                 "#226:1547": "Green",                 "#227:1101": "Green",                 "#225:205": "Green",                 "#227:654": "Green",                 "#228:654": "Green"             }         },         {             "@type": "d",             "@rid": "#-2:6",             "@version": 0,             "calc_class": "VWattNode_Total",             "diags": {                 "#230:10": "Green"             }         },         {             "@type": "d",             "@rid": "#-2:7",             "@version": 0,             "calc_class": "VAntisweat",             "diags": {                 "#221:247": "Green"             }         },         {             "@type": "d",             "@rid": "#-2:9",             "@version": 0,             "calc_class": "VDeshumStage",             "diags": {                 "#168:91": "Yellow",                 "#168:306": "Yellow"             }         },         {             "@type": "d",             "@rid": "#-2:3",             "@version": 0,             "calc_class": "VCOP",             "diags": {                 "#199:63": "Green",                 "#198:534": "Green",                 "#189:599": "Green",                 "#194:82": "Green"             }         },         {             "@type": "d",             "@rid": "#-2:8",             "@version": 0,             "calc_class": "VSpaceTemp",             "diags": {                 "#153:923": "Green",                 "#156:540": "Green"             }         },         {             "@type": "d",             "@rid": "#-2:5",             "@version": 0,             "calc_class": "VDeshumDXCoils",             "diags": {                 "#169:47": "Yellow"             }         },         {             "@type": "d",             "@rid": "#-2:1",             "@version": 0,             "calc_class": "VCompressor",             "diags": {                 "#220:3141": "Green",                 "#220:4443": "Green",                 "#220:1843": "Green",                 "#217:4444": "Green",                 "#218:3141": "Green",                 "#219:3141": "Green",                 "#218:4444": "Green",                 "#219:4444": "Green",                 "#217:3141": "Green",                 "#220:541": "Green",                 "#216:714": "Green",                 "#217:1844": "Green",                 "#219:541": "Green",                 "#218:541": "Green",                 "#218:1844": "Green",                 "#219:1844": "Green",                 "#217:3142": "Green",                 "#213:422": "Green",                 "#217:542": "Green"             }         },         {             "@type": "d",             "@rid": "#-2:4",             "@version": 0,             "calc_class": "VPreheat",             "diags": {                 "#163:101": "Green",                 "#164:841": "Green"             }         }     ],     "notification": "Query executed in 0.073 sec. Returned 10 record(s)" } ```  ## Actual behavior   But in orientdb  3.0.11, the results are not grouped   ``` {     "result": [         {             "calc_class": "VCompressor",             "diags": {                 "#218:1435": "Green"             }         },         {             "calc_class": "VCompressor",             "diags": {                 "#217:461": "Green"             }         },         {             "calc_class": "VHotte",             "diags": {                 "#187:1540": "Green"             }         },         {             "calc_class": "VCompressor",             "diags": {                 "#215:1060": "Green"             }         },         {             "calc_class": "VSpaceTemp",             "diags": {                 "#154:1271": "Green"             }         },         {             "calc_class": "VPreheat",             "diags": {                 "#164:518": "Green"             }         },         {             "calc_class": "VCompressor",             "diags": {                 "#215:105": "Green"             }         },         {             "calc_class": "VCompressor",             "diags": {                 "#217:1111": "Green"             }         },  ...  ```</body>
		<created>2018-12-28 19:21:16</created>
		<closed>2019-01-03 10:17:38</closed>
	</bug>
	<bug>
		<id>8706</id>
		<title>Decimal issues</title>
		<body>### OrientDB Version: 3.0.12 ### Java Version: 11.0.1+13 ### OS: Windows  This is duplicate of bug #6742 fix of which seems like missed from versions 3.X.X. Here are steps to reproduce: https://gist.github.com/Y0ba/0373a773bf2e65cd9df04b8e6a51cd3a  I use stripTrailingZeros() method to workaround this bug. Maybe OrientDB should use it internally too? </body>
		<created>2018-12-24 07:40:24</created>
		<closed>2019-01-03 13:20:45</closed>
	</bug>
	<bug>
		<id>8705</id>
		<title>Bug in SQL method keys/values </title>
		<body>### OrientDB Version: 3.0.x  https://github.com/orientechnologies/orientjs/issues/352   </body>
		<created>2018-12-21 13:59:31</created>
		<closed>2018-12-21 14:15:42</closed>
	</bug>
	<bug>
		<id>8693</id>
		<title>Index not used with OR/AND condition combination</title>
		<body>### OrientDB Version: 2.2.37 ### Java Version:  openjdk version "1.8.0_151" OpenJDK Runtime Environment (build 1.8.0_151-b12) OpenJDK 64-Bit Server VM (build 25.151-b12, mixed mode) ### OS: centos7   ## Expected behavior   Expected the index to be used  ## Actual behavior   The index was not used   ## Steps to reproduce    Create the test conditions with randomly named property prop1, prop2, prop3 ```SQL create property v.prop1 string create property v.prop2 string create property v.prop3 string ``` Create full-text indexes on prop1 and prop2  ```SQL create index prop1Index on v (prop1) fulltext create index prop2Index on v (prop2) fulltext ``` Now attempt to query (explain)  ```sql select * from v where prop1 containstext 'sometext' or prop2 containstext 'sometext' ``` This works as expected and the index is used  ```json {     "result": [         {             "@type": "d",             "@version": 0,             "fullySortedByIndex": false,             "compositeIndexUsed": 2,             "involvedIndexes": [                 "prop2Index",                 "prop1Index"             ],             "limit": -1,             "fetchingFromTargetElapsed": 0,             "indexIsUsedInOrderBy": false,             "elapsed": 0.445399,             "resultType": "collection",             "resultSize": 0,             "@fieldTypes": "compositeIndexUsed=l,involvedIndexes=e,fetchingFromTargetElapsed=l,elapsed=f"         }     ],     "notification": "Query executed in 0.01 sec. Returned 1 record(s)" } ``` However if these conditions are then surrounded in parentheses and the conditions following it use an AND this will fail to use the index  ```sql select * from v where (prop1 containstext 'sometext' or prop2 containstext 'sometext') and prop3 = 'sometext' ``` see explain below ```json {     "result": [         {             "@type": "d",             "@version": 0,             "fetchingFromTargetElapsed": 0,             "elapsed": 0.202031,             "resultType": "collection",             "resultSize": 0,             "@fieldTypes": "fetchingFromTargetElapsed=l,elapsed=f"         }     ],     "notification": "Query executed in 0.015 sec. Returned 1 record(s)" } ```</body>
		<created>2018-12-06 23:14:26</created>
		<closed>2019-04-10 12:00:10</closed>
	</bug>
	<bug>
		<id>8690</id>
		<title>BUG for dropping database,Unexpect operation for dropping non-current database</title>
		<body>### OrientDB Version: 3.0.11   ### Java Version: 1.8   ### OS: Centos6.9   ## Expected behavior   connected remote to a2 then drop database a1    ## Actual behavior   drop database  a2  ## Steps to reproduce    ![efe08d7c0d950e253e6f0c5578ee77ae](https://user-images.githubusercontent.com/45650038/49564742-91e95f00-f95f-11e8-9185-8e49b9f07c02.jpg)  </body>
		<created>2018-12-06 06:04:47</created>
		<closed>2018-12-06 13:30:47</closed>
	</bug>
	<bug>
		<id>8681</id>
		<title>[3.0.11] Cannot write Line break symbol.</title>
		<body>### OrientDB Version: 3.0.11 ### Java Version: 1.8.0_102 ### OS: centos 6.8  ## Expected behavior   write `\n` success, select that record and return `\n`  ## Actual behavior   write `\n` changed in to `n`  ## Steps to reproduce   execute sql below and check memo property ``` create vertex v content { name: "jack", memo: "this is a \n multi line text" } select from v ```  </body>
		<created>2018-11-29 01:51:55</created>
		<closed>2018-11-29 11:32:18</closed>
	</bug>
	<bug>
		<id>8677</id>
		<title>JDBC driver getBoolean fails on null value</title>
		<body>### OrientDB Version: latest git version (commit d6fb8ec8be455b1f5e7be7e89f646ee3d6404310) ### Java Version: 1.8.0_121-b13 ### OS: Windows 10  ## Expected behavior   I have a class myV with a property myBool which is of type Boolean. There are two records of type myV, the first record contains has a value for myBool (false) and the second record has myBool = null.  When I retrieve these records through the JDBC interface, I believe that I should be able to write: ``` // Execute query Statement s = conn.createStatement(); ResultSet r = s.executeQuery("SELECT myBool FROM myV"); // Obtain meta data ResultSetMetaData m = r.getMetaData(); int nCols = m.getColumnCount(); // Get the column types once and store them in an array int colTypes[] = new int[nCols]; for (int i=0;i&lt;nCols;i++) {     colTypes[i] = m.getColumnType(i+1); }  // Go through all rows and columns while(r.next()) {     for (int i=0;i&lt;nCols;i++) {         switch (colTypes[i]) {             case java.sql.Types.BOOLEAN:                 boolean b = r.getBoolean(i+1);                 System.out.println(b);                 break;             default:                 Object obj = r.getObject(i+1);                 System.out.println(obj);                 break;         }     } } r.close(); s.close(); ``` There are three important assumptions/points in this code:  1. I only have to determine the types of the columns once; I mean this cannot change per row, right?  2. If the type is BOOLEAN, I should retrieve the value with getBoolean.  3. In my real code I have case statements for other types as well, not shown here, plus, also, shown here, always a fallback which uses getObject, which should always work.  ## Actual behavior    This errors out with ``` Exception in thread "main" java.sql.SQLException: An error occurred during the retrieval of the boolean value at column 'myBool' ---&gt; {"@type":"d","@version":0,"myBool":null} at com.orientechnologies.orient.jdbc.OrientJdbcResultSet.getBoolean(OrientJdbcResultSet.java:379) at com.orientechnologies.orient.jdbc.OrientJdbcResultSet.getBoolean(OrientJdbcResultSet.java:369) at Main.main(Main.java:21) Caused by: java.lang.NullPointerException at com.orientechnologies.orient.jdbc.OrientJdbcResultSet.getBoolean(OrientJdbcResultSet.java:375) ... 2 more ``` The problem here is that getBoolean fails when the actual data is null.  Note by the way, that if I do not "cache" the column types and use m.getColumnType inside the while-loop, that getColumnType will return 0 once the second row is reached; which gets me into the default case which then works correctly. But the type of a column should not be changing when going through the rows, right?  ## Proposed fix  For now, I actually made a change to the JDBC driver, updated getBoolean to use `Boolean` object instead of `boolean` primitive and return false if value was null: ``` public boolean getBoolean(String columnLabel) throws SQLException {   try {     Boolean r = result.getProperty(columnLabel);     if (r==null) {       lastReadWasNull = true;       return false;     } else {         return r;     }   } catch (Exception e) {     throw new SQLException(         "An error occurred during the retrieval of the boolean value at column '" + columnLabel + "' ---&gt; " + result.toElement()             .toJSON(), e);   }  } ``` </body>
		<created>2018-11-26 10:28:50</created>
		<closed>2018-11-26 11:27:39</closed>
	</bug>
	<bug>
		<id>8674</id>
		<title>JDBC Driver does not properly implement wasNull</title>
		<body>### OrientDB Version: 3.0.3 ### Java Version: 1.8.0_121-b13 ### OS: Windows 10  ## Expected behavior   When having executed a query and having obtained a ResultSet `rs`, I should normally be able to:  ``` while(rs.next() {   string val = rs.getString(colnum);   if  (rs.wasNull()) {     // Do something special in case string was NULL   } else {     // Assume val is not NULL   } } ``` I _should_ not have to also check for `val==null`.  ## Actual behavior   `wasNull()` in OrientDB JDBC driver simply always returns `false`.     </body>
		<created>2018-11-23 14:18:18</created>
		<closed>2018-11-23 16:15:49</closed>
	</bug>
	<bug>
		<id>8673</id>
		<title>WAL issue adding edges to the same Vertex from more than one connection</title>
		<body>### OrientDB Version: 3.0.8, 3.0.10 ### Java Version: Oracle JDK 1.8 ### OS: Alpine Linux, Windows 7  * Start a standalone server (default configuration, 4GB ram) and **-Dstorage.useWAL=true**. * From a Java Client insert one Vertex of the class B (with just few simple fields, aka name, description an so on). * Start two or more instances of the Java Client inserting Vertex of class A (with just few simple fields, aka name, description an so on), all of them connected to Vertex B with one directed edge (see picture). Clients can run either fro different threads or different computers, the result is exactly the same.  ![issue](https://user-images.githubusercontent.com/4680279/48939774-ad8f4700-ef15-11e8-9af3-826c56df6e48.png)  ## Actual behavior   After a certain number of insert (15k max) the server hangs, no error are displayed. The clients hangs, too.  ## Steps to reproduce   Just start the server, create the schema with classes A and B and an edge A2B. Start 2 or more Java main on different threads/JVM/host, in order to insert a list of A vertexes, all of them connected to B vertex through edges A2B. Wait to find the server and the clients being blocked.     The same test works properly if you disable WAL on the server (**-Dstorage.useWAL=false**)  Setting up the bulk insert mode on the client connections do not resolve the problem. </body>
		<created>2018-11-23 11:04:14</created>
		<closed>2019-05-10 10:40:10</closed>
	</bug>
	<bug>
		<id>8672</id>
		<title>WAL errors</title>
		<body>### OrientDB Version: 3.0.12-SNAPSHOT, also earlier versions ### Java Version: 1.8 u192 ### OS: Windows 7 64-bit     I am seeing infinite looping in the server console of these errors, when trying to drop the database or fully rebuild the schema objects:  ``` Error during WAL writing java.util.concurrent.ExecutionException: java.lang.NullPointerException         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1985)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$writeBuffer$1(OCASDiskWriteAheadLog .java:2142)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         ... 3 more Exception in thread 'OrientDB WAL Flush Task' java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2058)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.util.concurrent.ExecutionException: java.lang.NullPointerException         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1985)         ... 7 more Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$writeBuffer$1(OCASDiskWriteAheadLog .java:2142)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         ... 3 more Error during WAL writing java.util.concurrent.ExecutionException: java.lang.NullPointerException         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1985)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$writeBuffer$1(OCASDiskWriteAheadLog .java:2142)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         ... 3 more Exception in thread 'OrientDB WAL Flush Task' java.lang.IllegalStateException: java.util.concurrent.ExecutionException: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:2058)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) Caused by: java.util.concurrent.ExecutionException: java.lang.NullPointerException         at java.util.concurrent.FutureTask.report(FutureTask.java:122)         at java.util.concurrent.FutureTask.get(FutureTask.java:192)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.run(OCASDiskWriteAheadLog.java:1985)         ... 7 more Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.cas.OCASDiskWriteAheadLog$RecordsWriter.lambda$writeBuffer$1(OCASDiskWriteAheadLog .java:2142)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         ... 3 more  ```  </body>
		<created>2018-11-21 20:11:54</created>
		<closed>2019-06-18 12:37:15</closed>
	</bug>
	<bug>
		<id>8671</id>
		<title>coalesce function should return value for $value.field</title>
		<body>### OrientDB Version: 3.0.9 ### Java Version: 1.8 ### OS: Windows 10  ## Expected behavior   _coalesce_ function should properly identify not null value referenced as $profile.Name  ## Actual behavior   The function returns last argument(i.e. 'Unknown') even when first argument is not null  ![image](https://user-images.githubusercontent.com/22835413/48785721-9702a900-ece5-11e8-821b-fefd63a9e621.png)   ## Steps to reproduce    Run following query on demo database:  ``` select @rid, @class, Phone, OrderedId,   $profile.Name,   coalesce($profile.Name, 'Unknown') from Customers let $profile = out('HasProfile')[0] ```  </body>
		<created>2018-11-20 16:00:19</created>
		<closed>2018-11-22 13:47:10</closed>
	</bug>
	<bug>
		<id>8669</id>
		<title>Error upgrading from 2.x to 3.x: The destination vertex must be a vertex record</title>
		<body>### OrientDB Version: 3.0.10   ### Java Version: "1.8.0_171" Java(TM) SE Runtime Environment (build 1.8.0_171-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11,  mixed mode) ### OS: Windows 10 Home  ## Expected behavior   Until (at least) version 2.2.23 Directly from Studio-&gt;Browse, execute the following query:  ``` SELECT percorso from ( SELECT shortestPath(son, parent, 'OUT', 'hypernym') as percorso from ( select from ( select list(son) as son, list(parent) as parent from ( SELECT EXPAND( $c )  LET $a = ( select null as son, @rid as parent from synset where lemmas lucene 'animale' and lang='it'),                $b = ( select @rid as son, null as parent from synset where lemmas lucene 'gatto' and lang='it' and verified is null ),  $c = UNIONALL( $a, $b )                         )                   ) unwind son, parent ) ) ```  Result ``` PROPERTIES --  #21:0#22:0#23:0#24:0#21:1#22:1..More(2) #21:2#21:0#22:0#23:0#24:0#21:1..More(3)  ```  ## Actual behavior   java.lang.IllegalArgumentException: The destinationVertex must be a vertex record  ## Steps to reproduce   See above. You can use the reduced example db in #8565  I cannot find any upgrade instruction about changes in the sql that could be impacted in the above query. Please, help, I cannot upgrade in these conditions  </body>
		<created>2018-11-19 13:23:02</created>
		<closed>2018-11-19 15:12:39</closed>
	</bug>
	<bug>
		<id>8666</id>
		<title>INSERT with CONTENT synax error when using named params v3.0.x</title>
		<body>OrientDB Version: 3.0.10 Java Version: 1.8.0_111 OS: Ubuntu 18.04 OrientJS Version:  3.0.1  and the same error with Java driver as mentioned here: orientechnologies/orientjs#346   ### this works if you put json inline: ````typescript session.command('INSERT INTO Log CONTENT {test: "inline json"}') ```` ### and this not if you use named parameters: ```typescript session.command( 'INSERT INTO Log CONTENT :log',  {     params: {log: { test: 'json in params' }} }) ```  ### it throws error: ```` OrientDB.RequestError: Error parsing query:       INSERT INTO Log CONTENT ":log"                             ^       Encountered " &lt;CONTENT&gt; "CONTENT "" at line 1, column 17.       Was expecting one of:           &lt;EOF&gt;            &lt;SELECT&gt; ...           &lt;FROM&gt; ...           &lt;RETURN&gt; ...           &lt;UNSAFE&gt; ...           "(" ...           ";" ...           &lt;CLUSTER&gt; ...           "(" ...                  DB name="smdb_dev"       Error Code="1"       at child.Object.&lt;anonymous&gt;.Operation.parseError (node_modules/orientjs/lib/client/network/protocol37/operation.js:1224:13)       at child.Object.&lt;anonymous&gt;.Operation.consume (node_modules/orientjs/lib/client/network/protocol37/operation.js:566:35)       at ONetworkConnection.Object.&lt;anonymous&gt;.Connection.process (node_modules/orientjs/lib/client/network/conn.js:460:17)       at ONetworkConnection.Object.&lt;anonymous&gt;.Connection.handleSocketData (node_modules/orientjs/lib/client/network/conn.js:342:20)  ````  It was working on 2.2 version any ideas what i'm doing wrong ? </body>
		<created>2018-11-18 20:25:13</created>
		<closed>2018-11-20 10:37:30</closed>
	</bug>
	<bug>
		<id>8665</id>
		<title>'CREATE INDEX BY VALUE' breaks 'SELECT WHERE'</title>
		<body>### OrientDB Version: 3.1.0 from develop branch ### Java Version: docker openjdk:8-jdk-alpine ### OS: docker openjdk:8-jdk-alpine  ## Steps to reproduce   ```sql CREATE CLASS TForm CREATE CLASS TDocument CREATE PROPERTY `TDocument`.`form` LINKMAP `TForm` CREATE PROPERTY `TForm`.`answer` EMBEDDEDMAP STRING  INSERT INTO TDocument SET form = {} --returns #17:0 INSERT INTO TDocument SET form = {} --returns #18:0 INSERT INTO TForm SET answer = {type: "profile"} --returns #15:0 INSERT INTO TForm SET answer = {type: "profile"} --returns #16:0 UPDATE TDocument SET form.profile = #15:0 where @rid = #17:0 UPDATE TDocument SET form.profile = #16:0 where @rid = #18:0  SELECT form.profile:{*} FROM TDocument where form.profile.answer.type = "profile" --returns result CREATE INDEX formByValue ON TDocument (form BY VALUE) NOTUNIQUE_HASH_INDEX SELECT form.profile:{*} FROM TDocument where form.profile.answer.type = "profile" --returns java.lang.NullPointerException ``` How to create right index to use it in sql like ```where form.profile.answer.type = "profile"```? </body>
		<created>2018-11-16 17:23:57</created>
		<closed>2018-11-19 11:53:49</closed>
	</bug>
	<bug>
		<id>8662</id>
		<title>MAPLINK expanding as mapfield:{*:{name}} doesn't work</title>
		<body>### OrientDB Version: 3.1.0 from develop branch   ### Java Version: docker openjdk:8-jdk-alpine   ### OS: docker openjdk:8-jdk-alpine   ## Expected behavior   ```{"A1":{"name":"test"},"A2":{"name":"test"}}  ```  ## Actual behavior   ```{"A1":"#23:0","A2":"#23:0"} ```  ## Steps to reproduce   ```sql CREATE CLASS Test; CREATE CLASS TestMap; CREATE PROPERTY Test.mymap LINKMAP TestMap; CREATE PROPERTY Test.id STRING;  INSERT INTO TestMap (name) VALUES ('test'); INSERT INTO Test SET id = "123", mymap = {};  UPDATE Test SET mymap['A1'] = (SELECT FROM TestMap WHERE name = 'test') WHERE id = "123" UPDATE Test SET mymap['A2'] = (SELECT FROM TestMap WHERE name = 'test') WHERE id = "123" ... SELECT mymap:{*:{name}} FROM Test where id = "123" // {"A1":"#23:0","A2":"#23:0"} SELECT mymap:{*:{*}} FROM Test where id = "123" // {"A1":"#23:0","A2":"#23:0"} SELECT mymap:{"A1":{name},"A2":{name}} FROM Test where id = "123" // {"A1":{"name":"test"},"A2":{"name":"test"}} ```</body>
		<created>2018-11-15 15:39:56</created>
		<closed>2018-11-16 14:13:55</closed>
	</bug>
	<bug>
		<id>8658</id>
		<title>How to initialise MAP type at the first time</title>
		<body>### OrientDB Version: 3.1.0 from develop branch ### Java Version: docker openjdk:8-jdk-alpine ### OS: docker openjdk:8-jdk-alpine  I have no idea how to set LINKMAP at the first time. Is there concat function as "||" for MAP types?    ## Steps to reproduce   ```sql CREATE CLASS Test; CREATE CLASS TestMap; CREATE PROPERTY Test.mymap LINKMAP TestMap; CREATE PROPERTY Test.id STRING;  INSERT INTO TestMap (name) VALUES ('test'); INSERT INTO Test SET id = "123";  0. UPDATE Test SET mymap['A-1'] = (SELECT FROM TestMap WHERE name = 'test') WHERE id = "123" // java.lang.NullPointerException 1. UPDATE Test SET mymap = {'A-1': (SELECT FROM TestMap WHERE name = 'test')} WHERE id = "123" // {"A-1": #x:x} 2. UPDATE Test SET mymap['A-2'] = (SELECT FROM TestMap WHERE name = 'test') WHERE id = "123" // {"A-1": #x:x, "A-2": #x:x} ``` The problem is I can't predict order of sql 1 and 2. I tried to do something like ```sql INSERT INTO Test SET id = "123", mymap = {"dummy": -1:-1} // com.orientechnologies.orient.core.exception.OValidationException: The field 'Test.mymap' has been declared as LINKMAP but contains a null record (probably a deleted record?) ```</body>
		<created>2018-11-14 14:51:53</created>
		<closed>2018-11-20 11:15:56</closed>
	</bug>
	<bug>
		<id>8654</id>
		<title>CONTAINS(EMBEDDED LIST) problem </title>
		<body>### OrientDB Version: 3.0.8 ### Java Version: 1.8 ### OS: Centos 6.8  ## Create class test  with property dict | Name |     Type     | Linked_Type | |:----:|:------------:|-------------| | dict | EMBEDDEDLIST | EMBEDDEDMAP |  ## Create a record of test ``` insert into test set dict=[{"name":"Jack"},{"age":"21"}]  ``` ##successful sql ``` select * from `test` where `dict` CONTAINS(`name` = "Jack") ```  ## Failed sql ``` select * from `test` where `dict` CONTAINS(`age` = "21") ``` Only the first map returned values, please figure out the reason.  Thanks, Matt </body>
		<created>2018-11-12 08:42:57</created>
		<closed>2018-11-12 11:29:23</closed>
	</bug>
	<bug>
		<id>8653</id>
		<title>[3.0]CONTAINS empty list or empty dict return unexpected result</title>
		<body>### OrientDB Version: 3.0.10 ### Java Version: 1.8.0_102 ### OS: &lt;os here&gt;  centos 6.8  ## Expected behavior   ``` select from v where test contains [] ``` return record which `test` value is `[[]]`  ## Actual behavior   looks like return all the records that have `test` field  ## Steps to reproduce   ``` create 4 records create vertex v content {"name": "jack", "age": 22} create vertex v content {"name": "rose", "age": 22, "test": [[]]} create vertex v content {"name": "pete", "age": 22, "test": [{}]} create vertex v content {"name": "david", "age": 22, "test": ["hello"]} ```  select record ``` select from v where test contains [] return three record ( rose, pete and david ), looks like return all the records that have `test` field  select from v where test contains {} return one record and looks work fine. ```  Thanks reading</body>
		<created>2018-11-12 07:49:47</created>
		<closed>2018-11-27 08:46:50</closed>
	</bug>
	<bug>
		<id>8647</id>
		<title>REMOVE element from LINKSET with subquery doesn't work</title>
		<body>### OrientDB Version: 3.1.0 from develop branch ### Java Version: docker openjdk:8-jdk-alpine ### OS: docker openjdk:8-jdk-alpine  ## Steps to reproduce   ```java CREATE CLASS Test; CREATE CLASS TestMap; CREATE PROPERTY Test.mymap LINKSET TestMap;  INSERT INTO TestMap (name) VALUES ('test'); INSERT INTO TestMap (name) VALUES ('test2');  //works INSERT INTO Test SET mymap = (SELECT FROM TestMap WHERE name = 'test') select mymap:{name} from Test // [{"name": "test"}]  //works UPDATE Test set mymap = (SELECT FROM TestMap WHERE name = 'test2') || mymap select mymap:{name} from Test // [{"name": "test"},{"name": "test2"}]  //doesn't work UPDATE Test remove mymap = (SELECT @rid FROM TestMap WHERE name = 'test2') select mymap:{name} from Test // [{"name": "test"},{"name": "test2"}]  //doesn't work UPDATE Test remove mymap = (SELECT FROM TestMap WHERE name = 'test2') select mymap:{name} from Test // [{"name": "test"},{"name": "test2"}]  //works by rid only UPDATE Test remove mymap = #xx:x select mymap:{name} from Test // [{"name": "test"}] ``` </body>
		<created>2018-11-06 10:31:44</created>
		<closed>2018-11-06 14:13:03</closed>
	</bug>
	<bug>
		<id>8646</id>
		<title>LINKMAP doesn't work with subquery</title>
		<body>### OrientDB Version: 3.1.0 from develop branch ### Java Version: docker openjdk:8-jdk-alpine ### OS: docker openjdk:8-jdk-alpine    ## Expected behavior   Should work like  ```java INSERT INTO Test (mymap) VALUES ({'A-1': #xx:x}); ``` ```LINKSET, LINKLIST, LINK, EMBEDDEDSET, EMBEDDEDLIST, EMBEDDED``` work fine with subquery syntax  ## Actual behavior   ```com.orientechnologies.orient.core.exception.OValidationException: The field 'Test.mymap' has been declared as LINKMAP but the value is not a record or a record-id DB name="nvd" Error Code="4"```    ## Steps to reproduce   ```java CREATE CLASS Test; CREATE CLASS TestMap; CREATE PROPERTY Test.mymap LINKMAP TestMap;  INSERT INTO TestMap (name) VALUES ('test'); INSERT INTO Test (mymap) VALUES ({'A-1': (SELECT FROM TestMap WHERE name = 'test')}); ```</body>
		<created>2018-11-05 16:03:43</created>
		<closed>2018-11-06 15:45:43</closed>
	</bug>
	<bug>
		<id>8634</id>
		<title>LINKSET within transaction: fails to remove newly created records.</title>
		<body>### OrientDB Version: 3.0.9  edit: 3.0.10 ### Java Version: 8-191   ### OS: MacOS  ## Expected behavior   When adding and subsequently removing a record to a LINKSET within a transaction, it should not be there after commit.  ## Actual behavior   When adding and subsequently removing a record to a LINKSET within a transaction, it is there again after commit.  ## Steps to reproduce See the following test written in groovy using the Java API:   ```ODatabaseSession db =  ...  /*    Structure:     WithLinks {        links: [Linked]    } */ OClass withLinks = db.createClass("WithLinks") withLinks.createProperty("links", OType.LINKSET) OClass linked = db.createClass("Linked")  /* A link must already be there */ OElement withLinks1 = db.newInstance("WithLinks") OElement link1 = db.newInstance("Linked") link1.save() withLinks1.setProperty("links", [link1].toSet()) withLinks1.save()  /* Only in transaction - without transaction all OK */ db.begin()     OElement withLinks1InTrans = db.load(withLinks1.identity)      /* Add a new linked record */     OElement link2 = db.newInstance("Linked")     link2.save()     withLinks1InTrans.getProperty("links").add(link2)     withLinks1InTrans.save()      /* Remove all from ORecordLazySet - if only link2 removed all OK */     withLinks1InTrans.getProperty("links").remove(link1)     withLinks1InTrans.getProperty("links").remove(link2)     withLinks1InTrans.save()      /* All seems OK before commit */     assert withLinks1InTrans.getProperty("links").size() == 0     assert withLinks1.getProperty("links").size() == 0 db.commit()  /* No difference if reload or not */ withLinks1 = withLinks1.reload()  /* Initial record was removed */ assert !withLinks1.getProperty("links").contains(link1) /* Fails: why is link2 still in the set? */ assert !withLinks1.getProperty("links").contains(link2) ```   While the flow of adding and removing within one transaction is not something you'd intentionally do, it is impossible to prevent when using an object mapping layer and complex operations on persisted objects. Can lead to serious and in the worst case long unnoticed bugs.</body>
		<created>2018-10-28 10:18:11</created>
		<closed>2018-11-29 15:27:13</closed>
	</bug>
	<bug>
		<id>8627</id>
		<title>Batch sql scripts still do not work with console</title>
		<body>### OrientDB Version: 3.0.8   ### Java Version: &lt;version here&gt;   ### OS: Windows 10    ## Expected behavior (using version 2.2.27)  orientdb {db=demodb}\&gt; load script "C:/mh/tmp/demodbSqlScriptTest.txt"  Loading script C:/mh/tmp/demodbSqlScriptTest.txt...[Started multi-line command. Type just 'end' to finish and execute]  orientdb {db=demodb}\&gt; script sql begin; let v1 = create vertex V set Name = "Source", Id = 1; let v2 = create vertex V set Name = "Destination", Id = 2; create edge E from $v1 to $v2; commit;  +----+-----+------+----+-----+ |#   |@RID |@CLASS|out |in   | +----+-----+------+----+-----+ |0   |#13:0|E     |#9:0|#10:0| +----+-----+------+----+-----+ Server side script executed in 0,203000 sec(s). Returned 1 records orientdb {db=demodb}\&gt;    ## Actual behavior with 3.0.8 &lt;orientdb {db=demodb}\&gt; load script C:\mh\tmp\demodbSqlScriptTest.txt  Loading script C:\mh\tmp\demodbSqlScriptTest.txt...[Started multi-line command. Type just 'end' to finish and execute]  Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query:  ^ Encountered " &lt;BEGIN&gt; "begin "" at line 1, column 1. Was expecting one of:     \&lt;WHILE\&gt; ...     \&lt;IF\&gt; ...     \&lt;FOREACH\&gt; ...     ";" ...  DB name="demodb" Error Code="1"  Loaded script C:\mh\tmp\demodbSqlScriptTest.txt orientdb {db=demodb}\&gt;    ## Steps to reproduce   Content of sql script file: `script sql;` `begin;` `let v1 = create vertex V set Name = "Source", Id = 1;` `let v2 = create vertex V set Name = "Destination", Id = 2;` `create edge E from $v1 to $v2;` `commit;` `end;`  </body>
		<created>2018-10-26 20:41:58</created>
		<closed>2018-11-16 09:51:21</closed>
	</bug>
	<bug>
		<id>8625</id>
		<title>Group by not working when columns not returned directly in select</title>
		<body>### OrientDB Version: 3.0.9 ### Java Version: openjdk version "1.8.0_171" ### OS: alpine 3.8.1 (I'm using the official Docker image)  Given table such as:  | @rid | @version | @class | last_name | first_name |  | -- | -- | -- | -- | -- |  41:0 | 1 | Test | Francescone | Onida 41:1 | 1 | Test | Springham | Lauree 41:2 | 1 | Test | Whal | Cory 42:0 | 1 | Test | Ryan | Onida 42:1 | 1 | Test | Ranking | Abran 42:2 | 1 | Test | Schoales | Cory 43:0 | 1 | Test | Ryan | Maximilien 43:1 | 1 | Test | Stannas | Abran 43:2 | 1 | Test | Schoales | Augusta 44:0 | 1 | Test | Henzley | Dot 44:1 | 1 | Test | Stannas | Gypsy 44:2 | 1 | Test | Garrard | Walliw  Then running a query with `GROUP BY` such as:  ``` SELECT first_name + ' ' + last_name, COUNT(@rid) FROM Test GROUP BY last_name, first_name ```  ## Expected behavior    Should group specified columns like in SQL:  | first_name + ' ' + last_name | COUNT(@rid) -- | -- Onida Francescone | 1 Lauree Springham | 1 Cory Whal | 1 Onida Ryan | 1 Abran Ranking | 1 Cory Schoales | 1 Maximilien Ryan | 1 Abran Stannas | 1 Augusta Schoales | 1 Dot Henzley | 1 Gypsy Stannas | 1 Walliw Garrard | 1  ## Actual behavior    Actually groups people with same last_name to same bucket  | first_name + ' ' + last_name | COUNT(@rid) -- | -- Onida Francescone | 1 Lauree Springham | 1 Cory Whal | 1 Maximilien Ryan | 2 Abran Ranking | 1 Augusta Schoales | 2 Gypsy Stannas | 2 Dot Henzley | 1 Walliw Garrard | 1    ## Steps to reproduce    Prepare table with data:  ``` CREATE CLASS TEST EXTENDS V; INSERT INTO Test (first_name, last_name) VALUES ('Onida', 'Francescone'), ('Onida', 'Ryan'), ('Maximilien', 'Ryan'), ('Dot', 'Henzley'), ('Lauree', 'Springham'), ('Abran', 'Ranking'), ('Abran', 'Stannas'), ('Gypsy', 'Stannas'), ('Cory', 'Whal'), ('Cory', 'Schoales'), ('Augusta', 'Schoales'), ('Walliw', 'Garrard'); ```  Query:  ``` SELECT first_name + ' ' + last_name, COUNT(@rid) FROM Test GROUP BY first_name, last_name ```  *Workaround:*  The query seems to give expected results when using `GROUP BY first_name + ' ' + last_name` syntax:  ``` SELECT first_name + ' ' + last_name, COUNT(@rid) FROM Test GROUP BY first_name + ' ' + last_name ```  Also when selecting first_name and last_name fields directly in SELECT the query returns results as expected. ``` SELECT first_name, last_name, COUNT(@rid) FROM Test GROUP BY first_name, last_name ```</body>
		<created>2018-10-26 11:28:12</created>
		<closed>2018-11-07 09:34:24</closed>
	</bug>
	<bug>
		<id>8624</id>
		<title>traversedVertex(0) function throws java.lang.IndexOutOfBoundsException</title>
		<body>### OrientDB Version: 3.0.9 ### Java Version: 11.0.1+13 ### OS: Windows 10  ## Expected behavior   No exception  ## Actual behavior   `java.lang.IndexOutOfBoundsException: Index 1 out of bounds for length 1`  Exception thrown here:  https://github.com/orientechnologies/orientdb/blob/6296c890a07960ee7002ceb417e1cdf8c6c2f1f9/core/src/main/java/com/orientechnologies/orient/core/sql/functions/coll/OSQLFunctionTraversedElement.java#L131-L132  Seems like `x` should be initialized to `listStack.size() - 1`.</body>
		<created>2018-10-24 13:41:29</created>
		<closed>2018-10-24 14:56:23</closed>
	</bug>
	<bug>
		<id>8621</id>
		<title>count(&lt;field&gt;) function broken for empty SELECTs</title>
		<body>### OrientDB Version: 3.0.9  This is similar to #8280, which seems to only partially have been solved. When using `count(*)` and there are no matching items a proper result set is returned with a count of 0. However if you use `count(&lt;field&gt;)` and there are no matching elements an empty result set is returned.  ```SQL CREATE CLASS Person; CREATE PROPERTY Person.name STRING;  SELECT count(*) as count from Person; -- returns: [{@version: 0, count: 0}]  SELECT count(name) as count from Person; -- returns: []  INSERT INTO Person SET name="bob";  SELECT count(*) as count from Person; -- returns: [{@version: 0, count: 1}]  SELECT count(name) as count from Person; -- returns: [{@version: 0, count: 1}]  SELECT count(*) as count from Person WHERE name = "susan"; -- returns: `[{@version: 0, count: 0}]`  SELECT count(name) as count from Person WHERE name = "susan"; -- returns: [] ```  So it seems like `count(*)` works properly. `count(&lt;field&gt;)` works when results match, but not when there are not records that match the SELECT.  </body>
		<created>2018-10-24 04:01:58</created>
		<closed>2018-10-26 14:27:42</closed>
	</bug>
	<bug>
		<id>8619</id>
		<title>IN keyword issue in Orient 3.0.8</title>
		<body>### OrientDB Version: 3.0.8   ### Java Version:   1.8.0_171 ### OS: Ubuntu 14.04.5 LTS    ## Expected behavior   Query should return same result as returning in OrientDB 2.2.35 but it is returning empty resultset  ## Actual behavior   **select from Company where outE('is_a')[type="Tenant"].inV()['@rid'] in [#28:9,#28:8,#28:7] limit 5**  This query is working fine with OrientDB 2.2.35 but the same query is not returning same result with OrientDB 3.0.8  ## Steps to reproduce   ``` CREATE CLASS Company EXTENDS V CREATE PROPERTY Company.name string Insert into Company(name) values("webix pvt. ltd."),("diversity pvt. ltd.")  CREATE CLASS Tenant EXTENDS V CREATE PROPERTY Tenant.name string Insert into Tenant(name) values("DotNet"),("pdev")  CREATE CLASS is_a EXTENDS E CREATE EDGE is_a FROM #18:0 TO #22:0 CREATE EDGE is_a FROM #18:0 TO #23:0 CREATE EDGE is_a FROM #19:0 TO #22:0 CREATE EDGE is_a FROM #19:0 TO #23:0  select from Company where outE('is_a')[type="Tenant"].inV()["@rid"] in [#22:0,#23:0]  ```  </body>
		<created>2018-10-22 16:35:12</created>
		<closed>2018-10-23 10:15:45</closed>
	</bug>
	<bug>
		<id>8611</id>
		<title>Import database with -merge=true but classes still removed</title>
		<body>### OrientDB Version: 3.0.4, 3.0.8, 3.0.9   ### Java Version: &lt;version here&gt;   ### OS: macOS    ## Expected behavior   import database with -merge=true should not delete existing classes   ## Actual behavior   ![](https://www.dropbox.com/s/d4px6b9x8q3uffp/Screenshot%202018-10-18%2021.49.57.png?raw=1)  ## Steps to reproduce    1. Create a "test" database 2. Create a "MyV" vertex 3. Create a dummy function 4. Export only functions as per https://orientdb.com/docs/2.1.x/Console-Command-Export.html 5. Import functions.gz  </body>
		<created>2018-10-18 13:51:30</created>
		<closed>2018-10-22 09:53:33</closed>
	</bug>
	<bug>
		<id>8605</id>
		<title>LET usage issue with LUCENE index</title>
		<body>Almost a duplicate for #8572 ( the only difference is replacing the Hash index with a Lucene index in test )  OrientDB Version: 3.0.9 Java Version: java version "1.8.0_171" OS: Windows 10 Home  I ve created the following simple database test:  ``` create class A extends V; create property A.name  string; create index A.nameLucene ON A (name) FULLTEXT ENGINE LUCENE;  create class B extends V; create class X extends E;    let $a = create vertex A set name="Mike"; let $b = create vertex B; create edge X from $a to $b; ``` The following query returns the expected non-empty result: `select $t,$t.size(),* from A let $t=(select * from (select expand($parent.$parent.$current.out()))) where [name] LUCENE '(name:(+("Mike")))'` Add " and $t.size()&gt;0" at the end and the query will return empty although $t.size() is 1 in our case:  `select $t,$t.size(),* from A let $t=(select * from (select expand($parent.$parent.$current.out()))) where [name] LUCENE '(name:(+("Mike")))' AND $t.size()&gt;0`  If i drop the index A.nameLucene the above query returns the expected non-empty result.  Thanks, Mihai</body>
		<created>2018-10-16 20:59:38</created>
		<closed>2018-10-17 10:10:27</closed>
	</bug>
	<bug>
		<id>8604</id>
		<title>CONTAINS(EMBEDDED LIST) problem</title>
		<body>### OrientDB Version: 3.0.8 ### Java Version: 1.8 ### OS: Centos 6.8  ## Create class test  with property dict | Name |     Type     | Linked_Type | |:----:|:------------:|-------------| | dict | EMBEDDEDLIST | EMBEDDEDMAP |  ## Create a record of test ``` insert into test (dict) values ("name":"Jack") ```  ## Failed sql ``` select * from `test` where `dict` CONTAINS(`name` = "Jack") ``` returned nothing, but in 2.x, It showed results.  Thanks, Matt </body>
		<created>2018-10-16 03:00:55</created>
		<closed>2018-10-17 13:41:12</closed>
	</bug>
	<bug>
		<id>8594</id>
		<title>Live query crashes after new edge created</title>
		<body>### OrientDB Version: 3.0.2, 3.0.6, 3.0.8   ### Java Version: 1.8.0_171   ### OS: Debian stretch x68_64, kernel 4.9  ## Expected behavior    When i subscribe on any Entity (subclass of vertex), live query works normally even the edge between entity1 and entity2 created.  ## Actual behavior   All live queries opened in current ODatabaseSession crashes after new  edge created  `Exception in thread "Thread-3" com.orientechnologies.common.io.OIOException: Impossible to read a chunk of length:55703937 max allowed chunk length:16777216 see NETWORK_BINARY_MAX_CONTENT_LENGTH settings  at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readBytes(OChannelBinary.java:165) at com.orientechnologies.orient.core.serialization.serializer.result.binary.OResultSerializerNetwork.fromStream(OResultSerializerNetwork.java:655) at com.orientechnologies.orient.client.remote.message.OMessageHelper.readProjection(OMessageHelper.java:503) at com.orientechnologies.orient.client.remote.message.OMessageHelper.readResult(OMessageHelper.java:471) at com.orientechnologies.orient.client.remote.message.OLiveQueryPushRequest.read(OLiveQueryPushRequest.java:83) at com.orientechnologies.orient.client.remote.OStorageRemotePushThread.run(OStorageRemotePushThread.java:58)`  ## Steps to reproduce   1. Create vertex Entity class, liveSession, subscribe on Entity changes and any number of other changes. 2. open new session, create entity1, close session  // ok, event fired 3. open new session, create entity2, and edge(entity1, entity2), close session // -&gt; after that all listeners  4. open new session, create entity3.  Now all listeners from step 1 are not working.   Code to reproduce here: https://github.com/pcholder/orientLiveQueryBug  May be i use orient in not properly manner, please help me.     </body>
		<created>2018-10-11 12:57:47</created>
		<closed>2018-10-11 15:11:09</closed>
	</bug>
	<bug>
		<id>8592</id>
		<title>java.lang.UnsupportedOperationException: Implement OTraverseStatement.refersToParent()</title>
		<body>### OrientDB Version: 3.0.8 ### Java Version: 11 ### OS: Mac  ## Expected behavior   `select from V let $type = (traverse * from $parent.$current.children)` should work without any error  ## Actual behavior   ``` orientdb {db=test}&gt; select from V let $type = (traverse * from $parent.$current.children) Error: com.orientechnologies.orient.enterprise.channel.binary.OResponseProcessingException: Exception during response processing Error: java.lang.UnsupportedOperationException: Implement OTraverseStatement.refersToParent()  ``` ## Steps to reproduce   Connect to console or Connect to Studio and try to execute this query `select from V let $type = (traverse * from $parent.$current.children)` </body>
		<created>2018-10-10 01:11:28</created>
		<closed>2018-10-10 13:11:57</closed>
	</bug>
	<bug>
		<id>8591</id>
		<title>OValidationException in OElement.save() for "read only field"</title>
		<body>### OrientDB Version: 3.0.8   ### Java Version: Java8   ### OS: Linux  ## Expected behavior   We should be able to save elements with read only fields in a remote database.  ## Actual behavior   An OValidationException is thrown.    ## Steps to reproduce   First create a remote database (the error does not occur if running an in memory database). Then execute the code below against the remote database, modifying the URL and credentials as needed.  ```Java import java.util.HashMap;  import com.orientechnologies.orient.core.db.ODatabaseSession; import com.orientechnologies.orient.core.db.OrientDB; import com.orientechnologies.orient.core.db.OrientDBConfig; import com.orientechnologies.orient.core.metadata.schema.OClass; import com.orientechnologies.orient.core.metadata.schema.OProperty; import com.orientechnologies.orient.core.metadata.schema.OSchema; import com.orientechnologies.orient.core.metadata.schema.OType; import com.orientechnologies.orient.core.record.OElement; import com.orientechnologies.orient.core.sql.executor.OResultSet;  public class SaveTest {    public static void main(String[] args) {     OrientDB odb = new OrientDB("remote:localhost", OrientDBConfig.defaultConfig());     ODatabaseSession db = odb.open("test", "admin", "admin");      OSchema schema = db.getMetadata().getSchema();      OClass childClass = schema.createClass("Child");     OProperty valProp = childClass.createProperty("val", OType.ANY);     valProp.setReadonly(true);     valProp.setMandatory(true);     valProp.setNotNull(true);      OClass parentClass = schema.createClass("Parent");     OProperty idProp = parentClass.createProperty("id", OType.STRING);     idProp.setReadonly(true);     idProp.setMandatory(true);     idProp.setNotNull(true);      OProperty childProp = parentClass.createProperty("child", OType.LINK);     childProp.setReadonly(true);     childProp.setMandatory(true);     childProp.setNotNull(true);      db.getMetadata().reload();      OElement child = db.newElement("Child");     child.setProperty("val", 4);      OElement parent = db.newElement("Parent");     parent.setProperty("id", "myId");     parent.setProperty("child", child, OType.LINK);      parent.save();      OResultSet resultSet = db.query("SELECT FROM Parent", new HashMap&lt;&gt;());     OElement queried = resultSet.next().toElement();     System.out.println(queried.toJSON());      db.close();     odb.close();   } } ```  This will produce the following exception:  ``` Exception in thread "main" com.orientechnologies.orient.core.exception.OValidationException: The field 'Child.val' is immutable and cannot be altered. Field value is: 4 DB name="test" Error Code="4" DB name="test" Error Code="4" at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:423) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:318) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:275) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:191) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:153) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1931) at com.orientechnologies.orient.client.remote.OStorageRemote.lambda$asyncNetworkOperationRetry$1(OStorageRemote.java:290) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:404) at com.orientechnologies.orient.client.remote.OStorageRemote.asyncNetworkOperationRetry(OStorageRemote.java:273) at com.orientechnologies.orient.client.remote.OStorageRemote.asyncNetworkOperationNoRetry(OStorageRemote.java:261) at com.orientechnologies.orient.client.remote.OStorageRemote.createRecord(OStorageRemote.java:716) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.executeSaveRecord(ODatabaseDocumentRemote.java:586) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:248) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2076) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2041) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2109) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2100) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63) at ODBTest$.delayedEndpoint$ODBTest$1(ODBTest.scala:46) at ODBTest$delayedInit$body.apply(ODBTest.scala:12) at scala.Function0.apply$mcV$sp(Function0.scala:34) at scala.Function0.apply$mcV$sp$(Function0.scala:34) at scala.runtime.AbstractFunction0.apply$mcV$sp(AbstractFunction0.scala:12) at scala.App.$anonfun$main$1$adapted(App.scala:76) at scala.collection.immutable.List.foreach(List.scala:389) at scala.App.main(App.scala:76) at scala.App.main$(App.scala:74) at ODBTest$.main(ODBTest.scala:12) at ODBTest.main(ODBTest.scala) Suppressed: com.orientechnologies.orient.core.exception.OValidationException: The field 'Child.val' is immutable and cannot be altered. Field value is: 4 DB name="test" Error Code="4" at com.orientechnologies.orient.core.record.impl.ODocument.validateField(ODocument.java:699) at com.orientechnologies.orient.core.record.impl.ODocument.validate(ODocument.java:2365) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2056) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2041) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:1933) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeCreateRecord(OConnectionBinaryExecutor.java:374) at com.orientechnologies.orient.client.remote.message.OCreateRecordRequest.execute(OCreateRecordRequest.java:118) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:304) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:206) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69) ```  </body>
		<created>2018-10-09 15:56:37</created>
		<closed>2018-10-15 12:23:05</closed>
	</bug>
	<bug>
		<id>8588</id>
		<title>NPE reading objects from DB after a crash</title>
		<body>### OrientDB Version: 3.0.8  ### Java Version: 1.8.0_101   ### OS: &lt;os here&gt;    ## Expected behavior   After crash recovery database should not contain corrupted records.  ## Actual behavior   NPE  ## Steps to reproduce   After database is running for several minutes. I crashed it to test recover.  After a couple of minutes of reading/writing reads, received NPE.  Below is stack.  I'll also attach .zip file if github allows it.  13:06:02.551 [doWork: nbbedmbaker4.empty] ERROR com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - Exception `7299F6C2` in storage `plocal:c:\progress\oemgmt120\work\cachedb/cachedb`: 3.0.8 - Veloce (build ace6fe7e50f069968d2ec61678848606703db1c0, branch 3.0.x) java.lang.NullPointerException: null at com.orientechnologies.orient.core.serialization.serializer.binary.impl.index.OCompositeKeySerializer.deserializeFromByteBufferObject(OCompositeKeySerializer.java:355) at com.orientechnologies.orient.core.serialization.serializer.binary.impl.index.OCompositeKeySerializer.deserializeFromByteBufferObject(OCompositeKeySerializer.java:42) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.deserializeFromDirectMemory(ODurablePage.java:182) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTreeBucket.getKey(OSBTreeBucket.java:377) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTreeBucket.find(OSBTreeBucket.java:137) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTree.findBucket(OSBTree.java:1728) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTree.iterateEntriesBetweenAscOrder(OSBTree.java:1453) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTree.iterateEntriesBetween(OSBTree.java:964) at com.orientechnologies.orient.core.storage.index.engine.OSBTreeIndexEngine.iterateEntriesBetween(OSBTreeIndexEngine.java:188) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doIterateIndexEntriesBetween(OAbstractPaginatedStorage.java:2989) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.iterateIndexEntriesBetween(OAbstractPaginatedStorage.java:2968) at com.orientechnologies.orient.core.index.OIndexMultiValues.iterateEntriesBetween(OIndexMultiValues.java:249) at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.iterateEntriesBetween(OIndexAbstractDelegate.java:110) at com.orientechnologies.orient.core.index.OIndexTxAwareMultiValue.iterateEntriesBetween(OIndexTxAwareMultiValue.java:344) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.init(FetchFromIndexStep.java:361) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.processAndBlock(FetchFromIndexStep.java:302) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.init(FetchFromIndexStep.java:225) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.init(FetchFromIndexStep.java:206) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.syncPull(FetchFromIndexStep.java:71) at com.orientechnologies.orient.core.sql.executor.GetValueFromIndexEntryStep$1.fetchNextItem(GetValueFromIndexEntryStep.java:92) at com.orientechnologies.orient.core.sql.executor.GetValueFromIndexEntryStep$1.hasNext(GetValueFromIndexEntryStep.java:58) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.fetchNextItem(FilterByClassStep.java:50) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.hasNext(FilterByClassStep.java:88) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:36) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:29) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:271) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:62) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:540) at com.orientechnologies.orient.object.db.OObjectDatabaseTx.command(OObjectDatabaseTx.java:1151) at com.progress.isq.ipqos.activity.ActivityDataAccess.getList(ActivityDataAccess.java:277) at com.progress.isq.ipqos.activity.ActivityService.getList(ActivityService.java:250) at com.progress.isq.ipqos.activity.ActivityService.deleteResourceActivityGroupAndActivities(ActivityService.java:499) at com.progress.isq.ipqos.activity.ServiceAdapter.deleteResourceActivityGroupAndActivities(ServiceAdapter.java:186) at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.delete(DatabaseActivityProcessor.java:1142) at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.processAndCollectData(DatabaseActivityProcessor.java:1026) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processData(MultiActivityServiceAdapter.java:339) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processResponse(MultiActivityServiceAdapter.java:295) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:248) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:224) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.fetchAndStoreActivities(MultiActivityServiceAdapter.java:137) at com.progress.isq.ipqos.resources.plugins.openedge.work.WorkRunnable.performPolling(WorkRunnable.java:75) at com.progress.isq.ipqos.resources.plugins.openedge.work.DatabaseInstWork.doWork(DatabaseInstWork.java:81) at com.progress.isq.ipqos.resources.plugins.database.DatabaseInstResource.doWork(DatabaseInstResource.java:519) at com.progress.isq.ipqos.ScheduledWorkShell.run(ScheduledWorkShell.java:130) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745) 13:06:02.552 [doWork: nbbedmbaker4.empty] ERROR Fathom - Unexpected exception occurred during resource polling for localhost:resource.database.local.empty com.progress.isq.ipqos.WorkErrorException: null at com.progress.isq.ipqos.resources.plugins.openedge.work.WorkRunnable.performPolling(WorkRunnable.java:79) at com.progress.isq.ipqos.resources.plugins.openedge.work.DatabaseInstWork.doWork(DatabaseInstWork.java:81) at com.progress.isq.ipqos.resources.plugins.database.DatabaseInstResource.doWork(DatabaseInstResource.java:519) at com.progress.isq.ipqos.ScheduledWorkShell.run(ScheduledWorkShell.java:130) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.NullPointerException: null at com.orientechnologies.orient.core.serialization.serializer.binary.impl.index.OCompositeKeySerializer.deserializeFromByteBufferObject(OCompositeKeySerializer.java:355) at com.orientechnologies.orient.core.serialization.serializer.binary.impl.index.OCompositeKeySerializer.deserializeFromByteBufferObject(OCompositeKeySerializer.java:42) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.deserializeFromDirectMemory(ODurablePage.java:182) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTreeBucket.getKey(OSBTreeBucket.java:377) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTreeBucket.find(OSBTreeBucket.java:137) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTree.findBucket(OSBTree.java:1728) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTree.iterateEntriesBetweenAscOrder(OSBTree.java:1453) at com.orientechnologies.orient.core.storage.index.sbtree.local.OSBTree.iterateEntriesBetween(OSBTree.java:964) at com.orientechnologies.orient.core.storage.index.engine.OSBTreeIndexEngine.iterateEntriesBetween(OSBTreeIndexEngine.java:188) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doIterateIndexEntriesBetween(OAbstractPaginatedStorage.java:2989) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.iterateIndexEntriesBetween(OAbstractPaginatedStorage.java:2968) at com.orientechnologies.orient.core.index.OIndexMultiValues.iterateEntriesBetween(OIndexMultiValues.java:249) at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.iterateEntriesBetween(OIndexAbstractDelegate.java:110) at com.orientechnologies.orient.core.index.OIndexTxAwareMultiValue.iterateEntriesBetween(OIndexTxAwareMultiValue.java:344) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.init(FetchFromIndexStep.java:361) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.processAndBlock(FetchFromIndexStep.java:302) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.init(FetchFromIndexStep.java:225) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.init(FetchFromIndexStep.java:206) at com.orientechnologies.orient.core.sql.executor.FetchFromIndexStep.syncPull(FetchFromIndexStep.java:71) at com.orientechnologies.orient.core.sql.executor.GetValueFromIndexEntryStep$1.fetchNextItem(GetValueFromIndexEntryStep.java:92) at com.orientechnologies.orient.core.sql.executor.GetValueFromIndexEntryStep$1.hasNext(GetValueFromIndexEntryStep.java:58) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.fetchNextItem(FilterByClassStep.java:50) at com.orientechnologies.orient.core.sql.executor.FilterByClassStep$1.hasNext(FilterByClassStep.java:88) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:36) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:29) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:271) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:62) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:540) at com.orientechnologies.orient.object.db.OObjectDatabaseTx.command(OObjectDatabaseTx.java:1151) at com.progress.isq.ipqos.activity.ActivityDataAccess.getList(ActivityDataAccess.java:277) at com.progress.isq.ipqos.activity.ActivityService.getList(ActivityService.java:250) at com.progress.isq.ipqos.activity.ActivityService.deleteResourceActivityGroupAndActivities(ActivityService.java:499) at com.progress.isq.ipqos.activity.ServiceAdapter.deleteResourceActivityGroupAndActivities(ServiceAdapter.java:186) at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.delete(DatabaseActivityProcessor.java:1142) at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.processAndCollectData(DatabaseActivityProcessor.java:1026) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processData(MultiActivityServiceAdapter.java:339) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processResponse(MultiActivityServiceAdapter.java:295) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:248) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:224) at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.fetchAndStoreActivities(MultiActivityServiceAdapter.java:137) at com.progress.isq.ipqos.resources.plugins.openedge.work.WorkRunnable.performPolling(WorkRunnable.java:75) ... 6 common frames omitted  </body>
		<created>2018-10-08 17:09:30</created>
		<closed>2018-10-30 16:38:23</closed>
	</bug>
	<bug>
		<id>8583</id>
		<title>UPDATE #9:1 SET foo.bar = (INSERT INTO...) Syntax Not Working</title>
		<body>### OrientDB Version: 3.0.8 ### Java Version: 1.8.0_141 ### OS: Windows 7    ## Expected behavior   `UPDATE ... SET foo.bar = (INSERT INTO...)` successfully updates the linkmap with the inserted record (it worked fine in OrientDB 2.2x)  ## Actual behavior   Fails, returns `java.lang.ClassCastException: java.util.ArrayList cannot be cast to com.orientechnologies.orient.core.db.record.OIdentifiable`  ## Steps to reproduce   `CREATE VERTEX V SET foo = {}` `UPDATE #9:1 SET foo.bar = (INSERT INTO V SET val = 1)`  What does work is if I do: `CREATE VERTEX V SET id = 1, foo = {}` `//#9:1`  `CREATE VERTEX V SET id = 2` `//#9:2` `UPDATE #9:1 SET foo.bar = #9:2` OK    </body>
		<created>2018-10-05 04:57:58</created>
		<closed>2018-10-05 13:33:07</closed>
	</bug>
	<bug>
		<id>8576</id>
		<title>Index Error Saving a Record after Upgrading from 2.x to 3.0.8</title>
		<body>### OrientDB Version: 3.0.8 ### Java Version: Java8 ### OS: RHEL  When calling OElement.save() we are seeing the below error. This was in a database that was originally created with 2.2.x. We recently upgraded to 3.0.8 and are now seeing this in several instances.  ``` Exception `7474E0BA` in storage `plocal:/orientdb/databases/6335366053283600827`: 3.0.8 - Veloce (build ace6fe7e50f069968d2ec61678848606703db1c0, branch 3.0.x) com.orientechnologies.orient.core.exception.OStorageException: Cannot put key value entry in index DB name="6335366053283600827" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateIndexEntry(OAbstractPaginatedStorage.java:2784) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateIndexEntry(OAbstractPaginatedStorage.java:2669) at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:173) at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:52) at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:861) at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:704) at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:676) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:2230) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:2150) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1984) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2750) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:363) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:166) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.endMicroTransaction(ODatabaseDocumentEmbedded.java:756) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.executeSaveRecord(ODatabaseDocumentEmbedded.java:746) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:244) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2076) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2041) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:1933) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeCreateRecord(OConnectionBinaryExecutor.java:374) at com.orientechnologies.orient.client.remote.message.OCreateRecordRequest.execute(OCreateRecordRequest.java:118) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:304) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:206) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Error during index update DB name="6335366053283600827" at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:1403) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:385) at com.orientechnologies.orient.core.storage.index.engine.OHashTableIndexEngine.put(OHashTableIndexEngine.java:176) at com.orientechnologies.orient.core.storage.index.engine.OHashTableIndexEngine.update(OHashTableIndexEngine.java:184) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateIndexEntry(OAbstractPaginatedStorage.java:2770) ... 25 more Caused by: java.lang.ClassCastException: com.orientechnologies.orient.core.storage.ridbag.sbtree.OMixedIndexRIDContainer cannot be cast to com.orientechnologies.orient.core.storage.ridbag.sbtree.OIndexRIDContainer at com.orientechnologies.orient.core.serialization.serializer.stream.OStreamSerializerSBTreeIndexRIDContainer.getObjectSize(OStreamSerializerSBTreeIndexRIDContainer.java:42) at com.orientechnologies.orient.core.storage.index.hashindex.local.OHashIndexBucket.addEntry(OHashIndexBucket.java:305) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1497) at com.orientechnologies.orient.core.storage.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:1395) ... 29 more  ``` </body>
		<created>2018-10-03 05:46:46</created>
		<closed>2018-10-30 16:39:38</closed>
	</bug>
	<bug>
		<id>8574</id>
		<title>NullPointerException when projecting on a class with an orphaned link</title>
		<body>### OrientDB Version: 3.0.8   ### Java Version: Java8 ### OS: Linux  ## Expected behavior   It is possible to create orphaned links in OrientDB by creating a link from one class to another, and then deleting the document the link points too. This should not break the entire class.  ## Actual behavior   An orphan link essentially creates SELECTING on the entire class, causing a NullPointerException.  ## Steps to reproduce   This took some doing to detect what was going on and boil it down to something easily reproducible. First run this script to create the classes and add some data.  ```SQL CREATE CLASS Target; CREATE PROPERTY Target.id String (MANDATORY TRUE, NOTNULL TRUE);  CREATE CLASS Source; CREATE PROPERTY Source.id String (MANDATORY TRUE, NOTNULL TRUE); CREATE PROPERTY Source.target LINK TARGET (MANDATORY TRUE, NOTNULL TRUE);  INSERT INTO TARGET SET id = "target1";  INSERT INTO SOURCE SET id = "source1", target = (SELECT FROM Target WHERE id = "target1"); ```  Selecting from the Source class works fine:  ```SQL SELECT FROM Source; ```  A projection also works:  ```SQL SELECT target.id FROM Source; ```  Now delete the linked document:  ```SQL DELETE FROM Target; ``` Selecting from the source table works. ```SQL SELECT FROM Source; ```  However, trying a projection that includes crossing the orphaned link results in a NullPointerException.  ```SQL SELECT target.id FROM Source; ```  The following stack trace appears in the console:  ``` Internal server error: java.lang.NullPointerException at com.orientechnologies.orient.core.sql.parser.OSuffixIdentifier.execute(OSuffixIdentifier.java:76) at com.orientechnologies.orient.core.sql.parser.OSuffixIdentifier.execute(OSuffixIdentifier.java:200) at com.orientechnologies.orient.core.sql.parser.OModifier.execute(OModifier.java:101) at com.orientechnologies.orient.core.sql.parser.OBaseExpression.execute(OBaseExpression.java:127) at com.orientechnologies.orient.core.sql.parser.OExpression.execute(OExpression.java:110) at com.orientechnologies.orient.core.sql.parser.OProjectionItem.execute(OProjectionItem.java:140) at com.orientechnologies.orient.core.sql.parser.OProjection.calculateSingle(OProjection.java:114) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep.calculateProjections(ProjectionCalculationStep.java:66) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep.access$000(ProjectionCalculationStep.java:13) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.next(ProjectionCalculationStep.java:41) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.doExecute(OScriptExecutionPlan.java:91) at com.orientechnologies.orient.core.sql.executor.OScriptExecutionPlan.fetchNext(OScriptExecutionPlan.java:49) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:35) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&amp;lt;init&amp;gt;(OLocalResultSet.java:29) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:55) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:587) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostBatch.execute(OServerCommandPostBatch.java:203) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:176) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:655) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:69) ```   </body>
		<created>2018-09-29 15:24:29</created>
		<closed>2018-10-01 07:26:54</closed>
	</bug>
	<bug>
		<id>8573</id>
		<title>IllegalArgumentException: fromKey &gt; toKey while iterateEntriesMinor</title>
		<body>### OrientDB Version: 2.2.37  ## Expected behavior   No exception  ## Actual behavior   ``` java.lang.IllegalArgumentException: fromKey &gt; toKey java.lang.IllegalArgumentException: fromKey &gt; toKey at java.util.TreeMap$NavigableSubMap.&lt;init&gt;(TreeMap.java:1368) at java.util.TreeMap$AscendingSubMap.&lt;init&gt;(TreeMap.java:1855) at java.util.TreeMap.subMap(TreeMap.java:913) at com.orientechnologies.orient.core.tx.OTransactionIndexChanges.firstAndLastKeys(OTransactionIndexChanges.java:92) at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue$PureTxBetweenIndexBackwardCursor.&lt;init&gt;(OIndexTxAwareOneValue.java:125) at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.iterateEntriesMinor(OIndexTxAwareOneValue.java:345) ```  ## Steps to reproduce   In a transaction add an item in an index. Call iterateEntriesMinor for the index with a kea lower than the added key.  Caused by the #7919 fix </body>
		<created>2018-09-29 00:22:37</created>
		<closed>2020-06-12 11:43:10</closed>
	</bug>
	<bug>
		<id>8572</id>
		<title>Filtering (WHERE) by context value from LET block not working when an index is also present in the WHERE clause.</title>
		<body>OrientDB Version: 3.0.8 Java Version: java version "1.8.0_171" OS: Windows 10 Home  I ve created the following simple database test: ```  create class A extends V; create property A.name  string; create index A.nameHash ON A (name) NOTUNIQUE_HASH_INDEX;     create class B extends V; create class X extends E;    let $a = create vertex A set name="Mike"; let $b = create vertex B; create edge X from $a to $b; ```  The following query returns the expected non-empty result: `select $t,$t.size(),* from A let $t=(select * from (select expand($parent.$parent.$current.out()))) where name="Mike" `  Add " and $t.size()&gt;0" at the end and the query will return empty although $t.size() is 1 in our case:  `select $t,$t.size(),* from A let $t=(select * from (select expand($parent.$parent.$current.out()))) where name="Mike" and $t.size()&gt;0`  If i drop the index A.nameHash the above query returns the expected non-empty result.  Thanks, Mihai</body>
		<created>2018-09-27 19:33:58</created>
		<closed>2018-10-01 10:32:46</closed>
	</bug>
	<bug>
		<id>8565</id>
		<title>error upgrading from 2.X to 3.X: java.lang.UnsupportedOperationException: Cannot convert</title>
		<body>### OrientDB Version: 3.0.7 ### Java Version: java version "1.8.0_171" Java(TM) SE Runtime Environment (build 1.8.0_171-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode) ### OS: Windows 10 Home  ## Expected behavior   Until (at least) version 2.2.23 Directly from Studio-&gt;Browse, execute the following query: ``` select from (    select list(son) as son, list(parent) as parent from (       SELECT EXPAND( $c )           LET $a = ( select null as son, @rid as parent from synset where lemmas lucene 'evento' and lang='it'),                $b = ( select @rid as son, null as parent from synset where lemmas lucene 'matrimonio' and lang='it' and verified is null ),                $c = UNIONALL( $a, $b )      ) ) unwind son, parent ``` Result: ``` parent | son -- | -- #20:4496 | #17:6119 #19:961 | #17:6119 #20:4496 | #19:6118 .... ``` ## Actual behavior   exactly same query, from Studio-&gt;Browse (db exported and imported, apparently without any issue): Error: java.lang.UnsupportedOperationException: Cannot convert {Synset_lemmas_totalHits=5, a=[{ son: null parent: #17:25795 } , { son: null parent: #20:39457 } ], current={ } , b=[{ son: #17:1520 parent: null } , { son: #20:14296 parent: null } , { son: #19:27075 parent: null } , { son: #17:841 parent: null } , { son: #20:39859 parent: null } ], totalHits=5} - class com.orientechnologies.orient.core.command.OBasicCommandContext to JSON  ## Steps to reproduce   See above.   I cannot find any upgrade instruction about changes in the sql that could be impacted in the above query. Please, help, I cannot upgrade in these conditions</body>
		<created>2018-09-26 18:54:49</created>
		<closed>2018-10-02 07:50:05</closed>
	</bug>
	<bug>
		<id>8563</id>
		<title>Update with positional parameters on embedded databases</title>
		<body>### OrientDB Version: 3.0.7 (embedded) ### Java Version: 1.8   ### OS: macOS 10.13    ## Expected behavior   &lt;add here&gt;    ## Actual behavior   If an update with positional parameters is executed on an **embedded in-memory** database the updated record can't be found after the update. The update count returned in the ResultSet of the update command is correct, but a distinct select statement afterwards returns an empty ResultSet.  It seems like the in-memory database takes some damage cause we had some strange effects in other unit tests running against the same in-memory database instance. Creating a new instance for each test isolated the problem.  This does not affect stand-alone instances (tested with 3.0.5) or updates with named parameters.  ## Steps to reproduce   Create an item in a embedded in-memory database, fire an update command with positional parameters and try to select the updated record again. ``` try (ODatabaseSession session = dbPool.acquire()) {     session.command("UPDATE MyVertex SET property = ? WHERE id = ?", "value", id).close();     try (OResultSet rs = session.query("SELECT FROM MyVertex WHERE id = ?", id)) {         if (rs.hasNext()) {             ...          }     } } ``` However, the record can still be found including the * projection but I guess it just hides the problem somehow as it affected other statements on the same database instance. ``` // select with projection still works try (OResultSet rs = session.query("SELECT * FROM MyVertex WHERE id = ?", id)) {     if (rs.hasNext()) {         ...     } } ```  Attached is a small unit test to reproduce at least the main effect. [orientdb-embedded-test.zip](https://github.com/orientechnologies/orientdb/files/2415551/orientdb-embedded-test.zip)  </body>
		<created>2018-09-25 14:19:25</created>
		<closed>2018-09-25 15:04:54</closed>
	</bug>
	<bug>
		<id>8560</id>
		<title>Facing SEVER Magic number verification failed for page `0` of `xxxxx.pcl`. [OWOWCache]</title>
		<body>### OrientDB Version: 3.0.7 ### Java Version: 1.8 ### OS: Centos ### RAM : 512 MB  ## Expected behavior   should work with out loosing vertexes, edges and the data.  ## Actual behavior   I was creating a new database model, creating vertexes, edges and inserting data. Suddenly OrientDB crashes and restarts. After restart I see the vertexes and the edges are lost.  The log show many verification failed  messages. SEVER Magic number verification failed for page `0` of `cvcontactprops.pcl`. [OWOWCache]  ## Steps to reproduce   it had happened couple of times.  I am sure there is something is wrong. My guess is the RAM of 512 is causing the crash but not sure. I appreciate you help in this. Attaching   the log file.   </body>
		<created>2018-09-23 23:53:17</created>
		<closed>2019-05-10 10:41:43</closed>
	</bug>
	<bug>
		<id>8555</id>
		<title>INSERT INTO Subquery Returns Empty Array</title>
		<body>### OrientDB Version: 3.0.7 ### Java Version: 1.8.0_141 ### OS: Windows 7    ## Expected behavior   `INSERT INTO` subquery returns the rid of the created record  ## Actual behavior   Appears to return `[]` instead.  ## Steps to reproduce   `CREATE VERTEX V SET foo = (INSERT INTO V SET bar = '1')` `SELECT foo FROM #9:0` </body>
		<created>2018-09-20 14:22:49</created>
		<closed>2018-09-21 10:38:54</closed>
	</bug>
	<bug>
		<id>8544</id>
		<title>[bug]backquote with count(*) problem </title>
		<body>### OrientDB Version: Latest Snapshot ### Java Version: 1.8 ### OS: Centos 6.8  ## FAILED SQL ``` SELECT name as `name` , count(*) FROM V WHERE name IN ['Jack', 'Rose'] GROUP BY name LIMIT -1 ``` ## SUCCESSFUL SQL   ``` SELECT name as `name`   FROM V WHERE name IN ['Jack', 'Rose'] GROUP BY name LIMIT -1 ``` ## Expected behavior     | PROPERTIES    | |---------------| | Jack | |Rose |  ## Actual behavior   &gt;Empty data  When I tried to use backquote with count(*), it doesn't return anything, but using `name` alone is okay, may you find the reason please?  Thanks, Matt</body>
		<created>2018-09-17 10:57:04</created>
		<closed>2018-09-17 13:53:56</closed>
	</bug>
	<bug>
		<id>8543</id>
		<title>insert ... return $current.link1:{field1} syntax returns null in develop branch</title>
		<body>### OrientDB Version: current develop branch  ### Java Version: docker openjdk:8-jdk-alpine ### OS: docker openjdk:8-jdk-alpine  ## Expected behavior   ``` {id: "xxx", name: "xxx"}   ```  ## Actual behavior  ```  {id: null, name: null}   ``` ```Update``` and ```Select``` works fine, but ```Insert```doesn't return values of fields of LINK type.  ## Steps to reproduce ```sql   insert into `Table` set code = #27:49  RETURN $current.code:{id,name} ```  </body>
		<created>2018-09-17 10:55:06</created>
		<closed>2018-11-27 15:37:30</closed>
	</bug>
	<bug>
		<id>8541</id>
		<title>Abnormal function in rename a property when use of Alter property command</title>
		<body>### OrientDB Version: 3.0.7   ### Java Version: 8 u181   ### OS: macOS 10.13.6    ## Expected behavior   I have tried to **rename** a property of a class with this command:  `alter property bcd.bcdId name bcd.did` I expected the **name** attribute has been changed because I didn't get any error with this command and it was ok. Also, I have tried the command below on another class property: `alter property bcc.bccId name cid`  ## Actual behavior   But, the property name attribute just had been changed to **NULL**  and also I couldn't drop the property after this... so, I had to drop the classes, it was ok but very painful.  ## Steps to reproduce    1- create class bcd extends V 2- create property bcd.bcdId long 3- alter property bcd.bcdId name bcd.did  and   1- create class bcc extends V 2- create property bcc.bccId long 3- alter property bcc.bccId name cid  Hey @saeedtabrizi, do you have any idea about this issue? </body>
		<created>2018-09-16 09:46:15</created>
		<closed>2018-09-17 08:03:10</closed>
	</bug>
	<bug>
		<id>8540</id>
		<title>SQL subquery does not work</title>
		<body>### OrientDB Version: 3.0.7 and 2.2.27   ### Java Version:   1.8.0_181 ### OS: Windows 10    Using the sample database GratefulDeadConcerts the query SELECT AVG(performances) FROM V results in AVG = 73  SELECT * FROM V WHERE performances &lt; 73 returns 375 records  However the first query as a subquery SELECT * FROM V WHERE performances &lt; (SELECT AVG(performances) FROM V) retrieves no records. </body>
		<created>2018-09-14 13:59:21</created>
		<closed>2018-10-11 12:04:23</closed>
	</bug>
	<bug>
		<id>8531</id>
		<title>JSON array serialisation with 'null' member </title>
		<body>### OrientDB Version: 3.0.5   ### Java Version: 1.8   ### OS: macOS 10.13  ## Expected behavior   Creating a correct JSON document.  ## Actual behavior   If a provided JSON document contains an array and the last member in an array element is _null_ the JSON document is not correctly processed. It looks like the `ORecord.fromJSON(String iJson)` which goes down to `ORecordSerializerJSON.fromString(String iSource, ORecord iRecord, final String[] iFields)` doesn't handle it correctly.   Example:  ``` {   "id": "f743507f-893f-417f-83a1-bb0db830c865",   "list": [     {       "prop1": "val1",       "prop2": null     },     {       "prop": "val"     }   ] } ```  ## Steps to reproduce   Create a new OElement and call the `fromJSON(String iJson)` method with a JSON document containing an array having a _null_ member in last position of an array item.  ``` private String odbAndBack(String id, String json) {     try (ODatabaseSession session = dbPool.acquire()) {         session.newElement("JsonTestGeneric").fromJSON(json).save();         OResultSet rs = session.query(String.format("SELECT * FROM `JsonTestGeneric` WHERE `id` = '%s'", id));         if (rs.hasNext()) {             return rs.next().toJSON();         }     } } ```  Input ``` {   "id": "f743507f-893f-417f-83a1-bb0db830c865",   "list": [     {       "prop1": "val1",       "prop2": null     },     {       "prop": "val"     }   ] } ```  Output ``` {   "@type": "d",   "@rid": "#49:0",   "@version": 1,   "@class": "JsonTestGeneric",   "id": "f743507f-893f-417f-83a1-bb0db830c865",   "list": [     {       "prop1": "val1",       "prop2": null     },     false   ] } ```  The behaviour is at least reproducible with `orientdb-client` version `3.0.5`, `3.0.6` and `3.0.7`.  A simple JUnit test case: [odb-json-test.zip](https://github.com/orientechnologies/orientdb/files/2378697/odb-json-test.zip)</body>
		<created>2018-09-13 09:55:07</created>
		<closed>2018-09-13 14:57:51</closed>
	</bug>
	<bug>
		<id>8528</id>
		<title>SQL subquery is not support in 3.0.x </title>
		<body>### OrientDB Version: 3.0.5 ### Java Version: 1.8 ### OS: Centos 6.8  ## SQL ``` select *  from v_test_1 where  id in ( select in('e_test').id from v_test_2 where name = 'jack' ) ```  ## Expected behavior   return v_test_1 which related v_test_2's name = 'jack'  ## Actual behavior   return 0 records BUT, the sql below work fine, and must use `$refs[0].refs_id`, and `$refs.refs_id` don't work ``` select *  from v_test_1 let $refs = ( select in('e_test').id as refs_id from v_test_2 where name = 'jack' )  where where  id in  $refs[0].`refs_id` ```  this sql syntax is very important for us, and if we change to `let`, it would be a very big change is a bug ? or is a deprecated feature ?  thanks reading</body>
		<created>2018-09-12 02:11:28</created>
		<closed>2018-09-12 10:31:57</closed>
	</bug>
	<bug>
		<id>8521</id>
		<title>Subqueries using LET not working as expected when LUCENE index involved</title>
		<body>### OrientDB Version: 3.0.7 ### Java Version: 1.8.0_181 ### OS: Ubuntu 16.04  When the WHERE part of a SELECT is using a LUCENE index the context variables from LET not working as expected.   I ve created the following simple database test:  ``` create class A extends V; create property A.name  string; create index A.nameLucene on A(name) fulltext engine LUCENE; create index A.nameHash ON A (name) NOTUNIQUE_HASH_INDEX;     create class B extends V; create class X extends E;   let $a = create vertex A set name="Mike"; let $b = create vertex B; create edge X from $a to $b; ```  When using a LUCENE index the $t is always empty ( [] ) : `select $t,* from A let $t=(select * from (select expand($parent.$parent.$current.out()))) where SEARCH_CLASS("Mike") = true;`  Similar query but replacing LUCENE with a  different index type returns the expected non empty value for $t : `select $t,* from A let $t=(select * from (select expand($parent.$parent.$current.out()))) where name="Mike";`  Thanks, Mihai     </body>
		<created>2018-09-08 12:24:08</created>
		<closed>2018-09-10 14:26:12</closed>
	</bug>
	<bug>
		<id>8516</id>
		<title>Rest batch query with script not working in 3.0.6</title>
		<body>### OrientDB Version: 3.0.6 ### Java Version: 1.8.0 ### OS: Ubuntu 18.04  ## Expected behavior   I'm trying the same query as given in the documentation [here](https://orientdb.com/docs/3.0.x/misc/OrientDB-REST.html#sql-batch)  ``` { "transaction" : true,   "operations" : [     {       "type" : "script",       "language" : "sql",       "script" : [ "LET account = CREATE VERTEX Account SET name = 'Luke'",                    "LET city = SELECT FROM City WHERE name = 'London'",                    "CREATE EDGE Lives FROM $account TO $city RETRY 100" ]     }   ] } ``` ## Actual behavior    ``` "errors": null,     "message": "{'message': 'Error parsing query:\\n\\n  ^\\nEncountered \" &lt;LET&gt; \"LET \"\" at line 1, column 1.\\nWas expecting one of:\\n    &lt;WHILE&gt; ...\\n    &lt;IF&gt; ...\\n    &lt;FOREACH&gt; ...\\n    \";\" ...\\n    &lt;IF&gt; ...\\n    \\r\\n\\tDB name=\"my db\"\\r\\n\\tError Code=\"1\"'}" ```  ## Steps to reproduce   Just run the above query as in the documentation. </body>
		<created>2018-09-05 13:11:10</created>
		<closed>2018-09-06 12:42:11</closed>
	</bug>
	<bug>
		<id>8505</id>
		<title>Alias doesn't work when used in outE / inE</title>
		<body>### OrientDB Version: 3.0.6 ### OS: Linux &amp; Windows  ## Expected behavior   select outE('AliasName') should return a value  ## Actual behavior   select outE('AliasName') doesn't return a value select outE('ClassName') returns a value  It works in V2. We are migrating to V3 and we noticed this issue. </body>
		<created>2018-09-02 16:18:57</created>
		<closed>2018-09-03 08:29:12</closed>
	</bug>
	<bug>
		<id>8474</id>
		<title>traversedVertex triggers ClassCastException ArrayDeque -&gt; List</title>
		<body>### OrientDB Version: 3.0.6 ### Java Version: 1.8 ### OS: Ubuntu 16.04 LTS   ## Expected behavior   SQL command, that contains traversedVertex(), executes without problems.  ## Actual behavior   ``` com.orientechnologies.orient.core.exception.OCommandExecutionException: ... Caused by: java.lang.ClassCastException: java.util.ArrayDeque cannot be cast to java.util.List ```  ## Steps to reproduce   We had a SQL command that workes fine on OrientDB v2.2.32, but gives an Exception in OrientDB v3: ``` select $depth as degrees, traversedVertex(-1,14) as vertexes from (traverse both('IS') from #1849:0 maxdepth 14) ```  The command above works fine in the **Studio**, but fails when executing the command like this in code: `tenant.getTenantGraph().command(new OCommandSQL(queryString)).execute()`    ## Exception ``` 2018-08-20 11:35:59.302 ERROR   --- [           main] c.o.o.c.s.i.memory.ODirectMemoryStorage  : Exception `46612BFC` in storage `memory:test`: 3.0.6 - Veloce (build b63614ab180ff02b75d65054b2a77116c16c0a3c, branch 3.0.x)  com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select $depth as degrees, traversedVertex(-1,14) as vertexes from (traverse both('IS') from #1849:0 maxdepth 14) DB name="test"  at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3807) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3723) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:68) at com.tinkerpop.blueprints.impls.orient.OrientGraphCommand.execute(OrientGraphCommand.java:49) at com.activitystream.core.model.factories.ActivityStreamManager.getNetworkForQuery(ActivityStreamManager.java:344) at com.activitystream.core.model.factories.ActivityStreamManagerTest.runQuery(ActivityStreamManagerTest.java:203) at com.activitystream.core.model.factories.ActivityStreamManagerTest.runQueryReturningASingleResult(ActivityStreamManagerTest.java:186) at com.activitystream.core.model.factories.ActivityStreamManagerTest.findsCustomerEventRelatedToEntity(ActivityStreamManagerTest.java:70) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124) at org.testng.internal.Invoker.invokeMethod(Invoker.java:580) at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:716) at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:988) at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125) at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109) at org.testng.TestRunner.privateRun(TestRunner.java:648) at org.testng.TestRunner.run(TestRunner.java:505) at org.testng.SuiteRunner.runTest(SuiteRunner.java:455) at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:450) at org.testng.SuiteRunner.privateRun(SuiteRunner.java:415) at org.testng.SuiteRunner.run(SuiteRunner.java:364) at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:84) at org.testng.TestNG.runSuitesSequentially(TestNG.java:1208) at org.testng.TestNG.runSuitesLocally(TestNG.java:1137) at org.testng.TestNG.runSuites(TestNG.java:1049) at org.testng.TestNG.run(TestNG.java:1017) at org.testng.IDEARemoteTestNG.run(IDEARemoteTestNG.java:72) at org.testng.RemoteTestNGStarter.main(RemoteTestNGStarter.java:123) Caused by: java.lang.ClassCastException: java.util.ArrayDeque cannot be cast to java.util.List at com.orientechnologies.orient.core.sql.functions.coll.OSQLFunctionTraversedElement.evaluate(OSQLFunctionTraversedElement.java:78) at com.orientechnologies.orient.core.sql.functions.coll.OSQLFunctionTraversedVertex.execute(OSQLFunctionTraversedVertex.java:40) at com.orientechnologies.orient.core.sql.functions.OSQLFunctionRuntime.execute(OSQLFunctionRuntime.java:128) at com.orientechnologies.orient.core.sql.ORuntimeResult.applyRecord(ORuntimeResult.java:127) at com.orientechnologies.orient.core.sql.ORuntimeResult.getProjectionResult(ORuntimeResult.java:261) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:698) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:665) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:615) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1611) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1557) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:510) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:473) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3786) ... 31 more  ```</body>
		<created>2018-08-20 11:55:25</created>
		<closed>2018-08-21 07:41:23</closed>
	</bug>
	<bug>
		<id>8469</id>
		<title>Create property ignore unsafe in case there si no linked type</title>
		<body>### OrientDB Version: 3.0.6  ### Java Version: Java 8 ### OS: Linux Debian  ## Expected behavior   ` create property class.property LINK unsafe ` is executed following the unsafe rules, as today the unsafe is ignored and used as linked type.  work around: ` create property class.property LINK V unsafe` specifying the linked type and unsafe it works properly.  </body>
		<created>2018-08-14 12:47:42</created>
		<closed>2018-08-16 10:48:47</closed>
	</bug>
	<bug>
		<id>8463</id>
		<title>Unexpected java.lang.ClassCastException </title>
		<body>### OrientDB Version: 3.0.6-SNAPSHOT ### Java Version: 1.8 ### OS: MacOs     What does the below exception mean and why am i getting it?  I have this piece of code, where I try to store in the "affected" field a vertex and an edges. ``` ... CREATE PROPERTY Action.affected   LINKSET  (READONLY TRUE);  ... public void  affects(OElement... affected) {             action.setProperty("affected", affected); } ```  ``` Caused by: java.lang.ClassCastException: com.orientechnologies.orient.core.record.impl.OEdgeDelegate cannot be cast to com.orientechnologies.orient.core.record.ORecordAbstract         at com.orientechnologies.orient.core.record.ORecordInternal.addIdentityChangeListener(ORecordInternal.java:111)         at com.orientechnologies.orient.core.db.record.ORecordLazySet.add(ORecordLazySet.java:132)         at com.orientechnologies.orient.core.db.record.ORecordLazySet.add(ORecordLazySet.java:44)         at com.orientechnologies.orient.core.record.impl.ODocumentHelper.convertField(ODocumentHelper.java:139)         at com.orientechnologies.orient.core.record.impl.ODocument.setProperty(ODocument.java:413)         at com.orientechnologies.orient.core.record.impl.ODocument.setProperty(ODocument.java:354)  ```  </body>
		<created>2018-08-11 06:54:02</created>
		<closed>2018-11-05 08:16:03</closed>
	</bug>
	<bug>
		<id>8457</id>
		<title>Back quote behavior is different between 2.2.x and 3.0.x</title>
		<body>### OrientDB Version: 3.0.4 ### Java Version: 1.8 ### OS: centos 6.8  ## Expected behavior   back quote character don't return in the result schema  ## Actual behavior   result schema have back quote character  ## Steps to reproduce   I have 3 sql need to execute ```sql sqlA: select `name` from v_instance_app limit 1  execute result: {     "result": [         {             "`name`": "emm-nginx"         }     ] } ```   ``` sqlB: select `cluster` from v_instance_app limit 1  execute result: {     "result": [         {             "`cluster`": null         }     ] } ```   ``` sqlC: select cluster from v_instance_app limit 1  get a exception {   "errors": [     {       "reason": 400,       "code": 400,       "content": "Error parsing query:\u000aselect cluster from v_instance_app limit 1\u000a     ^\u000aEncountered \" &lt;SELECT&gt; \"select \"\" at line 1, column 1.\u000aWas expecting one of:\u000a    &lt;LET&gt; ...\u000a    &lt;EXPLAIN&gt; ...\u000a    \u000d\u000a\u0009DB name=\"cmdb_org_1028\"\u000d\u000a\u0009Error Code=\"1\""     }   ] } ```  My question is: - I use back quote in 2.2.x everywhere, should I trim the back quote? - how can I get `cluster` schema with sql?</body>
		<created>2018-08-09 03:58:38</created>
		<closed>2018-09-25 06:45:57</closed>
	</bug>
	<bug>
		<id>8447</id>
		<title>oetl.sh hangs after running .json file</title>
		<body>### OrientDB Version: 3.0.4   ### Java Version: 1.8.0_121   ### OS: CentOS 6.8    ## Expected behavior   After running oetl.sh command it should end process and return control.  ## Actual behavior   when I run an oetl.sh that extracts data from PostgreSQL to OrientDB the command doesn't exit and hangs permanently on the last line.  [vagrant@ms-development bin]$ ./oetl.sh /&lt;PATH_TO_FILE&gt;/Jurisdiction.json OrientDB etl v.3.0.4 - Veloce (build 4578b51f72a55feaa0852bc8ddd52929011d956c, branch 3.0.x) https://www.orientdb.com 2018-08-01 15:21:31:341 INFO  Detected limit of amount of simultaneously open files is 4096,  limit of open files for disk cache will be set to 1536 [ONative] 2018-08-01 15:21:31:343 WARNI Value of limit of simultaneously open files is too small, recommended value is 262144 [ONative]dbName = map 2018-08-01 15:21:31:580 INFO  BEGIN ETL PROCESSOR [OETLProcessor] 2018-08-01 15:21:31:595 INFO  Started execution with 1 worker threads [OETLProcessor] 2018-08-01 15:21:32:118 INFO  END ETL PROCESSOR [OETLProcessor] 2018-08-01 15:21:32:119 INFO  + extracted 9 records (0 records/sec) - 9 records -&gt; loaded 4 vertices (0 vertices/sec) Total time: 539ms [0 warnings, 0 errors] [OETLProcessor]  We have a process that goes through many .json files one by one. Because of this, our process that executes all the etl .json files is hanging waiting on the first one to finish. Doing the same on 2.2.17 did exit the command execution and was able to continue processing files.  Note: entries were created as expected.   </body>
		<created>2018-08-02 08:03:24</created>
		<closed>2018-08-09 12:17:58</closed>
	</bug>
	<bug>
		<id>8444</id>
		<title>Strange transaction (Tx) behaviour for edges created within a Tx</title>
		<body>### OrientDB Version: 2.2.36 (also 3.0.4) ### Java Version: 1.8.0_151   ### OS: centos07  ## Expected behavior   Expected the transaction to succeed.   ## Actual behavior   Works when not using the let statements inside a transaction. Does not work within a transaction. It appears to take issue with using the result assigned to a LET after edge creation in a subsequent statement  ## Steps to reproduce   create a new database ``` create property E.history link create property V.history link ``` In the console attempt to perform the following transaction ``` script sql BEGIN     LET src = create vertex v set name = 'alice'     LET tgt = create vertex v set name = 'bob'     LET e1  = create edge e from $src to $tgt     LET e2 = create edge e from $tgt to $src set history = $e1 COMMIT end ``` you will see the following error ``` Error: com.orientechnologies.orient.core.exception.OValidationException: The field 'E.history' has been declared as LINK but the value is not a record or a record-id DB name="test_tx" DB name="test_tx" ``` However if you do the same thing without the transaction it works (18:0 is another edge and 9:0/12:0 are vertices) ``` create edge from #9:0 to #12:0 set name = 'manual second', history = #18:0  ```  </body>
		<created>2018-07-31 21:16:36</created>
		<closed>2018-09-18 10:10:21</closed>
	</bug>
	<bug>
		<id>8442</id>
		<title>Getting java.nio.BufferUnderflowException when querying</title>
		<body>### OrientDB Version: 3.0.4  ### Java Version: 1.8 ### OS: Alpine Linux v3.8    ## Expected behavior   Query should perform without throwing ByteUnderflowException    ## Actual behavior   Exception thrown while executing the below query.   SELECT FROM ( match { class: a, AS: a }   .out('aTob') { AS: b, WHERE: (field1 is defined and field1 = true) }         .out('bToC') { WHERE: (field2 = 'XYZ'), AS: c }   return a )  This query works fine when I add a LIMIT of 121 records.  If I add a limit of 122 or run the query without a limit, it throws "BufferUnderflowException"    Stack Trace: Exception `66F7FD08` in storage `plocal:/orientdb/databases/database-test`: 3.0.4 - Veloce (build 4578b51f72a55feaa0852bc8ddd52929011d956c, branch 3.0.x) java.nio.BufferUnderflowException at java.nio.DirectByteBuffer.get(DirectByteBuffer.java:271) at java.nio.ByteBuffer.get(ByteBuffer.java:715) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.getBinaryValue(ODurablePage.java:155) at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPage.getRecordBinaryValue(OClusterPage.java:376) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readFullEntry(OPaginatedCluster.java:1837) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.internalReadRecord(OPaginatedCluster.java:700) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:667) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:649) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doReadRecord(OAbstractPaginatedStorage.java:4547) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:4223) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1605) at com.orientechnologies.orient.core.db.document.SimpleRecordReader.readRecord(SimpleRecordReader.java:21) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.executeReadRecord(ODatabaseDocumentAbstract.java:1345) at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:109) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.load(ODatabaseDocumentAbstract.java:1114) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.load(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.core.record.impl.ODocument.getProperty(ODocument.java:305) at com.orientechnologies.orient.core.record.impl.OEdgeDocument.getTo(OEdgeDocument.java:33) at com.orientechnologies.orient.core.record.impl.OEdgeToVertexIterator.next(OEdgeToVertexIterator.java:32) at com.orientechnologies.orient.core.record.impl.OEdgeToVertexIterator.next(OEdgeToVertexIterator.java:12) at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser.traversePatternEdge(MatchEdgeTraverser.java:295) at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser.executeTraversal(MatchEdgeTraverser.java:127) at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser.init(MatchEdgeTraverser.java:98) at com.orientechnologies.orient.core.sql.executor.MatchEdgeTraverser.hasNext(MatchEdgeTraverser.java:35) at com.orientechnologies.orient.core.sql.executor.MatchStep.fetchNext(MatchStep.java:108) at com.orientechnologies.orient.core.sql.executor.MatchStep.access$000(MatchStep.java:13) at com.orientechnologies.orient.core.sql.executor.MatchStep$1.next(MatchStep.java:65) at com.orientechnologies.orient.core.sql.executor.MatchStep.fetchNext(MatchStep.java:103) at com.orientechnologies.orient.core.sql.executor.MatchStep.access$000(MatchStep.java:13) at com.orientechnologies.orient.core.sql.executor.MatchStep$1.next(MatchStep.java:65) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.next(ProjectionCalculationStep.java:38) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.next(OLocalResultSet.java:69) at com.orientechnologies.orient.core.sql.parser.OLocalResultSetLifecycleDecorator.next(OLocalResultSetLifecycleDecorator.java:56) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:96) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:172) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:633) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:82) </body>
		<created>2018-07-31 08:04:43</created>
		<closed>2020-07-03 17:12:01</closed>
	</bug>
	<bug>
		<id>8440</id>
		<title>Invalid format for configuration file</title>
		<body>### OrientDB Version: 3.0.4 ### Java Version: 10.0.2 ### OS: Ubuntu 16.04  ## Expected behavior   working with VehicleHistoryGraph databases  ## Actual behavior    And then from the console I try to `connect plocal:/opt/orientdb/databases/VehicleHistoryGraph admin admin` and get an error:      Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database 'VehicleHistoryGraph'          Error: com.orientechnologies.orient.core.exception.OStorageException: Invalid format for configuration file /opt/orientdb/bin/../databases/VehicleHistoryGraph/database.ocf for storageVehicleHistoryGraph  Is there a way for me to fix the configuration file?  ETA: downloading and unzipping a public database over the version that I had didn't fix the issue.  ETA: `GratefulDeadConcerts` and `Tolkien-Arda` work just fine.   ## Steps to reproduce   Install orientdb, download a public database, try to connect to it from console.  </body>
		<created>2018-07-30 09:59:34</created>
		<closed>2020-07-03 17:11:50</closed>
	</bug>
	<bug>
		<id>8439</id>
		<title>Fail to restore database after forced shutdown</title>
		<body>### OrientDB Version: 3.0.2 ### Java Version: jdk1.8.0_144 ### OS: Windows 10  ## Expected behavior   Be able to restart database system and retrieve database as it was.  ## Actual behavior   Database fails to restart with error  ``` 2018-07-27 09:30:35:874 SEVER {db=mydb} Magic number verification failed for page `0` of `myclass.cpm`. ``` This error displays multiple time for different classes.  ## Steps to reproduce   After orientdb server manually forced shutdown (closed terminal window or pc shutdown without closing orientdb process),  ### Extra information When database is closed using `&lt;Ctrl-C&gt;`, some extra logs are displayed in terminal and then database can be re-opened without error.  This problem is present for 2 dev in our team (others shutdown there environment properly) with same config.  I can send starting logs by mail if needed.</body>
		<created>2018-07-30 08:59:25</created>
		<closed>2019-05-10 13:24:05</closed>
	</bug>
	<bug>
		<id>8435</id>
		<title>Orientdb Edge class having property name starting with a number fails while fetching the edge</title>
		<body>### OrientDB Version: 2.2.34 ### Java Version: 1.8   ### OS: Windows -10   ## Expected behavior   There should not be any error while fetching  the record containing attribute whose name is starting with a number, as orientdb is letting us create the attribute with name starting with number and also letting us insert the edge into the edge class.  ## Actual behavior   For **Remote** oriendb database, we created an edge class with name - "test". We also created a property on that class with name - "2Test_Property" The property created successfully. We also created Unique index on that property. We tried to add the edge to this edge class and it successfully got created. But while fetching the edge we are getting following error:  caused by: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: select rid from index:test.2Test_Property where key = ? Encountered " &lt;FLOATING_POINT_LITERAL&gt; ".2 ""  **The same case is working properly in case of plocal mode.**    ## Steps to reproduce   1. Create a remote orientdb database.  2. Create a edge class and create a property whose name is starting with a number.  3. Create index on that property.  4. Insert a edge into the edge class  5. Try to fetch the edge.  </body>
		<created>2018-07-27 08:57:23</created>
		<closed>2018-07-30 15:00:16</closed>
	</bug>
	<bug>
		<id>8430</id>
		<title>SELECT FROM (&lt;MATCH query...&gt;) not working?</title>
		<body>### OrientDB Version: 3.0.5-SNAPSHOT   ### Java Version:  1.8   ### OS: any   I have a MATCH query that works as expected: ``` match  {class: Account, as: a}.outE(WorksFor){where: ('admin' in ROLES)}.inV(Staffer){where: (email='test@test.com')}, {as:a}.outE(WorksFor){where:('admin' in ROLES)}  return a, count(*) as totalAdmins group by a;  +----+-----+-----------+ |#   |a    |totalAdmins| +----+-----+-----------+ |0   |#65:0|2          | |1   |#66:0|1          | +----+-----+-----------+   ```  However any attempt to wrap it with SELECT : ``` select from (&lt;the_above_query&gt;) where totalAdmins=1; select a from (&lt;the_above_query&gt;) where totalAdmins=1; ``` fails with syntax error??? ``` Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: select from (match {class:Account, as: a}           ^ Encountered " &lt;FROM&gt; "from "" at line 1, column 8. Was expecting one of:     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ...     &lt;DISTINCT&gt; ... ```   </body>
		<created>2018-07-25 01:22:33</created>
		<closed>2018-07-31 08:01:21</closed>
	</bug>
	<bug>
		<id>8428</id>
		<title>EBEDDED[LIST/SET] types and IN/CONTAINS not working?</title>
		<body>### OrientDB Version: 3.0.5-SNAPSHOT   ### Java Version: 8   ### OS: any    I have this edge definition with ROLES property as an embedded set of strings: ``` -- Edge that links a staffer to an account. CREATE CLASS WorksFor extends E,Tracker; CREATE PROPERTY WorksFor.out     LINK  Account (MANDATORY TRUE, NOTNULL); CREATE PROPERTY WorksFor.in      LINK Staffer (MANDATORY TRUE, NOTNULL); CREATE INDEX    WorksFor.out_in ON WorksFor (in,out) UNIQUE; CREATE PROPERTY WorksFor.roles   EMBEDDEDSET STRING ; -- [P]ending, [A]ccepted, [R]ejected CREATE PROPERTY WorksFor.state   STRING (MANDATORY TRUE, DEFAULT "P");  ```  and some data: ```  &gt;select from WorksFor;  +----+------+--------+-----+-----+-----+---------+ |#   |@RID  |@CLASS  |state|out  |in   |ROLES    | +----+------+--------+-----+-----+-----+---------+ |0   |#97:0 |WorksFor|A    |#65:0|#89:0|[admin]  | |1   |#98:0 |WorksFor|A    |#65:0|#90:0|[staffer]| |2   |#99:0 |WorksFor|A    |#65:0|#91:0|[staffer]| |3   |#100:0|WorksFor|A    |#65:0|#92:0|[staffer]| |4   |#101:0|WorksFor|A    |#65:0|#93:0|[viewer] | |5   |#102:0|WorksFor|R    |#65:0|#94:0|[staffer]| |6   |#103:0|WorksFor|P    |#65:0|#95:0|[staffer]| +----+------+--------+-----+-----+-----+---------+ ``` According to [this example](https://stackoverflow.com/questions/36244601/query-embeddedlist-combined-with-other-property-in-orientdb), I expect that both of these queries would work: ``` select from WorksFor where 'admin' in roles; select from WorksFor where roles contains 'admin'; ``` __Yet in both cases I get no results ???__    </body>
		<created>2018-07-24 17:27:21</created>
		<closed>2018-08-06 15:29:36</closed>
	</bug>
	<bug>
		<id>8415</id>
		<title>Socket timeout exception</title>
		<body>### OrientDB Version: 3.0.5-SNAPSHOT  ### Java Version: 8   ### OS: Windows    I am getting socket timeouts (after waiting for a while) for a very simple query in console:  ```  orientdb {db=my.db}&gt; select from Account  +----+-----+-------+--------+----+-------------+--------+------------------+--------------------+ |#   |@RID |@CLASS |stripeId|name|emailAddress |livemode|subscriptionStatus|subscriptionLivemode| +----+-----+-------+--------+----+-------------+--------+------------------+--------------------+ |0   |#65:0|Account|test    |Test|test@test.com|false   |active            |false               | +----+-----+-------+--------+----+-------------+--------+------------------+--------------------+  1 item(s) found. Query executed in 0.002 sec(s). orientdb {db=my.db}&gt; select from Staffer  orientdb {db=my.db}&gt; select out('WorksFor') from Account  Error: com.orientechnologies.common.io.OIOException: Read timed out  Error: java.net.SocketTimeoutException: Read timed out  orientdb {db=my.db}&gt; select in() from Account  Error: com.orientechnologies.common.io.OIOException: Read timed out  Error: java.net.SocketTimeoutException: Read timed out  ```  </body>
		<created>2018-07-19 05:27:44</created>
		<closed>2018-07-20 08:00:34</closed>
	</bug>
	<bug>
		<id>8414</id>
		<title>Issues with MATCH</title>
		<body>### OrientDB Version: 3.0.5-SNAPSHOT ### Java Version: 8 ### OS: Windows    ## Expected behavior   I cannot get the MATCH queries to work at all for 2 vertexes (Account, Staffer) connected with an edge (WorksFor):  ``` match {class: Account, as: a}-WorksFor-{class: Staffer, as: s} return s match {class: Account, as: a} return a match {class: Account, as: a}--{class: WorksFor, as: w}--{class: Staffer, as: s} return a,s,w ```   See the below example:  ## Steps to reproduce   ``` orientdb {db=rehabowner.db}&gt; select from Account  +----+-----+-------+--------+----+-------------+--------+------------------+--------------------+ |#   |@RID |@CLASS |stripeId|name|emailAddress |livemode|subscriptionStatus|subscriptionLivemode| +----+-----+-------+--------+----+-------------+--------+------------------+--------------------+ |0   |#65:0|Account|test    |Test|test@test.com|false   |active            |false               | +----+-----+-------+--------+----+-------------+--------+------------------+--------------------+  1 item(s) found. Query executed in 0.002 sec(s). orientdb {db=rehabowner.db}&gt; select from Staffer  +----+-----+-------+------------------------------+--------------------+---------+--------+-------------+-------------+-------+-------+ |#   |@RID |@CLASS |auth0Id                       |email               |firstName|lastName|phoneVerified|emailVerified|blocked|created| +----+-----+-------+------------------------------+--------------------+---------+--------+-------------+-------------+-------+-------+ |0   |#89:0|Staffer|auth0|5b3cfedea177ac1965fab185|test@test.com|Hristo   |Stoyanov|             |true         |       |#209:0 | +----+-----+-------+------------------------------+--------------------+---------+--------+-------------+-------------+-------+-------+  1 item(s) found. Query executed in 0.001 sec(s). orientdb {db=rehabowner.db}&gt; select from WorksFor  +----+-----+--------+-----+-----+-----+ |#   |@RID |@CLASS  |state|in   |out  | +----+-----+--------+-----+-----+-----+ |0   |#97:0|WorksFor|A    |#89:0|#65:0| +----+-----+--------+-----+-----+-----+  1 item(s) found. Query executed in 0.001 sec(s).  orientdb {db=rehabowner.db}&gt; describe WorksFor  CLASS 'WorksFor'  Records..............: 1 Super classes........: [E, Tracker] Default cluster......: worksfor (id=97) Supported clusters...: worksfor(97), worksfor_1(98), worksfor_2(99), worksfor_3(100), worksfor_4(101), worksfor_5(102), worksfor_6(103), worksfor_7(104) Cluster selection....: round-robin Oversize.............: 0.0  PROPERTIES +----+------------+-----------------+---------+--------+--------+----+----+-------+-------+ |#   |NAME        |LINKED-TYPE/CLASS|MANDATORY|READONLY|NOT-NULL|MIN |MAX |COLLATE|DEFAULT| +----+------------+-----------------+---------+--------+--------+----+----+-------+-------+ |0   |created     |Action           |false    |false   |false   |    |    |default|       | |1   |lastModified|Action           |false    |false   |false   |    |    |default|       | |2   |deactivated |Action           |false    |false   |false   |    |    |default|       | |3   |in          |Staffer          |true     |false   |true    |    |    |default|       | |4   |roles       |STRING           |false    |false   |false   |    |    |default|       | |5   |state       |                 |true     |false   |false   |    |    |default|P      | |6   |out         |Account          |true     |false   |true    |    |    |default|       | +----+------------+-----------------+---------+--------+--------+----+----+-------+-------+  INDEXES (1 altogether) +----+---------------+----------+ |#   |NAME           |PROPERTIES| +----+---------------+----------+ |0   |WorksFor.out_in|[in,out]  | +----+---------------+----------+ orientdb {db=rehabowner.db}&gt;  orientdb {db=rehabowner.db}&gt; match {class: Account, as: a}-WorksFor-{class: Staffer, as: s} return s  Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: match {class: Account, as: a}                             ^ Encountered "&lt;EOF&gt;" at line 1, column 29. Was expecting one of:     &lt;RETURN&gt; ...     "," ...     "." ...     "&lt;" ...     "--" ...     "-" ...          DB name="rehabowner.db"         Error Code="1"         DB name="rehabowner.db"  !Unrecognized command: '-WorksFor-{class: Staffer, as: s}' !Unrecognized command: 'return s' orientdb {db=rehabowner.db}&gt;  orientdb {db=rehabowner.db}&gt; MATCH {Class: Account, as: a} RETURN a;  Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: match {Class: Account, as: a}                             ^ Encountered "&lt;EOF&gt;" at line 1, column 29. Was expecting one of:     &lt;RETURN&gt; ...     "," ...     "." ...     "&lt;" ...     "--" ...     "-" ...          DB name="rehabowner.db"         Error Code="1"         DB name="rehabowner.db"  !Unrecognized command: 'RETURN a'   ```  </body>
		<created>2018-07-18 23:37:19</created>
		<closed>2018-07-19 06:57:49</closed>
	</bug>
	<bug>
		<id>8412</id>
		<title>$parent.$current behaviour changes with indexed queries</title>
		<body>### OrientDB Version: 3.0.4 ### Java Version: 1.8 ### OS: Mac OS  ## Expected behavior   ``` select id, $max, $maxRecord from ABC let $max = (select max($parent.$current.out('A').value) as maxVal), $maxRecord = (select $parent.$current.out('A')[value = $parent.$current.$max.maxVal]) where id in [...] ``` This works as long as `id` in `ABC` is not indexed.   ## Actual behavior   After adding a unique/non-unique index on `id`, $parent.$current result changes to `{key: , rid: }` format.  And the above query returns null for $max and $maxRecord.  </body>
		<created>2018-07-18 19:27:13</created>
		<closed>2018-08-16 12:53:07</closed>
	</bug>
	<bug>
		<id>8411</id>
		<title>INSERT ... RETURN @rid and @this and $current doesn't work</title>
		<body>### OrientDB Version: v3.0.4 ### Java Version: official docker   ### OS: official docker   ## Expected behavior   an inserted rid    ## Actual behavior   null and this code doesn't create record ```RETURN $current.name``` returns 'Spain', but without creating record in db. Without RETURN works properly     ## Steps to reproduce   ```  insert into `DCountry` set name = 'Spain', code = 'ES' RETURN @rid ```   </body>
		<created>2018-07-18 11:42:03</created>
		<closed>2018-07-18 14:12:47</closed>
	</bug>
	<bug>
		<id>8406</id>
		<title>Update edge | unable to change the edge endpoint</title>
		<body>### OrientDB Version: v3.0.3 ### Java Version: 8 ### OS: macOS High Sierra   ## Expected behavior   On issuing update edge command the endpoint should update.  This worked in v2.2.35 but its not working in v3.0.3.  ## Actual behavior   It's throwing a error saying out is not a vertex and is failing on validateOutInForEdge.  `com.orientechnologies.orient.core.exception.OCommandExecutionException: Error updating edge: 'out' is not a vertex - [V#9:0{name:a} v1] DB name="test" at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep.validateOutInForEdge(UpdateEdgePointersStep.java:126) at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep.handleUpdateEdge(UpdateEdgePointersStep.java:86) at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep.access$000(UpdateEdgePointersStep.java:16) at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep$1.next(UpdateEdgePointersStep.java:35) at com.orientechnologies.orient.core.sql.executor.SaveElementStep$1.next(SaveElementStep.java:37) at com.orientechnologies.orient.core.sql.executor.CountStep.syncPull(CountStep.java:53) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:144) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:59) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:540) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:175) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:84) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:172) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:633) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:82) Internal server error:  com.orientechnologies.orient.core.exception.OCommandExecutionException: Error updating edge: 'out' is not a vertex - [V#9:0{name:a} v1] DB name="test" at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep.validateOutInForEdge(UpdateEdgePointersStep.java:126) at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep.handleUpdateEdge(UpdateEdgePointersStep.java:86) at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep.access$000(UpdateEdgePointersStep.java:16) at com.orientechnologies.orient.core.sql.executor.UpdateEdgePointersStep$1.next(UpdateEdgePointersStep.java:35) at com.orientechnologies.orient.core.sql.executor.SaveElementStep$1.next(SaveElementStep.java:37) at com.orientechnologies.orient.core.sql.executor.CountStep.syncPull(CountStep.java:53) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37) at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46) at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:144) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:59) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:540) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:175) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:84) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:172) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:633)`  ## Steps to reproduce   `create vertex v set name = 'a'; --&gt; #9:0` `create vertex v set name = 'b'; --&gt; #10:0` `create vertex v set name = 'c'; --&gt; #11:0`  `create edge  e  from #10:0 to #11:0; --&gt; #17:0`  `update edge e set out = (select from v where name = 'a' ) where  @rid = #17:0`     </body>
		<created>2018-07-17 00:55:56</created>
		<closed>2018-07-17 07:58:23</closed>
	</bug>
	<bug>
		<id>8400</id>
		<title>MATCH query bug on values containing whitespace</title>
		<body>### OrientDB Version: 2.2.35  ### Java Version: 1.8.0_151   ### OS: centos07  ## Expected behavior   I can select the record by querying name = 'the name' but then when I try to query using a match query the query fails. I am selecting a record that has both in and out going edges.  The query that works looks something like ``` select * from myclass where name = 'the name' ``` the match query that fails looks something like ``` MATCH {class: myclass, where: (name = 'the name')}.out(){while: (out().size() &gt; 0)} RETURN $pathElements ``` I expected the match to return itself and related records  ## Actual behavior   the select works but the match returns no records  ## Steps to reproduce   This is difficult to reproduce. I only seem to be able to do it when there is a significant number of entries in a field with a FULL_TEXT_HASH index. It also only affects records where that field name contains a space (or likely any other separator char). The smallest set I have so far been able to reproduce it with is 800+ vertices and 800+ edges  If I delete the full text hash the problem goes away. I think it is an issue with the match query using the full text hash for = (I thought it would only use it for containstext queries)   </body>
		<created>2018-07-12 16:34:04</created>
		<closed>2018-07-31 11:00:33</closed>
	</bug>
	<bug>
		<id>8395</id>
		<title>Impossible to stack TRAVERSE $depth constraints after $depth has been selected once</title>
		<body>### OrientDB Version: v3.0.3 ### Java Version: 1.8.0_161  ### OS: Ubuntu 16.04  Hi OrientDB Team,  ## Expected behavior   Possibility to "reset" $depth constraint by changing its name with a projection    ## Actual behavior   Requests returns no result.    ## Steps to reproduce   Import minimalist database : [delete_from_match.gz](https://github.com/orientechnologies/orientdb/files/2187842/delete_from_match.gz)   Run following query :  `TRAVERSE outE("knows") FROM ( SELECT *, $depth as some_depth FROM ( TRAVERSE out("knows") FROM ( SELECT * FROM my_class where name = "Alice" ) WHILE $depth &lt;= 2 ) SKIP 0 LIMIT 3 )`    If you run the same query without selecting the $depth, it will work :  `TRAVERSE outE("knows") FROM ( SELECT * FROM ( TRAVERSE out("knows") FROM ( SELECT * FROM my_class where name = "Alice" ) WHILE $depth &lt;= 2 ) SKIP 0 LIMIT 3 )`   About the general idea behind this, i'm interested in the $depth of the first traverse because this is about a constructed query where a client declared how much depth level he allows to traverse the data and once the query is over, our system will always retrieve the outgoing edges of the processed set of vertices.  I guess i could make it work by storing the intermediate set into memory and then doing a second step (request) to retrieve the outgoing edges but this is exactly what i want to avoid, i should not have to store the intermediate set in order to retrieve what i want.  I tried to tweak the query by using a batch script like so :  &gt; LET $a = ( &gt; SELECT *, $depth as d FROM ( &gt; TRAVERSE out("knows") FROM ( SELECT * FROM my_class where name = "Alice" ) WHILE $depth &lt;= 2 &gt; ) SKIP 0 LIMIT 3 ) ; &gt; SELECT *, $depth from ( TRAVERSE outE("knows") FROM (select expand($a)));  But it didn't worked either, any ideas ?  Best Regards,  Cyprien.</body>
		<created>2018-07-12 09:18:21</created>
		<closed>2018-07-13 08:32:48</closed>
	</bug>
	<bug>
		<id>8383</id>
		<title>Subqueries using let: $current and $parent not found</title>
		<body>### OrientDB Version: 3.0.2 ### Java Version: 8 ### OS: Mac OS   ## Expected behavior   When executing the command:  select $foo from Bar  let  $foo = (select expand(out('foo-bar')) from $parent.current)  Returns Foo vertices.  ## Actual behavior   Exception: com.orientechnologies.orient.core.exception.OCommandExecutionException: Class $parent not found DB name=  **Sidenote:** In Orientdb 2.2.x the below used to work select $foo from Bar  let  $foo = (select expand(out('foo-bar')) from $current)  But in v3.0.2 this also throws exception: com.orientechnologies.orient.core.exception.OCommandExecutionException: Class $current not found DB name=  </body>
		<created>2018-07-08 18:38:36</created>
		<closed>2018-07-09 09:49:18</closed>
	</bug>
	<bug>
		<id>8379</id>
		<title>Multiple statement functions - new problems in 3.03, worked in 3.0.0?</title>
		<body>### OrientDB Version: 3.03 ### Java Version: OpenJDK Runtime Environment (build 1.8.0_171-8u171-b11-1~deb9u1-b11)  ### OS: Debian GNU/Linux 9   ## Expected behavior   In version 3.0.0, I was able to create and use functions which comprised several statements - similar to stored procedures, e.g.  ``` let entity = SELECT FROM Entity WHERE entityId = :entityId; IF ($entity.size() == 0) { return "entity_not_found"; } ```  But since a move to 3.0.3, these refuse to work, issuing a parse error.  ## Actual behavior   ``` {     "errors": [         {             "reason": 400,             "code": 400,             "content": "Error parsing query:&lt;exact query contents removed&gt;...Encountered \" \"#\" \"# \"\" at line 2, column 1. Was expecting: &lt;EOF&gt; DB name="&lt;db removed&gt;" Error Code="1"         }     ] } ```  ## Steps to reproduce   Add a multi-line function similar to above with a parameter, try to run a test through the console (or REST api, which also fails) and get a parse error.  Any suggestions?  </body>
		<created>2018-07-05 13:06:14</created>
		<closed>2018-07-06 11:15:46</closed>
	</bug>
	<bug>
		<id>8365</id>
		<title>Long.MIN_VALUE is parsed incorrectly in a query</title>
		<body>### OrientDB Version: 2.2.29 ### Java Version: 1.8.0_72 ### OS: Windows 10  ## Expected behavior   Parse Long.MIN_VALUE correctly for a query  ## Actual behavior   Parser throws an exception  ## Steps to reproduce   Use a query that check the value of a property using Long.MIN_VALUE For example: SELECT FROM V WHERE hs_3apoint &gt;= -9223372036854775808  It appears the '-' is parsed first and then the number. Since 9223372036854775807 is the max long value, a parsing exception occurs.  </body>
		<created>2018-06-29 18:56:05</created>
		<closed>2018-07-02 15:57:00</closed>
	</bug>
	<bug>
		<id>8355</id>
		<title>3.0.3-SNAPSHOT serious regression</title>
		<body>### OrientDB Version: 3.0.3-SNAPSHOT ### Java Version: 1.8_172 ### OS: Win 7     The attached schema script used to work with 3.0.2, but __does nothing__ in 3.0.3-SNAPSHOT: ``` connect 'plocal:c:/temp/my.db' admin admin; load script 'schema.sql' ``` I suspect this has something to do with the fix for #8325   [schema.zip](https://github.com/orientechnologies/orientdb/files/2125720/schema.zip)    </body>
		<created>2018-06-22 00:04:52</created>
		<closed>2018-06-22 07:48:33</closed>
	</bug>
	<bug>
		<id>8351</id>
		<title>OrientDB make an inconsistency graph.</title>
		<body>### OrientDB Version: orientdb-server-2.2.33 ### Java Version: openjdk version "1.8.0_144" OpenJDK Runtime Environment (build 1.8.0_144-b01) OpenJDK 64-Bit Server VM (build 25.144-b01, mixed mode) ### OS: FreeBSD 11.0-RELEASE-p1 FreeBSD 11.0-RELEASE-p1  ## Expected behavior   Graph should maintain consistency between vertex , edge.  ## Actual behavior   OrientDB has a conflict link or missing metadata between vertex.    ## Steps to reproduce   I don't know how can this happened. But I found it while i'm drill down to investigated some problem that happen to our application.  Let's see the query out put below.  Please note that the record 173:443 was created by our application and then create an edge to connect with 140:136.  select out() from #173:443         +----+----------+ |#   |out       | +----+----------+ |0   |[#140:136]|                       &lt;------------ correct +----+----------+  select outE() from #173:443 +----+----------+ |#   |outE      | +----+----------+ |0   |[#182:595]|                      &lt;------------ correct +----+----------+  select from #182:595 +----+--------+--------+----+--------+--------+ |#   |@RID    |@CLASS  |type|out     |in      | +----+--------+--------+----+--------+--------+ |0   |#182:595|HardLink|file|#173:443|#140:136|                 &lt;------------ correct +----+--------+--------+----+--------+--------+  select inE() from 140:136  +----+---------------------------------------------+ |#   |inE                                          | +----+---------------------------------------------+ |0   |[#183:595,#184:595,#189:591,#190:591,#355:15]|         &lt;---- ??? where is the edge 182:595 +----+---------------------------------------------+  This mean that when I'm trying to list items related with 140:136 by our application we never see it.  Do you have any idea to suggest us for this case?  If more informations require please tell me.  Thank you,</body>
		<created>2018-06-21 07:30:16</created>
		<closed>2018-07-03 13:02:47</closed>
	</bug>
	<bug>
		<id>8338</id>
		<title>OUser.hasRole() does not work correctly  in case of child ORole class</title>
		<body>### OrientDB Version: 2.2.30, 3.0.3  There is such line in code: https://github.com/orientechnologies/orientdb/blob/develop/core/src/main/java/com/orientechnologies/orient/core/metadata/security/OSecurityShared.java#L319  ```java   public ORole getRole(final OIdentifiable iRole) {     final ODocument doc = iRole.getRecord();     if (doc != null &amp;&amp; "ORole".equals(doc.getClassName()))       return new ORole(doc);      return null;   } ```  As you can see, there is explicit check for className - it should be equal ORole. But if you extend ORole and use for your project child class: it will lead to bug when hasRole doesn't work.</body>
		<created>2018-06-17 04:13:32</created>
		<closed>2018-06-18 12:39:19</closed>
	</bug>
	<bug>
		<id>8335</id>
		<title>Studio CSV Doesn't Populate File</title>
		<body>### OrientDB Version: 3.0.2 ### Java Version: 8   ### OS: Windows 10    ## Expected behavior   To run a query in Studio with the CSV option. When query runs and you open the file, it should be populated with the results  ## Actual behavior   The query runs, file is generated, but the workbook is blank. A green indicator pops up in Studio stating that "the command has been executed"  ## Steps to reproduce   SELECT X FROM *VERTEXNAME*  with content type of CSV in Orientdb Studio  </body>
		<created>2018-06-16 05:57:57</created>
		<closed>2018-12-19 16:48:56</closed>
	</bug>
	<bug>
		<id>8334</id>
		<title>Cannot UPDATE REMOVE from Map in 3.x</title>
		<body>### OrientDB Version: 3.0.2 ### Java Version: Java 8 ### OS: MacOS   ## Expected behavior   Apologies if I missed something in the documentation regarding migrating to 3.x, however it seems like removing elements from a MAP (either embedded or linked) using the previous syntax is problematic. The following SQL worked in 2.2.35:    ```SQL CREATE CLASS Test; INSERT INTO Test SET m = {"k1": "v1", "k2": "v2"}; UPDATE Test REMOVE m = "k1"; SELECT FROM Test; ```  The result was  `[{"m": {"k2":"v2"}}]`  ## Actual behavior   This same script in 3.0.2 produces the following exception:  ``` java.lang.IllegalArgumentException: Object {k1=v1, k2=v2} is not a multi value     at com.orientechnologies.common.collection.OMultiValue.remove(OMultiValue.java:660)     at com.orientechnologies.orient.core.sql.parser.OUpdateRemoveItem.applyUpdate(OUpdateRemoveItem.java:75)     at com.orientechnologies.orient.core.sql.executor.UpdateRemoveStep$1.next(UpdateRemoveStep.java:36)     at com.orientechnologies.orient.core.sql.executor.SaveElementStep$1.next(SaveElementStep.java:37)     at com.orientechnologies.orient.core.sql.executor.CountStep.syncPull(CountStep.java:53)     at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlan.fetchNext(OSelectExecutionPlan.java:37)     at com.orientechnologies.orient.core.sql.executor.OUpdateExecutionPlan.executeInternal(OUpdateExecutionPlan.java:46)     at com.orientechnologies.orient.core.sql.parser.OUpdateStatement.execute(OUpdateStatement.java:156)     at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:70)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:600) ```  I've reviewed the following docs and did not see any planned changes to this syntax.  - https://orientdb.com/docs/3.0.x/release/3.0/SQL-Changes.html - https://orientdb.com/docs/3.0.x/release/3.0/Upgrading-to-OrientDB-3.0.html - https://orientdb.com/docs/3.0.x/sql/SQL-Update.html  This does not seem to be a parsing issue though. A quick review of the stack suggests that this is in the execution phase. I took a look at OUpdateRemoveItem:  https://github.com/orientechnologies/orientdb/blob/9847c4359eab6476b403a1777c5f97d7f6e02957/core/src/main/java/com/orientechnologies/orient/core/sql/parser/OUpdateRemoveItem.java#L74  Oddly it checks `OMultiValue.isMultiValue(leftVal)` before calling `OMultiValue.remove(leftVal, rightVal, false);` which returns true. Then in `OMultiValue.remove()` it blows up for some reason. This seems like a bug inside OMultiValue perhaps.   </body>
		<created>2018-06-16 04:00:27</created>
		<closed>2018-06-18 08:28:57</closed>
	</bug>
	<bug>
		<id>8327</id>
		<title>Cannot convert v[#12:0] - class org.apache.tinkerpop.gremlin.orientdb.OrientVertex to JSON</title>
		<body>### OrientDB Version: 3.0.2 tinkerpop ### Java Version: 8 ### OS: Linux debian   Hello,  when i use the rest api with gremlin orientdb cannot convert a Vertex to Json.  Thanks  Marcel  ## Expected behavior   I would expect a correct path  ## Actual behavior   And errormessage:  `java.lang.UnsupportedOperationException: Cannot convert v[#12:0] - class org.apache.tinkerpop.gremlin.orientdb.OrientVertex to JSON`  ## Steps to reproduce   ``` curl -s -XPOST https://&lt;domain&gt;/command/&lt;database&gt;/gremlin -d '{"command": "g.V().has(\"key\",\"123\").out().values(\"names\").path()"}' | jq '.' {   "errors": [     {       "reason": 501,       "code": 501,       "content": "java.lang.UnsupportedOperationException: Cannot convert v[#12:0] - class org.apache.tinkerpop.gremlin.orientdb.OrientVertex to JSON"     }   ] } ```  ``` curl -s -XPOST https://&lt;domain&gt;/command/&lt;database&gt;/gremlin -d '{"command": "g.V().has(\"key\",\"123\").out().out().values(\"names\").tree().sideEffect(System.out.&amp;println)"}' | jq '.' {   "errors": [     {       "reason": 501,       "code": 501,       "content": "java.lang.UnsupportedOperationException: Cannot convert v[#12:0] - class org.apache.tinkerpop.gremlin.orientdb.OrientVertex to JSON"     }   ] } ```</body>
		<created>2018-06-13 22:07:09</created>
		<closed>2018-06-14 13:29:14</closed>
	</bug>
	<bug>
		<id>8325</id>
		<title>console still interprets file path strings for special characters</title>
		<body>### OrientDB Version: 3.0.2   ### Java Version: 1.8_172   ### OS: Windows 7     ## Expected behavior   console executes the scripts  ## Actual behavior   console fails attempts to interpret file names and fails to execute scripts   Here is a gradle task I use to automate the creation of my sample database - I put all file paths in single quotes (I also tried double-quotes with the same result):  ```groovy task createDevDatabase(type: JavaExec){     doFirst {         new File("${projectDir}/../rehabowner.db").deleteDir()     }     main = 'com.orientechnologies.orient.console.OConsoleDatabaseApp'     classpath = configurations.odb     jvmArgs  = ['-Dfile.encoding=utf-8',                 '-Djna.nosys=true',                 '-Djava.awt.headless=true',                 '-Djava.util.logging.config.file=${projectDir}/src/main/odb/config/odb-client-log.properties'     ]     args  = [             "set verbose 10;"+             "create database plocal:'${projectDir}/../rehabowner.db admin admin';" +             "load script '${projectDir}/src/main/odb/scripts/schema.sql';" +             "load script '${projectDir}/src/main/odb/scripts/sample_data.sql';" +             "disconnect;"     ] } ```  Here is what  I get:  ``` com.orientechnologies.orient.console.OConsoleDatabaseApp set verbose 10;create database plocal:'C:\temp\gitlab\peruncs\ recres\recres-webapp/../rehabowner.db admin admin';load script 'C:\temp\gitlab\peruncs\recres\recres-webapp/src/main/odb/scripts/schema.sql';load script 'C:\temp\gitlab\peruncs\recres\recres-webapp/src/main/odb/scripts/sample_data.sql';disconnect; Successfully started process 'command 'C:\Program Files (x86)\Java\jre1.8.0_172\bin\java.exe''  OrientDB console v.3.0.2 - Veloce (build e47e693f1470a7a642461be26983d4eca70777fd, branch develop) https://www.orientdb.com Type 'help' to display all the supported commands.  Previous value was: 2 verbose = 10  ecres-webapp/../rehabowner.db admin admin] using the storage type [PLOCAL]...  ecres-webapp\../rehabowner.db admin admin: Illegal char &lt;       &gt; at index 3: C:\       emp\gitlab\peruncs\ :recres-webapp:createDevDatabase (Thread[Task worker for ':',5,main]) completed. Took 1.101 secs. ```  As you can see, ```\r``` which is part of the path is __being interpreted and the path gets broken__. Other random ```\X``` in typical windows path can break script and database paths.  On Unix/MacOs, there is no issue since paths there use ```/```</body>
		<created>2018-06-13 17:06:04</created>
		<closed>2018-06-28 07:10:27</closed>
	</bug>
	<bug>
		<id>8311</id>
		<title>Accessing Vertex Record through index makes OSQL delete statement fail within the same transaction</title>
		<body>### OrientDB Version: 3.0.2   ### Java Version: 1.8.0_161 ### OS: Ubuntu 16.04  ## Expected behavior   OSQL statement working properly    ## Actual behavior   OSQL statement is not executed, the transaction crashes with an error:  &gt; com.orientechnologies.orient.core.exception.OSerializationException:  &gt; Cannot read transaction record from the network. Transaction aborted &gt; DB name="index-strange-behavior" &gt; DB name="index-strange-behavior" &gt; at com.mycompany.testing.StrangeIndexBehavior.testBehavior(StrangeIndexBehavior.java:38) &gt; Caused by: java.lang.NullPointerException  The OSQL statement is not executed, the records which i asked for suppression are still there.  ## Steps to reproduce   I've joined a very simple DB to help reproduce the problem : [index-strange-behavior.gz](https://github.com/orientechnologies/orientdb/files/2079460/index-strange-behavior.gz)  Also, here is a snippet which works to make the problem appear :  ``` @Test     public void testBehavior() throws BackendClosedException {          final OrientGraphFactory factory = new OrientGraphFactory("remote:127.0.0.1/index-strange-behavior", "root", "root").setupPool(5, 1000);         OrientBaseGraph graph = factory.getTx();                  // First retrieve instance of myclass using myproperty_index                  final OIndexManager idxManager = graph.getRawGraph().getMetadata().getIndexManager();         OIndex&lt;?&gt; idx = idxManager.getIndex("myproperty_index");                  final OIdentifiable projectionIdentifier = (OIdentifiable) idx.get("value_1");         final OrientVertex vertex = graph.getVertex(projectionIdentifier);                  graph.command(new OCommandSQL("DELETE VERTEX FROM MyClass WHERE true")).execute();          graph.commit();         graph.shutdown();      } ```  Now, i've noticed that the problem is solved if i "reset" the transaction by closing the current OrientBaseGraph object and open a second one to perform the OSQL Statement. Here is a working example :  ``` @Test     public void testBehaviorWorking() throws BackendClosedException {          final OrientGraphFactory factory = new OrientGraphFactory("remote:127.0.0.1/index-strange-behavior", "root", "root").setupPool(5, 1000);         OrientBaseGraph graph = factory.getTx();                  // First retrieve instance of myclass using myproperty_index                  final OIndexManager idxManager = graph.getRawGraph().getMetadata().getIndexManager();         OIndex&lt;?&gt; idx = idxManager.getIndex("myproperty_index");                  final OIdentifiable projectionIdentifier = (OIdentifiable) idx.get("value_1");         final OrientVertex vertex = graph.getVertex(projectionIdentifier);                  graph.shutdown();         graph = factory.getTx();                  graph.command(new OCommandSQL("DELETE VERTEX FROM MyClass WHERE true")).execute();          graph.commit();         graph.shutdown();      } ```  I hope you have enough information with that to solve the problem. OrientDB is running with default configuration. I just added "root"/"root" for the credentials.  Thanks in advance,  Best regards.</body>
		<created>2018-06-07 08:10:42</created>
		<closed>2018-06-07 15:11:51</closed>
	</bug>
	<bug>
		<id>8304</id>
		<title>toJSON() method seems broken in 3.0.1</title>
		<body>### OrientDB Version: 3.0.1 Community Edition / May 18th, 2018   ### Java Version: 8 / jdk1.8.0_161 ### OS: Windows 10 / 64-bit  ## Expected behavior   Running `SELECT @this.toJSON('prettyPrint') FROM Hotels WHERE Id = 1` against `demodb` should return a valid JSON document.  ## Actual behavior   `null` result is returned.  ## Steps to reproduce    1. Attach to `demodb` database using Studio or Console. 2. Execute SQL query detailed above. 3. Note empty results. 4. Consult the 'Raw' tab in Studio and note `null` value in `result` object. </body>
		<created>2018-06-04 10:30:37</created>
		<closed>2018-06-04 12:15:45</closed>
	</bug>
	<bug>
		<id>8303</id>
		<title>Moving vertex from class seems to delete its edges in OrientDB 3.0.1</title>
		<body>### OrientDB Version:  3.0.1   ### Java Version: openjdk version "1.8.0_171"   ### OS: Debian 9.4    ## Expected behavior    In OrientDB 2.2.35 this query worked fine:  MOVE VERTEX (SELECT FROM Uncompleted_Personal_Task WHERE @rid = #105:1) TO CLASS:Completed_Task  It moved the vertex into the Completed_Task class and it kept all its edges.  ## Actual behavior    In OrientDB 3.0.1 the same query moves the vertex into the Completed_Task class but all its edges disappear.  ## Steps to reproduce   &lt;add here&gt;    </body>
		<created>2018-06-02 17:58:15</created>
		<closed>2018-06-04 14:15:13</closed>
	</bug>
	<bug>
		<id>8302</id>
		<title>Query with "any()" seems not to work in OrientDB 3.0.1</title>
		<body>### OrientDB Version: 3.0.1   ### Java Version: openjdk version "1.8.0_171"   ### OS: Debian 9.4    ## Expected behavior   In OrientDB 2.2.35 this query worked fine:  select from V where any() like '%Word%'  ## Actual behavior   In OrientDB 3.0.1 I get an error  "com.orientechnologies.orient.core.exception.OCommandExecutionException: Funciton not found: any DB name="Example_DB""  ## Steps to reproduce   &lt;add here&gt;    </body>
		<created>2018-06-02 17:52:41</created>
		<closed>2018-06-04 15:45:31</closed>
	</bug>
	<bug>
		<id>8301</id>
		<title>Null rootCacheEntry in OSBTreeBonsaiLocal when upgrade from 2.2.21</title>
		<body>### OrientDB Version: 2.2.22   ### Java Version: 1.8.0   ### OS: CentOS 7  ## Expected behavior   Upgrade from 2.2.21, copy databases folder into new installation, should work as before.  ## Actual behavior   Some SQL failed to run some query (for example: `select out('IsProductOfEquipment') from Product`) in Studio, NullPointerException reported.  Tried 2.2.22 to 2.2.35, all same error, seems the bug was introduced since 2.2.22.  However, following queries can be executed without error: - select in('IsProductOfEquipment') from Product - select in('IsProductOfEquipment') from Equipment The edge class `IsProductOfEquipment` is from vertex `Product` to vertex `Equipment`.  ## Steps to reproduce   com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select out('IsProductOfEquipment') from Product         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3221)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3138)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:169)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:621)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.load(OSBTreeBonsaiLocal.java:495)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerShared.loadTree(OSBTreeCollectionManagerShared.java:107)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerAbstract.loadSBTree(OSBTreeCollectionManagerAbstract.java:174)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.loadTree(OSBTreeRidBag.java:976)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.access$800(OSBTreeRidBag.java:59)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.init(OSBTreeRidBag.java:501)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.&lt;init&gt;(OSBTreeRidBag.java:437)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.rawIterator(OSBTreeRidBag.java:560)         at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.rawIterator(ORidBag.java:161)         at com.tinkerpop.blueprints.impls.orient.OrientVertex.getVertices(OrientVertex.java:435)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove.v2v(OSQLFunctionMove.java:103)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionOut.move(OSQLFunctionOut.java:54)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove$1$2.call(OSQLFunctionMove.java:87)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove$1$2.call(OSQLFunctionMove.java:84)         at com.orientechnologies.orient.core.sql.OSQLEngine.foreachRecord(OSQLEngine.java:294)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove$1.call(OSQLFunctionMove.java:84)         at com.orientechnologies.orient.graph.sql.OGraphCommandExecutorSQLFactory.runWithAnyGraph(OGraphCommandExecutorSQLFactory.java:210)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove.execute(OSQLFunctionMove.java:69)         at com.orientechnologies.orient.core.sql.functions.OSQLFunctionRuntime.execute(OSQLFunctionRuntime.java:128)         at com.orientechnologies.orient.core.sql.ORuntimeResult.applyRecord(ORuntimeResult.java:141)         at com.orientechnologies.orient.core.sql.ORuntimeResult.getProjectionResult(ORuntimeResult.java:255)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:707)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:673)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:630)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1619)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1566)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:525)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:488)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3200)         ... 7 more Internal server error:  java.lang.NullPointerException         at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.load(OSBTreeBonsaiLocal.java:495)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerShared.loadTree(OSBTreeCollectionManagerShared.java:107)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerAbstract.loadSBTree(OSBTreeCollectionManagerAbstract.java:174)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.loadTree(OSBTreeRidBag.java:976)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.access$800(OSBTreeRidBag.java:59)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.init(OSBTreeRidBag.java:501)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.&lt;init&gt;(OSBTreeRidBag.java:437)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.rawIterator(OSBTreeRidBag.java:560)         at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.rawIterator(ORidBag.java:161)         at com.tinkerpop.blueprints.impls.orient.OrientVertex.getVertices(OrientVertex.java:435)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove.v2v(OSQLFunctionMove.java:103)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionOut.move(OSQLFunctionOut.java:54)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove$1$2.call(OSQLFunctionMove.java:87)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove$1$2.call(OSQLFunctionMove.java:84)         at com.orientechnologies.orient.core.sql.OSQLEngine.foreachRecord(OSQLEngine.java:294)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove$1.call(OSQLFunctionMove.java:84)         at com.orientechnologies.orient.graph.sql.OGraphCommandExecutorSQLFactory.runWithAnyGraph(OGraphCommandExecutorSQLFactory.java:210)         at com.orientechnologies.orient.graph.sql.functions.OSQLFunctionMove.execute(OSQLFunctionMove.java:69)         at com.orientechnologies.orient.core.sql.functions.OSQLFunctionRuntime.execute(OSQLFunctionRuntime.java:128)         at com.orientechnologies.orient.core.sql.ORuntimeResult.applyRecord(ORuntimeResult.java:141)         at com.orientechnologies.orient.core.sql.ORuntimeResult.getProjectionResult(ORuntimeResult.java:255)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:707)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:673)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:630)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1619)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1566)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:525)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:488)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3200)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3138)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:169)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:621)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) </body>
		<created>2018-06-01 15:38:42</created>
		<closed>2020-07-03 17:11:41</closed>
	</bug>
	<bug>
		<id>8294</id>
		<title>[V3.0.1] Using `SEARCH_FIELDS` function in  square bracket throws an error.</title>
		<body>### OrientDB Version: 3.0.1, 3.0.2-SNAPSHOT ### Java Version: 1.8 ### OS: Linux  Hi, I want to use `Lucene` operator in square bracket (in projection).  ## Actual/Expected behavior   I used to use `Lucene` operator in square bracket to filter outputs, but it's deprecated in orientdb v3. Now I want to use `SEARCH_FIELDS` function instead of `Lucene` operator in square bracket, but it throws `ClassCastException` error.  Error: ``` java.lang.ClassCastException: com.orientechnologies.orient.core.record.impl.OVertexDocument cannot be cast to com.orientechnologies.orient.core.sql.executor.OResult ```  Orientdb v3: ```sql SELECT expand(out("Friends")[SEARCH_FIELDS(["name"], "A*") = true]) FROM User WHERE id = 1; /* It throws an error */ ```    Orientdb v2: ```sql SELECT expand(out("Friends")[name Lucene  "A*"]) FROM User WHERE id = 1;  /* It works fine */ ``` ## Steps to reproduce   ```sql /* Schema */ create class User extends V; create property User.id Integer; create property User.name String; CREATE INDEX User.name ON User(name) FULLTEXT ENGINE LUCENE;  CREATE CLASS Friends EXTENDS E  insert into User set id = 1, name = "A"; insert into User set id = 2, name = "AB"; insert into User set id = 3, name = "ABC"; insert into User set id = 4, name = "ABCD";  CREATE EDGE Friends FROM (SELECT FROM User WHERE id = 1) to (SELECT FROM User WHERE id IN [2, 3, 4]);  / * Query */ SELECT out("Friends")[SEARCH_FIELDS(["name"], "A*") = true] FROM User WHERE id = 1; ```  </body>
		<created>2018-05-27 09:38:04</created>
		<closed>2018-05-28 11:09:20</closed>
	</bug>
	<bug>
		<id>8286</id>
		<title>Different behavior of SQL statement when used within SQL function</title>
		<body>### OrientDB Version: 3.0.1 (official docker image)   ## Expected behavior   We ware trying to retrieve out vertices of a hierarchical structure in two different ways: Via traverse, where all traversed vertices appear only once. But we also need to retrieve them multiple times if they have multiple in edges (for counting in some scenarios). For that way we use the MATCH syntax. Now when creating SQL functions with these statements, we expect the same result of the functions as when we execute the statements directly.  ## Actual behavior   Actually, when creating a SQL function with a MATCH statement, the function behaves like a traverse, but when executed directly, the multiple linked vertices appear multiple times.    ## Steps to reproduce   Simple data creation for reproducing: ``` CREATE CLASS C EXTENDS V CREATE PROPERTY C.ID INTEGER  CREATE CLASS C_C EXTENDS E  INSERT INTO C (ID) VALUES (1) INSERT INTO C (ID) VALUES (2) INSERT INTO C (ID) VALUES (3) INSERT INTO C (ID) VALUES (4)  CREATE EDGE C_C FROM (SELECT FROM C WHERE ID = 1) TO (SELECT FROM C WHERE ID = 2) CREATE EDGE C_C FROM (SELECT FROM C WHERE ID = 1) TO (SELECT FROM C WHERE ID = 3) CREATE EDGE C_C FROM (SELECT FROM C WHERE ID = 2) TO (SELECT FROM C WHERE ID = 4) CREATE EDGE C_C FROM (SELECT FROM C WHERE ID = 3) TO (SELECT FROM C WHERE ID = 4) ``` Calculating vertices where they should only appear once (works, getting all 4 vertices): ``` TRAVERSE out() FROM (SELECT FROM C WHERE ID = 1) ``` Calculating vertex where they should appear multiple times (works when directly executed, getting vertice with ID 4 two times): ``` MATCH {class: C, where: (ID = 1)}.out(){as: result, while: (true)} RETURN result ``` Calculating vertices where they should appear multiple times from a function (does not work as expected, getting vertex with ID 4 only once, like traverse): ``` CREATE FUNCTION test "MATCH {class: C, where: (ID = 1)}.out(){as: result, while: (true)} RETURN result" LANGUAGE SQL  SELECT test() ``` Can be reproduced from console or within OrientDB Studio.</body>
		<created>2018-05-23 13:01:38</created>
		<closed>2018-05-23 13:55:40</closed>
	</bug>
	<bug>
		<id>8283</id>
		<title>[v3.0.1] LET block always returns null when used with `out` function</title>
		<body>### OrientDB Version: 3.0.1 ### Java Version: 1.8 ### OS: Linux  I want to use `Let` block in my query.   ## Actual/Expected behavior   When I assign an edge to a variable in `LET` block and use it in projection, it returns `null`. But it is expected to return a value.  ```sql SELECT $x, name FROM V let $x = out("E") ```  ```sql SELECT $x, name FROM V let $x = out("E").name ```  Result: ```js {   "result": [         {             "$x": null,             "name": "A"         },         {             "$x": null,             "name": "B"         }     ], } ```    ## Steps to reproduce    ```sql insert into V set id = 1, name = "A" insert into V set id = 2, name = "B"  create edge E from (select from V where id = 1) to (select from V where id = 2)  SELECT $x, name FROM V let $x = out("E")   ``` </body>
		<created>2018-05-22 14:00:41</created>
		<closed>2018-05-25 12:11:11</closed>
	</bug>
	<bug>
		<id>8280</id>
		<title>COUNT return nothing when no line match the criteria</title>
		<body>### OrientDB Version: 3.0.1, 3.0.0RC2 ### Java Version: 1.8.0_162 Java(TM) SE Runtime Environment (build 1.8.0_162-b12) Java HotSpot(TM) 64-Bit Server VM (build 25.162-b12, mixed mode)    ### OS: MacOSX 10.13.4  ## Expected behavior   When counting elements of a class with a restriction ``` select count(*) from foo where name = 'bar' ``` I expect to get a single result with the count value event if no foo object has the name 'bar'. In this case, the value of count should be 0.  ## Actual behavior   When the restriction is empty, count has no result at all.  Note, when there is no restriction but the class is empty, the query bahave has expected.  Note: the problem seams to come from a premature optimisation of the query plan that dump the result when the restriction is empty.  ## Steps to reproduce    Here is a scenario from the console 3.0.1. The same behavior happens in the java driver.  ``` orientdb&gt; create database memory:test  Creating database [memory:test] using the storage type [MEMORY]... Database created successfully.  Current database is: memory:test orientdb {db=test}&gt; create class a  Class created successfully.  orientdb {db=test}&gt; create property a.name string  Property created successfully.  orientdb {db=test}&gt; select count(*) from a  +----+--------+ |#   |count(*)| +----+--------+ |0   |0       | +----+--------+  1 item(s) found. Query executed in 0.004 sec(s).  orientdb {db=test}&gt; insert into a (name) values ('a')  Inserted record '[a#25:0{name:a} v1]' in 0,009000 sec(s).  orientdb {db=test}&gt; insert into a (name) values ('b')  Inserted record '[a#26:0{name:b} v1]' in 0,001000 sec(s).  orientdb {db=test}&gt; insert into a (name) values ('c')  Inserted record '[a#27:0{name:c} v1]' in 0,001000 sec(s).  orientdb {db=test}&gt; select count(*) from a  +----+--------+ |#   |count(*)| +----+--------+ |0   |3       | +----+--------+  1 item(s) found. Query executed in 0.005 sec(s). orientdb {db=test}&gt; select count(*) from a where name = 'a'  +----+--------+ |#   |count(*)| +----+--------+ |0   |1       | +----+--------+  1 item(s) found. Query executed in 0.013 sec(s). orientdb {db=test}&gt; select count(*) from a where name = 'd'   0 item(s) found. Query executed in 0.002 sec(s). orientdb {db=test}&gt; ```  The last command should return an item with 0. </body>
		<created>2018-05-21 15:46:24</created>
		<closed>2018-06-11 15:12:21</closed>
	</bug>
	<bug>
		<id>8277</id>
		<title>SQL Parsing of list of objects keeps only the first element and fail later</title>
		<body>### OrientDB Version: 3.0.1, 3.0.0, 3.0.0RC2   ### Java Version: 1.8.0_162 Java(TM) SE Runtime Environment (build 1.8.0_162-b12) Java HotSpot(TM) 64-Bit Server VM (build 25.162-b12, mixed mode)    ### OS: Mac OS X 10.13.4   ## Expected behavior   Expect list of objects to be read as a list and be used   ## Actual behavior   The parser replace the list by it's first element. The command that use the list fails because it expects a list.  ## Steps to reproduce    Here is an exemple in the console. The same error happens with the execute command of the java driver.  ``` orientdb&gt; create database memory:test  Creating database [memory:test] using the storage type [MEMORY]... Database created successfully.  Current database is: memory:test orientdb {db=test}&gt; create class values  Class created successfully.  orientdb {db=test}&gt; create property values.name string  Property created successfully.  orientdb {db=test}&gt; create property values.value string  Property created successfully.  orientdb {db=test}&gt; create class stuff  Class created successfully.  orientdb {db=test}&gt; create property stuff.name string  Property created successfully.  orientdb {db=test}&gt; create property stuff.values embeddedlist values  Property created successfully.  orientdb {db=test}&gt; insert into stuff set name = 'a', values = [{'name':'p1','value':'v1'}]  Error: com.orientechnologies.orient.core.exception.OValidationException: The field 'stuff.values' has been declared as EMBEDDEDLIST but an incompatible type is used. Value: {name=p1, value=v1} DB name="test" Error Code="4"  orientdb {db=test}&gt; insert into stuff (name, values) values ('a', [{'name':'p1','value':'v1'}])  Error: com.orientechnologies.orient.core.exception.OValidationException: The field 'stuff.values' has been declared as EMBEDDEDLIST but an incompatible type is used. Value: {name=p1, value=v1} DB name="test" Error Code="4"  orientdb {db=test}&gt; insert into stuff (name, values) values ('a', [{'name':'p1','value':'v1'},{'name':'b','value':'v2'}])  Error: com.orientechnologies.orient.core.exception.OValidationException: The field 'stuff.values' has been declared as EMBEDDEDLIST but an incompatible type is used. Value: {name=p1, value=v1} DB name="test" Error Code="4" ```  </body>
		<created>2018-05-21 15:15:46</created>
		<closed>2018-05-22 11:59:27</closed>
	</bug>
	<bug>
		<id>8272</id>
		<title>Object API does not propagate save over Set fields</title>
		<body>### OrientDB Version: 2.2.35 ### Java Version: 8 ### OS: Windows, Linux    ## Expected behavior   A model where an entity is related to another entity by a one-to-many relationship implemented using a Set. Scenario: 1. fooEntity is created. 2. barEntity is created. 3. barEntity is added to fooEntity. 4. fooEntity is saved. 5. An entity retrievedFoo is retrieved from the database using fooEntity.id 6. A property is set in retrievedBar (acessed via retrievedFoo). Both entity handlers are now dirty. 7. retrievedFoo is saved.   ## Actual behavior   If the first save and the latter retrieve/save are executed using different connections (typical scenario in a multi thread application) the save operation is not propagated, and retrievedBar **stays marked as dirty**.  ## Steps to reproduce   I've created an integration test reproducing it. [PropagateSaveOnSetFieldIT](https://github.com/CompartAG/orientdb-tryouts/blob/bugs/object-api-does-not-propagate-save-on-sets/2.2.x/src/test/java/com/compart/tec/orientdb/object/PropagateSaveOnSetFieldIT.java)  3 scenarios:  - Master entity saved using a connection and later changes saved using the same connection. **It works**. - Master entity saved using a connection and later changes saved using a different connection. **It fails**. - same scenario than the former but the relationship is stored using a List instead of a Set. **It works**.  Something I have noticed while debugging is that when a single connection is used, when retrieved, the aggregate root's internal dirtyManager is not null (actually the root and the child share the same dirtyManager). In the scenario using different connections, when retrieved, **the dirtyManager in the root entity is null**.  </body>
		<created>2018-05-17 16:37:23</created>
		<closed>2018-05-21 09:00:31</closed>
	</bug>
	<bug>
		<id>8270</id>
		<title>[v3.0.0] `IN` operator and `UNIQUE_HASH_INDEX` index cause an error</title>
		<body>### OrientDB Version: 3.0.0  ### Java Version: 1.8  ### OS: Linux    Using `IN` operator on a property that has `UNIQUE_HASH_INDEX` index cause an error    ## Expected/Actual behavior    The following queries should return a few records but first query throws `java.lang.UnsupportedOperationException: Cannot evaluate id IN [1, 2] on index User.id` error. (I think it's because the `id` property uses `UNIQUE_HASH_INDEX` index!) but second query works fine (the `key` property uses `UNIQUE` index).    Queries:    1. `select from User where id in [1, 2]`  2. `select from User where key in [1, 2]`    ## Steps to reproduce      Run these commands:    ```sql  /* schema */  create class User extends V;  create property User.id Integer;  create property User.key Integer;    CREATE INDEX User.id ON User (id) UNIQUE_HASH_INDEX;  CREATE INDEX User.key ON User (key) UNIQUE;    /* data */  create vertex User set id = 1, key = 1;  create vertex User set id = 2, key = 2;  create vertex User set id = 3, key = 3;    select from User where id in [1, 2]    /* it cause an error */  ```</body>
		<created>2018-05-17 13:06:27</created>
		<closed>2018-05-17 18:58:22</closed>
	</bug>
	<bug>
		<id>8268</id>
		<title>CREATE INDEX doesn't automatically bound index to the schema property in v3.0.0</title>
		<body>### OrientDB Version: v3.0.0 ### Java Version: 9.0.1 ### OS: MacOS  ## Expected behavior    `CREATE INDEX` should automatically bound index to a property using index name:  ```sql CREATE INDEX User.id UNIQUE    /* throws error */   CREATE INDEX User.id ON User (id) UNIQUE    /* working */  ```  ## Actual behavior    It throws this error:  ``` com.orientechnologies.orient.core.exception.ODatabaseException: Impossible to create an index without specify the key type or the associated property: CREATE INDEX User.id UNIQUE  ```  ## Steps to reproduce    Run these commands (from https://orientdb.com/docs/3.0.x/sql/SQL-Create-Index.html):  ```sql CREATE PROPERTY User.id BINARY CREATE INDEX User.id UNIQUE ``` </body>
		<created>2018-05-17 12:23:29</created>
		<closed>2018-05-21 12:58:34</closed>
	</bug>
	<bug>
		<id>8263</id>
		<title>size() method returns different result from inside of IF() statement</title>
		<body>I opened a StackOverflow ticket on this recently but I believe it is actually a bug.  ### OrientDB Version: 3.0.0 ### Java Version: 1.8.0_171  ### OS: Ubuntu 16.04   ## Expected behavior   $3.size() should be greater than 0 for both of the following scripts ``` LET $1 = SELECT expand(bothE(Begets)) FROM Creature WHERE uniquename='hildigrimTook'; LET $2 = SELECT expand(bothE(Begets)) FROM Creature WHERE uniquename='adalgrimTook'; LET $3 = SELECT INTERSECT($1, $2).size(); LET $4 = CREATE EDGE Begets FROM (SELECT FROM Creature WHERE uniquename='hildigrimTook') TO (SELECT FROM Creature WHERE uniquename='adalgrimTook'); SELECT $3.size(); ``` ``` LET $1 = SELECT expand(bothE(Begets)) FROM Creature WHERE uniquename='hildigrimTook'; LET $2 = SELECT expand(bothE(Begets)) FROM Creature WHERE uniquename='adalgrimTook'; LET $3 = SELECT INTERSECT($1, $2).size(); LET $4 = CREATE EDGE Begets FROM (SELECT FROM Creature WHERE uniquename='hildigrimTook') TO (SELECT FROM Creature WHERE uniquename='adalgrimTook'); IF($3.size() &gt; 0 {     return 'Edge already exists' } IF($3.size() == 0 {     return $4; } ```  ## Actual behavior   Calling `$3.size()` is 0 when called from inside of an `IF()` statement, but &gt; 0 when called from a `SELECT`, so $4 is called every time and creates duplicate edges.  ## Steps to reproduce   The following creates a duplicate edge instead of correctly reading $3.size() and returning 'Edge already exists'.  ``` LET $1 = SELECT expand(bothE(Begets)) FROM Creature WHERE uniquename='hildigrimTook'; LET $2 = SELECT expand(bothE(Begets)) FROM Creature WHERE uniquename='adalgrimTook'; LET $3 = SELECT INTERSECT($1, $2).size(); LET $4 = CREATE EDGE Begets FROM (SELECT FROM Creature WHERE uniquename='hildigrimTook') TO (SELECT FROM Creature WHERE uniquename='adalgrimTook'); IF($3.size() &gt; 0 {     return 'Edge already exists' } IF($3.size() == 0 {     return $4; } ```</body>
		<created>2018-05-14 19:58:29</created>
		<closed>2018-05-17 08:03:08</closed>
	</bug>
	<bug>
		<id>8256</id>
		<title>not fully detachAll</title>
		<body>### OrientDB Version: 2.2.34  ### Java Version: 1.8   ### OS: windows   ## Expected behavior    &gt; OObjectEntitySerializer.detachAll(o, db, returnNonProxiedInstance, new HashMap&lt;Object, Object&gt;(), new HashMap&lt;Object, Object&gt;());  with returnNonProxiedInstance= true return full detached object  ## Actual behavior   return inner map as OTrackedMap  ## Steps to reproduce   save simple object:   ``` public class SimpleObject{  @Id private Object rid;  @Version private Object version;  private String objectId;  private Map&lt;String, String&gt; templatePartsIds;  public String getObjectId() { return objectId; }  public void setObjectId(String objectId) { this.objectId = objectId; }  public Map&lt;String, String&gt; getTemplatePartsIds() { return templatePartsIds; }  public void setTemplatePartsIds(Map&lt;String, String&gt; templatePartsIds) { this.templatePartsIds = templatePartsIds; } } ```  read it from DB and try to deatachall  </body>
		<created>2018-05-10 05:04:49</created>
		<closed>2018-05-11 13:01:30</closed>
	</bug>
	<bug>
		<id>8252</id>
		<title>Issues with free space managament of sparse files</title>
		<body>During the test of a MT benchmark, the error `Not enough disk space, force sync will be called` popped up after a while. It looks like the WAL is never trunked. I have 53GB free on my SSD.  OrientDB v3.0.1 (develop branch).  Test case:  ``` public class PerformanceIndexMTTest {   public final static  String    DATABASE_PATH = "target/database";   private static final int       TOT           = 5000000;   private static final String    TYPE_NAME     = "Person";   private static final ODocument END           = new ODocument();    public static void main(String[] args) throws Exception {     new PerformanceIndexMTTest().run();   }    private void run() {     final File dir = new File(DATABASE_PATH + "/performance");     OFileUtils.deleteRecursively(dir);     dir.mkdirs();      final int parallel = 2;      OrientDB orient = new OrientDB("plocal:" + DATABASE_PATH, OrientDBConfig.defaultConfig());     orient.create("performance", ODatabaseType.PLOCAL);     final ODatabaseSession database = orient.open("performance", "admin", "admin");      if (!database.getMetadata().getSchema().existsClass(TYPE_NAME)) {       final OClass personType = database.getMetadata().getSchema().createClass(TYPE_NAME, parallel);       personType.createProperty("id", OType.LONG);       personType.createProperty("name", OType.STRING);       personType.createProperty("surname", OType.STRING);       personType.createProperty("locali", OType.INTEGER);       personType.createProperty("notes1", OType.STRING);       personType.createProperty("notes2", OType.STRING);        personType.createIndex(TYPE_NAME + ".id", OClass.INDEX_TYPE.UNIQUE, "id");     }      long begin = System.currentTimeMillis();      try {        final Thread[] threads = new Thread[parallel];       final ArrayBlockingQueue&lt;ODocument&gt;[] queues = new ArrayBlockingQueue[parallel];       final AtomicInteger[] counter = new AtomicInteger[parallel];        for (int i = 0; i &lt; parallel; ++i) {         queues[i] = new ArrayBlockingQueue&lt;ODocument&gt;(1024);         counter[i] = new AtomicInteger();          final int id = i;         threads[i] = new Thread(new Runnable() {           @Override           public void run() {             final ODatabaseSession database = orient.open("performance", "admin", "admin");             while (true) {               try {                 ODocument record = queues[id].take();                  if (record == END)                   break;                  database.save(record, TYPE_NAME + (id == 0 ? "" : "_" + id));                  counter[id].incrementAndGet();                } catch (InterruptedException e) {                 e.printStackTrace();               }             }              OLogManager.instance().info(this, "Closing thread %d", id);             database.close();             OLogManager.instance().info(this, "Closed thread %d", id);           }         });         threads[i].start();       }        long row = 0;       for (; row &lt; TOT; ++row) {         final ODocument record = database.newInstance(TYPE_NAME);          record.setProperty("id", row);         record.setProperty("name", "Luca" + row);         record.setProperty("surname", "Skywalker" + row);         record.setProperty("locali", 10);         record.setProperty("notes1",             "This is a long field to check how OrientDB behaves with large fields. This is a long field to check how OrientDB behaves with large fields. This is a long field to check how OrientDB behaves with large fields. This is a long field to check how OrientDB behaves with large fields.");         record.setProperty("notes2",             "This is a long field to check how OrientDB behaves with large fields. This is a long field to check how OrientDB behaves with large fields. This is a long field to check how OrientDB behaves with large fields. This is a long field to check how OrientDB behaves with large fields.");          try {           queues[(int) (row % parallel)].put(record);         } catch (InterruptedException e) {           e.printStackTrace();         }          if (row % 100000 == 0)           System.out.println("Written " + row + " elements in " + (System.currentTimeMillis() - begin) + "ms");        }        for (int i = 0; i &lt; parallel; ++i) {         try {           queues[i].put(END);         } catch (InterruptedException e) {           e.printStackTrace();         }       }        for (int i = 0; i &lt; parallel; ++i) {         try {           threads[i].join();         } catch (InterruptedException e) {           e.printStackTrace();         }       }        System.out.println("Inserted " + row + " elements in " + (System.currentTimeMillis() - begin) + "ms");        System.out.println(" Counters ");       for (int i = 0; i &lt; parallel; ++i)         System.out.println(" - " + counter[i].get());      } finally {       database.close();       System.out.println("Insertion finished in " + (System.currentTimeMillis() - begin) + "ms");     }   } } ```  Output:  ``` Written 0 elements in 2ms Written 100000 elements in 5960ms Written 200000 elements in 9619ms Written 300000 elements in 13380ms Written 400000 elements in 17144ms Written 500000 elements in 20878ms Written 600000 elements in 25377ms Written 700000 elements in 29063ms Written 800000 elements in 33818ms Written 900000 elements in 38141ms Written 1000000 elements in 42160ms Written 1100000 elements in 46283ms Written 1200000 elements in 49956ms Written 1300000 elements in 53719ms Written 1400000 elements in 57607ms Written 1500000 elements in 61355ms Written 1600000 elements in 65282ms Written 1700000 elements in 69089ms Written 1800000 elements in 72991ms Written 1900000 elements in 76780ms Written 2000000 elements in 80554ms Written 2100000 elements in 84349ms Written 2200000 elements in 88107ms Written 2300000 elements in 91972ms Written 2400000 elements in 96154ms Written 2500000 elements in 100732ms Written 2600000 elements in 105795ms Written 2700000 elements in 109984ms Written 2800000 elements in 113812ms Written 2900000 elements in 118791ms Written 3000000 elements in 122881ms Written 3100000 elements in 131169ms Written 3200000 elements in 137366ms Written 3300000 elements in 142464ms Written 3400000 elements in 147055ms Written 3500000 elements in 151473ms Written 3600000 elements in 156005ms Written 3700000 elements in 162993ms Written 3800000 elements in 168244ms Written 3900000 elements in 174288ms Written 4000000 elements in 180323ms Written 4100000 elements in 187034ms Written 4200000 elements in 193305ms Written 4300000 elements in 205683ms Written 4400000 elements in 223523ms Written 4500000 elements in 231899ms Written 4600000 elements in 240256ms Written 4700000 elements in 244627ms Written 4800000 elements in 249298ms May 03, 2018 1:00:32 PM com.orientechnologies.common.log.OLogManager log SEVERE: $ANSI{green {db=performance}} Not enough disk space, force sync will be called May 03, 2018 1:00:38 PM com.orientechnologies.common.log.OLogManager log SEVERE: Error during data write for file 'Person.id_66.sbt' 1-th attempt java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  May 03, 2018 1:00:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: Error during data write for file 'Person.id_66.sbt' 1-th attempt java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  May 03, 2018 1:00:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: Error during data write for file 'Person.id_66.sbt' 2-th attempt java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  May 03, 2018 1:00:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: Exception in thread 'OrientDB Write Cache Flush Task (performance)' java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  May 03, 2018 1:00:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: Exception `044A0D45` in storage `plocal:/Users/luca/work/dev/orientechnologies/orientdb/modules/orientdb-benchmarks/target/database/performance/performance`: 3.0.0 - Veloce (build 099033f72305d1c17f27d025b04afad7059c1298, branch develop) com.orientechnologies.orient.core.exception.OWriteCacheException: File flush was abnormally terminated DB name="performance" at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1245) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1255) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:3987) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:3231) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkLowDiskSpaceRequestsAndReadOnlyConditions(OAbstractPaginatedStorage.java:5349) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1911) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1873) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2721) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:363) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:166) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.endMicroTransaction(ODatabaseDocumentEmbedded.java:757) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.executeSaveRecord(ODatabaseDocumentEmbedded.java:747) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:244) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2059) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2019) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2108) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2099) at com.orientechnologies.benchmarks.PerformanceIndexTest.run(PerformanceIndexTest.java:62) at com.orientechnologies.benchmarks.PerformanceIndexTest.main(PerformanceIndexTest.java:20) Caused by: java.util.concurrent.ExecutionException: java.io.IOException: No space left on device at java.util.concurrent.FutureTask.report(FutureTask.java:122) at java.util.concurrent.FutureTask.get(FutureTask.java:192) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1240) ... 20 more Caused by: java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  May 03, 2018 1:00:39 PM com.orientechnologies.common.log.OLogManager log SEVERE: Exception `044A0D45` in storage `plocal:/Users/luca/work/dev/orientechnologies/orientdb/modules/orientdb-benchmarks/target/database/performance/performance`: 3.0.0 - Veloce (build 099033f72305d1c17f27d025b04afad7059c1298, branch develop) com.orientechnologies.orient.core.exception.OWriteCacheException: File flush was abnormally terminated DB name="performance" at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1245) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1255) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:3987) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:3231) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkLowDiskSpaceRequestsAndReadOnlyConditions(OAbstractPaginatedStorage.java:5349) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1911) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1873) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2721) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:363) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:166) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.endMicroTransaction(ODatabaseDocumentEmbedded.java:757) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.executeSaveRecord(ODatabaseDocumentEmbedded.java:747) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:244) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2059) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2019) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2108) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2099) at com.orientechnologies.benchmarks.PerformanceIndexTest.run(PerformanceIndexTest.java:62) at com.orientechnologies.benchmarks.PerformanceIndexTest.main(PerformanceIndexTest.java:20) Caused by: java.util.concurrent.ExecutionException: java.io.IOException: No space left on device at java.util.concurrent.FutureTask.report(FutureTask.java:122) at java.util.concurrent.FutureTask.get(FutureTask.java:192) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1240) ... 20 more Caused by: java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  Insertion finished in 256764ms Exception in thread "main" com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #26:-2 DB name="performance" at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:206) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.saveInternal(ODatabaseDocumentAbstract.java:2059) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2019) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:84) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2108) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2099) at com.orientechnologies.benchmarks.PerformanceIndexTest.run(PerformanceIndexTest.java:62) at com.orientechnologies.benchmarks.PerformanceIndexTest.main(PerformanceIndexTest.java:20) Caused by: com.orientechnologies.orient.core.exception.OWriteCacheException: File flush was abnormally terminated DB name="performance" at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1245) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1255) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:3987) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:3231) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkLowDiskSpaceRequestsAndReadOnlyConditions(OAbstractPaginatedStorage.java:5349) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1911) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1873) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.internalCommit(ODatabaseDocumentAbstract.java:2721) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:363) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:166) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.endMicroTransaction(ODatabaseDocumentEmbedded.java:757) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.executeSaveRecord(ODatabaseDocumentEmbedded.java:747) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:244) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) ... 7 more Caused by: java.util.concurrent.ExecutionException: java.io.IOException: No space left on device at java.util.concurrent.FutureTask.report(FutureTask.java:122) at java.util.concurrent.FutureTask.get(FutureTask.java:192) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:1240) ... 20 more Caused by: java.io.IOException: No space left on device at sun.nio.ch.FileDispatcherImpl.pwrite0(Native Method) at sun.nio.ch.FileDispatcherImpl.pwrite(FileDispatcherImpl.java:66) at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:89) at sun.nio.ch.IOUtil.write(IOUtil.java:51) at sun.nio.ch.FileChannelImpl.writeInternal(FileChannelImpl.java:745) at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:731) at com.orientechnologies.common.io.OIOUtils.writeByteBuffer(OIOUtils.java:394) at com.orientechnologies.orient.core.storage.fs.OFileClassic.write(OFileClassic.java:226) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flushPage(OWOWCache.java:2272) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.access$3500(OWOWCache.java:107) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2972) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:2939) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  Process finished with exit code 1 ```</body>
		<created>2018-05-03 11:03:52</created>
		<closed>2018-05-18 11:46:22</closed>
	</bug>
	<bug>
		<id>8236</id>
		<title>.toJSON omits commas in object Arrays.</title>
		<body>### OrientDB Version: 2.2.28 ### Java Version: 1.8.0_161   ### OS: windows    ## Expected behavior   toJSON on embedded properties should export compliant JSON. array of objects should be comma separated. ``` `[     {         "a": "b"     },     {         "c": "d",         "e": "f"     },     {         "g": {             "h": "i"         }     } ] ```  should export as is.` ## Actual behavior   .toJSON don't insert commas in-between array elements `[{"@type":"d","@version":0,"a":"b"}{"@type":"d","@version":0,"c":"d","e":"f"}{"@type":"d","@version":0,"g":{"h":"i"}}] `  ## Steps to reproduce   `insert into testclass content {"testcol":[{"a":"b"},{"c":"d","e":"f"},{"g":{"h":"i"}}]}`  `select testcol.toJSON()`  </body>
		<created>2018-04-23 12:41:03</created>
		<closed>2018-04-23 13:51:44</closed>
	</bug>
	<bug>
		<id>8218</id>
		<title>Nullpointer exception at login on 3.0.0</title>
		<body>### OrientDB Version: 3.0.0 ### Java Version: docker orientdb ### OS: Ubuntu 16.04 LTS  ## Expected behavior   logging in on the webpanel should be ok   ## Actual behavior   loggin in works but throws an error in the console:   ``` Internal server error:  java.lang.NullPointerException at com.orientechnologies.orient.core.sql.parser.OSuffixIdentifier.execute(OSuffixIdentifier.java:76) at com.orientechnologies.orient.core.sql.parser.OSuffixIdentifier.execute(OSuffixIdentifier.java:196) at com.orientechnologies.orient.core.sql.parser.OModifier.execute(OModifier.java:93) at com.orientechnologies.orient.core.sql.parser.OBaseExpression.execute(OBaseExpression.java:125) at com.orientechnologies.orient.core.sql.parser.OExpression.execute(OExpression.java:109) at com.orientechnologies.orient.core.sql.parser.OBinaryCondition.evaluate(OBinaryCondition.java:44) at com.orientechnologies.orient.core.sql.parser.ONotBlock.evaluate(ONotBlock.java:45) at com.orientechnologies.orient.core.sql.parser.OAndBlock.evaluate(OAndBlock.java:48) at com.orientechnologies.orient.core.sql.parser.OOrBlock.evaluate(OOrBlock.java:50) at com.orientechnologies.orient.core.sql.parser.OWhereClause.matchesFilters(OWhereClause.java:50) at com.orientechnologies.orient.core.sql.executor.FilterStep$1.fetchNextItem(FilterStep.java:63) at com.orientechnologies.orient.core.sql.executor.FilterStep$1.hasNext(FilterStep.java:83) at com.orientechnologies.orient.core.sql.executor.ProjectionCalculationStep$1.hasNext(ProjectionCalculationStep.java:33) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:36) at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:29) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:281) at com.orientechnologies.orient.core.command.OSqlScriptExecutor.execute(OSqlScriptExecutor.java:44) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.execute(ODatabaseDocumentEmbedded.java:588) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:174) at com.orientechnologies.tinkerpop.command.OServerCommandPostCommandGremlin.executeStatement(OServerCommandPostCommandGremlin.java:48) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:84) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:172) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:633) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:82)  ```  ## Steps to reproduce   I'm not sure if I'm doing something wrong. I'm using the latest docker orient from this dockerfile:  https://raw.githubusercontent.com/orientechnologies/orientdb-docker/master/3.0/x86_64/alpine/Dockerfile  I also imported our database with the command `IMPORT DATABASE`  </body>
		<created>2018-04-17 10:39:37</created>
		<closed>2018-10-19 11:11:32</closed>
	</bug>
	<bug>
		<id>8211</id>
		<title>AssertionError at OCachePointer.incrementReadersReferrer </title>
		<body>### OrientDB Version: 2.2.33   ### Java Version: 1.8.162 ### OS: windows 10  ## Expected behavior   No assertion error  ## Actual behavior   The following exception is thrown.   ```  SEVERE [null]: Exception `0059A5E4` in storage `plocal:C:/Basis/Projects/CyberTriage/CyberTriageApp/build/testuserdir/databases/2.0/CyberTriage`: 2.2.33 (build 77584cd6827f647cf4aa231cf27bd6f10bc04e2c, branch 2.2.x) java.lang.AssertionError at com.orientechnologies.orient.core.storage.cache.OCachePointer.incrementReadersReferrer(OCachePointer.java:92) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:790) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1155) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:361) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.load(O2QCache.java:294) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:148) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecordBuffer(OPaginatedCluster.java:713) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:689) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:668) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doReadRecord(OAbstractPaginatedStorage.java:4203) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:3819) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1409) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3412) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:2023) at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:98) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1772) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:103) at com.orientechnologies.orient.core.iterator.OIdentifiableIterator.readCurrentRecord(OIdentifiableIterator.java:300) at com.orientechnologies.orient.core.iterator.ORecordIteratorClusters.hasNext(ORecordIteratorClusters.java:167) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1636) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1585) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:522) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:485) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:70) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3417) [catch] at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3335) at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78) at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74) at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:102) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:760) ```  ## Steps to reproduce   Our system inserts a large number of records and when a query is issued simultaneously, it results in the above error.  We upgraded from 2.2.19 to 2.2.33. We have not observed this issue in the past versions.    </body>
		<created>2018-04-12 15:45:18</created>
		<closed>2018-04-24 17:27:32</closed>
	</bug>
	<bug>
		<id>8195</id>
		<title>Pool can't reopen connection</title>
		<body>### OrientDB Version: 3.0.0-RC2 ### Java Version: 9.0.4   ### OS: client: win10, orient: dockerized ubuntu   ## Expected behavior   Open connection after database repair  ## Actual behavior   exception.ODatabaseException: Cannot execute the request because an asynchronous operation is in progress. Please use a different connection  ## Steps to reproduce   1. I have following java program fragment:  ```        OrientDB db = new OrientDB("remote:localhost", "root", "rootpwd", OrientDBConfig.defaultConfig());         ODatabasePool pool =  new ODatabasePool(db, "demodb", "root", "rootpwd");           while (true) {             ODatabaseSession session = null;             try {                 Thread.sleep(3000);                  session = pool.acquire();                  OResultSet rs = session.query("SELECT * from SomeClass3");                  System.out.println("session: " + session);                 System.out.println("rs: " + rs);              } catch (Throwable e) {                 System.out.println("Thrown: "+ e);                 StackTraceElement elems[] = e.getStackTrace();                 for (int i=0; i &lt; Math.min(12, elems.length); i++) {                     System.out.println(elems[i]);                 }             } finally {                 if (session != null) session.close();             }         } ```  2. I start this application and see how it runs in loop outputing "session: ...." and "rs:......".  3. At some moment I turn off orient db instance.   5. I see   --- OIOException: Error on connecting to 127.0.0.1:2424/demodb  ---  but just once. On next iteration I see  ----- ODatabaseException: Cannot execute the request because an asynchronous operation is in progress. Please use a different connection -------  6. Moreover when I restore orient db instance these messages continue and database connection is not stored.  It contradicts with my intuition about expected behavior in such case.  I guess reasonable expectations are following:  1. As soon as orient is restored connection should be re-established.  2. If connection is dropped then fact of drop  should be detected and session on client side should not stay open forever.  3. Even if session is kept open then new connection should be initiated as part of pool logic. At least until pool size is exhausted.  BTW, if I start application when orient is down,and then  turn it on again I see that connection is established.  Thanks in advance, Sergey</body>
		<created>2018-04-05 22:39:54</created>
		<closed>2018-05-18 11:46:47</closed>
	</bug>
	<bug>
		<id>8179</id>
		<title>OrientDB 3.0 ST_Equals behavior</title>
		<body>### OrientDB Version: 3.0 RC2  with Spatial module  I need to find object by coordinates. Also I need to check if any object with requested coordinates exists.  I`ve inserted one object ``` {             "@type": "d",             "@rid": "#43:1",             "@version": 1,             "@class": "AddressGeo",             "address": "Some Name",             "coords": {                 "@type": "d",                 "@version": 0,                 "@class": "OPoint",                 "coordinates": [                     55.786396,                     37.58378                 ]           }  } ```  Now I am trying to find it `select * from AddressGeo where ST_Equals (coords, 'POINT (55.786396 37.58378)') = true ` **Why the result is empty?** and in this case `select ST_Equals('POINT (55.786396 37.58378)', 'POINT (55.786396 37.58378)')`  These works ``` select * from AddressGeo where ST_Within(coords, 'POINT (55.786396 37.58378)') = true  select * from AddressGeo where ST_Contains(coords, 'POINT (55.786396 37.58378)') = true  select * from AddressGeo where ST_Intersects(coords, 'POINT (55.786396 37.58378)') = true  ``` but I need to find objects by exactly requested coordinates   </body>
		<created>2018-03-28 15:21:06</created>
		<closed>2018-07-10 08:31:08</closed>
	</bug>
	<bug>
		<id>8166</id>
		<title>Batch Conditionals in v3.0.0-RC2 result in NullPointerException</title>
		<body>### OrientDB Version: 3.0.0RC2 ### Java Version: 1.8.0_151 openjdk version "1.8.0_151" OpenJDK Runtime Environment (build 1.8.0_151-8u151-b12-0ubuntu0.16.04.2-b12) OpenJDK 64-Bit Server VM (build 25.151-b12, mixed mode)   ### OS: Ubuntu 16.04.3 LTS Distributor ID:Ubuntu Description:Ubuntu 16.04.3 LTS Release:16.04 Codename:xenial  ## Expected behavior   Using the Studio UI at port 2480 in BATCH mode: `if (1 &lt; 2) { return 'yes'; }` Should return 'yes'  _Screenshot using OrientDB v2.2.15_ &lt;img width="712" alt="OrientDB v2.2.15" src="https://user-images.githubusercontent.com/18404903/37626510-901b6240-2b8d-11e8-9d3d-a7c4644c8b24.png"&gt;  ## Actual behavior   Causes NullPointerException  _Screenshot using OrientDB v3.0.0RC2_ &lt;img width="800" alt="OrientDB v3.0.0RC2" src="https://user-images.githubusercontent.com/18404903/37626518-94f3a1c4-2b8d-11e8-81a0-724fbeebdea2.png"&gt;  ## Steps to reproduce   Navigate to OrientDB UI, click on Browse, click the wrench for 'Query configuration', and change the type to BATCH. Enter the following into the text field: `if (1 &lt; 2) { return 'yes'; }`  I hope that I am simply misunderstanding the new batch requirements.  I know that there were changes with regards to newline characters and semicolons.  I cannot seem to make this work using the HTTP API or the Studio UI.</body>
		<created>2018-03-19 22:56:33</created>
		<closed>2018-03-20 08:16:23</closed>
	</bug>
	<bug>
		<id>8159</id>
		<title>Unexpected OTokenSecurityException </title>
		<body>### OrientDB Version: orientdb-community-gremlin-3.0.0RC2  ### Java Version: openjdk version "1.8.0_151" (accordingly with java -v output)   ### OS: ubuntu 16.04  ## Expected behavior   Normal query execution  ## Actual behavior   OTokenSecurityException thrown  ## Steps to reproduce   I'm not sure it is easily reporducible in any environment. So I just describe what I see.  We are develooing application relying on OrientDb.  It starts to work in expected way. However at some moment (it could take few hours or day but it happens regularly) upon call to ODatabase.query() method some kind of exception is thrown.  Stack trace looks like following:   threw exception [Request processing failed; nested exception is com.orientechnologies.orient.enterprise.channel.binary.OTokenSecurityException: missing session and token] with root cause com.orientechnologies.orient.enterprise.channel.binary.OTokenSecurityException: missing session and token         at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)         at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)         at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)         at java.lang.reflect.Constructor.newInstance(Constructor.java:423)         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:318)         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:275)         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:191)         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:153)         at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1766)         at com.orientechnologies.orient.client.remote.OStorageRemote.lambda$networkOperationRetryTimeout$2(OStorageRemote.java:226)         at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:284)         at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetryTimeout(OStorageRemote.java:214)         at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:243)         at com.orientechnologies.orient.client.remote.OStorageRemote.query(OStorageRemote.java:860)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.query(ODatabaseDocumentRemote.java:345)   It looks like problem happens on server side and exception is passed to client in serialized form.  Could you please kindly explain what could be reason to this. Shoud I tune something ?  Thanks, Sergey Reznick  </body>
		<created>2018-03-14 22:17:25</created>
		<closed>2018-03-15 13:56:10</closed>
	</bug>
	<bug>
		<id>8151</id>
		<title>Deep traversal doesn't appear to work as expected</title>
		<body>### OrientDB Version: &lt;version here&gt;   3.0.0RC1  ### Java Version: &lt;version here&gt;   openjdk:8-jdk-alpine (Using Orient Server from the official 3.0.0 RC1 docker image)  ### OS: &lt;os here&gt;   Linux (Server), Both Linux and Windows (Client)   ## Expected behavior   Query 1 result is; 1 2.1 1.1.1 1.1 1.1.1 2 2.1 1.1.1 1.1 1.1.1  Query 2 result is: The counts of nodes in the result is: Node  Count 1         1 2         1 1.1      2 2.1      2 1.1.1   4  ## Actual behavior   Query 1 result is: 1 2.1 1.1 1.1.1 2 2.1 1.1.1 1.1  i.e. doesn't seem to matching 1.1.1 via. the paths 1-&gt;2.1-&gt;1.1.1 or 2-&gt;1.1-&gt;1.1.1  Query 2 result is: 1         1 2         1 1.1      2 2.1      2 1.1.1   2 i.e. if consistent with query 1, is not matching 1.1.1 via. the paths 1-&gt;2.1-&gt;1.1.1 or 2-&gt;1.1-&gt;1.1.1  ## Steps to reproduce   I have an orient the following graph as follows.  1-&gt;1.1 2-&gt;2.1  2-&gt;1.1 1-&gt;2.1  1.1-&gt;1.1.1 2.1-&gt;1.1.1  I'm trying to run a query to present the graph structure rooted at 1 and 2 (as a depth first tree): In accordance with the notes on #5804 and https://orientdb.com/docs/last/SQL-Match.html I run the following a query to present the graph structure rooted at RISK (as a depth first tree):  query 1: SELECT dp,vtx.ID FROM (MATCH {class: Risk, as: orig}.in("mitigates","implements") {as: vtx, while: ($depth &lt; 100),depthAlias:dp, pathAlias:pth} RETURN dp,vtx, [orig.@rid] || pth as loc ORDER BY orig.@rid,loc.asString() desc)  I get the Actual Behaviour I was expecting the Expected Behaviour  In case the query 1 is too complicated, I tried the query below: query 2: MATCH {class: Risk, as: orig}.in("mitigates","implements") {as: vtx, while: ($depth &lt; 100)} RETURN vtx.ID  I get the Actual Behaviour I was expecting the Expected Behaviour  For convenience - here are some orient queries to set up a test database to reproduce this:  #Setup CREATE CLASS Thing EXTENDS V CREATE PROPERTY Thing.ID STRING  CREATE CLASS RISK EXTENDS Thing CREATE CLASS RISKCONTROL EXTENDS Thing CREATE CLASS REQUIREMENT EXTENDS Thing  CREATE CLASS mitigates EXTENDS E   CREATE VERTEX RISK SET ID="1" CREATE VERTEX RISK SET ID="2"  CREATE VERTEX RISKCONTROL SET ID="1.1" CREATE VERTEX RISKCONTROL SET ID="2.1"  CREATE VERTEX REQUIREMENT SET ID="1.1.1"   CREATE EDGE mitigates FROM (SELECT FROM RISKCONTROL WHERE ID="1.1") TO (SELECT FROM RISK WHERE ID="1")  CREATE EDGE mitigates FROM (SELECT FROM RISKCONTROL WHERE ID="2.1") TO (SELECT FROM RISK WHERE ID="2")  CREATE EDGE mitigates FROM (SELECT FROM RISKCONTROL WHERE ID="1.1") TO (SELECT FROM RISK WHERE ID="2")  CREATE EDGE mitigates FROM (SELECT FROM RISKCONTROL WHERE ID="2.1") TO (SELECT FROM RISK WHERE ID="1")  CREATE EDGE implements FROM (SELECT FROM REQUIREMENT WHERE ID="1.1.1") TO (SELECT FROM RISKCONTROL WHERE ID="1.1")   CREATE EDGE implements FROM (SELECT FROM REQUIREMENT WHERE ID="1.1.1") TO (SELECT FROM RISKCONTROL WHERE ID="2.1")   #Query 1 SELECT dp,vtx.ID FROM (MATCH {class: Risk, as: orig}.in("mitigates","implements") {as: vtx, while: ($depth &lt; 100),depthAlias:dp, pathAlias:pth} RETURN dp,vtx, [orig.@rid] || pth as loc ORDER BY orig.@rid,loc.asString() desc) #Query 2 MATCH {class: Risk, as: orig}.in("mitigates","implements") {as: vtx, while: ($depth &lt; 100)} RETURN vtx.ID </body>
		<created>2018-03-09 13:23:31</created>
		<closed>2018-03-12 17:29:40</closed>
	</bug>
	<bug>
		<id>8148</id>
		<title>Make ODiskWriteAheadLog#cutAllSegmentsSmallerThan is not thread safe</title>
		<body>ODiskWriteAheadLog#cutAllSegmentsSmallerThan is not really threadsafe. We should use ordered read locks instead of the map inside of implementation.</body>
		<created>2018-03-09 07:57:39</created>
		<closed>2018-05-04 03:01:59</closed>
	</bug>
	<bug>
		<id>8140</id>
		<title>Wrong exception on setDefaultClusterId</title>
		<body>### OrientDB Version: 3.0.0RC2 ### Java Version: 8 ### OS: Ubuntu 17.10    ## Expected behavior   Default cluster id changes.  ## Actual behavior   Receive exception when try to change default cluster id. com.orientechnologies.orient.core.exception.OSchemaException: Cluster with id '33' do not exists  com.orientechnologies.orient.core.metadata.schema.OClassRemote `` public void setDefaultClusterId(final int defaultClusterId) {     final ODatabaseDocumentInternal database = getDatabase();     String clusterName = database.getClusterNameById(defaultClusterId);     if (clusterName != null)         throw new OSchemaException("Cluster with id '" + defaultClusterId + "' do not exists"); `` It looks like wrong "clusterName" checking.   </body>
		<created>2018-03-06 07:56:10</created>
		<closed>2018-03-06 11:54:22</closed>
	</bug>
	<bug>
		<id>8135</id>
		<title>OOM Exception on Fetching Records with the help of functions</title>
		<body>### OrientDB Version: 2.2.32 ### Java Version: 1.8 ### OS: ubuntu  Basic Sample Query: Select *, price() as price from Books Where price returns simply an integer or some value ## Expected behavior   Fetch all the records from Books Class along with price column  ## Actual behavior   UnsuportedOperationException: Operation is not supported because may cause OOM Exception  ## Steps to reproduce   1. create a function that returns a value, could be string or integer or what ever 2. Execute select from Class query 3. Now add function as additional column to select query Basic Sample Query: Select *, price() as price from Books Basic Sample Function(javascript): price(){ return 5; }  In my older version 2.2.17 all the functions are working fine. The issue is only with 2.2.32 @laa @lvca @luigidellaquila Please respond ASAP. thanks.  </body>
		<created>2018-03-02 10:22:01</created>
		<closed>2018-03-02 12:03:48</closed>
	</bug>
	<bug>
		<id>8129</id>
		<title>Error parsing MATCH query with "class" and "while" clauses</title>
		<body>### OrientDB Version: 2.2.30 ### Java Version: OpenJDK 8 ### OS: Linux    ## Expected behavior Regardless of other `while` and `where` clauses, a MATCH statement's `class: Foo` clause should behave identically to a `where: (@this INSTANCEOF 'Foo')`.  For example, the following two queries should behave identically, without errors, and return the same rows (the only difference is below the `out('Quux_Quux')` part): ``` MATCH {     class: Foo,     as: Foo___1 }.out('Foo_Bar') {     class: Bar,     as: Bar___1 }.out('Bar_Quux') {     as: Quux___1 }.out('Quux_Quux') {     class: Special_Quux,     while: ($depth &lt; 5),     where: (name = 'SQ1'),     as: Special_Quux___1 } RETURN $matches ``` and ``` MATCH {     class: Foo,     as: Foo___1 }.out('Foo_Bar') {     class: Bar,     as: Bar___1 }.out('Bar_Quux') {     as: Quux___1 }.out('Quux_Quux') {     while: ($depth &lt; 5),     where: ((name = 'SQ1') and (@this INSTANCEOF 'Special_Quux')),     as: Special_Quux___1 } RETURN $matches ```  ## Actual behavior   The first query produces a strange error: ``` Error on parsing query Query: (select from null) ```  The second query runs correctly and returns the correct outputs.  ## Steps to reproduce   Here's a sample schema and data that exhibit this problem: ``` CREATE CLASS Foo EXTENDS V CREATE CLASS Bar EXTENDS V CREATE CLASS Quux EXTENDS V CREATE CLASS Special_Quux EXTENDS Quux  CREATE CLASS Foo_Bar EXTENDS E CREATE CLASS Bar_Quux EXTENDS E CREATE CLASS Quux_Quux EXTENDS E  CREATE VERTEX Foo SET name = 'FooA' CREATE VERTEX Foo SET name = 'FooB' CREATE VERTEX Foo SET name = 'FooC'  CREATE VERTEX Bar SET name = 'BarA' CREATE VERTEX Bar SET name = 'BarB' CREATE VERTEX Bar SET name = 'BarC'  CREATE VERTEX Quux SET name = 'Q' CREATE VERTEX Special_Quux SET name = 'SQ1' CREATE VERTEX Special_Quux SET name = 'SQ2'  # Link up Foo -&gt; Bar, matching up letters CREATE EDGE Foo_Bar FROM (SELECT * FROM Foo WHERE name = 'FooA') TO (SELECT * FROM Bar WHERE name = 'BarA') CREATE EDGE Foo_Bar FROM (SELECT * FROM Foo WHERE name = 'FooB') TO (SELECT * FROM Bar WHERE name = 'BarB') CREATE EDGE Foo_Bar FROM (SELECT * FROM Foo WHERE name = 'FooC') TO (SELECT * FROM Bar WHERE name = 'BarC')  # Link up Bar "BarA" -&gt; Quux "Q", other Bars -&gt; Special_Quux "SQ2" CREATE EDGE Bar_Quux FROM (SELECT * FROM Bar WHERE name = 'BarA') TO (SELECT * FROM Quux WHERE name = 'Q') CREATE EDGE Bar_Quux FROM (SELECT * FROM Bar WHERE name = 'BarB') TO (SELECT * FROM Special_Quux WHERE name = 'SQ2') CREATE EDGE Bar_Quux FROM (SELECT * FROM Bar WHERE name = 'BarC') TO (SELECT * FROM Special_Quux WHERE name = 'SQ2')  # Link Quux "Q" -&gt; Special_Quux "SQ1" CREATE EDGE Quux_Quux FROM (SELECT * FROM Quux WHERE name = 'Q') TO (SELECT * FROM Special_Quux WHERE name = 'SQ1') ```  The problematic query is similar to the one in issue #7823, but the symptoms are different (this time we get a parse error instead of no results) and that issue was closed and fixed in 2.2.30. In contrast, this issue is still present in 2.2.30.  </body>
		<created>2018-02-28 22:17:24</created>
		<closed>2018-03-01 12:08:02</closed>
	</bug>
	<bug>
		<id>8113</id>
		<title>BYTE field behavior</title>
		<body>### OrientDB Version: 3.0 RC1 &lt;version here&gt;   ### Java Version: &lt;version here&gt;   ### OS: debian 9&lt;os here&gt;   ## Expected behavior   &lt;add here&gt;   I have a field of type BYTE used as status field like 1,2,3 and etc. In orientdb web studio I created a record with status = 1  http://joxi.ru/LmG9BWBuR0Gk7A I expected to have this records returned with filter "where status = 1"  ## Actual behavior   I made a query like "select * from Class where status = 1" and got 0 records. Simple select without filter returns me this http://joxi.ru/823dBYBi60Y7WA  It works only if status value is like " status='1' " but 1 is not a string  ## Steps to reproduce   &lt;add here&gt;   </body>
		<created>2018-02-20 09:53:34</created>
		<closed>2018-02-23 16:11:17</closed>
	</bug>
	<bug>
		<id>8111</id>
		<title>Dependency Conflict: duplicate classes "com.orientechnologies.orient.server.network.protocol.http.OHttpGraphResponse" in different JARs, have different implmentations.</title>
		<body>### OrientDB Version: &lt;3.0.0-SNAPSHOT&gt;   ### Java Version: &lt;1.7&gt;   ### OS: win10  ## Expected behavior    By analyzing the module orientdb/distribution-tp2, we found it depends on two JARs: com.orientechnologies:orientdb-server:3.0.0-20180219.092740-1154  and com.orientechnologies:orientdb-graphdb:3.0.0-20180219.092746-1154. These two JARs contain a same class "com.orientechnologies.orient.server.network.protocol.http.OHttpGraphResponse", but the implementations of these duplicate classes are different:  One method only exists in com.orientechnologies:**orientdb-graphdb**: 3.0.0-20180219.092746-1154::  [com.orientechnologies:orientdb-community-tp2:3.0.0-SNAPSHOT::null-&gt;com.orientechnologies:orientdb-graphdb:3.0.0-20180219.092746-1154::compile] :  **com.orientechnologies.orient.server.network.protocol.http.OHttpGraphResponse: void writeEdge(com.tinkerpop.blueprints.impls.orient.OrientEdge,com.orientechnologies.orient.core.serialization.serializer.OJSONWriter)**   As the JVM only load the classes present first on the classpath and shadow the other duplicate ones with the same names. The dependency conflict problem brings high risks of "NoSuchMethodException" or "NoSuchMethodError"  issues at runtime. Please notice this problem. </body>
		<created>2018-02-19 13:09:37</created>
		<closed>2019-01-04 16:04:31</closed>
	</bug>
	<bug>
		<id>8097</id>
		<title>misleading error at start of the server.</title>
		<body>### OrientDB Version: 3.0.0-20180212 ### Java Version: 1.8 ### OS: Centos  As I'm reviewing this errors that show up in the log when starting the server with @luigidellaquila . we saw this error and  it seems that it's not an error but actually more of info.  the error message is misleading.    `- error in log [OVariableParser.resolveVariables] Error on resolving property: distributed  ` Thanks, Safwan</body>
		<created>2018-02-12 22:13:40</created>
		<closed>2018-07-10 08:31:59</closed>
	</bug>
	<bug>
		<id>8093</id>
		<title>Misleading exception when Schema/Table is not defined in the database.</title>
		<body>### OrientDB Version: 3.0.0-20180212 ### Java Version: 1.8 ### OS: Centos   Hi,  If you attempt to createVertex with an undefined schema, it'll give a misleading exception.  This happens when the vertex is created inside of a Hook.   `java.lang.NullPointerException when createVertex is null.`  Syntax: `OVertex indexVertex = database.newVertex(targetTable);`  Thanks, Safwan</body>
		<created>2018-02-12 21:53:54</created>
		<closed>2018-02-13 09:25:05</closed>
	</bug>
	<bug>
		<id>8092</id>
		<title>Critical: Embedded LiveQuery causes a stackoverflow.</title>
		<body>### OrientDB Version: 3.0.0-20180212 ### Java Version: 1.8 ### OS: Centos  Hi,  As of recent update LiveQuery causes a stackoverflow when an action triggers LiveQuery.  I've commented all my code in the implementation of OLiveQueryResultListener and it still crashes.  having  `database.live("select from Person", liveQueryListener);`  will crash.  The release I have before then is the 30th of January.  Thanks, Safwan   </body>
		<created>2018-02-12 21:50:33</created>
		<closed>2018-02-13 14:39:27</closed>
	</bug>
	<bug>
		<id>8088</id>
		<title>NullPointerException using an non existing index in SQL</title>
		<body>### OrientDB Version: 3.0.0.RC1 ### Java Version: _   ### OS: Windows 10  Using Studio, got a NullPointerException in my SELECT execution caused by the use of an index that does not exist (a typo in my case). The original error was obviously on my side, but I guess you would like to provide a better error message in such case.  The SQL looks like this one: ``` SELECT FROM INDEX:ndexthatdoesnotexist ```  The stacktrace is the following: ```` java.lang.NullPointerException at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.calculateTargetClusters(OSelectExecutionPlanner.java:343) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.calculateShardingStrategy(OSelectExecutionPlanner.java:174) at com.orientechnologies.orient.core.sql.executor.OSelectExecutionPlanner.createExecutionPlan(OSelectExecutionPlanner.java:64) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.createExecutionPlan(OSelectStatement.java:264) at com.orientechnologies.orient.core.sql.parser.OSelectStatement.execute(OSelectStatement.java:242) at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:59) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:545) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:174) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:84) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:172) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:633) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:82) ````  </body>
		<created>2018-02-09 10:52:27</created>
		<closed>2018-02-09 11:37:53</closed>
	</bug>
	<bug>
		<id>8086</id>
		<title>Custom OClusterSelectionStrategy does not appear in studio manager dropdown</title>
		<body>### OrientDB Version: 2.1 and 2.2 ### Java Version: 1.8  ### OS: centos7  ## Expected behavior   The name of the OClusterSelectionStrategy implementation should appear in the orientdb's schema manager (UI)   ## Actual behavior   The dropdown in the UI contains a blank string. When deselecting it, and re-opening the drop down, the "name" does not appear. It would be nice if the system populated the dropdown with all the "name"s of the implementation of OClusterSelectionStrategy loaded. And error appears after some time - in the lower error "bar".  **See attached screen-shots:** &lt;img width="1088" alt="screen_shot_2018-02-07_at_9 53 08_am" src="https://user-images.githubusercontent.com/25620872/35992913-8f209c0c-0cc0-11e8-920a-5a9e0926f019.png"&gt; ![screen_shot_2018-02-08_at_9 14 42_am](https://user-images.githubusercontent.com/25620872/35992916-8f492cda-0cc0-11e8-9015-63343639d472.png)  ## Steps to reproduce   1) Follow direction for 2.2/Cluster-Selection.html, the "random" implementation will suffice. 2) deploy the jar into orientdb's lib folder, restart the orientdb service/server. 3) connect to the database -&gt;     CONNECT remote:localhost/&lt;db-name&gt; &lt;username&gt; &lt;password&gt; 4) activate the custom implementation -&gt;     ALTER CLASS messages CLUSTERSELECTION random       where "messages" is the class being altered. 5) verify the cluster selection is activated with "info class &lt;class-name&gt; 6) open the orient db UI, http://&lt;host&gt;:&lt;port&gt;/studio/index.html#/database/&lt;db-name&gt;/schema  7) Find the altered class in the manager... </body>
		<created>2018-02-08 19:10:33</created>
		<closed>2018-03-26 11:14:17</closed>
	</bug>
	<bug>
		<id>8080</id>
		<title>so easy to broke db?</title>
		<body>### OrientDB Version: &lt;version here&gt;   ### Java Version: &lt;version here&gt;   ### OS: &lt;os here&gt;   debian 9, orietdb 3.0 ## Expected behavior   working condition ## Actual behavior    Once I decided to alter column type. I dont remember exactly the types but it could be byte and integer. Then somehow I got error about value range and after page reload I saw that orientdb saved this range.. I was working with db for a days without critical errors except that I always saw the same errors after altering column.  And recently I decided to reload db server... Since I cant connect to the db from anywhere. I see this error and cannot access to the db  and I dont even know where error is. the error: ``` code:500 content:"java.lang.NumberFormatException: Value out of range. Value:"256" Radix:10" reason:500 ``` lost my DB ## Steps to reproduce   &lt;add here&gt;    </body>
		<created>2018-02-07 13:37:40</created>
		<closed>2018-05-04 03:02:23</closed>
	</bug>
	<bug>
		<id>8037</id>
		<title>Batch scripts are not working with params.</title>
		<body>### OrientDB Version: 3.0.0 RC1 ### Java Version: 1.8 ### OS: Centos  batch scripts are not working with params.  In the code below name is always empty in the database.     private static void batchScriptParams(ODatabaseDocument db)     {         String script =                 "BEGIN;" +                         "LET $a = CREATE VERTEX V SET name = :_name;" +                         "LET $b = CREATE VERTEX V SET name = :_name2;" +                         "LET $edge = CREATE EDGE E from $a to $b;" +                         "COMMIT;" +                         "RETURN $edge;";          HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;();         map.put(":_name", "bozo");         map.put(":_name2", "bozi");         map.put("_name", "bozo");         map.put("_name2", "bozi");          OResultSet rs = db.execute("sql", script, map);         while (rs.hasNext())         {             OResult row = rs.next();         }          rs.close();     }  Regards, Safwan</body>
		<created>2018-01-30 07:26:08</created>
		<closed>2018-02-01 15:18:31</closed>
	</bug>
	<bug>
		<id>8029</id>
		<title>One problematic record stops execution of query over all table</title>
		<body>### OrientDB Version: 2.2.30  ### Java Version: 8  ### OS: Ubuntu    Issue how we observed it:  Search query over a specific table stop working with the exception:  ```java java.lang.IllegalArgumentException: Cluster 1131 is null      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getClusterById(OAbstractPaginatedStorage.java:3021)      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1408)      at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3411)      at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:2022)      at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:187)      at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:162)      at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:291)      at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1739)      at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:103)      at com.orientechnologies.orient.core.record.impl.ODocument.field(ODocument.java:828)      at com.orientechnologies.orient.core.sql.filter.OSQLFilterItemFieldMultiAbstract.getValue(OSQLFilterItemFieldMultiAbstract.java:66)      at com.orientechnologies.orient.core.sql.filter.OSQLFilterCondition.evaluate(OSQLFilterCondition.java:379)      at com.orientechnologies.orient.core.sql.filter.OSQLFilterCondition.evaluate(OSQLFilterCondition.java:88)      at com.orientechnologies.orient.core.sql.filter.OSQLFilter.evaluate(OSQLFilter.java:105)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.evaluateRecord(OCommandExecutorSQLResultsetAbstract.java:422)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.filter(OCommandExecutorSQLResultsetAbstract.java:412)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:609)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1637)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1584)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:522)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:485)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:70)      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3421)      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3339)      at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78)      at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74)      at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:99)      at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)      at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:760) ``` SQL is pretty simple:  ```sql select from MyE where any() contains "text" ```  During debuging we found that some records in MyE in field "in" contains references to already not existing vertex. Not sure how such edges appears, but it's not first time when I see it: and not only on edges. So, it seems that `any()` (and might be some other such filters) doesn't properly handle situation when reference is broken.</body>
		<created>2018-01-28 23:22:40</created>
		<closed>2018-05-04 03:02:59</closed>
	</bug>
	<bug>
		<id>8013</id>
		<title>shortestPath() returns ArrayIndexOutOfBoundsException </title>
		<body>### OrientDB Version: 2.2.31 ### Java Version: 1.8 ### OS: Ubuntu 16.04  ## Actual behavior   After upgrading OrientDB from version 2.2.29 to 2.2.31 passing a direction to `shortestPath()` function results in the following error: ``` Error: java.lang.ArrayIndexOutOfBoundsException: 3 ```  ## Steps to reproduce   I broke it down to this example: ``` CREATE CLASS Person EXTENDS V CREATE CLASS Restaurant EXTENDS V CREATE VERTEX Person SET name='Luca' CREATE VERTEX Restaurant SET name='Dante', type='Pizza' CREATE CLASS Eat EXTENDS E CREATE EDGE Eat FROM ( SELECT FROM Person WHERE name='Luca' ) TO ( SELECT FROM Restaurant WHERE name='Dante' ) ```  Performing shortestPath with direction `OUT`: ``` SELECT shortestPath($person[0].rid, $restaurant[0].rid, "OUT") LET $person = (select @rid from Person where name = "Luca"), $restaurant = (select @rid from Restaurant where name = "Dante")  Error: java.lang.ArrayIndexOutOfBoundsException: 3 ```  Removing the direction works as expected: ``` SELECT shortestPath($person[0].rid, $restaurant[0].rid) LET $person = (select @rid from Person where name = "Luca"), $restaurant = (select @rid from Restaurant where name = "Dante") +----+--------------+ |#   |shortestPath  | +----+--------------+ |0   |[#73:0,#105:0]| +----+--------------+  1 item(s) found. Query executed in 0.007 sec(s). ```</body>
		<created>2018-01-19 14:01:49</created>
		<closed>2018-01-19 14:41:58</closed>
	</bug>
	<bug>
		<id>8012</id>
		<title>Find files broken while write data to orientdb 2.2.30</title>
		<body>### OrientDB Version: 2.2.30   ### Java Version: 1.8  ### OS: centos 7  ## Expected behavior   ``` Caused by: com.orientechnologies.orient.core.exception.OPageIsBrokenException: Following files and pages are detected to be broken ['ner_16.pcl' :138;], storage is switched to 'read only' mode. Any modification operations are prohibited. Typically it means hardware error, before filling a bug please check your hardware. To restore database and make it fully operational you may export and import database to and from JSON. DB name="db_skynet" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkLowDiskSpaceRequestsAndReadOnlyConditions(OAbstractPaginatedStorage.java:5130) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:1342) at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage$5.call(ODistributedStorage.java:644) at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage$5.call(ODistributedStorage.java:638) at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage$11.call(ODistributedStorage.java:1220) at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70) at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.executeRecordOperationInLock(ODistributedStorage.java:1217) at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.createRecord(ODistributedStorage.java:637) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2216) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:241) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:171) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2782) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2662) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:103) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createRecord(ONetworkProtocolBinary.java:2844) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createRecord(ONetworkProtocolBinary.java:1832) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:629) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:398) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:217) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:82) 2018-01-19_17:22:44 [Executor task launch worker-1] WARN orientdb.graph.dao.impl.GraphDaoImpl:215: renew and try again! tryCount: 1 2018-01-19_17:22:44 [Executor task launch worker-1] ERROR orientechnologies.orient.client.binary.OChannelBinaryAsynchClient:143: Error during exception deserialization java.lang.NoSuchMethodException: com.orientechnologies.orient.core.exception.OPageIsBrokenException.&lt;init&gt;(com.orientechnologies.orient.core.exception.OPageIsBrokenException) ```    </body>
		<created>2018-01-19 09:25:15</created>
		<closed>2019-05-10 10:47:00</closed>
	</bug>
	<bug>
		<id>8007</id>
		<title>DROP INDEX succeeds even with invalid index name</title>
		<body>### OrientDB Version: 2.2.30 ### Java Version: OpenJDK 8 ### OS: Linux    ## Expected behavior   The following command should either produce an error, or return a `value` of `0` since no index was dropped: ``` DROP INDEX DefinitelyDoesNotExist ```  ## Actual behavior   The above command returns `value: 1`, the same as if an index was actually dropped.  ## Steps to reproduce   Just run the above command.  </body>
		<created>2018-01-17 00:17:17</created>
		<closed>2018-01-17 11:42:28</closed>
	</bug>
	<bug>
		<id>8005</id>
		<title>Full Backup error. Wal file not found</title>
		<body>### OrientDB Version: 2.2.31 ### Java Version: 1.8.152 ### OS: linux ## Expected behavior   on version 2.2.21 all backup was good  ## Actual behavior   On version 2.2.31 we catching errors  ``` $ANSI{green {db=vis_demo}} Error on backup of database 'plocal:/opt/orientdb-community-2.2.31/databases/vis_demo' to directory: /opt/backup/orient/ java.lang.IllegalArgumentException: Directory /opt/orientdb-community-2.2.31/databases/vis_demo/vis_demo.9.wal not found         at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:145)         at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)         at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.compressDirectory(OZIPCompressionUtil.java:57)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.backup(OLocalPaginatedStorage.java:229)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.backup(ODatabaseDocumentTx.java:3060)         at com.orientechnologies.orient.server.handler.OAutomaticBackup.fullBackupDatabase(OAutomaticBackup.java:353)         at com.orientechnologies.orient.server.handler.OAutomaticBackup$1.run(OAutomaticBackup.java:183)         at java.util.TimerThread.mainLoop(Timer.java:555)         at java.util.TimerThread.run(Timer.java:505)  ``` in results we have 2018-01-16 03:56:51:640 INFO  Automatic Backup finished: 5 ok, 3 errors   ## Steps to reproduce    /opt/orientdb-community-2.2.31/config/automatic-backup.json ``` {   "enabled": true,   "mode": "FULL_BACKUP",   "exportOptions": "",   "delay": "24h",   "firstTime": "03:15:00",   "targetDirectory": "/opt/backup/orient",   "targetFileName": "${DBNAME}-${DATE:yyyyMMdd}.zip",   "compressionLevel": 9,   "bufferSize": 1048576 }  ```  [orientdb.zip](https://github.com/orientechnologies/orientdb/files/1633671/orientdb.zip)  </body>
		<created>2018-01-16 04:57:37</created>
		<closed>2018-03-15 13:13:59</closed>
	</bug>
	<bug>
		<id>8004</id>
		<title>Old DB data seems not properly updated by newer DB</title>
		<body>### OrientDB Version: 2.2.31 (Using DB of 2.2.29) ### Java Version: 8u152 ### OS: RHEL7.4  ## Steps to reproduce   1. Create 2.2.29 DB 2. Update to 2.2.31 3. Try to stop DB  ## Expected behavior   Cleanly stops  ## Actual behavior   Stops with error saying it could not update a wal.. It does not seem to reproduce with a freshly created DB though.  ``` com.orientechnologies.common.io.OIOException: Error during appending of new segment to the WAL     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.appendNewSegment(ODiskWriteAheadLog.java:1156)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:3707)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:4397)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:580) ... Caused by: java.io.FileNotFoundException: ~/managementdb/hedgedb/hedgedb.2.wal (No such file or directory)     at java.io.RandomAccessFile.open0(Native Method)     at java.io.RandomAccessFile.open(RandomAccessFile.java:316)     at java.io.RandomAccessFile.&lt;init&gt;(RandomAccessFile.java:243)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV2.getRndFile(OLogSegmentV2.java:397)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV2.init(OLogSegmentV2.java:441)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.appendNewSegment(ODiskWriteAheadLog.java:627)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.appendNewSegment(ODiskWriteAheadLog.java:1153)     ... 20 common frames omitted ```</body>
		<created>2018-01-15 23:35:58</created>
		<closed>2019-05-10 10:47:42</closed>
	</bug>
	<bug>
		<id>8000</id>
		<title>CREATE EDGE ... CONTENT doesn't work</title>
		<body>### OrientDB Version: 3.0.0-SNAPSHOT   ### Java Version: 1.8 ### OS: CentOS  If create a edge use this sql: ``` CREATE EDGE invest1 FROM (SELECT FROM Person WHERE _key="5fdaac8bdd1bb190149926974433a3be") TO (SELECT FROM Company WHERE _key="680d0edb49b9792456c7a1045f446e19") CONTENT { "name": "Jay", "surname": "Miner" } ``` then the values are missing. Then I use this sql: ``` CREATE EDGE invest1 FROM (SELECT FROM Person WHERE _key="5fdaac8bdd1bb190149926974433a3be") TO (SELECT FROM Company WHERE _key="680d0edb49b9792456c7a1045f446e19") SET brand = 'fiat', name = 'wow' ``` It works well. Below is the select result of them. ``` +----+--------+-------+----------+----------+-----+----+ |#   |@RID    |@CLASS |out       |in        |brand|name| +----+--------+-------+----------+----------+-----+----+ |0   |#66:5000|invest1|#30:123233|#28:193011|fiat |wow | |1   |#67:5000|invest1|#30:123233|#28:193011|     |    | +----+--------+-------+----------+----------+-----+----+ ``` </body>
		<created>2018-01-12 10:53:29</created>
		<closed>2018-01-16 17:32:01</closed>
	</bug>
	<bug>
		<id>7998</id>
		<title>Getting error com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/../employeeDb' with mode=rw</title>
		<body>### OrientDB Version: 2.2.30   ### Java Version: 8   ### OS: Docker image  ## Expected behavior   It should connect to database    ## Actual behavior    `Exception '38A1B784' in storage 'plocal:/../employeeDb': 2.2.30 (build 43d850df23c0fd1edca7279761c2238fdc6cc576, branch 2.2.x) com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/../employeeDb' with mode=rw DB name="employeeDb" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:326) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:259) at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:995) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:974) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:947) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:938) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.openDatabase(ONetworkProtocolBinary.java:914) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.handshakeRequest(ONetworkProtocolBinary.java:248) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:213) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:82) Caused by: java.lang.ArrayIndexOutOfBoundsException: 1743 at com.orientechnologies.orient.core.config.OStorageConfiguration.fromStream(OStorageConfiguration.java:529) at com.orientechnologies.orient.core.storage.impl.local.OStorageConfigurationSegment.load(OStorageConfigurationSegment.java:138) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:270) ... 9 more `  ## Steps to reproduce   We don't know what happened, all of a sudden its starting to show this error, after stopping and restarting docker container    </body>
		<created>2018-01-11 11:49:38</created>
		<closed>2018-03-20 14:08:42</closed>
	</bug>
	<bug>
		<id>7985</id>
		<title>OCommandExecutionException "Class not found" when trying to GraphTraversal.hasNext</title>
		<body>### OrientDB Version: 3.0.0RC1 ### Java Version: OpenJDK Runtime Environment (build 1.8.0_151-8u151-b12-0ubuntu0.16.04.2-b12) ### OS: Ubuntu 16.04  ## Expected behavior   This code to work: ```java // Using org.apache.tinkerpop:tinkergraph-gremlin:3.3.0 and com.orientechnologies:orientdb-gremlin:3.0.0RC1 // import org.apache.tinkerpop.gremlin.process.traversal.dsl.graph.GraphTraversal; // graph variable is an instance of org.apache.tinkerpop.gremlin.structure.Graph  GraphTraversal&lt;Vertex, Vertex&gt; rootTraversal = graph.traversal().V().hasLabel("Root"); if (rootTraversal.hasNext()) { Object rootVertexId = rootTraversal.next().id(); } ```  ## Actual behavior   Following exception is thrown: ``` com.orientechnologies.orient.core.exception.OCommandExecutionException: Class not found: `Root` DB name="mydb" DB name="mydb" at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:423) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:318) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:275) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:191) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:153) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1693) at com.orientechnologies.orient.client.remote.OStorageRemote.lambda$networkOperationRetryTimeout$2(OStorageRemote.java:226) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:279) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetryTimeout(OStorageRemote.java:214) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationNoRetry(OStorageRemote.java:239) at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:867) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.command(ODatabaseDocumentRemote.java:360) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.lambda$executeSql$2(OrientGraph.java:254) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.executeWithConnectionCheck(OrientGraph.java:193) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.executeSql(OrientGraph.java:252) at org.apache.tinkerpop.gremlin.orientdb.OrientGraphQuery.execute(OrientGraphQuery.java:30) at org.apache.tinkerpop.gremlin.orientdb.traversal.step.sideEffect.OrientGraphStep.lambda$elements$6(OrientGraphStep.java:78) at java.util.Optional.map(Optional.java:215) at org.apache.tinkerpop.gremlin.orientdb.traversal.step.sideEffect.OrientGraphStep.elements(OrientGraphStep.java:77) at org.apache.tinkerpop.gremlin.orientdb.traversal.step.sideEffect.OrientGraphStep.vertices(OrientGraphStep.java:47) at org.apache.tinkerpop.gremlin.orientdb.traversal.step.sideEffect.OrientGraphStep.lambda$new$0(OrientGraphStep.java:39) at org.apache.tinkerpop.gremlin.process.traversal.step.map.GraphStep.processNextStart(GraphStep.java:139) at org.apache.tinkerpop.gremlin.process.traversal.step.util.AbstractStep.hasNext(AbstractStep.java:143) at org.apache.tinkerpop.gremlin.process.traversal.util.DefaultTraversal.hasNext(DefaultTraversal.java:192)  ```  </body>
		<created>2018-01-05 10:49:57</created>
		<closed>2018-01-05 13:05:57</closed>
	</bug>
	<bug>
		<id>7979</id>
		<title>[Question]`IS DEFINED` syntax cannot use in 3.0?</title>
		<body>### OrientDB Version: orientdb-community-spatial-3.0.0RC1.tar.gz ### Java Version: 1.8 ### OS: centos 6.8  login the demodb execute the sql below ```select from v where id is defined```   ## Expected behavior   get the data where id is defined  ## Actual behavior   get an exception ``` {   "errors": [     {       "reason": 501,       "code": 501,       "content": "java.lang.UnsupportedOperationException: TODO Implement IS DEFINED!!!"     }   ] } ```  so, `IS DEFINED` syntax cannot use in 3.0? it's an import feature for me, and 2.2.x have it </body>
		<created>2018-01-03 08:03:04</created>
		<closed>2018-01-03 13:24:45</closed>
	</bug>
	<bug>
		<id>7962</id>
		<title>'select $path from traverse' return null</title>
		<body>### OrientDB Version: &lt;3.0.0RC1 community edition No Gremlin support&gt;   ### Java Version: &lt; 1.8.0_144 &gt;   ### OS: &lt;CentOS 7&gt;    according to this [documentation](http://orientdb.com/docs/3.0.x/sql/SQL-Traverse.html), one can use $path, $stack when traverse. So I run a SQL like  ``` select $path from (traverse both() from #153:28622 maxdepth 2 strategy breadth_first) ```  The result is a list and all elements within are nulls.  But the result of the 'traverse' sub-command is not empty. I tried the SQL above through orientdb-self-provided web page as well as ODatabaseSession.query(), it just won't work.   FYI, according to my tests, the only context variable that works is $depth.</body>
		<created>2017-12-22 10:46:31</created>
		<closed>2017-12-27 12:50:00</closed>
	</bug>
	<bug>
		<id>7961</id>
		<title>Truncate</title>
		<body>### OrientDB Version: orientdb-community-2.2.19    ### Java Version: 1.8.0_144   ### OS: Linux version 2.6.32-431.el6.x86_64  (CentOS)  ## Expected behavior   ![normal](https://user-images.githubusercontent.com/34740749/34254731-3b1eca1a-e66f-11e7-8199-d06ccf4b6ab1.png)  ## Actual behavior   Requests made on the WebStudio clip data up to 10 characters. A query executed in the console.sh produces the correct data. In the backup file obtained through exporting the database in WebStudio, the data is also truncated. What configuration can be responsible for this behavior? ![fail](https://user-images.githubusercontent.com/34740749/34254735-40cb1d24-e66f-11e7-9756-3454fc4ab2a4.png)  ## Steps to reproduce     </body>
		<created>2017-12-21 11:52:26</created>
		<closed>2017-12-29 07:16:02</closed>
	</bug>
	<bug>
		<id>7934</id>
		<title>v3.0 compile error</title>
		<body>### OrientDB Version: 3.0.0.SNAPSHORT ### Java Version: 1.8 ### OS: CentOS   When I run `mvn clean install -DskipTests`, I get below exception. But the compile can run successful. ``` [INFO] --- maven-bundle-plugin:3.0.1:manifest (bundle-manifest) @ orientdb-core --- [INFO] [INFO] --- javassist-maven-plugin:1.1.0:javassist (default) @ orientdb-core --- [ERROR] Class com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage could not not be instrumented due to initialize FAILED. java.lang.ClassCastException: javassist.bytecode.InterfaceMethodrefInfo cannot be cast to javassist.bytecode.MethodrefInfo at javassist.bytecode.ConstPool.getMethodrefType(ConstPool.java:452) at javassist.bytecode.stackmap.Tracer.doInvokeMethod(Tracer.java:800) at javassist.bytecode.stackmap.Tracer.doOpcode148_201(Tracer.java:597) at javassist.bytecode.stackmap.Tracer.doOpcode(Tracer.java:81) at javassist.bytecode.stackmap.MapMaker.make(MapMaker.java:187) at javassist.bytecode.stackmap.MapMaker.make(MapMaker.java:199) at javassist.bytecode.stackmap.MapMaker.make(MapMaker.java:199) at javassist.bytecode.stackmap.MapMaker.make(MapMaker.java:164) at javassist.bytecode.stackmap.MapMaker.make(MapMaker.java:108) at javassist.bytecode.MethodInfo.rebuildStackMap(MethodInfo.java:423) at javassist.bytecode.MethodInfo.rebuildStackMapIf6(MethodInfo.java:405) at javassist.CtBehavior.addCatch(CtBehavior.java:1096) at javassist.CtBehavior.addCatch(CtBehavior.java:1048) at com.orientechnologies.common.javassist.OStaticInitializerExceptionLoggerWeaver.applyTransformations(OStaticInitializerExceptionLoggerWeaver.java:32) at de.icongmbh.oss.maven.plugin.javassist.ClassTransformer.transform(ClassTransformer.java:171) at de.icongmbh.oss.maven.plugin.javassist.ClassTransformer.transform(ClassTransformer.java:131) at de.icongmbh.oss.maven.plugin.javassist.JavassistTransformerExecutor.execute(JavassistTransformerExecutor.java:107) at de.icongmbh.oss.maven.plugin.javassist.JavassistTransformerExecutor.execute(JavassistTransformerExecutor.java:98) at de.icongmbh.oss.maven.plugin.javassist.JavassistMojo.execute(JavassistMojo.java:118) at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134) at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:208) at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:154) at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:146) at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:117) at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:81) at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51) at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128) at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:309) at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:194) at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:107) at org.apache.maven.cli.MavenCli.execute(MavenCli.java:993) at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:345) at org.apache.maven.cli.MavenCli.main(MavenCli.java:191) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289) at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229) at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415) at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356) [INFO] #2216 classes instrumented by com.orientechnologies.common.javassist.OStaticInitializerExceptionLoggerWeaver ``` </body>
		<created>2017-12-15 08:28:50</created>
		<closed>2017-12-15 12:03:09</closed>
	</bug>
	<bug>
		<id>7933</id>
		<title>3.0.0 throw exception when start</title>
		<body>### OrientDB Version: 3.0.0.SNAPSHORT ### Java Version: 1.8 ### OS: CentOS  I pull the last code on develop branch, compile it and get the orientdb-community-3.0.0-SNAPSHOT.zip. When I unzip it and run it, it throws this exception: ``` java.lang.IllegalAccessException: Class java.util.logging.LogManager$1 can not access a member of class com.orientechnologies.common.log.OLogManager with modifiers "protected" at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:102) at java.lang.Class.newInstance(Class.java:436) at java.util.logging.LogManager$1.run(LogManager.java:192) at java.util.logging.LogManager$1.run(LogManager.java:181) at java.security.AccessController.doPrivileged(Native Method) at java.util.logging.LogManager.&lt;clinit&gt;(LogManager.java:181) at java.util.logging.Logger.demandLogger(Logger.java:448) at java.util.logging.Logger.getLogger(Logger.java:502) at jdk.nashorn.internal.runtime.logging.DebugLogger.instantiateLogger(DebugLogger.java:84) at jdk.nashorn.internal.runtime.logging.DebugLogger.&lt;init&gt;(DebugLogger.java:77) at jdk.nashorn.internal.runtime.logging.DebugLogger.&lt;clinit&gt;(DebugLogger.java:55) at jdk.nashorn.internal.lookup.MethodHandleFactory$StandardMethodHandleFunctionality.&lt;init&gt;(MethodHandleFactory.java:325) at jdk.nashorn.internal.lookup.MethodHandleFactory.&lt;clinit&gt;(MethodHandleFactory.java:103) at jdk.nashorn.internal.runtime.Context.initLoggers(Context.java:1404) at jdk.nashorn.internal.runtime.Context.&lt;init&gt;(Context.java:549) at jdk.nashorn.internal.runtime.Context.&lt;init&gt;(Context.java:466) at jdk.nashorn.api.scripting.NashornScriptEngine$1.run(NashornScriptEngine.java:129) at jdk.nashorn.api.scripting.NashornScriptEngine$1.run(NashornScriptEngine.java:125) at java.security.AccessController.doPrivileged(Native Method) at jdk.nashorn.api.scripting.NashornScriptEngine.&lt;init&gt;(NashornScriptEngine.java:125) at jdk.nashorn.api.scripting.NashornScriptEngineFactory.getScriptEngine(NashornScriptEngineFactory.java:148) at javax.script.ScriptEngineManager.getEngineByName(ScriptEngineManager.java:238) at com.orientechnologies.orient.core.command.script.OScriptManager.&lt;init&gt;(OScriptManager.java:78) at com.orientechnologies.orient.core.Orient.&lt;init&gt;(Orient.java:74) at com.orientechnologies.orient.core.Orient.startUp(Orient.java:198) at com.orientechnologies.orient.core.Orient.instance(Orient.java:184) at com.orientechnologies.orient.server.OServer.&lt;init&gt;(OServer.java:107) at com.orientechnologies.orient.server.OServerMain.create(OServerMain.java:28) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:47) ```  </body>
		<created>2017-12-15 07:25:04</created>
		<closed>2017-12-15 09:52:39</closed>
	</bug>
	<bug>
		<id>7919</id>
		<title>Transaction cursor wrong selection</title>
		<body>### OrientDB Version: 2.2.30 ### Java Version: 1.8   ### OS: OS X  ## Expected behavior   The document will be returned in the selection although it's out of selection  ## Actual behavior   The document should not be returned  ## Steps to reproduce   Create an index In a transaction create a document in this index iterateEntriesBetween so that the document will be out of the range. If ascending, it should be before the document, if descending it should be after the document  The problem happens in PureTxBetweenIndexForwardCursor and PureTxBetweenIndexBackwardCursor.   For PureTxBetweenIndexForwardCursor, lastKey will be null and firstKey after the toKey parameter. ODefaultComparator.INSTANCE.compare(nextKey, lastKey) &gt; 0 will return 1 after this but the first item will be still returned.  For PureTxBetweenIndexBackwardCursor, it's even worse, as ODefaultComparator.INSTANCE.compare(nextKey, firstKey) &lt; 0 return 1 and it will return all items from the transaction.  I think it's a critical problem. </body>
		<created>2017-12-08 00:29:21</created>
		<closed>2018-04-26 12:43:00</closed>
	</bug>
	<bug>
		<id>7916</id>
		<title>Inconsistent SQL results on property names with dots</title>
		<body>#### OrientDB Version: 3.0.0m2 #### Java Version: 1.8.0_121 #### OS: Windows 10   I created an element with a property whose name contains a dot from Java using following code: ```         OElement element = session.newElement("Test");         element.setProperty("with.dot", "hello");         element.save();         session.commit(); ```  Executing a SQL `SELECT * from Test` from Java returns an OElement which has the property value correctly assigned: ```         OResultSet results = session.query("SELECT * from Test");         while (results.hasNext()) {             OElement element = results.next().toElement();             system.out.println(element); ``` displays: &gt; Test#21:0{with.dot:hello} v1  Executing the very same SQL query from Studio or Console shows the element but the property "with.dot" is not set (value is empty).  It seems I get different results for the same SQL query depending on where I do execute it. Is there a known limitation here?  Moreover, the 3.0.0m2 release notes (http://orientdb.com/docs/3.0.x/release/3.0/What-is-new-in-OrientDB-3.0.html) claim this:  &gt; Property names can now contain any character, including blank spaces, dots, brackets and special characters.  Is there a setting I should put somewhere to allow SQL to correctly retrieve the dot property value? </body>
		<created>2017-12-05 17:28:49</created>
		<closed>2017-12-06 14:13:32</closed>
	</bug>
	<bug>
		<id>7905</id>
		<title>Recoverable exceptions are being logged as ERROR </title>
		<body>Change the check in ODatabaseDocumentTx.commit to only log an exception as ERROR if it's not an instance of OHighLevelException or ONeedRetryException.</body>
		<created>2017-11-29 14:35:47</created>
		<closed>2017-11-29 16:09:07</closed>
	</bug>
	<bug>
		<id>7898</id>
		<title>"Encountered " &lt;CREATE&gt; "create """ when trying to create a user with console.sh</title>
		<body>### OrientDB Version: 3.0.0m2 ### Java Version: then one in Docker image 3.0.0m2 ### OS: Ubuntu 16.04  ## Expected behavior   In the `console.sh` I want to create a user with the following command:  ``` CREATE USER myuser IDENTIFIED BY userpass ROLE admin ```  ## Actual behavior   I've got the following error: ``` Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query:       ^ Encountered " &lt;CREATE&gt; "create "" at line 1, column 1. Was expecting one of:     &lt;IF&gt; ...     &lt;FOREACH&gt; ...     ";" ...     &lt;IF&gt; ...      DB name="db" Error Code="1" DB name="db" ```  ## Steps to reproduce   As explained [here](https://stackoverflow.com/q/47446065/535203), in terminal 1, run the following:      docker run -it --name orientdb -p "2424:2424" -e ORIENTDB_ROOT_PASSWORD=rootpass orientdb:3.0.0m2  In terminal 2, run the following:      docker run -it --rm --link orientdb:orientdb orientdb:3.0.0m2 /orientdb/bin/console.sh  Then create the db:      CREATE DATABASE remote:orientdb/db root rootpass PLOCAL  And try to create the user:      CREATE USER myuser IDENTIFIED BY userpass ROLE admin</body>
		<created>2017-11-23 01:04:01</created>
		<closed>2017-11-23 10:26:15</closed>
	</bug>
	<bug>
		<id>7897</id>
		<title>NullPointerException on OSBTreeBonsaiLocal.splitBucket </title>
		<body>### OrientDB Version: 2.2.26 ### Java Version: 1.8.0_101   ### OS:  Linux CentOS release 6.6 (Final)  ## Expected behavior   save record succeed  ## Actual behavior   $ANSI{green {db=test}} Error on updating record #752:219768 (cluster: plocal cluster: imei05_7) java.lang.NullPointerException at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.splitBucket(OSBTreeBonsaiLocal.java:1171) at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.put(OSBTreeBonsaiLocal.java:255) at com.orientechnologies.orient.core.storage.impl.local.paginated.ORidBagUpdateSerializationOperation.execute(ORidBagUpdateSerializationOperation.java:66) at com.orientechnologies.orient.core.storage.impl.local.paginated.ORecordSerializationContext.executeOperations(ORecordSerializationContext.java:90) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateRecord(OAbstractPaginatedStorage.java:3821) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateRecord(OAbstractPaginatedStorage.java:1302) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2220) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:181) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2762) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2642) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.updateRecord(ONetworkProtocolBinary.java:2860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.updateRecord(ONetworkProtocolBinary.java:1775) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:615) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) $ANSI{green {db=test}} Error on updating record #98:1930276 (cluster: plocal cluster: user_id_25) com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record update  DB name="test"  Component Name="user_id_25" at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.updateRecord(OPaginatedCluster.java:1186) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateRecord(OAbstractPaginatedStorage.java:3817) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateRecord(OAbstractPaginatedStorage.java:1302) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2220) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:181) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2762) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2642) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.updateRecord(ONetworkProtocolBinary.java:2860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.updateRecord(ONetworkProtocolBinary.java:1775) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:615) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused this rollback is : java.lang.NullPointerException at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.splitBucket(OSBTreeBonsaiLocal.java:1171) at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.put(OSBTreeBonsaiLocal.java:255) at com.orientechnologies.orient.core.storage.impl.local.paginated.ORidBagUpdateSerializationOperation.execute(ORidBagUpdateSerializationOperation.java:66) at com.orientechnologies.orient.core.storage.impl.local.paginated.ORecordSerializationContext.executeOperations(ORecordSerializationContext.java:90) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateRecord(OAbstractPaginatedStorage.java:3821) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateRecord(OAbstractPaginatedStorage.java:1302) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2220) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:181) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2762) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2642) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.updateRecord(ONetworkProtocolBinary.java:2860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.updateRecord(ONetworkProtocolBinary.java:1775) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:615) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)     DB name="test" at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:457) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:412) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.updateRecord(OPaginatedCluster.java:1183) ... 13 more   ## Steps to reproduce    </body>
		<created>2017-11-22 08:46:51</created>
		<closed>2018-04-19 04:01:58</closed>
	</bug>
	<bug>
		<id>7891</id>
		<title>user defined sql functions with arguments, doc example does not work.</title>
		<body>### OrientDB Version: 2.2.18 ### Java Version: 8.121 ### OS: alpinelinux 3.5  (from docker orientdb_latest)  ## Expected behavior   function returns factorial    ## Actual behavior   Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Invalid script:Encountered "" at line 1, column 5. Was expecting one of:  DB name="testdb" DB name="testdb"  ## Steps to reproduce   create new db connect via console  create function following example in 2.2 docs &gt; create function factorial "if (num === 0) return 1; else return num * factorial(num - 1)" PARAMETERS [num]    call function  &gt; select factorial(2)  In fact, I cannot seem to reference a parameter in a user defined sql function without encountering this error.  This happens whether I define the function and run it in Studio or the console. </body>
		<created>2017-11-16 16:27:57</created>
		<closed>2017-11-17 10:33:45</closed>
	</bug>
	<bug>
		<id>7886</id>
		<title>Check lightweight edges on vertex delete</title>
		<body>### OrientDB Version: 2.2.30  ## Expected behavior   Vertices are correctly updated when a vertex linked with lightweight edges is removed  ## Actual behavior    Stale links  ## Steps to reproduce    Enable Lightweight Edges CREATE CLASS SimpleV EXTENDS V CREATE CLASS SimpleE EXTENDS E INSERT INTO SimpleV CONTENT {"name":"A"}  // this is #25:0 INSERT INTO SimpleV CONTENT {"name":"B"}  // this is #25:1 CREATE EDGE SimpleE FROM #25:0 TO #25:1 SELECT FROM SimpleE  // empty result, provides that Lightweight Edge was used DELETE VERTEX #25:1 SELECT FROM SimpleV  // returns #25:0, with OUT still showing link to #25:1  </body>
		<created>2017-11-15 09:07:54</created>
		<closed>2018-01-02 12:11:19</closed>
	</bug>
	<bug>
		<id>7882</id>
		<title>StackOverflow while starting in OSGi environment</title>
		<body>### OrientDB Version: 2.2.30   ### Java Version: 1.8   ### OS: Mac    This happened when ODatabaseRecordThreadLocal.INSTANCE changed to ODatabaseRecordThreadLocal.instance()  ## Steps to reproduce   OServer oServer = OServerMain.create(); oServer.setServerRootDirectory(ORIENTDB_HOME); oServer.startup(new File(ORIENTDB_HOME, SERVER_CONF)); oServer.activate();  While initialising the OScriptManager  `ScriptEngineManager.getEngineByName` returns null, so you write warning message and entrancing to infinity loop.  ## Stack trace at com.orientechnologies.orient.core.command.script.OScriptManager.&lt;init&gt;(OScriptManager.java:58) ~[?:?]         at com.orientechnologies.orient.core.Orient.&lt;init&gt;(Orient.java:75) ~[?:?]         at com.orientechnologies.orient.core.Orient.instance(Orient.java:171) ~[?:?]         at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.instance(ODatabaseRecordThreadLocal.java:45) ~[?:?]         at com.orientechnologies.common.log.OLogManager.log(OLogManager.java:101) ~[?:?]         at com.orientechnologies.common.log.OLogManager.warn(OLogManager.java:186) ~[?:?]         at com.orientechnologies.orient.core.command.script.OScriptManager.&lt;init&gt;(OScriptManager.java:72) ~[?:?]         at com.orientechnologies.orient.core.Orient.&lt;init&gt;(Orient.java:75) ~[?:?]         at com.orientechnologies.orient.core.Orient.instance(Orient.java:171) ~[?:?]         at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.instance(ODatabaseRecordThreadLocal.java:45) ~[?:?]         at com.orientechnologies.common.log.OLogManager.log(OLogManager.java:101) ~[?:?]         at com.orientechnologies.common.log.OLogManager.warn(OLogManager.java:186) ~[?:?]         at com.orientechnologies.orient.core.command.script.OScriptManager.&lt;init&gt;(OScriptManager.java:72) ~[?:?]         at com.orientechnologies.orient.core.Orient.&lt;init&gt;(Orient.java:75) ~[?:?]         at com.orientechnologies.orient.core.Orient.instance(Orient.java:171) ~[?:?]         at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.instance(ODatabaseRecordThreadLocal.java:45) ~[?:?]</body>
		<created>2017-11-13 12:30:02</created>
		<closed>2017-11-14 14:09:13</closed>
	</bug>
	<bug>
		<id>7881</id>
		<title>NullPointerException when Check Database</title>
		<body>### OrientDB Version: 2.29 ### Java Version: 1.8.0 ### OS: freeBSD 10.3  ## Expected behavior   Check Database should always return a result gracefully (either success or fail)  ## Actual behavior   Check Database return Error: java.lang.NullPointerException  ## Steps to reproduce   I have corrupted database (very same as #7722). After having upgraded most databases in testing team from 2.4 to 2.29, we encounter that issue again. The problem probably lies within compatibility of orientdb core between 2.4 and 2.23+ (hopefully we don't have to discuss that issue again). I went straight to Check Database, it returned a lot (around 17k) of corrupted edge and ended at Error: java.lang.NullPointerException  Check Database is done in 2.29  </body>
		<created>2017-11-13 09:22:03</created>
		<closed>2017-12-27 06:31:11</closed>
	</bug>
	<bug>
		<id>7879</id>
		<title>[Question]`IS DEFINED` syntax doesn't work when property is create?</title>
		<body>### OrientDB Version: 2.2.24 ### Java Version: 1.8 ### OS: Centos 6.8  ## Expected behavior   For example, I create property `age` on v_test, because I need create index on it. And I execute the sql below `select from v_test where age is not defined` I expect orientdb  return record where the `age` is not exists , but orientdb return None record.  ## Actual behavior   I expect orientdb  return record where the `age` is not exists , but orientdb return None record.  ## Steps to reproduce   create a vertex class `v_test` create a property `age` on `v_test` create a record : `create vertex v_test content {name="jack"}` execute sql: `select from v_test where age is not defined` </body>
		<created>2017-11-11 08:49:33</created>
		<closed>2017-11-20 09:26:22</closed>
	</bug>
	<bug>
		<id>7876</id>
		<title>Wrong sequence used in case of inherited default value</title>
		<body>### OrientDB Version: community-2.2.29 ### Java Version: OpenJDK 1.8.0._131 ### OS: Ubuntu 16.10  ## Expected behavior After running the following script: ``` create sequence parent_seq type ordered start 1023 increment 1 create sequence child_seq type ordered start 0 increment 1  create class parent extends v create property parent.parent_id string (notnull true, mandatory true) alter property parent.parent_id default 'sequence("parent_seq").next()'  create class child extends parent create property child.child_id string  create vertex child set child_id=sequence("child_seq").next() select parent_id, child_id from child ```  The two sequences should have been be used: ``` +----+---------+--------+ |#   |parent_id|child_id| +----+---------+--------+ |0   |1024     |1       | +----+---------+--------+ ```  ## Actual behavior ...but the output shows that only parent_seq has been used, twice: ``` +----+---------+--------+ |#   |parent_id|child_id| +----+---------+--------+ |0   |1024     |1025    | +----+---------+--------+ ```  ## Steps to reproduce Run the script specified above. </body>
		<created>2017-11-07 17:17:13</created>
		<closed>2017-11-20 16:05:56</closed>
	</bug>
	<bug>
		<id>7869</id>
		<title>dijkstra throwing exceptions in some cases</title>
		<body>### OrientDB Version: 2.2.29   ### Java Version: 1.8.0_111   ### OS: Amazon Linux AMI 2016.09    ## Expected behavior   Running dijkstra will return the cheapest path between two vertices  ## Actual behavior   Exceptions are thrown in certain cases    ## Steps to reproduce   I have a graph where I added the Property 'weight' to E. I created other Sub classes from E and V. If I run shortestPath I get a response. If I run dijkstra on the same source and destination I get an exception.  orientdb {db=SpinOffIntelligence}&gt; select shortestPath(#30:5,#39:3,'BOTH')  +----+---------------------+ |#   |shortestPath         | +----+---------------------+ |0   |[#30:5,#13:780,#39:3]| +----+---------------------+  1 item(s) found. Query executed in 0.002 sec(s). orientdb {db=SpinOffIntelligence}&gt; select dijkstra(#30:5,#39:3,'weight','BOTH')  Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select dijkstra(#30:5,#39:3,'weight','BOTH')         DB name="SpinOffIntelligence"         DB name="SpinOffIntelligence"  Running dijkstra with other Vertices does work some time. I can't tell why.  orientdb {db=SpinOffIntelligence}&gt; select dijkstra(#30:5,#39:5,'weight','BOTH')  +----+-------------------------+ |#   |dijkstra                 | +----+-------------------------+ |0   |[#30:5,#31:0,#16:6,#39:5]| +----+-------------------------+    </body>
		<created>2017-11-04 13:33:37</created>
		<closed>2017-11-06 14:29:57</closed>
	</bug>
	<bug>
		<id>7863</id>
		<title>console.bat - IllegalArgumentException: Unknown signal: WINCH</title>
		<body>### OrientDB Version: 2.2.29 ### Java Version: 1.8.0_151   ### OS: Windows 7 Pro x64 ## Expected behavior   OrientDB console should start when console.bat is executed  ## Actual behavior   The following exception is thrown: Exception in thread "main" java.lang.ExceptionInInitializerError         at com.orientechnologies.orient.graph.console.OGremlinConsole.main(OGremlinConsole.java:70) Caused by: java.lang.IllegalArgumentException: Unknown signal: WINCH         at sun.misc.Signal.&lt;init&gt;(Unknown Source)         at com.orientechnologies.common.console.TTYConsoleReader.&lt;clinit&gt;(TTYConsoleReader.java:58)         ... 1 more  ## Steps to reproduce   execute console.bat    </body>
		<created>2017-11-01 17:19:32</created>
		<closed>2017-11-02 16:55:38</closed>
	</bug>
	<bug>
		<id>7844</id>
		<title>Lucene indexes become corrupted after some use (memory database)</title>
		<body>### OrientDB Version: 2.2.29 ### Java Version: java version "1.8.0_131" - Java(TM) SE Runtime Environment (build 1.8.0_131-b11) - Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode) ### OS: Ubuntu Xenial (LXC Container)   ## Expected behavior   The indexes must persist.  ## Actual behavior   No response for queries using lucene indexes  ## Steps to reproduce   1 - Create a memory database; 2 - Insert 400k objects with a string property 3 - Create a lucene index for the string property 4 - After some use, the queries will not return any result using the lucene index.  I've solved the issue downgrading the system to OrientDB Server v2.2.22 that works fine for the issue described above.  </body>
		<created>2017-10-23 20:36:13</created>
		<closed>2017-10-25 14:56:10</closed>
	</bug>
	<bug>
		<id>7840</id>
		<title>After removal of default cluster in OrientDB binary compatibility tests start to fail</title>
		<body>After removal of default cluster in OrientDB binary compatibility tests start to fail</body>
		<created>2017-10-22 07:20:04</created>
		<closed>2017-10-23 09:12:39</closed>
	</bug>
	<bug>
		<id>7837</id>
		<title>create edge throws ArrayIndexOutOfBoundsException</title>
		<body>### OrientDB Version: 3.0-develop ### Java Version: 1.8 ### OS: CentOS  When I insert edges, I find there are many logs like this: ``` com.orientechnologies.orient.core.exception.OStorageException: Error on executing command: sql.CREATE EDGE invest FROM (SELECT FROM Person WHERE _key="5F6F46D993DF8F72E40F612278D8968A") TO (SELECT FROM Company WHERE _key="49FD77C666507DD42F7069D635527E2F") CONTENT {"invest_amount_unit":"","_from":"Person/5F6F46D993DF8F72E40F612278D8968A","entity_type":"invest","src_id":"5F6F46D993DF8F72E40F612278D8968A","invest_amount":"100000.0","utime":"2017-06-27 18:08:09","ctime":"2017-06-27 18:08:09","dst_id":"49FD77C666507DD42F7069D635527E2F","_to":"Company/49FD77C666507DD42F7069D635527E2F","_key":"0FC0CA6A63A3266EA1F0AA9C9CB48BB9"}; DB name="dev" at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:322) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetryTimeout(OStorageRemote.java:209) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:237) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:823) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:68) ~[orientdb-core-3.0.0m2.jar!/:3.0.0m2] at com.tinkerpop.blueprints.impls.orient.OrientGraphCommand.execute(OrientGraphCommand.java:49) ~[orientdb-graphdb-3.0.0m2.jar!/:3.0.0m2] at com.haizhi.test.orientdb.runner.HbaseRelationScan.lambda$null$2(HbaseRelationScan.java:150) ~[classes!/:1.0-SNAPSHOT] at java.util.ArrayList.forEach(ArrayList.java:1249) ~[na:1.8.0_131] at com.haizhi.test.orientdb.runner.HbaseRelationScan.lambda$saveBySql$3(HbaseRelationScan.java:136) ~[classes!/:1.0-SNAPSHOT] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_131] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_131] at java.lang.Thread.run(Thread.java:748) ~[na:1.8.0_131] Caused by: java.lang.ArrayIndexOutOfBoundsException: 687865856 at com.orientechnologies.common.exception.OErrorCode.getErrorCode(OErrorCode.java:99) ~[orientdb-core-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.message.OError37Response.read(OError37Response.java:37) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:276) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:195) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:159) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1658) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:223) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:209) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:273) ~[orientdb-client-3.0.0m2.jar!/:3.0.0m2] ... 11 common frames omitted ```  </body>
		<created>2017-10-20 22:53:01</created>
		<closed>2017-11-16 01:50:39</closed>
	</bug>
	<bug>
		<id>7833</id>
		<title>running sql in console throws Error</title>
		<body>### OrientDB Version: 3.0 ### Java Version: 1.8 ### OS: CentOS  When I run `truncate class xxx unsafe` in console, it always throws error: `Truncated Error: java.util.IllegalFormatConversionException: d != java.util.ArrayList`  After that, If I run other `select` command, it throws error: `Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot close query: 1508409995119_32 DB name="dev" DB name="dev" `</body>
		<created>2017-10-19 10:55:17</created>
		<closed>2017-10-19 13:09:26</closed>
	</bug>
	<bug>
		<id>7827</id>
		<title>ETL doesn't log</title>
		<body></body>
		<created>2017-10-17 14:22:08</created>
		<closed>2017-10-17 15:47:09</closed>
	</bug>
	<bug>
		<id>7826</id>
		<title>BUG: insert select edge creates invalid TO references</title>
		<body>### OrientDB Version: 2.x   ### Java Version: n/a   ### OS: n/a    ## Expected behavior   insert-select  correctly copies all of the edges  ## Actual behavior   insert-select generates invalid edge meta-data    ## Steps to reproduce    I suspect this is a serious bug and is raising doubts about how OrientDB manages the integrity of the graphs data during various DML operations. How can an Edge have multiple TOs?  The below outlines a simple operation that is using 'insert into select' to copy a Vertex. Initial State  `{ "result": [     {         "@type": "d",         "@rid": "#-2:1",         "@version": 0,         "rid": "#133:46",         "version": 1,         "class": "RuleSet",         "out_HasRule": [             "#80:32"         ],         "@fieldTypes": "rid=x,out_HasRule=g"     },     {         "@type": "d",         "@rid": "#-2:2",         "@version": 0,         "rid": "#130:39",         "version": 1,         "class": "Rule",         "in_HasRule": [             "#80:32"         ],         "@fieldTypes": "rid=x,in_HasRule=g"     } ], "notification": "Query executed  in 0.213 sec. Returned 2 record(s)" }`   If I execute the following, bad edge data is created. Notice that #80:32 is the IN for more than one Vertex.  `insert into Rule from select * from #130:39;`  'insert into Rule from select * from #130:39;'  `{ "result": [     {         "@type": "d",         "@rid": "#-2:1",         "@version": 0,         "rid": "#133:46",         "version": 1,         "class": "RuleSet",         "out_HasRule": [             "#80:32"         ],         "@fieldTypes": "rid=x,out_HasRule=g"     },     {         "@type": "d",         "@rid": "#-2:2",         "@version": 0,         "rid": "#131:38",         "version": 1,         "class": "Rule",         "in_HasRule": [             "#80:32"         ],         "@fieldTypes": "rid=x,in_HasRule=g"     },     {         "@type": "d",         "@rid": "#-2:3",         "@version": 0,         "rid": "#130:39",         "version": 1,         "class": "Rule",         "in_HasRule": [             "#80:32"         ],         "@fieldTypes": "rid=x,in_HasRule=g"     } ], "notification": "Query executed  in 0.151 sec. Returned 3 record(s)"}`  @luigidellaquila    Stack Overflow - https://stackoverflow.com/questions/46781586/bug-insert-select-edge-creates-invalid-to-references</body>
		<created>2017-10-17 13:34:54</created>
		<closed>2017-10-18 14:22:34</closed>
	</bug>
	<bug>
		<id>7823</id>
		<title>Incorrect output from MATCH with "class" and "while" clauses</title>
		<body>### OrientDB Version: 2.2.29 ### Java Version: OpenJDK 8   ### OS: Linux    ## Expected behavior   Regardless of other `while` and `where` clauses, a MATCH statement's `class: Bar` clause should behave identically to a `where: (@this INSTANCEOF 'Bar')`.  ## Actual behavior   In the query below, using the `class:` clause causes the query to incorrectly return no results, while using the equivalent `where:` clause returns the correct set of results.  ## Steps to reproduce   Bear with me, this is a hard one to reproduce. This is the minimal setup I've been able to consistently reproduce the issue with: ``` CREATE CLASS Foo EXTENDS V CREATE CLASS AbstractBar EXTENDS V CREATE CLASS Bar EXTENDS AbstractBar CREATE CLASS Baz EXTENDS V CREATE PROPERTY Foo.name STRING CREATE PROPERTY AbstractBar.name STRING CREATE PROPERTY Baz.name STRING  CREATE CLASS Foo_Bar EXTENDS E CREATE CLASS Bar_ParentBar EXTENDS E CREATE CLASS Baz_Foo EXTENDS E  # tier 2:           bar-1-tier-2 #                    /        \ # tier 1:  bar-1-tier-1     bar-2-tier-1 CREATE VERTEX Bar SET name = 'bar-1-tier-1' CREATE VERTEX Bar SET name = 'bar-2-tier-1' CREATE VERTEX Bar SET name = 'bar-1-tier-2'  CREATE EDGE Bar_ParentBar FROM (SELECT * FROM Bar WHERE name != 'bar-1-tier-2') TO (SELECT * FROM Bar WHERE name = 'bar-1-tier-2')  CREATE VERTEX Foo SET name = 'foobaz1' CREATE VERTEX Foo SET name = 'foobaz2' CREATE VERTEX Foo SET name = 'foobaz3' CREATE VERTEX Foo SET name = 'foobaz4' CREATE VERTEX Foo SET name = 'foobaz5'  # Foos 1-3 are connected to the 'bar-1-tier-1' Bar # Foos 4-5 are connected to the 'bar-2-tier-1' Bar CREATE EDGE Foo_Bar FROM (SELECT * FROM Foo WHERE name &lt;= 'foobaz3') TO (SELECT * FROM Bar WHERE name = 'bar-1-tier-1') CREATE EDGE Foo_Bar FROM (SELECT * FROM Foo WHERE name &gt; 'foobaz3') TO (SELECT * FROM Bar WHERE name = 'bar-2-tier-1')  CREATE VERTEX Baz SET name = 'foobaz1' CREATE VERTEX Baz SET name = 'foobaz2' CREATE VERTEX Baz SET name = 'foobaz3' CREATE VERTEX Baz SET name = 'foobaz4' CREATE VERTEX Baz SET name = 'foobaz5'  # Each Baz is connected to the Foo with the matching name CREATE EDGE Baz_Foo FROM (SELECT * FROM Baz WHERE name = 'foobaz1') TO (SELECT * FROM Foo WHERE name = 'foobaz1') CREATE EDGE Baz_Foo FROM (SELECT * FROM Baz WHERE name = 'foobaz2') TO (SELECT * FROM Foo WHERE name = 'foobaz2') CREATE EDGE Baz_Foo FROM (SELECT * FROM Baz WHERE name = 'foobaz3') TO (SELECT * FROM Foo WHERE name = 'foobaz3') CREATE EDGE Baz_Foo FROM (SELECT * FROM Baz WHERE name = 'foobaz4') TO (SELECT * FROM Foo WHERE name = 'foobaz4') CREATE EDGE Baz_Foo FROM (SELECT * FROM Baz WHERE name = 'foobaz5') TO (SELECT * FROM Foo WHERE name = 'foobaz5') ```  Here's the query with `where:` and `INSTANCEOF`: ``` MATCH {     class: Foo,     as: my_starting_foo }.out('Foo_Bar') {     where: (@this INSTANCEOF 'Bar'),     as: my_starting_bar }.in('Bar_ParentBar') {     while: ($depth &lt; 10),     as: my_recursing_bar }.in('Foo_Bar') {     class: Foo,     where: ((name &lt;&gt; $matched.my_starting_foo.name)),     as: my_final_foo }.in('Baz_Foo') {     class: Baz,     as: my_baz } RETURN $matches ``` It correctly outputs 8 results: the entire block with `while:` is a no-op, and the valid results are any pair of the 3 `Foo`s connected to the same tier-1 `Bar`, and the two permutations of the 2 `Foo`s connected to the same tier-1 `Bar` on the other side.  Let's make that `INSTANCEOF` into a `class:` clause: ``` MATCH {     class: Foo,     as: my_starting_foo }.out('Foo_Bar') {     class: Bar,     as: my_starting_bar }.in('Bar_ParentBar') {     while: ($depth &lt; 10),     as: my_recursing_bar }.in('Foo_Bar') {     class: Foo,     where: ((name &lt;&gt; $matched.my_starting_foo.name)),     as: my_final_foo }.in('Baz_Foo') {     class: Baz,     as: my_baz } RETURN $matches ``` Now, the query returns no results. This is clearly incorrect.  Hope you are able to make sense of this -- please let me know if I can help with anything.</body>
		<created>2017-10-16 15:12:41</created>
		<closed>2017-10-18 10:30:28</closed>
	</bug>
	<bug>
		<id>7820</id>
		<title>Adding UNIQUE index causes comparison operator to not work</title>
		<body>### OrientDB Version: 2.2.29 ### Java Version: OpenJDK 8   ### OS: Linux    ## Expected behavior   The following two queries are equivalent and should always return the same results: ``` SELECT * FROM Foo WHERE name &gt;= "0" SELECT * FROM Foo WHERE "0" &lt;= name ```   ## Actual behavior   With a `UNIQUE` index on `Foo.name`, the second query always returns no results, whereas the first query continues working.    ## Steps to reproduce   ``` CREATE CLASS Foo EXTENDS V CREATE PROPERTY Foo.name String  CREATE VERTEX Foo SET name = "1" CREATE VERTEX Foo SET name = "2"  SELECT * FROM Foo WHERE name &gt;= "0" SELECT * FROM Foo WHERE "0" &lt;= name # both queries return the same results  CREATE INDEX Foo.name UNIQUE  SELECT * FROM Foo WHERE name &gt;= "0" # returns two rows, same as before  SELECT * FROM Foo WHERE "0" &lt;= name # returns no rows ```</body>
		<created>2017-10-13 20:45:08</created>
		<closed>2017-10-16 08:52:38</closed>
	</bug>
	<bug>
		<id>7818</id>
		<title>dijkstra throws exception</title>
		<body>### OrientDB Version: 2.2.9   ### Java Version: 1.8.0_111-b15  ### OS: Amazon Linux AMI 2016.09    ## Expected behavior   Running dijkstra  will return the cheapest path between two vertices   ## Actual behavior   The dijkstra(#30:5, #39:3,'weight', 'both') call throws an error Error: java.lang.NullPointerException   ## Steps to reproduce   I have a simple graph where two vertices are connected by two other vertices via 4 edges forming a diamond. V1 &lt;-E1- VA -E2-&gt; V2 and V1 &lt;-E3- VB -E4-&gt; V2.   The dijkstra(#30:5, #39:3,'weight', 'both') call throws an error Error: java.lang.NullPointerException </body>
		<created>2017-10-13 11:58:09</created>
		<closed>2017-10-30 09:23:40</closed>
	</bug>
	<bug>
		<id>7809</id>
		<title>2 spaces between ALTER and PROPERTY leads to error</title>
		<body>### OrientDB Version: docker orientdb:2.2.28  ## Expected behavior   The ALTER command works.  ## Actual behavior   The folowing error occurs:  &gt;com.orientechnologies.orient.core.command.OCommandExecutorNotFoundException: Cannot find a command executor for the command request: sql.ALTER  PROPERTY Person.firstname COLLATE ci  ## Steps to reproduce  Execute the following commands:  ``` CREATE CLASS Person EXTENDS V CREATE PROPERTY Person.firstname STRING ALTER  PROPERTY Person.firstname COLLATE ci  -- note that there are 2 spaces after ALTER ```  </body>
		<created>2017-10-10 15:06:50</created>
		<closed>2017-10-10 15:47:27</closed>
	</bug>
	<bug>
		<id>7808</id>
		<title>java.util.concurrent.CancellationException periodically appears in the log </title>
		<body>CancellationException periodically appears in the log every time we close WAL segment in WAL and start a new one. The same exception also appears on shutdown. I suppose it is quite safe to ignore it and do not log it because it is part of normal database life cycle. </body>
		<created>2017-10-10 15:04:28</created>
		<closed>2017-10-10 16:42:47</closed>
	</bug>
	<bug>
		<id>7804</id>
		<title>ClassCastException in security module in 3.0 version</title>
		<body>### OrientDB Version: 3.0  If you run `mvn clean install` you will see:  ``` java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.orientechnologies.orient.core.record.impl.ODocument        at com.orientechnologies.orient.server.security.ODefaultServerSecurity.getSection(ODefaultServerSecurity.java:772)         at com.orientechnologies.orient.server.security.ODefaultServerSecurity.onAfterDynamicPlugins(ODefaultServerSecurity.java:683)         at com.orientechnologies.orient.server.security.ODefaultServerSecurity.reload(ODefaultServerSecurity.java:501)         at com.orientechnologies.orient.server.OServerDatabaseOperationsTest.before(OServerDatabaseOperationsTest.java:52) ```</body>
		<created>2017-10-10 07:17:06</created>
		<closed>2017-10-10 10:00:40</closed>
	</bug>
	<bug>
		<id>7794</id>
		<title>java.lang.ArrayIndexOutOfBoundsException: 0 on dev build of CI 3.0</title>
		<body>On CI we have got this exception   java.lang.ArrayIndexOutOfBoundsException: 0 at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTableWALTestIT.restoreDataFromWAL(OLocalHashTableWALTestIT.java:255) at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTableWALTestIT.assertFileRestoreFromWAL(OLocalHashTableWALTestIT.java:217) at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTableWALTestIT.testKeyDeleteRandomUniform(OLocalHashTableWALTestIT.java:168)  Standard Output  testKeyDeleteRandomUniform : 1507289765031 Start data restore</body>
		<created>2017-10-06 16:50:16</created>
		<closed>2018-05-04 03:03:58</closed>
	</bug>
	<bug>
		<id>7793</id>
		<title>SQL query CONTAINSVALUE don't working with EMBEDDED MAP</title>
		<body>### OrientDB Version: 2.2.28 ### Java Version: OpenJDK 1.8 ### OS: Ubuntu 16.04 Hi,  I need to create filter by embedded map values, but something is wrong.   ## Expected behavior   `SELECT FROM Test WHERE embedded_map CONTAINSVALUE {"name":"key_2", "id":"0"}` must returns documents which contains embedded_map with given value.  ## Actual behavior   Query `SELECT FROM Test WHERE embedded_map CONTAINSVALUE {"name":"key_2", "id":"0"}` don't return documents which contains embedded_map with given value. But if we use query `SELECT FROM Test WHERE  {"name":"key_2", "id":"0"} IN embedded_map.values()` all works fine.  ## Steps to reproduce   `CREATE CLASS Test` `CREATE PROPERTY Test.embedded_map EMBEDDEDMAP` `CREATE PROPERTY Test.id INTEGER` `INSERT INTO Test SET id = 0, embedded_map = {"key_2" :  {"name" : "key_2",  "id" : "0"}}` `INSERT INTO Test SET id = 1, embedded_map = {"key_1" :  {"name" : "key_1", "id" : "1" }}` `SELECT FROM Test WHERE embedded_map CONTAINSVALUE {"name":"key_2", "id":"0"} `  In last query expected that I get record with id = 0, but result is empty.  Query `SELECT FROM Test WHERE link_map CONTAINSVALUE #18:0` works fine with LINKMAP.  Thank you,  Vitaliy.</body>
		<created>2017-10-06 08:36:57</created>
		<closed>2017-10-06 14:22:40</closed>
	</bug>
	<bug>
		<id>7786</id>
		<title>In case of the high load graphdb cache may contain records with diff content but the same version</title>
		<body>### OrientDB Version: 1.x  In case of high load we may experience a situation in GraphDB when we will have in DB cache records which have the same version but different content it can lead to the problems with graph consistency.</body>
		<created>2017-10-04 12:30:13</created>
		<closed>2017-10-04 13:43:00</closed>
	</bug>
	<bug>
		<id>7785</id>
		<title>Micro-transactions cannot be rolled back when OrientDB engine is started with  -Dstorage.useWAL=false</title>
		<body>### OrientDB Version: 3.0-M2 ### Java Version: 1.8.0_111 ### OS: Windows 10  ## Expected behavior   Trying a massive import from a JDBC database, we expected better performances with -Dstorage.useWAL=false (we don't use a transactional mode)  ## Actual behavior   [ERROR] 2017-10-04 13:22:40 [main] c.o.o.c.s.i.l.p.OLocalPaginatedStorage - $ANSI{green {db=connectitdb}} Exception `6161B39B` in storage `connectitdb` [142] com.orientechnologies.orient.core.exception.OStorageException: WAL mode is not active. Transactions are not supported in given mode DB name="connectitdb" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.rollback(OAbstractPaginatedStorage.java:2733) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeRollback(OAbstractPaginatedStorage.java:2666) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1665) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.doCommit(OMicroTransaction.java:372) at com.orientechnologies.orient.core.storage.impl.local.OMicroTransaction.commit(OMicroTransaction.java:161) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.endMicroTransaction(ODatabaseDocumentAbstract.java:3105) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.executeSaveRecord(ODatabaseDocumentAbstract.java:1627) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:244) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:174) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:2434) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.save(ODatabaseDocumentAbstract.java:93) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2125) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:2116) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63) at com.activus.connectit.storage.service.graph.AbstractGraphService.save(AbstractGraphService.java:410)   ## Steps to reproduce   massive Insertions in an non-transactional mode with   -Dstorage.useWAL=false.  </body>
		<created>2017-10-04 12:05:29</created>
		<closed>2017-10-24 13:13:54</closed>
	</bug>
	<bug>
		<id>7782</id>
		<title>`JS` and `JSS` in uppercase and lowercase works in different ways</title>
		<body>### OrientDB Version: v2.2.28   ### Java Version: 1.8.0_144   ### OS: Windows 7 x64    ## Expected behavior   Commands should be case-insensitive. Resulf of ` JS print('Hello World!')` should be the same as ` js print('Hello World!')`.  ## Actual behavior   ``` orientdb {db=StarterHabr}&gt; JS print('Hello World!') Hello World!  Client side script executed in 0,002000 sec(s). Value returned is: null ```  ``` orientdb {db=StarterHabr}&gt; js print('Hello World!') [Started multi-line command. Type just 'end' to finish and execute] end Hello World!  Client side script executed in 0,002000 sec(s). Value returned is: null ``` Uppercase command `JS` and  `JSS` run the command and not goes to interactive javascript mode. Lowercase version `js` and `jss` goes to interactive javascript mode.  ## Steps to reproduce   Type and run in console: ` JS print('Hello World!')`  ` js print('Hello World!')`</body>
		<created>2017-10-02 00:54:30</created>
		<closed>2017-10-03 14:44:53</closed>
	</bug>
	<bug>
		<id>7780</id>
		<title>Java 9 : Illegal reflective access</title>
		<body>### OrientDB Version: Community Edition 2.2.28  `build.number=2.2.x@r7f8db5be4bbc6b9f9382fdcce95c505c0588f238` ### Java Version: Oracle JRE 9 and 8   ### OS: Debian 9 (stretch)  ## Error with Oracle Java 9   ``` OrientDB console v.2.2.28 (build 7f8db5be4bbc6b9f9382fdcce95c505c0588f238) https://www.orientdb.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  orientdb&gt; connect plocal:../databases/OpenBeer/ admin mypasswd  Connecting to database [plocal:../databases/OpenBeer/] with user 'admin'...WARNING: An illegal reflective access operation has occurred WARNING: Illegal reflective access by com.orientechnologies.common.directmemory.OByteBufferPool (file:/home/orientdb/orientdb-community-importers-2.2.28/lib/orientdb-core-2.2.28.jar) to method sun.nio.ch.DirectBuffer.cleaner() WARNING: Please consider reporting this to the maintainers of com.orientechnologies.common.directmemory.OByteBufferPool WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations WARNING: All illegal access operations will be denied in a future release  Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '../databases/OpenBeer' with mode=rw   DB name="OpenBeer"  Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot open storage it is acquired by other process   DB name="OpenBeer" ```  ## No error with Oracle Java 8 ``` OrientDB console v.2.2.28 (build 7f8db5be4bbc6b9f9382fdcce95c505c0588f238) https://www.orientdb.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  orientdb&gt; connect plocal:../databases/OpenBeer/ admin mypasswd  Connecting to database [plocal:../databases/OpenBeer/] with user 'admin'...OK orientdb {db=OpenBeer}&gt; quit ```  ## Steps to reproduce    * Install `oracle-java-9-jre`  * Start orientdb  * Try to onnect at your db via console.sh  No custom config for java :  ``` java -d64 -server -Xms2G -Xmx2G -Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=512g -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 -Djava.util.logging.manager=com.orientechnologies.common.log.OLogManager$ShutdownLogManager -Djava.util.logging.config.file=/home/orientdb/odb-01/config/orientdb-server-log.properties -Dorientdb.config.file=/home/orientdb/odb-01/config/orientdb-server-config.xml -Dorientdb.www.path=/home/orientdb/odb-01/www -Dorientdb.build.number=2.2.x@r7f8db5be4bbc6b9f9382fdcce95c505c0588f238; 2017-09-26 10:13:05+0000 -cp /home/orientdb/odb-01/lib/orientdb-server-2.2.28.jar:/home/orientdb/odb-01/lib/*:/home/orientdb/odb-01/plugins/* com.orientechnologies.orient.server.OServerMain ```</body>
		<created>2017-09-29 11:40:05</created>
		<closed>2018-01-17 01:38:01</closed>
	</bug>
	<bug>
		<id>7772</id>
		<title>Invisible classes in OSGi environment</title>
		<body>### OrientDB Version: 2.2.27   ### Java Version: 1.8 ### OS: Mac os    After installing OrientDB in OSGi environment (I use karat 4.1.2) I stuck with some problems: 1. java.lang.NoClassDefFoundError: Could not initialize class com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal         at com.orientechnologies.orient.server.OSystemDatabase.init(OSystemDatabase.java:147) ~[?:?]         at com.orientechnologies.orient.server.OSystemDatabase.&lt;init&gt;(OSystemDatabase.java:44) ~[?:?]         at com.orientechnologies.orient.server.OServer.initSystemDatabase(OServer.java:1290) ~[?:?]         at com.orientechnologies.orient.server.OServer.activate(OServer.java:352) ~[?:?]     To fix it I removed static section in ODatabaseRecordThreadLocal class.  2. Because I use Embedded &amp; Distributed mode, orientdb-core indirectly uses orientdb-distributed module.     In particular classes from com.orientechnologies.orient.server.distributed.impl,    com.orientechnologies.orient.server.distributed.impl.task packages, that is not exportable. To fix it I added ,com.orientechnologies.orient.server.distributed.impl.* in &lt;osgi.export&gt; property of orientdb-distributed         pom.xml and     com.orientechnologies.orient.server.distributed.impl;resolution:=optional,     com.orientechnologies.orient.server.distributed.impl.task;resolution:=optional, in &lt;osgi.import&gt; property of orientdb-core       pom.xml  Now bundles started and database synchronized with remote node.  Could you add those changes to next version.  </body>
		<created>2017-09-26 09:54:48</created>
		<closed>2017-10-29 12:08:38</closed>
	</bug>
	<bug>
		<id>7760</id>
		<title>If user changes size of disk cache through API it can be overwritten</title>
		<body>If the user changes the size of disk cache through API but before the engine is initialized it can be overwritten during initialization of engine by setting the default or optimised values for disk cache.</body>
		<created>2017-09-20 12:36:30</created>
		<closed>2017-09-21 07:37:18</closed>
	</bug>
	<bug>
		<id>7756</id>
		<title>OLogSegmentV2 cannot be cast to OLogSegmentV1</title>
		<body>### OrientDB Version: 2.2.27 ### Java Version:  8 ### OS: Linux  ## Expected behavior   Upgraded Orient from 2.2.25 to 2.2.27. Expected database to open fine.   ## Actual behavior    ``` om.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:297) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:258) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.openOrCreate(OrientBaseGraph.java:1918) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:162) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:102)  at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedSt         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:98)         at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:103)         ..         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.ClassCastException: com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV2 cannot be cast to com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV1         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV1.compareTo(OLogSegmentV1.java:397)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV1.compareTo(OLogSegmentV1.java:34)         at java.util.ComparableTimSort.countRunAndMakeAscending(ComparableTimSort.java:320)         at java.util.ComparableTimSort.sort(ComparableTimSort.java:188)         at java.util.Arrays.sort(Arrays.java:1312)         at java.util.Arrays.sort(Arrays.java:1506)         at java.util.ArrayList.sort(ArrayList.java:1454)         at java.util.Collections.sort(Collections.java:141)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.&lt;init&gt;(ODiskWriteAheadLog.java:282)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.&lt;init&gt;(ODiskWriteAheadLog.java:155)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.initWalAndDiskCache(OLocalPaginatedStorage.java:581)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:259)         ... 13 common frames omitted ```  &lt;add here&gt;    ## Steps to reproduce   &lt;add here&gt;    </body>
		<created>2017-09-19 20:19:46</created>
		<closed>2017-09-21 10:32:20</closed>
	</bug>
	<bug>
		<id>7751</id>
		<title>[V3] Results of two transactions not as expected</title>
		<body>### OrientDB Version: 3.0.0m2  ### Java Version: The one from the docker image  ### OS: The official docker image  ## Expected behavior   Just after a transaction creating two instances of V and one instance of E linking them together, I get, when doing a SELECT FROM V to see the correct content of my 2 Vs and my E in the result. If I use another transaction to delete one of the Vs and update the other (one of the fields with a different value), when I do a select I expect to get my only V, with its fields.  ## Actual behavior    OrientDB v3.0.0m2 returns an empty V record (no field at all) after my second transaction when v2.2.24 was doing fine. If I check its content with studio, I see the same problem.  ## Steps to reproduce    I'm using a home made Erlang client library, so I'll start by giving you pseudo code of what I'm doing:  * Create an empty database * Connect to it (the rest of the operations is done with this single connection) * In a single connection, create 2 instance of V ({toto: 42, tutu= 'tutu'} and {x: 4.5}) and one instance of E linking them together * Do a command (type "q"): SELECT FROM V * Check the results match what I expect * In another transaction, delete one of the 2 V and update the other ({toto: 43, tutu= 'tutu'}) * Do a command (type "q"): SELECT FROM V * Check the results match what I expect  Here is a dump of what happens on the socket:  * The TX_COMMIT:     * Send: `0x3C0000001F0000007B00000000047465737400FFFFFFFFFFFFFFFFFFFF0000015E960DD7D6010004726F6F74002500174F5265636F726453657269616C697A657242696E61727900164F7269656E7444422045726C616E6720436C69656E740003302E318920A36B98D02120F454C05928F419079AEF6C765E7C0460AC5D9EBC4591A5ED00000001010103FFFFFFFFFFFFFFFFFFFE6400000047000256086F75745F000000221608746F746F0000004101087475747500000042070003647DECE703DE4779334122E474B29DC200000001FFFFFFFFFFFFFFFFFFFC5408747574750103FFFFFFFFFFFFFFFFFFFD640000003B00025606696E5F000000141602780000003305000398E21317D09B48701D42CE048F1B503600000001FFFFFFFFFFFFFFFFFFFC40120000000000000103FFFFFFFFFFFFFFFFFFFC640000001900024504696E000000150D066F7574000000170D00010301050000000003000000`     * Receive: `0x000000001F0000000000000003FFFFFFFFFFFFFFFFFFFD000A0000000000000000FFFFFFFFFFFFFFFFFFFC00110000000000000000FFFFFFFFFFFFFFFFFFFE0009000000000000000000000003000A0000000000000000000000010009000000000000000000000001001100000000000000000000000100000000` * The COMMAND:     * Send: `0x290000001F0000007B00000000047465737400FFFFFFFFFFFFFFFFFFFF0000015E960DD7D6010004726F6F74002500174F5265636F726453657269616C697A657242696E61727900164F7269656E7444422045726C616E6720436C69656E740003302E318920A36B98D02120F454C05928F419079AEF6C765E7C0460AC5D9EBC4591A5ED730000002500000001710000000D73656C6563742066726F6D2056FFFFFFFF000000032A3A3100000000`     * Receive: `0x000000001F000000006C00000002000064000900000000000000000000000100000037000256086F75745F000000221608746F746F00000031010874757475000000320700010000000100110000000000000000540874757475000064000A0000000000000000000000010000002B00025606696E5F0000001416027800000023050001000000010011000000000000000040120000000000000200006400110000000000000000000000010000001900024504696E000000150D066F7574000000170D001200140000` * The second TX_COMMAND:     * Send: `0x3C0000001F0000007B00000000047465737400FFFFFFFFFFFFFFFFFFFF0000015E960DD7D6010004726F6F74002500174F5265636F726453657269616C697A657242696E61727900164F7269656E7444422045726C616E6720436C69656E740003302E318920A36B98D02120F454C05928F419079AEF6C765E7C0460AC5D9EBC4591A5ED0000000201010100090000000000000000640000000100000037000256086F75745F000000221608746F746F00000031010874757475000000320700010000000100110000000000000000560874757475010102000A000000000000000064000000010000000003000000`     * Receive: `0x000000001F000000000000000000000001000900000000000000000000000200000000` * The second COMMAND:     * Send: `0x290000001F0000007B00000000047465737400FFFFFFFFFFFFFFFFFFFF0000015E960DD7D6010004726F6F74002500174F5265636F726453657269616C697A657242696E61727900164F7269656E7444422045726C616E6720436C69656E740003302E318920A36B98D02120F454C05928F419079AEF6C765E7C0460AC5D9EBC4591A5ED730000002500000001710000000D73656C6563742066726F6D2056FFFFFFFF000000032A3A3100000000`     * Receive: `0x000000001F000000006C00000001000064000900000000000000000000000200000004000256000`  As you can see, the only remaining V has just an empty record, no field.  Another difference I have with V2 is the disappearance of the E in 3.0.0m2 when 2.2.24 was leaving it undeleted. I was expecting OrientDB to delete the edges connected to deleted vertices. So, in that regard, V3 is behaving better. If only it was not nuking all my fields.</body>
		<created>2017-09-18 16:50:58</created>
		<closed>2017-09-21 19:30:35</closed>
	</bug>
	<bug>
		<id>7728</id>
		<title>Attributes of database are not updated when we pass them in builder</title>
		<body>### OrientDB Version:3.0  ## Steps to reproduce   1. Create OrientDB instance using code  ``` OrientDBConfig config = OrientDBConfig.builder()         .addConfig(OGlobalConfiguration.STORAGE_CHECKSUM_MODE, OChecksumMode.StoreAndSwitchReadOnlyMode).             addAttribute(ODatabase.ATTRIBUTES.MINIMUMCLUSTERS, 1).build();  OrientDB orientDB = new OrientDB("embedded:" + buildPath.toFile().getAbsolutePath(), config); ```  2. Create new class in database schema. 3. Several clusters are created for a single class instead of single one.  </body>
		<created>2017-09-07 14:59:24</created>
		<closed>2017-09-13 17:12:24</closed>
	</bug>
	<bug>
		<id>7712</id>
		<title>Some edges are missing, if graph.query() was called before </title>
		<body>### OrientDB Version: 3.0.0-SNAPSHOT  ### Java Version: 1.8.0_131 ### OS: Windows 10    ## Expected behavior   All vertexes and edges are saved and can be viewed by select query.   ## Actual behavior   Some edges OUT are not found while selecting.   ## Steps to reproduce   Edges OUT are missing in some vertexes, even when they are saved before. The output in Studio is like this:   &lt;img width="915" alt="missing_edges" src="https://user-images.githubusercontent.com/4200801/30028939-c67ea48e-918f-11e7-8c97-9d76a5dc8d85.png"&gt;  If to comment line 149 (graph.query(...) call), everything works as expected:   &lt;img width="902" alt="all_edges" src="https://user-images.githubusercontent.com/4200801/30029124-8d504a36-9190-11e7-8ba0-68ea1e42653f.png"&gt;  Please find code example by link:  https://github.com/arkolesnik/orientdb-automation-transactions/blob/missing_edges_branch/src/test/java/TransactionsTest.java  </body>
		<created>2017-09-04 13:48:03</created>
		<closed>2017-12-29 12:36:15</closed>
	</bug>
	<bug>
		<id>7711</id>
		<title>HA: problem on reading the WAL after server crash</title>
		<body>This has been reproduced 3 times by internal HA testing after restarting random nodes.  ``` 2017-09-04 15:07:57:733 INFO  [node1]-&gt;[node2] Creating delta backup of database 'stress-test-db-20170904_150644' (startLSN=LSN{segment=0, position=1408376}) in directory: /var/folders/zc/y34429014c3bt_x1587qblth0000gn/T/orientdb/backup_node2_stress-test-db-20170904_150644_server0.zip... [OSyncDatabaseDeltaTask]Exception `64C4ED84` in storage `stress-test-db-20170904_150644` java.nio.BufferUnderflowException     at java.nio.HeapByteBuffer.get(HeapByteBuffer.java:151)     at java.nio.ByteBuffer.get(ByteBuffer.java:715)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALPageV2.getRecord(OWALPageV2.java:113)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV2.readRecord(OLogSegmentV2.java:747)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegmentV2.getNextLSN(OLogSegmentV2.java:780)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.next(ODiskWriteAheadLog.java:892)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.recordsChangedAfterLSN(OAbstractPaginatedStorage.java:995)     at com.orientechnologies.orient.server.distributed.impl.task.OSyncDatabaseDeltaTask.deltaBackup(OSyncDatabaseDeltaTask.java:138)     at com.orientechnologies.orient.server.distributed.impl.task.OSyncDatabaseDeltaTask.execute(OSyncDatabaseDeltaTask.java:70)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(ODistributedAbstractPlugin.java:604)     at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(ODistributedAbstractPlugin.java:600)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:347)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:121) ```</body>
		<created>2017-09-04 13:44:53</created>
		<closed>2017-09-08 06:45:09</closed>
	</bug>
	<bug>
		<id>7709</id>
		<title>Error during read of record com.orientechnologies.orient.core.exception.ODatabaseException: Database 'plocal:/home/kisho.dai/mnt/orientdb/orientdb-enterprise-2.2.22/databases/sns' is closed</title>
		<body>### OrientDB Version: Enterprise-2.2.22 ### Java Version: 1.8 ### OS: CentOs  ## Expected behavior   No error log.   The issue is very strange. I can still select/upsert orientdb. But the logs is increasing very quickly .  ## Actual behavior   ``` $ANSI{green {db=sns}} Error during read of record com.orientechnologies.orient.core.exception.ODatabaseException: Database 'plocal:/home/kisho.dai/mnt/orientdb/orientdb-enterprise-2.2.22/databases/sns' is closed DB name="sns" at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.checkOpeness(ODatabaseDocumentTx.java:3145) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1956) at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:98) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1766) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:102) at com.orientechnologies.orient.core.iterator.OIdentifiableIterator.readCurrentRecord(OIdentifiableIterator.java:290) at com.orientechnologies.orient.core.iterator.ORecordIteratorClusters.hasNext(ORecordIteratorClusters.java:167) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1617) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1566) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:525) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:488) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3200) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3138) at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78) at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:755) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLUpdate.execute(OCommandExecutorSQLUpdate.java:303) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3200) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3138) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1520) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:642) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:380) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:203) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  ``` ## Steps to reproduce     </body>
		<created>2017-09-04 07:18:59</created>
		<closed>2017-10-11 10:16:47</closed>
	</bug>
	<bug>
		<id>7704</id>
		<title>Caused by: java.lang.NegativeArraySizeException</title>
		<body>### OrientDB Version: 2.2.17   ### Java Version: 1.8 ### OS: CentOs  ## Expected behavior   Can retrieve record  ## Actual behavior   com.orientechnologies.orient.core.exception.ODatabaseException: Error on retrieving record #110:63406 (cluster: apply_5) DB name="sns" at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:2027) at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:98) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1761) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:102) at com.orientechnologies.orient.core.iterator.OIdentifiableIterator.readCurrentRecord(OIdentifiableIterator.java:290) at com.orientechnologies.orient.core.iterator.ORecordIteratorCluster.hasNext(ORecordIteratorCluster.java:141) at com.orientechnologies.orient.core.index.OIndexAbstract.indexCluster(OIndexAbstract.java:1029) at com.orientechnologies.orient.core.index.OIndexAbstract.fillIndex(OIndexAbstract.java:543) at com.orientechnologies.orient.core.index.OIndexAbstract.rebuild(OIndexAbstract.java:504) at com.orientechnologies.orient.core.index.OIndexAbstract.rebuild(OIndexAbstract.java:407) at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.rebuild(OIndexAbstractDelegate.java:167) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLRebuildIndex.execute(OCommandExecutorSQLRebuildIndex.java:105) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2615) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2561) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106) at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:169) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:621) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.NegativeArraySizeException at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.getBinaryValue(ODurablePage.java:135) at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPage.getRecordBinaryValue(OClusterPage.java:376) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readFullEntry(OPaginatedCluster.java:1950) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecordBuffer(OPaginatedCluster.java:704) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:667) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:646) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doReadRecord(OAbstractPaginatedStorage.java:3297) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:2916) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1114) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3320) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1989) ... 20 more  ## Steps to reproduce    Killed the orientdb process, and then restart.   </body>
		<created>2017-09-01 00:46:05</created>
		<closed>2017-10-11 11:36:23</closed>
	</bug>
	<bug>
		<id>7702</id>
		<title>Some ClusterPositions are negative after commit if a select query is performed before</title>
		<body>### OrientDB Version: 3.0.0-SNAPSHOT   ### Java Version: 1.8.0_131 ### OS: Windows 10  ## Expected behavior   All clusterPositions become positive after commit.     ## Actual behavior   Some clusterPositions remain negative after commit, if a select query is performed before (try to comment/uncomment line 128).   ## Steps to reproduce   1. Add some number of vertexes and edges in a loop. 2. Perform some select operation inside the loop, when some vertexes and edges are added.  3. Commit.  4. Check vertexes clusterPositions - some of them are negative.   Please find code example by link: https://github.com/arkolesnik/orientdb-automation-transactions/blob/temp/src/test/java/TransactionsTest.java  Vertexes before commit:  &lt;img width="687" alt="before_commit" src="https://user-images.githubusercontent.com/4200801/29920991-addf28a2-8e58-11e7-9331-211723c14500.png"&gt;  Vertexes after commit:  &lt;img width="672" alt="after_commit" src="https://user-images.githubusercontent.com/4200801/29920996-b67a7bba-8e58-11e7-84e2-b9a2c8e24e39.png"&gt;  </body>
		<created>2017-08-31 11:25:57</created>
		<closed>2017-12-29 12:36:55</closed>
	</bug>
	<bug>
		<id>7698</id>
		<title>lusterIds of not commited vertexes and edges become positive after select operation</title>
		<body>### OrientDB Version: 3.0.0-SNAPSHOT   ### Java Version: 1.8.0_131  ### OS: Windows 10  ## Expected behavior   Select operation shouldn't change clusterIds of not commited records from negative to positive ones, as select is idempotent operation.  ## Actual behavior   ClusterIds of vertexes and edges stored in ArrayList remain negative before select and changed to positive just after it. See attachments.  ## Steps to reproduce   1.  Create instance of db: OrientDB orientDB = new OrientDB(URL, OrientDBConfig.defaultConfig()); ODatabaseSession graph = orientDB.open(DB_NAME, DB_USERNAME, DB_PASSWORD); 2. Create classes for vertexes and edges:  graph.createVertexClass(VERTEX_CLASS); graph.createEdgeClass(EDGE_LABEL); 3. Add some vertexes and save them:  OVertex vertex = graph.newVertex(VERTEX_CLASS); vertex.save(); 4. Connect them by edges: newEdge(vertexes.get(i - 1), vertexes.get(i), EDGE_LABEL); 5. Put vertexes in some collection.  6.  Perform select operation, for example:   graph.query("select * from V where " + VERTEX_ID + " &lt;= ? order by " + VERTEX_ID + " limit " + limit, lastId);   &lt;img width="923" alt="before_select" src="https://user-images.githubusercontent.com/4200801/29869300-217b61d2-8d8b-11e7-971d-5f5e167f665e.png"&gt;  &lt;img width="923" alt="after_select" src="https://user-images.githubusercontent.com/4200801/29869315-2aea3c02-8d8b-11e7-8c84-7d99b3c1d800.png"&gt;   </body>
		<created>2017-08-30 11:00:30</created>
		<closed>2017-08-31 10:27:40</closed>
	</bug>
	<bug>
		<id>7695</id>
		<title>IllegalstateException when client or storage shut down</title>
		<body>Launching the QA tests  on distribution module, at the end this exception appears: ```shell Exception in thread "Thread-64" java.lang.IllegalStateException: Connection cannot be released because the pool doesn't exist anymore at com.orientechnologies.orient.client.remote.ORemoteConnectionManager.remove(ORemoteConnectionManager.java:127) at com.orientechnologies.orient.client.remote.OStorageRemote.onPushDisconnect(OStorageRemote.java:1931) at com.orientechnologies.orient.client.remote.OStorageRemotePushThread.run(OStorageRemotePushThread.java:66) ```  To launch the tests in distribution module:  mvn clean install -Pqa</body>
		<created>2017-08-29 10:29:48</created>
		<closed>2017-12-14 16:49:07</closed>
	</bug>
	<bug>
		<id>7694</id>
		<title>Memory leak detector is switched off</title>
		<body>When I run tests I see a lot of: " DIRECT-TRACK: unreleased direct memory buffer `6D1058B7` detected. java.lang.Exception         at com.orientechnologies.common.directmemory.OByteBufferPool$TrackedBufferReference.&lt;init&gt;(OByteBufferPool.java:816)         at com.orientechnologies.common.directmemory.OByteBufferPool.track(OByteBufferPool.java:743)         at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:301)         at com.orientechnologies.orient.core.storage.impl.memory.ODirectMemoryOnlyDiskCache$MemoryFile.addNewPage(ODirectMemoryOnlyDiskCache.java:535) "  We need to detect leaks in fail tests in such cases</body>
		<created>2017-08-29 09:49:14</created>
		<closed>2017-09-22 13:49:03</closed>
	</bug>
	<bug>
		<id>7680</id>
		<title>LIMIT clause not working in DELETE EDGE syntax</title>
		<body>### OrientDB Version: 2.2.26 + 3.0.0-SNAPSHOT ### Java Version: 1.8 ### OS: win 10 64bit  ## Expected behavior   LIMIT x limits the number of deleted records to x  ## Actual behavior   all records that match the delete query are removed  ## Steps to reproduce   - create vertex class1 and vertex class2 - create vertex a in class1 and vertex b in class2 - create edge class class3 - create x edges (e.g. 4) from a to b using class class3 - execute query  DELETE EDGE class3 FROM (SELECT FROM class1 WHERE your_primary_key) TO (SELECT FROM class2 WHERE your_primary_key) LIMIT 1;  In demoDB:  execute a few times the query:  CREATE EDGE HasVisited FROM (SELECT FROM Customers WHERE OrderedId=31) TO (SELECT FROM Castles WHERE Id=28);  execute the following query from the graph editor to see how many edges you have:  MATCH {class:Customers, WHERE:(OrderedId=31)}--{class:Castles, WHERE:(Id=28)} return $pathelements  in my case,  I have 4 edges:  ![edges](https://user-images.githubusercontent.com/14923389/29690164-2ce1b238-8926-11e7-975a-b27ed38591f7.PNG)  execute delete query - note the limit 1:  DELETE EDGE HasVisited FROM (SELECT FROM Customers WHERE OrderedId=31) TO (SELECT FROM Castles WHERE Id=28) LIMIT 1   note the value = 4 in the image:  ![edges2](https://user-images.githubusercontent.com/14923389/29690182-3f3bf254-8926-11e7-85f7-ee09e8ec17af.PNG)  execute again the match query to see how many edges there are --&gt; no edges (should be 4-1 = 3)  Thanks, </body>
		<created>2017-08-24 21:50:58</created>
		<closed>2017-09-06 15:42:15</closed>
	</bug>
	<bug>
		<id>7679</id>
		<title>Test testCreateVertexByContent with CP-1251 encoding</title>
		<body>The test does not pass because SQL parser uses system encoding instead of DB encoding. The same problem exists in several Lucene tests too. I suppose DB encoding should be used by default.  </body>
		<created>2017-08-24 14:59:04</created>
		<closed>2017-10-10 12:51:29</closed>
	</bug>
	<bug>
		<id>7674</id>
		<title>OrientDB does not recover after abrupt power failure - EOFException - OStorageException: Cannot open local storage '/.../ddnmondb' with mode=rw</title>
		<body>### OrientDB Version: OrientDB Server v2.2.25 (build 72a35a4bb42c4ca33272e7a59ad4c7a1d3ee859d) ### Java Version:  java version "1.8.0_121" Java(TM) SE Runtime Environment (build 1.8.0_121-b13) Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)   ### OS: CentOS Linux release 7.2.1511 (Core)  ## Expected behavior   the database recovers after an abrupt power failure   ## Actual behavior   Database is unable to recover    ## Steps to reproduce   We have a two node cluster. Both nodes were operational and then the data-center experienced an abrupt power failure and when power was restored. Node1- complained that it is waiting on Node2 to acquire a lock (as expected) since this database is owned by Node2. On Node2, we are seeing the following exception.  ``` OStorageException: Cannot open local storage '/.../ddnmondb' with mode=rw ... Caused by: java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:197) at java.io.DataInputStream.readLong(DataInputStream.java:416) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:658) ```  Additional Details:  ``` &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; devdm3n2 (NODE2) Exception &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2017-08-21 18:04:04:626 INFO  [192.168.1.156]:2434 [5e29b2a28563955899c1f5ee92bb553a] [3.6.5] All migration tasks have been completed, queues are empty. [InternalPartitionService]$ANSI{green {db=ddnmondb}} Exception `7637B209` in storage `ddnmondb` com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/data/ddnmon/orientdb/databases/ddnmondb' with mode=rw DB name="ddnmondb" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:299) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:258) at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:987) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:954) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:939) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.reassignClustersOwnership(ODistributedAbstractPlugin.java:739) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:740) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1686) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:254) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1249) at com.orientechnologies.orient.server.OServer.activate(OServer.java:399) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot restore state of cache for storage placed under /data/ddnmon/orientdb/databases/ddnmondb DB name="ddnmondb" at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:685) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:279) ... 13 more Caused by: java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:197) at java.io.DataInputStream.readLong(DataInputStream.java:416) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:658) ... 14 more [devdm3n2] Error on starting distributed plugin com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/data/ddnmon/orientdb/databases/ddnmondb' with mode=rw DB name="ddnmondb" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:299) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:258) at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:987) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:954) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:939) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.reassignClustersOwnership(ODistributedAbstractPlugin.java:739) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:740) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1686) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:254) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1249) at com.orientechnologies.orient.server.OServer.activate(OServer.java:399) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot restore state of cache for storage placed under /data/ddnmon/orientdb/databases/ddnmondb DB name="ddnmondb" at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:685) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:279) ... 13 more Caused by: java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:197) at java.io.DataInputStream.readLong(DataInputStream.java:416) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:658) ... 14 more com.orientechnologies.orient.server.distributed.ODistributedStartupException: Error on starting distributed plugin at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:309) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1249) at com.orientechnologies.orient.server.OServer.activate(OServer.java:399) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/data/ddnmon/orientdb/databases/ddnmondb' with mode=rw DB name="ddnmondb" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:299) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:258) at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:987) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:954) at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:939) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.reassignClustersOwnership(ODistributedAbstractPlugin.java:739) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:740) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1686) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:254) ... 3 more Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot restore state of cache for storage placed under /data/ddnmon/orientdb/databases/ddnmondb DB name="ddnmondb" at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:685) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:279) ... 13 more Caused by: java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:197) at java.io.DataInputStream.readLong(DataInputStream.java:416) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.loadCacheState(O2QCache.java:658) ... 14 more &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; devdm3n1 (NODE1) EXCEPTION &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2017-08-21 18:04:24:440 WARNI [devdm3n1]-&gt;[devdm3n2] Server 'devdm3n1' cannot acquire distributed lock on resource 'ddnmondb' (timeout=20000)... [ODistributedLockManagerRequester][devdm3n1] Error on starting distributed plugin com.orientechnologies.common.concur.lock.OLockException: Server 'devdm3n1' cannot acquire exclusive lock on resource 'ddnmondb' (timeout=20000) at com.orientechnologies.orient.server.distributed.impl.ODistributedLockManagerRequester.acquireExclusiveLock(ODistributedLockManagerRequester.java:72) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1669) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:254) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1249) at com.orientechnologies.orient.server.OServer.activate(OServer.java:399) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) com.orientechnologies.orient.server.distributed.ODistributedStartupException: Error on starting distributed plugin at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:309) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1249) at com.orientechnologies.orient.server.OServer.activate(OServer.java:399) at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) Caused by: com.orientechnologies.common.concur.lock.OLockException: Server 'devdm3n1' cannot acquire exclusive lock on resource 'ddnmondb' (timeout=20000) at com.orientechnologies.orient.server.distributed.impl.ODistributedLockManagerRequester.acquireExclusiveLock(ODistributedLockManagerRequester.java:72) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1669) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:727) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:254) ... 3 more Error executing request com.orientechnologies.orient.core.exception.ODatabaseException: Error on plugin lookup: the server did not start correctly DB name="ddnmondb" at com.orientechnologies.orient.server.OServer.getPlugin(OServer.java:860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.openDatabase(ONetworkProtocolBinary.java:930) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.handshakeRequest(ONetworkProtocolBinary.java:238) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:203) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Error executing request com.orientechnologies.orient.core.exception.ODatabaseException: Error on plugin lookup: the server did not start correctly DB name="ddnmondb" at com.orientechnologies.orient.server.OServer.getPlugin(OServer.java:860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.openDatabase(ONetworkProtocolBinary.java:930) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.handshakeRequest(ONetworkProtocolBinary.java:238) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:203) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Error executing request com.orientechnologies.orient.core.exception.ODatabaseException: Error on plugin lookup: the server did not start correctly DB name="ddnmondb" at com.orientechnologies.orient.server.OServer.getPlugin(OServer.java:860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.openDatabase(ONetworkProtocolBinary.java:930) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.handshakeRequest(ONetworkProtocolBinary.java:238) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:203) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Error executing request com.orientechnologies.orient.core.exception.ODatabaseException: Error on plugin lookup: the server did not start correctly DB name="ddnmondb" at com.orientechnologies.orient.server.OServer.getPlugin(OServer.java:860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.openDatabase(ONetworkProtocolBinary.java:930) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.handshakeRequest(ONetworkProtocolBinary.java:238) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:203) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Error executing request com.orientechnologies.orient.core.exception.ODatabaseException: Error on plugin lookup: the server did not start correctly DB name="ddnmondb" at com.orientechnologies.orient.server.OServer.getPlugin(OServer.java:860) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.openDatabase(ONetworkProtocolBinary.java:930) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.handshakeRequest(ONetworkProtocolBinary.java:238) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:203) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ```</body>
		<created>2017-08-22 18:15:16</created>
		<closed>2017-08-24 15:39:01</closed>
	</bug>
	<bug>
		<id>7673</id>
		<title>Boolean filter not returning zero when .size() is used</title>
		<body>When we filter over a boolean attribute and use .size() plus an alias, the alias is not returned if the filter doesn't find any matches:  `[completed=true].size() AS totalCompleted`  I was really expecting totalCompleted to be returned and to have an integer as value, starting from zero, of course. Instead it is not returned at all if there are no completed=true around.  Thanks</body>
		<created>2017-08-21 15:53:05</created>
		<closed>2017-08-24 11:14:57</closed>
	</bug>
	<bug>
		<id>7671</id>
		<title>"Error deserializing record to get field-names" with non-bundled gremlin client</title>
		<body>### OrientDB Version: orientdb-community-tp3-3.0.0m2  ### Java Version: openjdk version "1.8.0_141" ### OS:  Fedora 26 x86_64  Not sure if this is a bug somewhere, or expected and I'm missing something.  I start the orientdb server with "server.sh" and load default config. I access "demodb" through the studio web application and everything seems to work 100%.  ## Expected behavior    Then start gremlin.sh that comes with orient, and get: $ ./gremlin.sh            \,,,/          (o o) -----oOOo-(3)-oOOo----- plugin activated: tinkerpop.orientdb gremlin&gt; graph = OrientGraph.open("remote:localhost/demodb","root","root") SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder". SLF4J: Defaulting to no-operation (NOP) logger implementation SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details. ==&gt;orientgraph[remote:localhost/demodb] gremlin&gt; g = graph.traversal() ==&gt;graphtraversalsource[orientgraph[remote:localhost/demodb], standard] gremlin&gt; g.V().has('Name', 'Belgium') ==&gt;v[#36:2]  All good.  ## Actual behavior    I'm building an app, so gradle pulls all the right libraries - but I get an error when doing the g.V().has in my app. So tried doing the same using a non-bundled gremlin-console and then I get the same issue - so will tackle from that use-case as I think it's simpler.  When I try with the non-bundled version I get: $ gremlin.sh            \,,,/          (o o) -----oOOo-(3)-oOOo----- plugin activated: tinkerpop.server plugin activated: tinkerpop.utilities plugin activated: tinkerpop.orientdb plugin activated: tinkerpop.neo4j plugin activated: tinkerpop.tinkergraph gremlin&gt; graph = OrientGraph.open("remote:localhost/demodb","root","root") ==&gt;orientgraph[remote:localhost/demodb] gremlin&gt; g = graph.traversal() ==&gt;graphtraversalsource[orientgraph[remote:localhost/demodb], standard] gremlin&gt; g.V().has('Name', 'Belgium') Aug 19, 2017 7:10:10 PM com.orientechnologies.common.log.OLogManager log WARNING: Error deserializing record to get field-names, send this data for debugging: EkN1c3RvbWVycxIcb3V0X01hZGVSZXZpZXcW/////////////////////wEcpAMSpgMSpAM6qANQogNipgN4sAOIAa4DsAGqA9gBrAPYAagDgAKqA4ACpgOoAqgDqAIST3JkZXJlZElkA1IKUGhvbmUHFisxNjAwOTA3NDYyIm91dF9Jc0Zyb21Db3VudHJ5Fv////////////////////8BAqICChpvdXRfSGFzU3RheWVkFv////////////////////8BCsICLMQCLMYCLMgCLMoCLBhvdXRfSGFzRWF0ZW4W/////////////////////wEo4AJQ0gJS1AJS1gJS2AJS2gJS3AJS3gJS4AJS0gJU1AJU1gJU2AJU2gJU3AJU3gJU4AJU0gJW1AJW1gJWHG91dF9IYXNQcm9maWxlFv////////////////////8BAvICChxpbl9IYXNDdXN0b21lchb/////////////////////AQqOAzSKA06GA2iQA4ABigOaARxvdXRfSGFzVmlzaXRlZBb/////////////////////ApCIgIDAzMje+AEAgCAA  441  So there must be some difference in the way standalone gremlin starts up or the libraries it loads?  ## Steps to reproduce    Do all steps as in expected behaviour - then download apache-tinkerpop-gremlin-console-3.2.5-bin.zip from tinkerpop website.  Unpack gremlin console and start it - then do:  gremlin&gt; :install com.orientechnologies orientdb-gremlin 3.0.0m2 gremlin&gt; :plugin use tinkerpop.orientdb gremlin&gt; graph = OrientGraph.open("remote:localhost/demodb","root","root") gremlin&gt; g = graph.traversal() gremlin&gt; g.V().has('Name', 'Belgium')  Then the error as above.</body>
		<created>2017-08-19 17:40:53</created>
		<closed>2017-08-24 08:11:54</closed>
	</bug>
	<bug>
		<id>7669</id>
		<title>OPaginatedCluster.deleteRecord null(OrientDB-2.1.11)</title>
		<body>ERROR [2017-08-18T14:06:59,133] : [InventoryDataPersisterMaster_MajorEventInventoryDataBuilder] : MajorEventInventoryWriter: (): com.orientechnologies.orient.core.exception.OStorageException: null         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:705) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:1955) ~[orientdb-core-2.1.11.jar :2.1.11]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:743) ~[orientdb-core-2.1.11.jar:2. 1.11]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1999) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2514) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2444) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.record.ORecordAbstract.save(ORecordAbstract.java:287) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.record.ORecordAbstract.save(ORecordAbstract.java:279) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.record.ORecordAbstract.save(ORecordAbstract.java:48) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:675) ~[or ientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:689) ~[o rientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:574) ~[ori entdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260) ~[orientdb-c ore-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105) ~[orientdb-core-2 .1.11.jar:2.1.11]         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:2446) ~[orientdb-core-2.1.11.jar:2. 1.11]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1181) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2689) ~[orientdb-core-2.1.11.jar:2.1.11]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2658) ~[orientdb-core-2.1.11.jar:2.1.11] at in.co.nmsworks.documenttdb.db.DocDB.commit(DocDB.java:645) ~[cygnetfc.jar:?]         at in.co.nmsworks.cygnet.telecom.fault.rcasia.majorevent.inventory.persister.MajorEventInventoryWriter.addOrUpdateCircuitOrSNCTrees(MajorEventInventoryWriter.java:101) ~[cygnet-otnms.jar:?]         at in.co.nmsworks.cygnet.telecom.fault.rcasia.majorevent.inventory.persister.MajorEventInventoryDataPersister.doWorkForUpdate(MajorEventInventoryDataPersister.java:76) ~[cygnet-otnms.jar:?]         at in.co.nmsworks.cygnet.telecom.fault.rcasia.inventory.queue.InventoryDataPersisterMaster.run(InventoryDataPersisterMaster.java:95) ~[cygnet-otnms.jar:?]         at java.lang.Thread.run(Thread.java:745) [?:1.7.0_71] Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused this rollback is : com.orientechnologies.orient.core.exception.OStorageException         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:434)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:1938)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:743)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1999)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2514)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2444)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)         at com.orientechnologies.orient.core.record.ORecordAbstract.save(ORecordAbstract.java:287)         at com.orientechnologies.orient.core.record.ORecordAbstract.save(ORecordAbstract.java:279)         at com.orientechnologies.orient.core.record.ORecordAbstract.save(ORecordAbstract.java:48)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:675)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:689)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:574)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:2446)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1181)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2689)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2658)         at in.co.nmsworks.documenttdb.db.DocDB.commit(DocDB.java:645)    Client version -- 68</body>
		<created>2017-08-19 10:16:17</created>
		<closed>2017-09-02 10:46:41</closed>
	</bug>
	<bug>
		<id>7665</id>
		<title>OutOfMemoryError: Direct buffer memory. Build unique hash index on big table</title>
		<body>### OrientDB Version: 2.2.26-snapshot   ### Java Version: 1.8.131   ### OS:  centos 7      ## Actual behavior   `/bin/java -d64 -server -XX:+UseG1GC -Xms4G -Xmx16G -Djna.nosys=true -Dmemory.directMemory.trackMode=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=10g -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 -Djava.util.logging.config.file=/gp/data/arangodb/orientdb-community-2.2.26-SNAPSHOT/config/orientdb-server-log.properties -Dorientdb.config.file=/gp/data/arangodb/orientdb-community-2.2.26-SNAPSHOT/config/orientdb-server-config.xml -Dorientdb.www.path=/gp/data/arangodb/orientdb-community-2.2.26-SNAPSHOT/www -Dorientdb.build.number=2.2.x@r72a35a4bb42c4ca33272e7a59ad4c7a1d3ee859d; 2017-08-02 13:50:43+0000 -cp /gp/data/arangodb/orientdb-community-2.2.26-SNAPSHOT/lib/orientdb-server-2.2.25.jar:/gp/data/arangodb/orientdb-community-2.2.26-SNAPSHOT/lib/*:/gp/data/arangodb/orientdb-community-2.2.26-SNAPSHOT/plugins/* com.orientechnologies.orient.server.OServerMa`  ``` 2017-08-17 12:03:18:528 INFO  {db=test} --&gt; 79.34% progress, 91,635,575 indexed so far (17,821 items/sec) [OIndexRebuildOutputListener] 2017-08-17 12:03:28:529 INFO  {db=test} --&gt; 79.50% progress, 91,812,618 indexed so far (17,704 items/sec) [OIndexRebuildOutputListener] 2017-08-17 12:03:38:530 INFO  {db=test} --&gt; 79.65% progress, 91,988,180 indexed so far (17,556 items/sec) [OIndexRebuildOutputListener]$ANSI{green {db=test}} Exception `549F3242` in storage `test` java.lang.OutOfMemoryError: Direct buffer memory         at java.nio.Bits.reserveMemory(Bits.java:693)         at java.nio.DirectByteBuffer.&lt;init&gt;(DirectByteBuffer.java:123)         at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)         at com.orientechnologies.common.directmemory.OByteBufferPool.allocateBuffer(OByteBufferPool.java:335)         at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:286)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.loadFileContent(OWOWCache.java:1454)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:701)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1147)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:349)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.load(O2QCache.java:294)         at com.orientechnologies.orient.core.storage.cache.pages.OLruPageCache.loadPage(OLruPageCache.java:71)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.loadPage(OAtomicOperation.java:128)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:150)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:142)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1530)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:1459)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.validatedPut(OLocalHashTable.java:412)         at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.validatedPut(OHashTableIndexEngine.java:156)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doValidatedPutIndexValue(OAbstractPaginatedStorage.java:2357)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.validatedPutIndexValue(OAbstractPaginatedStorage.java:2336)         at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:82)         at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:35)         at com.orientechnologies.orient.core.index.OIndexAbstract.populateIndex(OIndexAbstract.java:940)         at com.orientechnologies.orient.core.index.OIndexAbstract.indexCluster(OIndexAbstract.java:1040)         at com.orientechnologies.orient.core.index.OIndexAbstract.fillIndex(OIndexAbstract.java:539)         at com.orientechnologies.orient.core.index.OIndexAbstract.create(OIndexAbstract.java:250)         at com.orientechnologies.orient.core.index.OIndexOneValue.create(OIndexOneValue.java:129)         at com.orientechnologies.orient.core.index.OIndexOneValue.create(OIndexOneValue.java:40)         at com.orientechnologies.orient.core.index.OIndexManagerShared.createIndex(OIndexManagerShared.java:169)         at com.orientechnologies.orient.core.index.OIndexManagerProxy.createIndex(OIndexManagerProxy.java:87)         at com.orientechnologies.orient.core.metadata.schema.OClassImpl.createIndex(OClassImpl.java:1897)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLCreateIndex.execute(OCommandExecutorSQLCreateIndex.java:269)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3213)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3151)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) $ANSI{green {db=test}} Exception `549F3242` in storage `test` java.lang.OutOfMemoryError: Direct buffer memory         at java.nio.Bits.reserveMemory(Bits.java:693)         at java.nio.DirectByteBuffer.&lt;init&gt;(DirectByteBuffer.java:123)         at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)         at com.orientechnologies.common.directmemory.OByteBufferPool.allocateBuffer(OByteBufferPool.java:335)         at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:286)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.loadFileContent(OWOWCache.java:1454)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:701)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1147)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:349)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.load(O2QCache.java:294)         at com.orientechnologies.orient.core.storage.cache.pages.OLruPageCache.loadPage(OLruPageCache.java:71)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.loadPage(OAtomicOperation.java:128)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:150)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:142)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1530)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:1459)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.validatedPut(OLocalHashTable.java:412)         at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.validatedPut(OHashTableIndexEngine.java:156)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doValidatedPutIndexValue(OAbstractPaginatedStorage.java:2357)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.validatedPutIndexValue(OAbstractPaginatedStorage.java:2336)         at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:82)         at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:35)         at com.orientechnologies.orient.core.index.OIndexAbstract.populateIndex(OIndexAbstract.java:940)         at com.orientechnologies.orient.core.index.OIndexAbstract.indexCluster(OIndexAbstract.java:1040)         at com.orientechnologies.orient.core.index.OIndexAbstract.fillIndex(OIndexAbstract.java:539)         at com.orientechnologies.orient.core.index.OIndexAbstract.create(OIndexAbstract.java:250)         at com.orientechnologies.orient.core.index.OIndexOneValue.create(OIndexOneValue.java:129)         at com.orientechnologies.orient.core.index.OIndexOneValue.create(OIndexOneValue.java:40)         at com.orientechnologies.orient.core.index.OIndexManagerShared.createIndex(OIndexManagerShared.java:169)         at com.orientechnologies.orient.core.index.OIndexManagerProxy.createIndex(OIndexManagerProxy.java:87)         at com.orientechnologies.orient.core.metadata.schema.OClassImpl.createIndex(OClassImpl.java:1897)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLCreateIndex.execute(OCommandExecutorSQLCreateIndex.java:269)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3213)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3151)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) $ANSI{green {db=test}} Exception `549F3242` in storage `test` java.lang.OutOfMemoryError: Direct buffer memory         at java.nio.Bits.reserveMemory(Bits.java:693)         at java.nio.DirectByteBuffer.&lt;init&gt;(DirectByteBuffer.java:123)         at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)         at com.orientechnologies.common.directmemory.OByteBufferPool.allocateBuffer(OByteBufferPool.java:335)         at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:286)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.loadFileContent(OWOWCache.java:1454)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:701)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1147)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:349)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.load(O2QCache.java:294)         at com.orientechnologies.orient.core.storage.cache.pages.OLruPageCache.loadPage(OLruPageCache.java:71)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.loadPage(OAtomicOperation.java:128)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:150)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:142)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1530)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:1459)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.validatedPut(OLocalHashTable.java:412)         at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.validatedPut(OHashTableIndexEngine.java:156)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doValidatedPutIndexValue(OAbstractPaginatedStorage.java:2357)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.validatedPutIndexValue(OAbstractPaginatedStorage.java:2336)         at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:82)         at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:35)         at com.orientechnologies.orient.core.index.OIndexAbstract.populateIndex(OIndexAbstract.java:940)         at com.orientechnologies.orient.core.index.OIndexAbstract.indexCluster(OIndexAbstract.java:1040)         at com.orientechnologies.orient.core.index.OIndexAbstract.fillIndex(OIndexAbstract.java:539)         at com.orientechnologies.orient.core.index.OIndexAbstract.create(OIndexAbstract.java:250)         at com.orientechnologies.orient.core.index.OIndexOneValue.create(OIndexOneValue.java:129)         at com.orientechnologies.orient.core.index.OIndexOneValue.create(OIndexOneValue.java:40)         at com.orientechnologies.orient.core.index.OIndexManagerShared.createIndex(OIndexManagerShared.java:169)         at com.orientechnologies.orient.core.index.OIndexManagerProxy.createIndex(OIndexManagerProxy.java:87)         at com.orientechnologies.orient.core.metadata.schema.OClassImpl.createIndex(OClassImpl.java:1897)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLCreateIndex.execute(OCommandExecutorSQLCreateIndex.java:269)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3213)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3151)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  2017-08-17 12:05:14:339 INFO  Database 'GratefulDeadConcerts' uses 8,694MB/10,238MB of DISKCACHE memory, while Heap is not completely used (usedHeap=4096MB maxHeap=16384MB). To improve performance set maxHeap to 4915MB and DISKCACHE to 21706MB [OAbstractProfiler$MemoryChecker] 2017-08-17 12:05:14:339 INFO  -&gt; Open server.sh (or server.bat on Windows) and change the following variables: 1) MAXHEAP=-Xmx4915M 2) MAXDISKCACHE=21706 [OAbstractProfiler$MemoryChecker]    ## Steps to reproduce   ``` &lt;add here&gt;    </body>
		<created>2017-08-17 04:53:58</created>
		<closed>2017-08-30 04:52:40</closed>
	</bug>
	<bug>
		<id>7663</id>
		<title>3.0.0-m2 - integer instead of floating point is returned</title>
		<body>Hi,  demodb, query:  SELECT   count(*) as OrdersNumber,   sum(Amount) AS TotalRevenuesFromOrders,   min(Amount) as MinAmount,   (sum(Amount)/count(*)) as AverageAmount,   max(Amount) as MaxAmount FROM Orders  AverageAmount should be floating point (an integer result is returned instead)  Thanks</body>
		<created>2017-08-16 12:40:32</created>
		<closed>2017-08-16 14:23:00</closed>
	</bug>
	<bug>
		<id>7661</id>
		<title>3.0.0-m2 - NPE on a query</title>
		<body>Hi,  Non blocking for me, but I think we should fix the NPE or return better error - FYI  on demodb:  **1.** java.lang.NullPointerException: SELECT count(*) FROM Orders GROUP BY OrderDate.format('yyyy')  **2.** works as expected: SELECT count(*), OrderDate.format('yyyy') as year FROM Orders GROUP BY year  **3.** return strange recordsets: SELECT count(*), OrderDate.format('yyyy') FROM Orders GROUP BY OrderDate.format('yyyy')  **4** works as expected: SELECT count(*), OrderDate.format('yyyy') as year FROM Orders GROUP BY OrderDate.format('yyyy') </body>
		<created>2017-08-16 11:44:15</created>
		<closed>2017-08-16 13:47:35</closed>
	</bug>
	<bug>
		<id>7656</id>
		<title>new OrientGraph java.lang.OutOfMemoryError: Direct buffer memory</title>
		<body>### OrientDB Version: 2.2.25 ### Java Version: 8 ### OS: Darwin xxx.local 16.5.0 Darwin Kernel Version 16.5.0: Fri Mar  3 16:52:33 PST 2017; root:xnu-3789.51.2~3/RELEASE_X86_64 x86_64  ## Expected behavior   Java params -Xmx1024m -Xms256m storage.diskCache.bufferSize=128 graph = new OrientGraph(settings.getUrl(), settings.getLogin(), settings.getPassword()); No error...  ## Actual behavior   2017-08-15 10:36:34 s.c.s.a.d.b.BluePrintDatabaseUtil [ERROR] orient cannot restore WAL file:Direct buffer memory java.lang.OutOfMemoryError: Direct buffer memory at java.nio.Bits.reserveMemory(Bits.java:658) at java.nio.DirectByteBuffer.&lt;init&gt;(DirectByteBuffer.java:123) at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311) at com.orientechnologies.common.directmemory.OByteBufferPool.allocateBuffer(OByteBufferPool.java:328) at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:279) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:769) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1149) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:347) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.allocateNewPage(O2QCache.java:398) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.commitChanges(OAtomicOperation.java:434) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:468) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:412) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.create(OPaginatedCluster.java:195) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.addClusterInternal(OAbstractPaginatedStorage.java:4136) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doAddCluster(OAbstractPaginatedStorage.java:4117) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.create(OAbstractPaginatedStorage.java:459) at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.create(OLocalPaginatedStorage.java:127) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.create(ODatabaseDocumentTx.java:438) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.create(ODatabaseDocumentTx.java:398) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.openOrCreate(OrientBaseGraph.java:1980) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:162) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:102) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:98) at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:103) at ..  Thereafter, try to reconnect to db...   2017-08-15 10:37:46 s.c.s.a.d.Services [ERROR] error:stop:com.orientechnologies.orient.core.exception.ODatabaseException: Database created with orientdb version not supported anymore, use export+import to migrate the database DB name="archiva$sueZ0E_CWnbNnsPv6otyw_BztqxW2eiQM6uYfQ9B7OU" com.orientechnologies.orient.core.exception.ODatabaseException: Database created with orientdb version not supported anymore, use export+import to migrate the database DB name="archiva$sueZ0E_CWnbNnsPv6otyw_BztqxW2eiQM6uYfQ9B7OU" at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.initAtFirstOpen(ODatabaseDocumentTx.java:3163) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:270) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.openOrCreate(OrientBaseGraph.java:1978) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:162) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:102) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:98) at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:103) at ..  Restart server. try to reconnect with .24 com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/Library/Application Support/MailArchiva/sueZ0E_CWnbNnsPv6otyw_BztqxW2eiQM6uYfQ9B7OU/database/archiva$sueZ0E_CWnbNnsPv6otyw_BztqxW2eiQM6uYfQ9B7OU' with mode=rw DB name="archiva$sueZ0E_CWnbNnsPv6otyw_BztqxW2eiQM6uYfQ9B7OU" at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:299) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:258) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.openOrCreate(OrientBaseGraph.java:1978) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:162) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:102) at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:98) at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:103) at .. Caused by: com.orientechnologies.common.io.OIOException: You cannot access outside the file size (0 bytes). You have requested portion 0-4 bytes. File: File: database.ocf os-size=1024, stored=0 at com.orientechnologies.orient.core.storage.fs.OFileClassic.checkRegions(OFileClassic.java:517) at com.orientechnologies.orient.core.storage.fs.OFileClassic.readInt(OFileClassic.java:250) at com.orientechnologies.orient.core.storage.impl.local.OStorageConfigurationSegment.load(OStorageConfigurationSegment.java:103) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:240) ... 14 common frames omitted  It should not try to allocate more direct memory than is available. Also, why is it now, showing a database compatibility / acess errors?   ## Steps to reproduce    See above   </body>
		<created>2017-08-15 08:36:13</created>
		<closed>2017-09-02 10:47:13</closed>
	</bug>
	<bug>
		<id>7654</id>
		<title>3.0-m2 - maxdepth seems not working</title>
		<body>### OrientDB Version: 3.0-m2  On demodb, try:  SELECT COUNT(*)  FROM (   TRAVERSE * FROM (     SELECT FROM Profiles WHERE Name='Santo' and Surname='OrientDB'   ) MAXDEPTH 1 )  SELECT COUNT(*)  FROM (   TRAVERSE * FROM (     SELECT FROM Profiles WHERE Name='Santo' and Surname='OrientDB'   ) MAXDEPTH 2 )  SELECT COUNT(*)  FROM (   TRAVERSE * FROM (     SELECT FROM Profiles WHERE Name='Santo' and Surname='OrientDB'   ) MAXDEPTH 3 )  The queries above all return 21303 as result. This is a regression  Thanks,</body>
		<created>2017-08-13 22:42:18</created>
		<closed>2017-08-14 09:24:28</closed>
	</bug>
	<bug>
		<id>7641</id>
		<title>Issue on direct memory allocation in scala+sbt environment</title>
		<body>### OrientDB Version: 2.2.25 2.2.26-SNAPSHOT ### Java Version: java 8 ### OS: Debian  ## Expected behavior   Test case: https://github.com/fixundfertig123/7547/blob/InMemoryErrorFlatSpec/src/test/scala/Test.scala goes smooth  ## Actual behavior   Out Of Memory on Direct Memory  allocation  ## Steps to reproduce    Checkout the project https://github.com/fixundfertig123/7547 on the branch https://github.com/fixundfertig123/7547/tree/InMemoryErrorFlatSpec  and run `sbt clean` + `sbt compile` + `sbt test`  from previous debug session the issue seems to come from a allocation size calculation issue: ``` maxPagesPerSingleArea(16384)*pageSize(65536) or preAllocationLimit(4294967296) - [bufferIndex(0)* maxPagesPerSingleArea(16384)*pageSize(65536) Allocating of size 1048576Kb ```    </body>
		<created>2017-08-10 11:57:00</created>
		<closed>2017-08-29 13:49:37</closed>
	</bug>
	<bug>
		<id>7636</id>
		<title>NumberFormatException for input string </title>
		<body>### OrientDB Version: 3.0.x  ## Steps to reproduce    - create a database and then use this SQL  ```SQL create class Foo extends V create property Foo.id LONG create property Foo.name STRING create index Foo.id_nane on FOO (id,name) UNIQUE create vertex FOO set id = 1 , name = 'Bar' select from Foo where name = 'Bar' ```  </body>
		<created>2017-08-10 08:52:35</created>
		<closed>2017-08-10 10:13:44</closed>
	</bug>
	<bug>
		<id>7635</id>
		<title>Batch script : Invalid FROM vertex for edge</title>
		<body>### OrientDB Version: 3.0.x  ## Steps to reproduce    - Create a new database - Execute this batch script from Studio  ``` begin; let $v1 = create vertex v set name = 'Foo'; let $v2 = create vertex v set name = 'Foo'; create edge from $v1 to $v2; let $v3 = create vertex v set name = 'Foo'; create edge from $v1 to $v3; commit; ```  </body>
		<created>2017-08-10 08:39:50</created>
		<closed>2017-08-10 09:18:11</closed>
	</bug>
	<bug>
		<id>7634</id>
		<title>Exception during load test on remote storage and noticeable slowdown</title>
		<body>### OrientDB Version: 3.0 We tried to reproduce issue https://github.com/orientechnologies/orientdb/issues/7610 and created following load test https://gist.github.com/laa/82a0fe264ecf8120458acbf769949da8 . On @taburet machine we get   ``` * embedded 2.2.x: 2260 qps develop: 1320 qps  * remote 2.2.x: 850 qps develop: 200 qps ```  So remote storage performance was decreased at 2.4 times. (on 2.2.x remote storage is 1.7 times slower on 3.0 remote storage is 4.3 times slower) we found the reason for the slowdown of embedded storage and fixed it. But the reason of slowdown of remote storage also should be fixed.  Also when I tried to run the same load test on my machine after a while (load test was running already for about a minute I got https://gist.github.com/laa/2c8f6122ffbb855aa80bb0dd81558743) Which should be fixed too.   </body>
		<created>2017-08-09 13:13:00</created>
		<closed>2017-09-21 12:47:09</closed>
	</bug>
	<bug>
		<id>7633</id>
		<title>Inline LINK Batch Variable</title>
		<body>### OrientDB Version: 2.2.25 ### Java Version: openjdk version "1.8.0_131" ### OS: Ubuntu 17.04  ## Expected behavior   Should be able to set batch variables to RID values. Useful, for example, when substituting a single value into a batch with tokens and conditional logic. E.g. Where `/* token */` can be replaced by a RID  ```sql /* Do stuff */ LET foo = /* token */ if ($foo is not null) {     // Do something with $foo } /* Do other stuff... */ ```  ## Actual behavior   ``` com.orientechnologies.orient.core.command.OCommandExecutorNotFoundException: Cannot find a command executor for the command request: sql.#1:0 DB name="pac" at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.parse(OCommandExecutorSQLDelegate.java:54) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.parse(OCommandExecutorSQLDelegate.java:39) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3144) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeCommand(OCommandExecutorScript.java:486) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeLet(OCommandExecutorScript.java:624) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:276) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostBatch.execute(OServerCommandPostBatch.java:196) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  ## Steps to reproduce    Executing a simple batch, substituting any RID - valid or not, like this:  ```sql BEGIN LET foo = #1:0 COMMIT ``` ... gives an error.  Whereas LINKLIST works... ```sql BEGIN LET foo = [#1:0] COMMIT ```</body>
		<created>2017-08-09 09:46:05</created>
		<closed>2017-10-09 09:49:10</closed>
	</bug>
	<bug>
		<id>7627</id>
		<title>Batch insert sql:  Direct buffer memory</title>
		<body>### OrientDB Version:  2.2.5 ### Java Version: 1.8.0_144   ### OS:  centos 7  | mac  ## Exception    ``` Caused by: java.lang.OutOfMemoryError: Direct buffer memory at java.nio.Bits.reserveMemory(Bits.java:694) at java.nio.DirectByteBuffer.&lt;init&gt;(DirectByteBuffer.java:123) at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311) at com.orientechnologies.common.directmemory.OByteBufferPool.allocateBuffer(OByteBufferPool.java:328) at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:279) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:769) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1149) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:347) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.allocateNewPage(O2QCache.java:398) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.commitChanges(OAtomicOperation.java:434) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:468) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3732) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:1191) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2211) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:241) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:171) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2758) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1805) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1796) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:338) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:235) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  ## Steps to reproduce   ``` OPartitionedDatabasePool pool = new OPartitionedDatabasePool("remote:localhost/enterprise", "admin", "admin"); whiletrue{ long start = System.currentTimeMillis(); ODatabaseDocumentTx insertTx = pool.acquire(); ODatabaseRecordThreadLocal.INSTANCE.set(insertTx); String sql = insertSql; OCommandSQL insertSql = new OCommandSQL(sql); insertSql.execute(); insertTx.commit(); insertTx.close(); } return String.format("spend %s ms on insert orientdb table from hbase %s, total count is %s ", (System.currentTimeMillis() - start) , TABLE_NAME, SAVE_BATCH_COUNT); ```  batch insert sql like below with 2000 records in a sql: `INSERT INTO Company(rowkey,_key,name,business_status,ctime,entity_type,capital,city,enterprise_type,industry,operation_startdate,province,utime) VALUES ('09A626712730E39B779AB5BDA1E318D0','','','','','','','','','','','','2017-06-2718:01:37'),('09A626D27DB8C7C98678C3D8CB8737EF','09A626D27DB8C7C98678C3D8CB8737EF','','','2017-06-2718:02:04','Company','','','','','2012-08-13','',''),('09A626D27DB8C7C98678C3D8CB8737EF','','','','','','','','','','','','2017-06-2718:02:04'),('09A626EC2ED573F799C603CCC3244B2C','09A626EC2ED573F799C603CCC3244B2C','','','2017-06-2717:59:02','Company','100000.00','','','','2010-12-21','','')`  run sometimes then always get the above exception </body>
		<created>2017-08-09 01:40:45</created>
		<closed>2017-08-10 06:57:32</closed>
	</bug>
	<bug>
		<id>7626</id>
		<title>OClusterPositionMapException with UPDATE UPSERT edges</title>
		<body>### OrientDB Version: 2.2.25 ### Java Version: Java(TM) SE Runtime Environment (build 1.8.0_144-b01) Java HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode) ### OS: Windows 10 x64    ## Actual behavior    ``` 2017-08-08 15:58:28:387 INFO  {db=vw-volume-predict} Created database 'vw-volume-predict' of type 'plocal' [ONetworkProtocolBinary]$ANSI{green {db=vw-volume-predict}} Error on creating record in cluster: plocal cluster: default com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error of update of mapping between logical and physical record position DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:326) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:483) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3726) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Passed in cluster position 0 is outside of range of cluster-position map DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:305) ... 20 more $ANSI{green {db=vw-volume-predict}} Exception `0E1B22CA` in storage `vw-volume-predict` com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record deletion DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:893) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3743) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused this rollback is : com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error of update of mapping between logical and physical record position DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:326) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:483) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3726) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Passed in cluster position 0 is outside of range of cluster-position map DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:305) ... 20 more   DB name="vw-volume-predict" at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:457) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:412) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:812) ... 19 more $ANSI{green {db=vw-volume-predict}} Exception `0E1B22CA` in storage `vw-volume-predict` com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record deletion DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:893) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3743) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused this rollback is : com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error of update of mapping between logical and physical record position DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:326) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:483) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3726) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Passed in cluster position 0 is outside of range of cluster-position map DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:305) ... 20 more   DB name="vw-volume-predict" at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:457) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:412) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:812) ... 19 more $ANSI{green {db=vw-volume-predict}} Exception `0E1B22CA` in storage `vw-volume-predict` com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record deletion DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:893) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3743) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused this rollback is : com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error of update of mapping between logical and physical record position DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:326) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:483) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3726) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:4359) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1692) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:541) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:99) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2891) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2860) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:325) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:197) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:104) at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:88) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1529) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:646) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:384) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:207) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Passed in cluster position 0 is outside of range of cluster-position map DB name="vw-volume-predict" Component Name="default" at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.update(OClusterPositionMap.java:305) ... 20 more   DB name="vw-volume-predict" at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:457) at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:412) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:812) ... 19 more ```  ## Steps to reproduce    ``` BEGIN; LET vol=CREATE VERTEX v_volume SET f_year=2017,f_quantity=59,f_recorded='2017-08-08 15:58:44'; LET province=UPDATE v_province SET f_name='Guangdong', f_recorded='2017-08-08 15:58:44' UPSERT RETURN AFTER @rid WHERE f_name='Guangdong'; LET city=UPDATE v_city SET f_name='Guangzhou', f_recorded='2017-08-08 15:58:44' UPSERT RETURN AFTER @rid WHERE f_name='Guangzhou'; LET pr=UPDATE v_plan_round SET f_name='PR67', f_number=67, f_recorded='2017-08-08 15:58:44', f_updated='2017-08-08 15:58:44' UPSERT RETURN AFTER @rid WHERE f_number=67; LET brand=UPDATE v_brand SET f_name='Bentley', f_recorded='2017-08-08 15:58:44' UPSERT RETURN AFTER @rid WHERE f_name='Bentley'; LET model=UPDATE v_model SET f_name='Continental GT/GTC/SSp', f_recorded='2017-08-08 15:58:44' UPSERT RETURN AFTER @rid WHERE f_name='Continental GT/GTC/SSp'; UPDATE e_in_location SET OUT=(SELECT FROM v_volume WHERE @rid in $vol), IN=$province, f_recorded='2017-08-08 15:58:44' UPSERT WHERE OUT IN (SELECT FROM v_volume WHERE @rid in $vol) AND IN IN $province; UPDATE e_in_location SET OUT=(SELECT FROM v_volume WHERE @rid in $vol), IN=$city, f_recorded='2017-08-08 15:58:44' UPSERT WHERE OUT IN (SELECT FROM v_volume WHERE @rid in $vol) AND IN IN $city; CREATE EDGE e_in_pr FROM $vol TO $pr SET f_recorded='2017-08-08 15:58:44'; UPDATE e_content_item SET OUT=(SELECT FROM v_content WHERE f_name='PR Status'), IN=$pr, f_recorded='2017-08-08 15:58:44' UPSERT WHERE OUT IN (SELECT FROM v_content WHERE f_name='PR Status') AND IN IN $pr; CREATE EDGE e_has_type FROM $vol TO $brand SET f_recorded='2017-08-08 15:58:44'; CREATE EDGE e_has_type FROM $vol TO $model SET f_recorded='2017-08-08 15:58:44'; CREATE EDGE e_has_type FROM $vol TO [#41:1,#47:0,#18:0,#22:0,#38:0,#29:0,#25:0] SET f_recorded='2017-08-08 15:58:44'; COMMIT RETRY 100; ``` </body>
		<created>2017-08-08 08:08:27</created>
		<closed>2017-08-09 04:00:51</closed>
	</bug>
	<bug>
		<id>7624</id>
		<title>maybe a bug when i select entire index in console?</title>
		<body>### OrientDB Version: 3   select from index:i.a                     Error: com.orientechnologies.orient.core.index.sbtree.local.OSBTreeException: Null keys are not supported.   </body>
		<created>2017-08-07 19:48:00</created>
		<closed>2017-08-08 09:55:20</closed>
	</bug>
	<bug>
		<id>7604</id>
		<title>java.lang.NullPointerException during INSERT INTO</title>
		<body>### OrientDB Version: v.2.2.25 (build 72a35a4bb42c4ca33272e7a59ad4c7a1d3ee859d) ### Java Version: openjdk version "1.8.0_131" ### OS: Ubuntu 16.04.2 LTS xenial  ## Expected behavior   New record into lh_item class  ## Actual behavior   ``` $ANSI{green {db=main_database_v1}} Error on creating record in cluster: plocal cluster: lh_item com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record creation   DB name="main_database_v1"   Component Name="lh_item"   at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createSinglePageRecord(OPaginatedCluster.java:636)   at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createDataRecord(OPaginatedCluster.java:513)   at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:478)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3726)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:1191)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2211)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:241)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:171)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2758)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1805)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1796)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:338)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:246)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146)   at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)   at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)   at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)   at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.IllegalArgumentException   at java.nio.Buffer.position(Buffer.java:244)   at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALPageChangesPortion.readData(OWALPageChangesPortion.java:226)   at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALPageChangesPortion.getIntValue(OWALPageChangesPortion.java:85)   at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.getIntValue(ODurablePage.java:116)   at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPage.appendRecord(OClusterPage.java:103)   at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.addEntry(OPaginatedCluster.java:1930)   at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createSinglePageRecord(OPaginatedCluster.java:627)   ... 23 more $ANSI{green {db=main_database_v1}} Exception `3706BA41` in storage `main_database_v1` com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #14:-1   DB name="main_database_v1"   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:203)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2758)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1805)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1796)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:338)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:246)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146)   at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)   at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)   at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)   at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #14   DB name="main_database_v1"   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2257)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:241)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:171)   ... 16 more Caused by: java.lang.NullPointerException   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2212)   ... 18 more $ANSI{green {db=main_database_v1}} Exception `3706BA41` in storage `main_database_v1` com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #14:-1   DB name="main_database_v1"   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:203)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2758)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1805)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1796)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:338)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:246)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146)   at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)   at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)   at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)   at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #14   DB name="main_database_v1"   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2257)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:241)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:171)   ... 16 more Caused by: java.lang.NullPointerException   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2212)   ... 18 more Internal server error:  java.lang.NullPointerException   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2212)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:241)   at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:171)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2758)   at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:102)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1805)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1796)   at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:338)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:246)   at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3208)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3146)   at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)   at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)   at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:173)   at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)   at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ``` ## Steps to reproduce   Not sure how to reproduce the issue. At the moment the only class that has this error is lh_item, other works fine.  The same behavior on both OrientDB Studio and OrientDB console  If more informations or more tests needed please let me know</body>
		<created>2017-08-03 10:41:38</created>
		<closed>2017-08-25 13:35:36</closed>
	</bug>
	<bug>
		<id>7601</id>
		<title>Cache state file may contain outdated information</title>
		<body>The cache state file (`cache.stt`) is updated on storage shutdown. If the file content is used without/before proper storage shutdown, it may contain outdated information, for example information about files which are already deleted. This may result in a failure to open a database containing such outdated file.  1. `cache.stt` should be ignored while backing up and restoring a database.  2. Cache state restoration must be reworked to take care of the untrusted nature of `cache.stt`. </body>
		<created>2017-08-02 08:01:00</created>
		<closed>2017-08-03 11:38:29</closed>
	</bug>
	<bug>
		<id>7598</id>
		<title>Delete command with RETURN COUNT statement throws Error parsing query</title>
		<body>### OrientDB Version:  v2.2.24 (using Docker image orientdb) ### Java Version: openjdk version "1.8.0_131" ### OS: Alpine Linux v3.6.2  ## Expected behavior   `delete from Contact return COUNT where name = 'Bob'` should return number of deleted records (command without `return COUNT` works)   ## Actual behavior   Returns error `Error parsing query: delete from Contact return COUNT where name = 'Bob' ^ Encountered " &lt;COUNT&gt; "COUNT "" at line 1, column 28. Was expecting: &lt;BEFORE&gt; ... DB name="amc"`  ## Steps to reproduce   `delete from Contact return COUNT where name = 'Bob'`  Not sure if [documantation](http://orientdb.com/docs/last/SQL-Delete.html) is outdated or it is a bug  </body>
		<created>2017-08-01 12:49:26</created>
		<closed>2017-08-07 10:55:51</closed>
	</bug>
	<bug>
		<id>7592</id>
		<title>teleporter - 2.2.25-snapshot - build failure on windows 10 64bit</title>
		<body>![gabri](https://user-images.githubusercontent.com/14923389/28715093-be76cf76-7396-11e7-841a-202a9da3ccbb.PNG) </body>
		<created>2017-07-28 11:16:00</created>
		<closed>2017-08-08 15:46:06</closed>
	</bug>
	<bug>
		<id>7589</id>
		<title>Edge unique index lead to deadlock when insert vertex and edge</title>
		<body>### OrientDB Version: 2.2.24   ### Java Version: 1.8.091-b14   ### OS: CentOS 6.5    ## Expected behavior   I am trying to build a social relation network with orientdb graph(remotely connect plocal graph database). I defined the vertex and edge class with their unique index on their property 'memberId' and 'name' respectively (Note: the value of the parameter 'name' for edge class is combined with the value of parameter 'memberId' for fromVertex and toVertex).  In my app, I also added a method to create these vertexes and edges , and ensure that there is only one edge between specific both of vertexes. Then I executed a performance test towards this method and expected vertexes and edges could be built susccessfully.  ## Actual behavior   However, orientdb encountered deadlock soon. I can't find the root cause but doubt that the edge index lead to this issue. In fact, If all of edges  between tested vertex have been built up, deadlock will disappear after I re-run the test. On the other hand, If I created only verstexes during test, this issue is also can't be reproduced.   ## Steps to reproduce   mentioned in the analysis above. </body>
		<created>2017-07-26 18:31:55</created>
		<closed>2017-08-05 09:46:16</closed>
	</bug>
	<bug>
		<id>7586</id>
		<title>Memory Issues with 32 Bit java</title>
		<body>### OrientDB Version: 2.2.23   ### Java Version: 1.8.0_131 32Bit ### OS: Windows 10    Hi @lvca ,   When I use your recomended settings with a 32 Bit (1.8.0_131) Runtime I get the out of memory immmediately (with -XX:MaxDirectMemorySize=128m it just comes later)   **_Here are the relevant settings:_** VER  @ 10:42:50.358 java.runtime.version: 1.8.0_131-b11 VER  @ 10:42:50.358 java.version: 1.8.0_131 VER  @ 10:42:50.358 java.vm.version: 25.131-b11 VER  @ 10:42:50.358 java.vm.vendor: Oracle Corporation VER  @ 10:42:50.358 java.vm.name: Java HotSpot(TM) Client VM VER  @ 10:42:50.358 java.specification.version: 1.8 VER  @ 10:42:50.358 java.vm.specification.version: 1.8 VER  @ 10:42:50.359 os.name: Windows 10 VER  @ 10:42:50.359 os.version: 10.0 VER  @ 10:42:50.359 os.arch: x86 MSG  @ 10:42:50.359 java.runtime totalMemory=16mb maxMemory=1037mb freeMemory=11mb processors=8 MSG  @ 10:42:50.361 java.runtime.argument: -Xmx1024m MSG  @ 10:42:50.361 java.runtime.argument: -XX:MaxDirectMemorySize=1G MSG  @ 10:42:50.361 java.runtime.argument: -Dpicapport.home=C:\ProgramData\Contecon MSG  @ 10:42:50.361 java.runtime.argument: -DTRACE=DEBUG     **_Here is the error during the start database_** MSG  @ 10:42:52.372 PicApportDBService.createDatabaseDirectory: C:\Users\Eric\.picapport\db MSG  @ 10:42:52.373 PicApportDBService.startDatabase:plocal:C:/Users/Eric/.picapport/db/db.2.2.23 EXCEP@ ============================================================ EXCEP@ Exception at: 2017-07-26 10:42:52 EXCEP@          Msg: EXCEP@ null EXCEP@ ------------------------------------------------------------ EXCEP@ java.lang.OutOfMemoryError EXCEP@     at sun.misc.Unsafe.allocateMemory(Native Method) EXCEP@     at java.nio.DirectByteBuffer.&lt;init&gt;(DirectByteBuffer.java:127) EXCEP@     at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311) EXCEP@     at com.orientechnologies.common.directmemory.OByteBufferPool.allocateBuffer(OByteBufferPool.java:328) EXCEP@     at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:279) EXCEP@     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:769) EXCEP@     at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1107) EXCEP@     at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:346) EXCEP@     at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.allocateNewPage(O2QCache.java:397) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.commitChanges(OAtomicOperation.java:434) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:468) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:412) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.create(OPaginatedCluster.java:195) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.addClusterInternal(OAbstractPaginatedStorage.java:4136) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doAddCluster(OAbstractPaginatedStorage.java:4117) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.create(OAbstractPaginatedStorage.java:459) EXCEP@     at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.create(OLocalPaginatedStorage.java:127) EXCEP@     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.create(ODatabaseDocumentTx.java:438) EXCEP@     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.create(ODatabaseDocumentTx.java:398) EXCEP@     at de.contecon.picapport.db.PicApportDBService.createDBSchema(Unknown Source) EXCEP@     at de.contecon.picapport.db.PicApportDBService.startDatabase(Unknown Source) EXCEP@     at de.contecon.picapport.db.PicApportDBService.startDatabase(Unknown Source) EXCEP@     at de.contecon.picapport.PicApport.startDatabase(Unknown Source) EXCEP@     at de.contecon.picapport.PicApport.init(Unknown Source) EXCEP@     at de.contecon.picapport.PicApport.main(Unknown Source) EXCEP@     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) EXCEP@     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) EXCEP@     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) EXCEP@     at java.lang.reflect.Method.invoke(Method.java:498) EXCEP@     at com.sun.javafx.application.LauncherImpl.launchApplicationWithArgs(LauncherImpl.java:389) EXCEP@     at com.sun.javafx.application.LauncherImpl.launchApplication(LauncherImpl.java:328) EXCEP@     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) EXCEP@     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) EXCEP@     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) EXCEP@     at java.lang.reflect.Method.invoke(Method.java:498) EXCEP@     at sun.launcher.LauncherHelper$FXHelper.main(LauncherHelper.java:767)    </body>
		<created>2017-07-26 09:08:18</created>
		<closed>2017-08-22 12:19:59</closed>
	</bug>
	<bug>
		<id>7584</id>
		<title>Failed to create a vertex and caught OSBTreeBonsaiLocalException</title>
		<body>### OrientDB Version: v.2.2.10 ### Java Version: 1.8.0_112 ### OS: FreeBSD 11.0-RELEASE-p1  Hi, I ran OrientDB server on FreeBSD 11. I have found a problem about running sql to create vertices via binary protocol.  My query is to create a new vertex and update values of its predecessors. When a server is under heavy load, it randomly fails to process some queries.  ### My query `let file = create vertex files set name=file1.txt, size=10` `create edge hardlink from $file to #32:12951 set type='file` `update (select from (traverse out('HardLink','ShareLink') from $file) where @Class='folders') increment size = 10` `update (select from (traverse out('HardLink','ShareLink', 'MemberOf') from $file) where @Class='users' OR @Class='domains') increment usage = 10` `commit retry 100`  Here is error log from orientdb.err. ### Error Log 2017-07-24 17:45:09:778 INFO  {db=FTO-Structure-2.0}  null possible previous close - Flush [OChannelBinaryServer] 2017-07-24 17:45:09:778 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Reading byte (1 byte)... [OChannelBinaryServer] 2017-07-24 17:45:09:921 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Read byte: 41 [OChannelBinaryServer] 2017-07-24 17:45:09:921 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Reading int (4 bytes)... [OChannelBinaryServer] 2017-07-24 17:45:09:921 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Read int: 12 [OChannelBinaryServer] 2017-07-24 17:45:09:921 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Reading byte (1 byte)... [OChannelBinaryServer] 2017-07-24 17:45:10:020 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Read byte: 115 [OChannelBinaryServer] 2017-07-24 17:45:10:020 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Reading chunk of bytes. Reading chunk length as int (4 bytes)... [OChannelBinaryServer] 2017-07-24 17:45:10:020 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Read chunk lenght: 762 [OChannelBinaryServer] 2017-07-24 17:45:10:021 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Reading 762 bytes... [OChannelBinaryServer] 2017-07-24 17:45:10:021 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Read 762 bytes: sSQLbegin   let file = create vertex files set name=file1.txt   create edge hardlink from $file to #32:12951 set type='file, size=10 update (select from (traverse out('HardLink','ShareLink') from $file) where @class='folders') increment size = 10 update (select from (traverse out('HardLink','ShareLink', 'MemberOf') from $file) where @class='users' OR @class='domains') increment usage = 10   commit retry 100   return $file [OChannelBinaryServer] 2017-07-24 17:45:10:024 INFO  {db=FTO-Structure-2.0}  null possible previous close - Flush [OChannelBinaryServer] 2017-07-24 17:45:10:024 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing byte (1 byte): 1 [OChannelBinaryServer] 2017-07-24 17:45:10:024 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing int (4 bytes): 12 [OChannelBinaryServer]  &gt; 2017-07-24 17:45:10:024 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing byte (1 byte): 1 [OChannelBinaryServer] &gt; 2017-07-24 17:45:10:024 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing string (4+71=75 bytes): com.orientechnologies.orient.core.exception.OSBTreeBonsaiLocalException [OChannelBinaryServer] &gt; 2017-07-24 17:45:10:024 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing string (4+112=116 bytes): Error creation of sbtree with namecollections_32 &gt; DB name="FTO-Structure-2.0" &gt; Component Name="collections_32" [OChannelBinaryServer] &gt; 2017-07-24 17:45:10:025 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing byte (1 byte): 1 [OChannelBinaryServer]  2017-07-24 17:45:10:025 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing string (4+30=34 bytes): java.lang.NullPointerException [OChannelBinaryServer] 2017-07-24 17:45:10:025 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing string (4+0=4 bytes): null [OChannelBinaryServer] 2017-07-24 17:45:10:025 INFO  {db=FTO-Structure-2.0} /10.10.9.44:59678 - Writing byte (1 byte): 0 [OChannelBinaryServer]   Could you tell me what is OSBTreeBonsaiLocalException and how to prevent this error? Thank you.</body>
		<created>2017-07-25 10:45:17</created>
		<closed>2017-08-10 06:56:54</closed>
	</bug>
	<bug>
		<id>7578</id>
		<title>IN operator not working on `Short` type fields</title>
		<body>### OrientDB Version: 2.2.24 ### Java Version: 1.8 ### OS: Linux, MacOS  I want to use `IN` operator to filter records.  ## Steps to reproduce   ```sql /* schema */ create class User extends V; create property User.state Short;  /* data*/ create vertex User set state = 1; create vertex User set state = 1; create vertex User set state = 2; ``` queries:  ```sql select from User where state in [1]  select from User where state in 1 ```  ## Expected/Actual behavior   These queries should return two records, but instead, it returns nothing. It should be noted that when I use `Integer` instead of `Short`, the queries are work as expected.  Thanks</body>
		<created>2017-07-21 19:51:07</created>
		<closed>2017-07-25 09:02:12</closed>
	</bug>
	<bug>
		<id>7577</id>
		<title>ODB2.2.20 OOM errors</title>
		<body>### OrientDB Version: 2.2.20 ### Java Version: 1.8.131 ### OS: Linux  ## Expected behavior   OrientDB should work perfectly and should never run into memory leak issue  ## Actual behavior   Orient DB 2.2.20 fails with either `GC Overhead limit exceeded error` or `java.lang.OutOfMemoryError: Java heap space` needing to restart the DB on our PROD env 2-3 times a day after the upgrade done from ODB V2.1.16 couple of days back.  Here is the ODB config `/bin/java -server -Xms2G -Xmx2G -Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=512g -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 -Dstorage.diskCache.bufferSize=26624 -Djava.util.logging.config.file=/opt/orientdb/config/orientdb-server-log.properties -Dorientdb.config.file=/opt/orientdb/config/orientdb-server-config.xml -Dorientdb.www.path=/opt/orientdb/www -Dorientdb.build.number=2.2.x@r76ab59e72943d0ba196188ed100c882be4315139; 2017-05-11 13:55:56+0000 -cp /opt/orientdb/lib/orientdb-server-2.2.20.jar:/opt/orientdb/lib/*:/opt/orientdb/plugins/* com.orientechnologies.orient.server.OServerMain`  ## Steps to reproduce   Steps are same as mentioned in issue #7576.  </body>
		<created>2017-07-21 18:38:31</created>
		<closed>2017-08-06 10:09:47</closed>
	</bug>
	<bug>
		<id>7574</id>
		<title>Exception in select from collection of DATETIME or DATE, using prepared statement</title>
		<body>### OrientDB Version: 2.2.23  ### Java Version: 7 OpenJDK  ### OS: Ubuntu 16.04  ## Expected behavior   Using prepared statement for collection of DATETIME works good.  ## Actual behavior   When I use prepared statement for DATETIME in equals query  `SELECT FROM Class WHERE date = :date` all works fine, but when I use prepared statement for collection of DATETIME or DATE `SELECT FROM Class WHERE date IN :dateCollection` I get [exception for datetime ](https://pastebin.com/dhEFUgc1) or [exception for date](https://pastebin.com/x6DtBUjL).  ## Steps to reproduce   [Test](https://github.com/WeaxMe/orienteer-test/blob/master/orientdb-test-data-query/src/test/java/com/weaxme/test/query/TestPreparedStatement.java#L111-L133) for date collection and date time collection.  </body>
		<created>2017-07-20 13:17:45</created>
		<closed>2017-07-21 10:02:15</closed>
	</bug>
	<bug>
		<id>7572</id>
		<title>OrientDB token error when reading</title>
		<body>Exception in thread "Delivery Thread" com.orientechnologies.orient.core.sql.parser.TokenMgrError: Lexical error at line 1, column 146.  Encountered: "\r" (13), after : "\'/U\ufffd\ufffd\ufffdn(\ufffd39\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd5\u0005 no\ufffd\ufffd]\ufffd\ufffd\ufffd]}!^o\u001c" at com.orientechnologies.orient.core.sql.parser.OrientSqlTokenManager.getNextToken(OrientSqlTokenManager.java:5966) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_scan_token(OrientSql.java:26084) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_280(OrientSql.java:23918) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_108(OrientSql.java:23935) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_138(OrientSql.java:20576) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_324(OrientSql.java:21673) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_130(OrientSql.java:21869) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_682(OrientSql.java:21982) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_594(OrientSql.java:22014) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_464(OrientSql.java:22133) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_465(OrientSql.java:22140) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_296(OrientSql.java:22180) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_115(OrientSql.java:22208) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_376(OrientSql.java:22223) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_218(OrientSql.java:20987) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_93(OrientSql.java:21053) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3_36(OrientSql.java:21362) at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_2_36(OrientSql.java:17931) at com.orientechnologies.orient.core.sql.parser.OrientSql.QueryStatement(OrientSql.java:893) at com.orientechnologies.orient.core.sql.parser.OrientSql.StatementInternal(OrientSql.java:717) at com.orientechnologies.orient.core.sql.parser.OrientSql.Statement(OrientSql.java:609) at com.orientechnologies.orient.core.sql.parser.OrientSql.parse(OrientSql.java:76) at com.orientechnologies.orient.core.sql.parser.OStatementCache.parse(OStatementCache.java:89) at com.orientechnologies.orient.core.sql.parser.OStatementCache.get(OStatementCache.java:72) at com.orientechnologies.orient.core.sql.parser.OStatementCache.get(OStatementCache.java:62) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLAbstract.preParse(OCommandExecutorSQLAbstract.java:229) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.parse(OCommandExecutorSQLSelect.java:266) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.parse(OCommandExecutorSQLSelect.java:100) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.parse(OCommandExecutorSQLDelegate.java:58) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.parse(OCommandExecutorSQLDelegate.java:39) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2616) at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78) at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74) at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:85) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:728) at com.tinkerpop.blueprints.impls.orient.OrientGraphQuery.vertices(OrientGraphQuery.java:204) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertices(OrientBaseGraph.java:933) at main.java.com.bag.server.database.OrientDBDatabaseAccess.getVertexList(OrientDBDatabaseAccess.java:211) at main.java.com.bag.server.database.OrientDBDatabaseAccess.compareNode(OrientDBDatabaseAccess.java:247) at main.java.com.bag.server.database.interfaces.IDatabaseAccess.equalHashNode(IDatabaseAccess.java:82) at main.java.com.bag.server.database.interfaces.IDatabaseAccess.equalHash(IDatabaseAccess.java:37) at main.java.com.bag.server.ConflictHandler.isCorrect(ConflictHandler.java:195) at main.java.com.bag.server.ConflictHandler.checkForConflict(ConflictHandler.java:52) at main.java.com.bag.server.GlobalClusterSlave.executeCommit(GlobalClusterSlave.java:214) at main.java.com.bag.server.GlobalClusterSlave.appExecuteBatch(GlobalClusterSlave.java:112) at bftsmart.tom.server.defaultservices.DefaultRecoverable.executeBatch(DefaultRecoverable.java:87) at bftsmart.tom.server.defaultservices.DefaultRecoverable.executeBatch(DefaultRecoverable.java:68) at bftsmart.tom.ServiceReplica.receiveMessages(ServiceReplica.java:432) at bftsmart.tom.core.DeliveryThread.deliverMessages(DeliveryThread.java:293) at bftsmart.tom.core.DeliveryThread.run(DeliveryThread.java:225)  That's the data where he gets problem reading. I do sb.toString() to store it.  MessageDigest mDigest = MessageDigest.getInstance("SHA1");          byte[] result = mDigest.digest(node.getBytes());          StringBuilder sb = new StringBuilder();         for (final byte aResult : result)         {             sb.append(Integer.toString((aResult &amp; 0xff) + 0x100, 16).substring(1));         }          return sb.toString(); </body>
		<created>2017-07-19 17:22:05</created>
		<closed>2017-09-27 09:35:17</closed>
	</bug>
	<bug>
		<id>7571</id>
		<title>Not able to drop database in embedded distributed, works fine with just embedded db</title>
		<body>It is impossible to drop and recreate database in distributed storage. The process of creation of re-created storage hangs in the middle of a process. To reproduce it just create storage, drop it and create again.</body>
		<created>2017-07-19 12:35:25</created>
		<closed>2017-07-19 13:06:19</closed>
	</bug>
	<bug>
		<id>7562</id>
		<title>Magic number verification failed for page ...</title>
		<body>### OrientDB Version: 2.2.23   ### Java Version: 1.8.0_131   ### OS: Ubuntu 16.04    ## Expected behavior   Keep all previously stored data after forced reboot (power failure).  ## Actual behavior   Only records stored 2 days ago (everyday &gt; 10000 records are stored) were kept. Server window reports multiple messages of:   Magic number verification failed for page `1234` of `outputs_3.pcl`. [OWOWCache]  for various items in quotes.  ## Steps to reproduce   Force power off after continuous storage for 3 days.  </body>
		<created>2017-07-17 17:58:39</created>
		<closed>2017-09-06 07:17:02</closed>
	</bug>
	<bug>
		<id>7558</id>
		<title>com.orientechnologies.orient.core.exception.OStorageException: Cannot restore state of cache for storage</title>
		<body>### OrientDB Version: 3.0  If the file which presents backed up the state of the disk cache is broken server can not be started. In such case, we just need to show a warning, instead of halting the server. Broken backup of the disk cache state does not affect the functionality of database, only initial performance.   </body>
		<created>2017-07-17 14:01:54</created>
		<closed>2017-07-17 14:44:25</closed>
	</bug>
	<bug>
		<id>7557</id>
		<title>Strange working SQL GET query for fields with OType.DATE in prepared statement</title>
		<body>### OrientDB Version: 2.2.23  ### Java Version: 7 OpenJDK ### OS: Ubuntu 16.04   Case:  strange working SQL GET query for fields with type OType.DATE when using prepared statement. ## Expected behavior When use prepared statements with java type Date and OrientDB DATE, DATETIME all works fine, but prepared statements for OrientDB DATE don't work correctly. ## Actual behavior   ### OType.DATE `Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();` `params.put("date", new SimpleDateFormat("yyyy-MM-dd").parse("2017-07-06"));` `db.query(new OSQLSynchQuery&lt;List&lt;ODocument&gt;&gt;("SELECT FROM Class WHERE date = :date"), params);` Document with field `date` and value `2017-07-06` is already exists, but query returns empty list.  ### OType.DATETIME `Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();` `params.put("datetime", new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse("2017-01-03 11:03:21"));` `db.query(new OSQLSynchQuery&lt;List&lt;ODocument&gt;&gt;("SELECT FROM Class WHERE datetime = :datetime"), params);` Document with field `datetime` and value `2017-01-03 11:03:21` is already exists and query returns list with document. All works fine.  ### Date in String If  convert date and date time to string and use prepared statements all works fine.  Date format in OrientDB for OType.DATE: "yyyy-MM-dd" Date format in OrientDB for OType.DATE: "yyyy-MM-dd HH:mm:ss" Tests with OrientDB version 2.2.22 and 2.2.23.  ## Steps to reproduce   Read before.  Thanks, Vitaliy </body>
		<created>2017-07-17 13:25:47</created>
		<closed>2017-07-18 10:06:34</closed>
	</bug>
	<bug>
		<id>7554</id>
		<title>Issue using lucene indexes and the OR operator with list fields</title>
		<body></body>
		<created>2017-07-17 07:36:45</created>
		<closed>2017-07-17 14:24:16</closed>
	</bug>
	<bug>
		<id>7553</id>
		<title>Cannot open local storage 'C:/orientdb-teleporter-community-2.2.23/databases/OSystem' with mode=rw at first run</title>
		<body>### OrientDB Version: orientdb-teleporter-community-2.2.23 OrientDB Server v2.2.23 (build 1318ca25b3927d22d6a7d5316000e20cb3d9329c) Databases directory: C:\orientdb-teleporter-community-2.2.23\databases [OServer] OrientDB auto-config DISKCACHE=1.024MB (heap=910MB direct=1.024MB os=8.122MB)   ### Java Version:  The first time it gave this information: INFO  32 bit JVM is detected. Lowering disk cache size from 1.024MB to 512MB. [OGlobalConfiguration] Analizing the server.bat I understand that it found C:\Program Files (x86)\Java\jdk1.8.0_92 (it was in the JAVA_HOME variable). However after the first run I forced it to use the 64bit version (C:\Program Files\Java\jdk1.8.0_92\bin) and it didn't displayed any more any information about the JVM (so I understand it correctly found that that was a 64bit version), but, sadly, with the same result   ### OS: Windows 10 Home, 64bit, with 8G RAM  ## Expected behavior   Clean first startup  ## Actual behavior   Following errors and no way to login from the Web studio (I tried both with the root user, with the password supplied during the installation phase and with admin/admin):  017-07-15 11:29:47:887 INFO  OrientDB Server is active v2.2.23 (build 1318ca25b3927d22d6a7d5316000e20cb3d9329c). [OServer]$ANSI{green {db=OSystem}} Exception `01F1F6FC` in storage `OSystem` com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage 'C:/orientdb-teleporter-community-2.2.23/databases/OSystem' with mode=rw         DB name="OSystem"         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:299)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:258)         at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:980)         at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:947)         at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:932)         at com.orientechnologies.orient.server.OSystemDatabase.openSystemDatabase(OSystemDatabase.java:92)         at com.orientechnologies.orient.server.OSystemDatabase.execute(OSystemDatabase.java:99)         at com.orientechnologies.orient.server.security.ODefaultServerSecurity.getSystemUser(ODefaultServerSecurity.java:284)         at com.orientechnologies.orient.server.security.authenticator.OSystemUserAuthenticator.isAuthorized(OSystemUserAuthenticator.java:93)         at com.orientechnologies.orient.server.security.ODefaultServerSecurity.isAuthorized(ODefaultServerSecurity.java:311)         at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetListDatabases.execute(OServerCommandGetListDatabases.java:56)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:169)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:621)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.common.io.OIOException: You cannot access outside the file size (0 bytes). You have requested portion 0-4 bytes. File: File: database.ocf os-size=1024, stored=0         at com.orientechnologies.orient.core.storage.fs.OFileClassic.checkRegions(OFileClassic.java:517)         at com.orientechnologies.orient.core.storage.fs.OFileClassic.readInt(OFileClassic.java:250)         at com.orientechnologies.orient.core.storage.impl.local.OStorageConfigurationSegment.load(OStorageConfigurationSegment.java:103)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:240)         ... 13 more  ## Steps to reproduce   Downloaded zip. Extracted in C:\. Changed server.bat memory sizes (512G-&gt;1G).  Executed server.bat (both by clicking on in and writing on the command line, in two differents steps - the second after a clean shutdown) connect to http://my_local_ip_address:2480/studio/index.html#/ Before connecting, no errors, only the first log startup lines. After connecting, the first error appeared also without trying to login. The web page seems ok.  </body>
		<created>2017-07-15 10:02:37</created>
		<closed>2017-07-21 08:27:25</closed>
	</bug>
	<bug>
		<id>7548</id>
		<title>Problem with nested collections</title>
		<body>### OrientDB Version: 2.2.18 ### Java Version: 1.8   ### OS: ubuntu 16.04  Hi folks,  Thank you for providing this very lovely database. Currently, I am restructuring our program, that it utilizes orientDB but I stuck in a problem I cannot solve. Within my class (say MyClass1) I have a nested collection, for instance: HashMap&lt;String, ArrayList&lt;MyClass2&gt;&gt; When storing in the database, I get the following error: Exception in thread "main" java.lang.NullPointerException at com.orientechnologies.orient.core.record.ORecordInternal.track(ORecordInternal.java:127) at com.orientechnologies.orient.core.db.record.OTrackedList.addOwnerToEmbeddedDoc(OTrackedList.java:125) at com.orientechnologies.orient.core.db.record.OTrackedList.add(OTrackedList.java:67) at com.orientechnologies.orient.core.db.record.ORecordLazyList.add(ORecordLazyList.java:178) at com.orientechnologies.orient.core.db.record.ORecordLazyList.add(ORecordLazyList.java:48) at com.orientechnologies.orient.object.enhancement.OObjectEntitySerializer.multiValueToStream(OObjectEntitySerializer.java:1378) at com.orientechnologies.orient.object.enhancement.OObjectEntitySerializer.typeToStream(OObjectEntitySerializer.java:796) at com.orientechnologies.orient.object.enhancement.OObjectEntitySerializer.multiValueToStream(OObjectEntitySerializer.java:1391) at com.orientechnologies.orient.object.enhancement.OObjectEntitySerializer.typeToStream(OObjectEntitySerializer.java:799) at com.orientechnologies.orient.object.enhancement.OObjectEntitySerializer.toStream(OObjectEntitySerializer.java:1211) at com.orientechnologies.orient.object.enhancement.OObjectEntitySerializer.serializeObject(OObjectEntitySerializer.java:145) at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:453) at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:398)  I checked, both classes MyClass1 and MyClass2 have correct getters and setters for all attributes.  When I use one flat collection, everything works fine. Could you give me a suggestion how to solve this error? Do you need more information? Thank you very much.  Cheers, Dominik </body>
		<created>2017-07-14 07:52:49</created>
		<closed>2017-07-17 14:02:06</closed>
	</bug>
	<bug>
		<id>7547</id>
		<title>Sequence used multiple times in single transaction block is not incremented</title>
		<body>### OrientDB Version: 2.2.22 ### Java Version: 1.8.0_92   ### OS: Windows 7  ## Expected behavior   A sequence used as a default value in multiple vertex classes (as uniqueID) in same transaction block should increment by one within each created vertex.  ## Actual behavior   If run in transaction block, sequence is not updated, and all vertices get the same "uniqueID" and due to an index an exception is thrown:   ``` com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record #19:162: found duplicated key '516' in index 'idx_V_Vertex1_uniqueID' previously assigned to the record #16:175 DB name="XXX" DB name="XXX" INDEX=idx_V_Vertex1_uniqueID RID=#16:175 ```  ## Steps to reproduce   - I am using the API not SQL - Create two vertex classed having each the property "uniqueID", which should be automatically created from the same sequence "seqCounter". The uniqueID property is defined in a superclass via the SQL command:` "ALTER PROPERTY V_XXXXX.uniqueID DEFAULT 'sequence("seqCounter").next()'"` - require remote connection via OrientGraphFactory.getTx (variable named "graph") - Create the two vertices instances and an edge between them.  - Only after all operations (addVertex, ...) I run "graph.shutdown". The above exception is thrown.  Debugging the "OTransaction" in method "public List&lt;ORecordOperation&gt; commit(final OTransaction iTx, final Runnable callback)" shows the follwing entries in OTransaction object  (I assume as ORecordOperation):  ``` #-1:-3=ORecordOperation [record=V_Vertex2#-1:-3{uniqueID:516,createdOn:Thu Jul 13 13:42:59 CEST 2017,updatedOn:Thu Jul 13 13:42:59 CEST 2017,email:mf1@localhost,lastName:asd,firstName:asd,in_E_Edge1:[#-1:-4]} v0, type=CREATE]  #7:0=ORecordOperation [record=OSequence#7:0{type:ORDERED,start:1,incr:1,value:516,name:seqCounter} v515, type=UPDATE]  #-1:-4=ORecordOperation [record=E_Edge1#-1:-4{updatedOn:Thu Jul 13 13:40:02 CEST 2017,createdOn:Thu Jul 13 13:40:02 CEST 2017,out:#-1:-2,in:#-1:-3} v0, type=CREATE]  #-1:-2=ORecordOperation [record=V_Vertex1#-1:-2{uniqueID:516,createdOn:Thu Jul 13 13:42:59 CEST 2017,updatedOn:Thu Jul 13 13:42:59 CEST 2017,email:mf1@localhost,lastName:asd,firstName:asd,out_E_Edge1:[#-1:-4]} v0, type=CREATE] ```  In my opinion the uniqueID values 516 of both vertices should not be set, since the are to be generated upon commit??? I did not insert the uniqueID property value via the API. This has been done somewhere in the orientDB.   Reloading the sequence in the middle of the transaction between both vertex creations via:   ``` graph.getRawGraph.getMetadata.getSequenceLibrary.getSequence("seqCounter").getDocument.reload() ``` caused exception (basing on the same reason than in issue #7046):  ``` WARNING: Found record in transaction with the same RID #7:0 but different instance. Probably the record has been loaded from another transaction and reused on the current one: reload it from current transaction before to update or delete it Jul 13, 2017 9:38:20 PM com.orientechnologies.common.log.OLogManager log SCHWERWIEGEND(German Severe / Fatal): Exception during commit of active transaction com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record #19:162: found duplicated key '516' in index 'idx_V_Vertex1_uniqueID' previously assigned to the record #16:175 DB name="XXX" DB name="XXX" INDEX=idx_V_Vertex1_uniqueID RID=#16:175 ```  I cannot provide you code yet, but I try to reduce the code to an standalone example.</body>
		<created>2017-07-13 19:51:30</created>
		<closed>2017-08-10 12:00:50</closed>
	</bug>
	<bug>
		<id>7546</id>
		<title>NPE during creation of a property for a specific class</title>
		<body>### OrientDB Version: 2.2.22 ### Java Version: 7+ ### OS: linux  It seems that OrientDB doesn't like class with name "Report". After creation of such class there are lots of interesting stuff is happening. And the only one solution: rollback to previous backup.  Creation of a new property for class "Report" or attempt to retrieve newly created class lead to the NPE in the same place.  Creation of property: ```java java.lang.NullPointerException      at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.getEntries(OPaginatedCluster.java:1425)      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.count(OAbstractPaginatedStorage.java:1158)      at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.countClusterElements(ODatabaseDocumentTx.java:816)      at com.orientechnologies.orient.core.iterator.ORecordIteratorClass.config(ORecordIteratorClass.java:141)      at com.orientechnologies.orient.core.iterator.ORecordIteratorClass.&lt;init&gt;(ORecordIteratorClass.java:90)      at com.orientechnologies.orient.core.iterator.ORecordIteratorClass.&lt;init&gt;(ORecordIteratorClass.java:68)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.searchInClasses(OCommandExecutorSQLResultsetAbstract.java:479)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.searchInClasses(OCommandExecutorSQLResultsetAbstract.java:468)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchInClasses(OCommandExecutorSQLSelect.java:1004)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.assignTarget(OCommandExecutorSQLResultsetAbstract.java:209)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.assignTarget(OCommandExecutorSQLSelect.java:530)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:512)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:488)      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:3200)      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:3138)      at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)      at com.orientechnologies.orient.core.metadata.schema.OClassImpl.checkPersistentPropertyType(OClassImpl.java:2186)      at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addPropertyInternal(OClassImpl.java:1812)      at com.orientechnologies.orient.core.metadata.schema.OClassImpl$6.call(OClassImpl.java:2606)      at com.orientechnologies.orient.core.metadata.schema.OClassImpl$6.call(OClassImpl.java:2603)      at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70)      at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addProperty(OClassImpl.java:2603)      at com.orientechnologies.orient.core.metadata.schema.OClassImpl.createProperty(OClassImpl.java:807) ```  Count of documents for a class:  ```java Caused by: java.lang.NullPointerException at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.getEntries(OPaginatedCluster.java:1425) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.count(OAbstractPaginatedStorage.java:1158) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.countClusterElements(ODatabaseDocumentTx.java:816) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.countClusterElements(ODatabaseDocumentTx.java:770) at com.orientechnologies.orient.core.metadata.schema.OClassImpl.count(OClassImpl.java:1510) at com.orientechnologies.orient.core.metadata.schema.OClassImpl.count(OClassImpl.java:1503) ```  If "Report" is so specific - please make it a keyword.</body>
		<created>2017-07-13 15:22:17</created>
		<closed>2017-07-19 13:11:03</closed>
	</bug>
	<bug>
		<id>7539</id>
		<title>Error on restore of cluster from file during replace cluster</title>
		<body>### OrientDB Version: develop  ## Steps to reproduce   Run distributed test TestShardingManualSync  </body>
		<created>2017-07-10 09:32:26</created>
		<closed>2017-07-24 17:55:35</closed>
	</bug>
	<bug>
		<id>7536</id>
		<title>Crash tests are frozen on shutdown</title>
		<body>### OrientDB Version: 3.0  During running of crash tests, they become frozen on shutdown, after the following exception is thrown ``` Jul 07, 2017 12:07:09 PM com.orientechnologies.common.log.OLogManager log INFO: - shutdown storage: testLocalPaginatedStorageUpdateCrashRestore... java.lang.InterruptedException at java.util.concurrent.SynchronousQueue.take(SynchronousQueue.java:928) at com.orientechnologies.orient.client.remote.OStorageRemotePushThread.subscribe(OStorageRemotePushThread.java:103) at com.orientechnologies.orient.client.remote.OStorageRemote.subscribeDistributedConfiguration(OStorageRemote.java:1361) at com.orientechnologies.orient.client.remote.OStorageRemote.onPushReconnect(OStorageRemote.java:1892) at com.orientechnologies.orient.client.remote.OStorageRemotePushThread.run(OStorageRemotePushThread.java:82) ```  You can find full log there https://gist.github.com/laa/c17f32fa95a108ebf41c3e5bc5dbc725 </body>
		<created>2017-07-07 13:40:06</created>
		<closed>2017-07-10 17:05:55</closed>
	</bug>
	<bug>
		<id>7535</id>
		<title>OObjectLazyList can not be looped using a Stream</title>
		<body>### OrientDB Version: 2.2.22   ### Java Version: 8    OObjectLazyList instances returned by the object API can not be streamed (initially).  The following IT reproduces the bug. https://github.com/CompartAG/orientdb-tryouts/blob/master/2.2.x/src/test/java/com/compart/tec/orientdb/object/OObjectLazyListRegressionIT.java </body>
		<created>2017-07-07 12:20:59</created>
		<closed>2017-08-05 07:01:25</closed>
	</bug>
	<bug>
		<id>7534</id>
		<title>Cannot create edge with new vertices in the same transaction</title>
		<body>### OrientDB Version: 2.2.5 - 2.2.22 ### Java Version: 8 update 131 ### OS: macOS, FreeBSD  ## Expected behavior Commit with these commands successfully via binary protocol (version 2.2.4)   BEGIN; CREATE VERTEX V SET num = 13 CREATE VERTEX V SET num = 14 CREATE EDGE E FROM (SELECT FROM V WHERE num = 13) TO (SELECT FROM V WHERE num = 14) COMMIT;  ## Actual behavior   Commit failed com.orientechnologies.orient.core.exception.OCommandExecutionException: No edge has been created because no source vertices  ## Steps to reproduce   Send commands BEGIN; CREATE VERTEX V SET num = 13 CREATE VERTEX V SET num = 14 CREATE EDGE E FROM (SELECT FROM V WHERE num = 13) TO (SELECT FROM V WHERE num = 14) COMMIT; via binary protocol (request command script "s", script language "SQL")</body>
		<created>2017-07-07 01:44:44</created>
		<closed>2017-07-10 08:44:58</closed>
	</bug>
	<bug>
		<id>7532</id>
		<title>Orientdb limit geospatial index</title>
		<body>https://stackoverflow.com/questions/44453117/orientdb-limit-geospatial-index</body>
		<created>2017-07-05 20:48:58</created>
		<closed>2017-07-05 20:49:09</closed>
	</bug>
	<bug>
		<id>7531</id>
		<title>During process of export/import of DB links to stale records are present in new DB</title>
		<body>### OrientDB Version:  2.2.20    ## Steps to reproduce   Server is crashed because of internal error and some clusters contains broken records.  To remove broken records and restore the ability to work with the database we perform procedure of export/import of database from/to JSON.  ## Expected behavior   In imported database links to broken records should be removed  ## Actual behavior   In imported database, we still have links to the broken and removed at this moment records. But because broken records were not exported to new database, RIDs of broken records are assigned to new records  and as result logical structure of the new database is broken.   </body>
		<created>2017-07-05 19:57:49</created>
		<closed>2017-07-06 10:17:01</closed>
	</bug>
	<bug>
		<id>7528</id>
		<title>ONetworkProtocolBinary error handling problem with connection without token</title>
		<body></body>
		<created>2017-07-03 17:28:15</created>
		<closed>2017-07-03 17:32:46</closed>
	</bug>
	<bug>
		<id>7518</id>
		<title>-1 record version prevents index updates</title>
		<body>### OrientDB Version: 2.2  ## Steps to reproduce   1. Create class "C" with field "f" and create a unique index for that field. 1.  Create a record of class "C" with a field "f" value equals to "v1" and store it. 2. Load record created at step 1, set record version to -1 and update value of field "f" to "v2" and store it. 3.  Create a record of class "C" with a field "f" value equals to "v2" and store it.  ## Expected behavior   The exception that indicates that uniqueness constraints are violated should be thrown.  ## Actual behavior    The record is inserted in the database, and uniqueness constraint is violated.  Despite feeling that this case is super rare, some of the third-party drivers for remote storage incorrectly send -1 as record version. As a result, we have duplicates in the database. In general uniqueness constraints should be bullet proof and should not be violated in such simple way.   </body>
		<created>2017-06-29 16:03:08</created>
		<closed>2017-06-30 08:07:19</closed>
	</bug>
	<bug>
		<id>7516</id>
		<title>Server can not be shutdown under the high load</title>
		<body>### OrientDB Version: 2.2 and I suppose 3.0  ## Expected behavior   I discovered this issue during the investigation of  https://github.com/orientechnologies/orientdb/issues/7388 .  If you start the test https://slack-files.com/T04EMG7AY-F57929QRW-2ee6e8b0ef and then wait till all databases and their metadata are created and insertion of data is started and then run shutdown script you  will see as a result of execution of shutdown script in the server log:  ``` 2017-06-27 21:27:47:628 INFO  Received shutdown command from the remote client /127.0.0.1:61934 [ONetworkProtocolBinary] 2017-06-27 21:27:47:629 INFO  Remote client /127.0.0.1:61934 authenticated. Starting shutdown of server... [ONetworkProtocolBinary] 2017-06-27 21:27:47:674 INFO  OrientDB Server is shutting down... [OServer] 2017-06-27 21:27:47:680 INFO  Shutting down listeners: [OServer] 2017-06-27 21:27:47:714 INFO  - ONetworkProtocolBinary /0.0.0.0:2424: [OServer] 2017-06-27 21:27:47:735 INFO  - ONetworkProtocolHttpDb /0.0.0.0:2480: [OServer] 2017-06-27 21:27:47:743 INFO  Shutting down protocols [OServer] ```   but the execution of test will continue it can be seen from the timing of the log on test's side:  ``` pool-202-thread-49][2017-06-27 21:29:02] ************ [tenantdb1_11] Total number of errors: [0] Delete error counter:[0] [pool-202-thread-49][2017-06-27 21:29:02] **********************************************************************!@#!@#! [tenantdb1_11] Total number of records: [2000] [pool-202-thread-14][2017-06-27 21:29:02]  [tenantdb1_3] Delete vertex : [7] [Test1Node] [pool-202-thread-14][2017-06-27 21:29:02] ################# [tenantdb1_3] Records removed after delete vertex  [Test1Node] Error on delete [0] [pool-202-thread-41][2017-06-27 21:29:03]  [tenantdb1_15] Delete vertex : [8] [Test1Node] [pool-202-thread-41][2017-06-27 21:29:03] ################# [tenantdb1_15] Records removed after delete vertex  [Test1Node] Error on delete [0] [pool-202-thread-16][2017-06-27 21:29:03]  [tenantdb1_38] Delete vertex : [7] [Test1Node] ``` ## Actual behavior   After successful issue of shutdown command server should reject new commands and gracefully close all databases.  </body>
		<created>2017-06-29 13:52:30</created>
		<closed>2017-07-25 17:41:01</closed>
	</bug>
	<bug>
		<id>7513</id>
		<title>select expand(rid) from index:collection.field where key lucene limit N - work slow</title>
		<body>### OrientDB Version: 2.2.22 ### Java Version: openjdk version "1.8.0_131" OpenJDK Runtime Environment (build 1.8.0_131-8u131-b11-0ubuntu1.16.04.2-b11) OpenJDK 64-Bit Server VM (build 25.131-b11, mixed mode) ### OS: ubuntu 16.04 lts  ## Expected behavior   select expand(rid) from index:collection.field where key lucene '~0.2' limit 3 mast work fine  ## Actual behavior   Dont work. OrientDB process corrupt. Database not accessible. Need kill + start.sh  ## Steps to reproduce   insert into class more 1 000 000 document with same "word" and select key lucene 'word~0.3' limit 2  select expand(rid) from index:collection.field where key lucene '~0.2' limit 3 - not work  </body>
		<created>2017-06-29 11:00:41</created>
		<closed>2017-07-02 07:48:23</closed>
	</bug>
	<bug>
		<id>7512</id>
		<title>NPE during database upgrade</title>
		<body>### OrientDB Version: 2.2.20 ### Java Version: 7 ### OS: linux   We had db which run on 2.1.19. But now we tried to run it on instance of Orienteer which use 2.2.20. So OrientDB tried to convert DB and failed with the following exception:  ```java Caused by: java.lang.NullPointerException at java.util.Locale.&lt;init&gt;(Locale.java:573) at java.util.Locale.&lt;init&gt;(Locale.java:602) at com.orientechnologies.orient.core.config.OStorageConfiguration.getLocaleInstance(OStorageConfiguration.java:242) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog$FilenameFilter.&lt;init&gt;(ODiskWriteAheadLog.java:144) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.&lt;init&gt;(ODiskWriteAheadLog.java:215) at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.&lt;init&gt;(ODiskWriteAheadLog.java:154) at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.initWalAndDiskCache(OLocalPaginatedStorage.java:484) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:255) ```  What can be done to prevent this failing?</body>
		<created>2017-06-26 13:27:51</created>
		<closed>2017-07-12 07:05:22</closed>
	</bug>
	<bug>
		<id>7511</id>
		<title>Problem in projection and filtering in EmbeddedMap property.</title>
		<body>### OrientDB Version: 2.2.22 ### Java Version:  1.8   ### OS:  linux     ## Expected behavior    I defined  an **embeded map** in **User** class and i want to project some map values after query on values .   `select LinkedAccounts.values() from `User` where LinkedAccounts.values() contains (Provider = "google") and LinkedAccounts.keys() contains "google::0923887327kjhdsf783kjhf7"`  returns some values and its ok   but `select LinkedAccounts.values()[IsDefault = true] from `User` where LinkedAccounts.values() contains (Provider = "google") and LinkedAccounts.keys() contains "google::0923887327kjhdsf783kjhf7"` returns a bracket only.  I test it by **embedded list** and it's ok . (same as documentation) I test it by **embedded set** and it's not ok .  I test it by **embedded map** and it's not ok .   Is it right or there is a problem here .   ## Actual behavior   Project and filter on `LinkedAccounts.values() ` with `LinkedAccounts.values()[IsDefault = true] ` syntax .  I attached some pictures to describe better . ![image](https://user-images.githubusercontent.com/10245423/27518756-485399a4-59fc-11e7-9dbd-8967262ed179.png)  and  compare to   ![image](https://user-images.githubusercontent.com/10245423/27518764-87ab0948-59fc-11e7-9b2a-1e9feec5009b.png)  Thanks  Saeed Tabrizi  </body>
		<created>2017-06-25 18:49:32</created>
		<closed>2017-06-26 08:37:18</closed>
	</bug>
	<bug>
		<id>7500</id>
		<title>SEVER Data restore was paused because of exception. during server starup</title>
		<body>### OrientDB Version: &lt;3.0.0m1&gt;   ### Java Version: &lt;1.8.0_131&gt;   ### OS: &lt;Win 10&gt;    ## Expected behavior   Ran the server.bat file and expected for the server to start  ## Actual behavior   (1) Ran the server.bat file and server startup failed and displayed the following message: 2017-06-16 10:39:08:089 SEVER Data restore was paused because of exception. The rest of changes  will be rolled back and WAL files will be backed up. Please report issue about this exception to bug tracker and provide WAL files which are backed up in 'wal_backup' directory. [OLocalPaginatedStorage] 2017-06-16 10:39:08:226 INFO  Storage data recover was completed [OLocalPaginatedStorage] 2017-06-16 10:39:08:942 INFO  {db=groupsdb} Wait till indexes restore after crash was finished. [OIndexManagerShared]  [wal_backup_16_06_17_10_39_08.zip](https://github.com/orientechnologies/orientdb/files/1081171/wal_backup_16_06_17_10_39_08.zip)   Then issued a Control-C on the console and in trying to shutdown the server hung up.  2017-06-16 10:40:45:689 WARNI Received signal: SIGINT [OSignalHandler] 2017-06-16 10:40:45:693 INFO  OrientDB Server is shutting down... [OServer] ## Steps to reproduce   Trying to start the server fails as mentioned above    The server Log:    [orient-server.log.zip](https://github.com/orientechnologies/orientdb/files/1081166/orient-server.log.zip)   </body>
		<created>2017-06-16 15:12:54</created>
		<closed>2017-06-16 15:45:04</closed>
	</bug>
	<bug>
		<id>7491</id>
		<title>Nodes Created When Querying Edges from Graph Editor</title>
		<body>### OrientDB Version: 2.2.21 ### Java Version: openjdk version "1.8.0_131" ### OS: Ubuntu 17.04  ## Expected behavior   SELECT should not mutate graph  ## Actual behavior   After creating two nodes (A, B), and two edges (A-&gt;B, B-&gt;B), and performing two SELECT commands inside the studio graph editor, on the second (and subsequent) SELECTs three new vertices are created, duplicating B.  ## Steps to reproduce    Create a new database, and set up the following schema:  ``` CREATE CLASS foo EXTENDS V CREATE CLASS bar EXTENDS V CREATE CLASS barfoo EXTENDS E CREATE CLASS barbar EXTENDS E ```  Run the following batch:  ``` BEGIN LET foo = CREATE VERTEX foo LET bar = CREATE VERTEX bar CREATE EDGE barfoo FROM $bar TO $foo CREATE EDGE barbar FROM $bar TO $bar LET result = SELECT $first AS tail,$last AS head FROM $foo LET first = in('barfoo')[0],last = $first.out('barbar') COMMIT RETURN $result ```  Then, in the graph editor (_this error only occurs from the graph editor_):  `SELECT FROM V`  The two vertices created in the batch appear.  `SELECT FROM E`  Three new vertices (of class 'bar') are added. From now on, this can be repeated, with three new vertices being added with each `SELECT FROM E` command.  Also, notably, no edges appear in the editor.</body>
		<created>2017-06-14 08:31:23</created>
		<closed>2017-06-14 11:22:07</closed>
	</bug>
	<bug>
		<id>7489</id>
		<title>Orientdb 3.0 - Problem with restarts when db is closed abruptly</title>
		<body>### OrientDB Version: 3.0 ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior   Database should stabilize and recover from any failures that might have caused because of abrupt close of db     ## Actual behavior   I think I have no idea why some times if db is closed (command window is closed) without control C, it doesn't work.  This never comes out of it. If it i doing some processing like fixing indexes, it must show status and let user be aware of it. going non responsive doesn't make sense at all.  ``` 2017-06-12 09:02:41:257 WARNI Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=16167388}} com.orientechnologies.orient.core.stora ge.impl.local.paginated.wal.OFuzzyCheckpointStartRecord{lsn=null, previousCheckpoint=OLogSequenceNumber{segment=0, position=16167341}} will be skipped during  data restore [OLocalPaginatedStorage]                                                                                                                          2017-06-12 09:02:41:257 WARNI Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segme nt=0, position=16167428}} will be skipped during data restore [OLocalPaginatedStorage]                                                                         2017-06-12 09:02:41:258 WARNI Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=16167435}} com.orientechnologies.orient.core.stora ge.impl.local.paginated.wal.OFuzzyCheckpointStartRecord{lsn=null, previousCheckpoint=OLogSequenceNumber{segment=0, position=16167388}} will be skipped during  data restore [OLocalPaginatedStorage]                                                                                                                          2017-06-12 09:02:41:259 WARNI Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segme nt=0, position=16167475}} will be skipped during data restore [OLocalPaginatedStorage]                                                                         2017-06-12 09:02:41:260 WARNI Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=16167482}} com.orientechnologies.orient.core.stora ge.impl.local.paginated.wal.OFuzzyCheckpointStartRecord{lsn=null, previousCheckpoint=OLogSequenceNumber{segment=0, position=16167435}} will be skipped during  data restore [OLocalPaginatedStorage]                                                                                                                          2017-06-12 09:02:41:261 WARNI Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segme nt=0, position=16167522}} will be skipped during data restore [OLocalPaginatedStorage]                                                                         2017-06-12 09:02:41:261 WARNI Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=16167529}} com.orientechnologies.orient.core.stora ge.impl.local.paginated.wal.OFuzzyCheckpointStartRecord{lsn=null, previousCheckpoint=OLogSequenceNumber{segment=0, position=16167482}} will be skipped during  data restore [OLocalPaginatedStorage]                                                                                                                          2017-06-12 09:02:41:262 WARNI Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segme nt=0, position=16167569}} will be skipped during data restore [OLocalPaginatedStorage]                                                                         2017-06-12 09:02:41:263 INFO  Storage data recover was completed [OLocalPaginatedStorage]                                                                      2017-06-12 09:02:44:302 INFO  {db=mlm} Wait till indexes restore after crash was finished. [OIndexManagerShared]          ```                        ## Steps to reproduce   Try having active databases created and used and then try killing db few times while active transactions are going on and try restart. you may be able to reproduce.   </body>
		<created>2017-06-13 13:46:27</created>
		<closed>2017-07-07 14:18:33</closed>
	</bug>
	<bug>
		<id>7488</id>
		<title>OrientDB 3.0 - NPE thrown when edge is not present</title>
		<body>### OrientDB Version: 3.0 (06/06 build) ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior    Shouln't cause NPE  ## Actual behavior   should we have NPE from OrientDB? while trying to do something like this.  code snippet that broke:     Iterator&lt;Edge&gt; edges = v.edges(Direction.OUT, RELATION_NAME);  ``` 09:47:17.147 [http-nio-8084-exec-3] ERROR   java.lang.NullPointerException: out vertex on edge com.orientechnologies.orient.core.record.impl.OEdgeDelegate@1025 at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:203) ~[google-collections-1.0-rc2.jar:?] at org.apache.tinkerpop.gremlin.orientdb.OrientEdge.&lt;init&gt;(OrientEdge.java:32) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientEdge.&lt;init&gt;(OrientEdge.java:46) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientEdge.&lt;init&gt;(OrientEdge.java:55) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientVertex.lambda$edges$8(OrientVertex.java:126) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_121] at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_121] at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_121] at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481) ~[?:1.8.0_121] at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471) ~[?:1.8.0_121] at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708) ~[?:1.8.0_121] at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_121] at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499) ~[?:1.8.0_121] at org.apache.tinkerpop.gremlin.orientdb.OrientVertex.edges(OrientVertex.java:128) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.callidus.mlm.data.dao.impl.TransactionDaoImpl.findById(TransactionDaoImpl.java:137) [classes/:?] at com.callidus.mlm.service.internal.OrderServiceImpl.processOrder(OrderServiceImpl.java:78) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:85) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.callidus.mlm.audit.ApplicationAuditor.serviceMethodExecutionTime(ApplicationAuditor.java:42) [classes/:?] at sun.reflect.GeneratedMethodAccessor66.invoke(Unknown Source) ~[?:?] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:629) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:618) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.sun.proxy.$Proxy96.processOrder(Unknown Source) [?:?] at com.callidus.mlm.resource.OrderResource.processOrder(OrderResource.java:69) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:116) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:648) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-embed-websocket-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121] at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]  ```  ## Steps to reproduce   should be a code issue, not writing any unit test for it. Let me know if this becomes difficult to reproduce and I will fix. </body>
		<created>2017-06-13 13:41:32</created>
		<closed>2017-06-29 00:57:56</closed>
	</bug>
	<bug>
		<id>7484</id>
		<title>OIndexException when trying to use index partially</title>
		<body>### OrientDB Version: 2.2.21 ### Java Version: 1.8   ### OS: linux  ## Scenario:  ``` CREATE CLASS User extends V CREATE PROPERTY User.login STRING (MANDATORY TRUE, NOTNULL) CREATE PROPERTY User.permissions EMBEDDEDSET STRING (MANDATORY TRUE, NOTNULL) CREATE INDEX User_Login_Perm on User(login, permissions) UNIQUE  // not entirely sure if a few vertices needed to reproduce. If not getting an error, please insert one or 2.  graph.getVertices("User", ["login"], ["admin"]) ``` Result:  &gt; ! com.orientechnologies.orient.core.index.OIndexException: Impossible add as key of a CompositeIndex a value of type class java.lang.String &gt; ! DB name="fragaria" &gt; ! at com.orientechnologies.orient.core.index.OCompositeCollate.transform(OCompositeCollate.java:62) &gt; ! at com.orientechnologies.orient.core.index.OIndexAbstract.getCollatingValue(OIndexAbstract.java:945) &gt; ! at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:47) &gt; ! at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:40) &gt; ! at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.get(OIndexAbstractDelegate.java:58) &gt; ! at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:262) &gt; ! at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:40) &gt; ! at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertices(OrientBaseGraph.java:907)</body>
		<created>2017-06-12 11:53:08</created>
		<closed>2017-07-13 16:36:40</closed>
	</bug>
	<bug>
		<id>7481</id>
		<title>3.0 - Found null entry in ridbag with rid=#26:-2</title>
		<body>### OrientDB Version: 3.0  ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior   code should work.  ## Actual behavior   `com.orientechnologies.orient.core.exception.OSerializationException: Found null entry in ridbag with rid=#26:-2 DB name="test1" at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.serialize(OEmbeddedRidBag.java:424) at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.toStream(ORidBag.java:269) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerNetworkV37.serializeValue(ORecordSerializerNetworkV37.java:498) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerNetworkV37.serialize(ORecordSerializerNetworkV37.java:149) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerNetworkV37.toStream(ORecordSerializerNetworkV37.java:775) at com.orientechnologies.orient.client.remote.message.OMessageHelper.writeTransactionEntry(OMessageHelper.java:201) at com.orientechnologies.orient.client.remote.message.OBeginTransactionRequest.write(OBeginTransactionRequest.java:76) at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:215) at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:210) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:274) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetryTimeout(OStorageRemote.java:210) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:238) at com.orientechnologies.orient.client.remote.OStorageRemote.reBeginTransaction(OStorageRemote.java:1783) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.checkAndSendTransaction(ODatabaseDocumentRemote.java:258) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote.command(ODatabaseDocumentRemote.java:292) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.lambda$executeSql$1(OrientGraph.java:245) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.executeWithConnectionCheck(OrientGraph.java:194) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.executeSql(OrientGraph.java:243) at com.orientdb.samples.test.RidBagErrorTest.testforRidBagError(RidBagErrorTest.java:75) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:108) at org.testng.internal.Invoker.invokeMethod(Invoker.java:661) at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:869) at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1193) at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:126) at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109) at org.testng.TestRunner.privateRun(TestRunner.java:744) at org.testng.TestRunner.run(TestRunner.java:602) at org.testng.SuiteRunner.runTest(SuiteRunner.java:380) at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:375) at org.testng.SuiteRunner.privateRun(SuiteRunner.java:340) at org.testng.SuiteRunner.run(SuiteRunner.java:289) at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86) at org.testng.TestNG.runSuitesSequentially(TestNG.java:1301) at org.testng.TestNG.runSuitesLocally(TestNG.java:1226) at org.testng.TestNG.runSuites(TestNG.java:1144) at org.testng.TestNG.run(TestNG.java:1115) at org.testng.remote.AbstractRemoteTestNG.run(AbstractRemoteTestNG.java:132) at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:230) at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:76)  `  ## Steps to reproduce   create a test db and use right credentials here. https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/java/com/orientdb/samples/test/RidBagErrorTest.java  </body>
		<created>2017-06-09 13:55:05</created>
		<closed>2017-06-28 16:16:32</closed>
	</bug>
	<bug>
		<id>7477</id>
		<title> ONeedRetryException : Cannot UPDATE the record #7:3 because the version is not the latest.</title>
		<body>### OrientDB Version: 3.0 snaphsot 06/07 ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior   Application should work fine all the time.  ## Actual behavior   randomly we run into this issue, not sure what is causing it.  work around we are using now is to restart the db and application. Otherwise we are struck actually.   com.mycompany.myapp.service.internal.AbstractBaseService - ONeedRetryException : Cannot UPDATE the record #7:3 because the version is not the latest. P robably you are updating an old record or it has been modified by another user (db=v18 your=v17)         DB name="dbName"         DB name="dbName"  Another one is  here `om.orientechnologies.orient.core.exception.OSerializationException: Found null entry in ridbag with rid=#142:-3         DB name="mlm"         at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.serialize(OEmbeddedRidBag.java:424)         at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.toStream(ORidBag.java:269)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serializeValue(ORecordSerializerBinaryV0.java:761)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:383)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:111)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:3553)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1274)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:545)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:110)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2593)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.close(ODatabaseDocumentEmbedded.java:271)         at com.orientechnologies.orient.server.OClientConnection.close(OClientConnection.java:72)         at com.orientechnologies.orient.server.OClientConnectionManager.disconnect(OClientConnectionManager.java:337)         at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeClose(OConnectionBinaryExecutor.java:136)         at com.orientechnologies.orient.client.remote.message.OCloseRequest.execute(OCloseRequest.java:47)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:252)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:176)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) $ANSI{green {db=mlm}} Exception during commit of active transaction`     ## Steps to reproduce   &lt;add here&gt;    </body>
		<created>2017-06-08 02:40:39</created>
		<closed>2017-07-25 19:08:54</closed>
	</bug>
	<bug>
		<id>7473</id>
		<title>Server failed to start when automatic backup is disabled</title>
		<body></body>
		<created>2017-06-06 14:07:57</created>
		<closed>2017-06-06 15:25:28</closed>
	</bug>
	<bug>
		<id>7472</id>
		<title>java.lang.ClassCastException: com.orientechnologies.orient.core.db.record.ORecordLazyList cannot be cast to com.orientechnologies.orient.core.db.record.ridbag.ORidBag</title>
		<body>### OrientDB Version: 2.2.17 ### Java Version: openjdk version "1.8.0_121" ### Java Version: OpenJDK Runtime Environment (IcedTea 3.3.0) (Alpine 8.121.13-r0) ### Java Version: OpenJDK 64-Bit Server VM (build 25.121-b13, mixed mode) ### OS: Alpine 3.5.2    ## Expected behavior    These query must work:  UPDATE EDGE LayerEntities SET out = #29:243 WHERE in = #35:65 AND out &lt;&gt; #29:243  ## Actual behavior    The query returns the following error:  **java.lang.ClassCastException: com.orientechnologies.orient.core.db.record.ORecordLazyList cannot be cast to com.orientechnologies.orient.core.db.record.ridbag.ORidBag**  ## Database Record Level Security  We have Drawing -DrawingLayers-&gt; Layer -LayerEntities-&gt; Entity. The Drawing and Layer classes inherits from ORestricted and the OUser has _allow on every Drawing and Layer record. The Entity class has no database record level security. We are basically moving an Entity from one Layer to another. </body>
		<created>2017-06-06 11:43:09</created>
		<closed>2017-06-06 20:00:29</closed>
	</bug>
	<bug>
		<id>7470</id>
		<title>OrientDB 3.0 issue with latest snapshot - com.orientechnologies.orient.core.exception.OConcurrentCreateException: Cannot create the record #17:0 because the assigned RID was #17:1 instead  DB name="testdb"  DB name="testdb"</title>
		<body>### OrientDB Version: 3.0 snapshot ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior   Should be able to retrieve and build edges with existing data.  ## Actual behavior   throws this error and fails. Resulting in application failing.  com.orientechnologies.orient.core.exception.OConcurrentCreateException: Cannot create the record #17:0 because the assigned RID was #17:1 instead  DB name="testdb"  DB name="testdb"   ## Steps to reproduce   create a db https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/resources/testdb.sql  run the tests. https://github.com/careerscale/orientdb-demo/blob/1d34326456df2f249a216044f147df4d5101579f/orientdb-java-sample/src/test/java/com/orientdb/samples/test/EmployeeCascadeTest.java  Run again  this test `testDbTransactionOperations_Working`  This fails.  we are blocked with this and any quick help will unblock our team.   Thanks. Harinath</body>
		<created>2017-06-06 02:35:15</created>
		<closed>2017-06-06 12:52:47</closed>
	</bug>
	<bug>
		<id>7464</id>
		<title>Locale dependent uppercase of schema prevents db from uploading data with turkish locale</title>
		<body>### OrientDB Version: 2.2.20 ### Java Version: 1.8.0_112   ### OS: Macos 10.12.5    ## Expected behavior   File should be uploaded without an error   ## Actual behavior   Error occurs  ` ETL process has problem: java.lang.IllegalArgumentException: No enum constant com.orientechnologies.orient.core.metadata.schema.OType.NTEGER ` ## Steps to reproduce   According to the tutorial at https://orientdb.com/docs/2.2/Import-the-Database-of-Beers.html   - With turkish region set operating system  - Download orient db  - Extract the compressed file  - Execute the command below with appropriate files   `oetl.sh categories.json`  ## Work around add the jvm parameters in oetl.bat to ORIENTDB_SETTINGS variable `  -Duser.language=en -Duser.region=EN  `  ## Check for similar bugs and the solutions  http://mattryall.net/blog/2009/02/the-infamous-turkish-locale-bug https://issues.apache.org/jira/browse/SPARK-20156 https://jira.atlassian.com/browse/CONFSERVER-5931 https://issues.apache.org/jira/browse/AVRO-1493  Thanks to @vezir for reporting the issue</body>
		<created>2017-05-31 08:18:34</created>
		<closed>2017-06-09 13:12:33</closed>
	</bug>
	<bug>
		<id>7459</id>
		<title>Orient 3.0 - NPE with dserver.bat  </title>
		<body>### OrientDB Version: 3.0 snapshot ### Java Version: 1.8 ### OS: win 7  ## Expected behavior   dserver.bat should have successful start even as a single node.  ## Actual behavior   Errors out and fails  ## Steps to reproduce    When tried to start using dserver.bat (I was using with server.bat all the time, wanted to try dserver.bat).  hmallepa@HMALLEPA-T450 C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\bin                                                                                                                    $ dserver.bat                                                                                                                                                                                                   .                                                                                                                                                                                                   .`        `                                                                                                                                                                                          ,      `:.                                                                                                                                                                                          `,`    ,:`                                                                                                                                                                                           .,.   :,,                                                                                                                                                                                            .,,  ,,,                                                                                                                                                                                        .    .,.:::::  ````                                 :::::::::     :::::::::                                                                                                                          ,`   .::,,,,::.,,,,,,`;;                      .:    ::::::::::    :::    :::                                                                                                                         `,.  ::,,,,,,,:.,,.`  `                       .:    :::      :::  :::     :::                                                                                                                         ,,:,:,,,,,,,,::.   `        `         ``     .:    :::      :::  :::     :::                                                                                                                          ,,:.,,,,,,,,,: `::, ,,   ::,::`   : :,::`  ::::   :::      :::  :::    :::                                                                                                                            ,:,,,,,,,,,,::,:   ,,  :.    :   ::    :   .:    :::      :::  :::::::                                                                                                                                :,,,,,,,,,,:,::   ,,  :      :  :     :   .:    :::      :::  :::::::::                                                                                                                        `     :,,,,,,,,,,:,::,  ,, .::::::::  :     :   .:    :::      :::  :::     :::                                                                                                                      `,...,,:,,,,,,,,,: .:,. ,, ,,         :     :   .:    :::      :::  :::     :::                                                                                                                        .,,,,::,,,,,,,:  `: , ,,  :     `   :     :   .:    :::      :::  :::     :::                                                                                                                          ...,::,,,,::.. `:  .,,  :,    :   :     :   .:    :::::::::::   :::     :::                                                                                                                               ,::::,,,. `:   ,,   :::::    :     :   .:    :::::::::     ::::::::::                                                                                                                                ,,:` `,,.                                                                                                                                                                                           ,,,    .,`                                                                                                                                                                                          ,,.     `,                                          GRAPH DATABASE                                                                                                                                 ``        `.                                                                                                                                                                                                   ``                                         www.orientdb.org                                                                                                                                          `                                                                                                                                                                                                                                                                                                                                                                                        2017-05-29 14:44:03:994 INFO  Loading configuration from: C:/software/orientdb-community-3.0.0-SNAPSHOT.20170526/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml]                2017-05-29 14:44:04:244 INFO  OrientDB Server v3.0.0-SNAPSHOT (build bae4ca56ff063ca253a15b54ae4c670742faf11b) is starting up... [OServer]                                                           2017-05-29 14:44:04:283 INFO  OrientDB auto-config DISKCACHE=13,576MB (heap=455MB direct=524,288MB os=16,080MB) [orientechnologies]                                                                  2017-05-29 14:44:04:349 INFO  Databases directory: C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\databases [OServer]                                                                        2017-05-29 14:44:04:858 INFO  Listening binary connections on 0.0.0.0:2424 (protocol v.37, socket=default) [OServerNetworkListener]                                                                  2017-05-29 14:44:04:862 INFO  Listening http connections on 0.0.0.0:2480 (protocol v.10, socket=default) [OServerNetworkListener]                                                                    2017-05-29 14:44:04:874 INFO  Installing dynamic plugin 'orientdb-studio-3.0.0-20170511.152528-55.zip'... [OServerPluginManager]                                                                                                                                                                                                                                                                          +---------------------------------------------------------------+                                                                                                                                    |         WARNING: FIRST DISTRIBUTED RUN CONFIGURATION          |                                                                                                                                    +---------------------------------------------------------------+                                                                                                                                    | This is the first time that the server is running as          |                                                                                                                                    | distributed. Please type the name you want to assign to the   |                                                                                                                                    | current server node.                                          |                                                                                                                                    |                                                               |                                                                                                                                    | To avoid this message set the environment variable or JVM     |                                                                                                                                    | setting ORIENTDB_NODE_NAME to the server node name to use.    |                                                                                                                                    +---------------------------------------------------------------+                                                                                                                                                                                                                                                                                                                                         Node name [BLANK=auto generate it]: node1                                                                                                                                                                                                                                                                                                                                                                 2017-05-29 14:44:13:663 WARNI Assigning distributed node name: node1 [OHazelcastPlugin]                                                                                                              2017-05-29 14:44:14:022 INFO  Configuring Hazelcast from 'C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\config\hazelcast.xml'. [FileSystemXmlConfig]                                        2017-05-29 14:44:14:166 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper]                                                                                2017-05-29 14:44:14:484 INFO  [LOCAL] [orientdb] [3.6.5] Prefer IPv4 stack is true. [DefaultAddressPicker]                                                                                           2017-05-29 14:44:14:655 INFO  [LOCAL] [orientdb] [3.6.5] Picked Address[10.102.200.145]:2434, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=2434], bind any local is true [DefaultAddres ker]                                                                                                                                                                                                 2017-05-29 14:44:14:675 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Hazelcast 3.6.5 (20160823 - e4af3d9) starting at Address[10.102.200.145]:2434 [system]                                        2017-05-29 14:44:14:676 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system]                                                        2017-05-29 14:44:14:677 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Configured Hazelcast Serialization version : 1 [system]                                                                       2017-05-29 14:44:14:920 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Backpressure is disabled [OperationService]                                                                                   2017-05-29 14:44:14:947 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Starting with 1 generic operation threads and 1 partition operation threads. [ClassicOperationExecutor]                       2017-05-29 14:44:15:771 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Creating MulticastJoiner [Node]                                                                                               2017-05-29 14:44:15:775 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Address[10.102.200.145]:2434 is STARTING [LifecycleService]                                                                   2017-05-29 14:44:15:891 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads [NonBlockingIOTh ingModel]                                                                                                                                                                                            2017-05-29 14:44:18:944 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Members [1] {                                                                                                                                                                                                Member [10.102.200.145]:2434 this                                                                                                                                                            }                                                                                                                                                                                                     [MulticastJoiner]                                                                                                                                                                                   2017-05-29 14:44:19:060 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Address[10.102.200.145]:2434 is STARTED [LifecycleService]                                                                    2017-05-29 14:44:19:066 INFO  Starting distributed server 'node1' (hzID=acd610cf-07d5-49df-adf9-9304ebe43bca)... [OHazelcastPlugin]                                                                  2017-05-29 14:44:19:084 INFO  Distributed cluster time=Mon May 29 14:44:19 PDT 2017 (delta from local node=0)... [OHazelcastPlugin]                                                                  2017-05-29 14:44:19:137 INFO  [10.102.200.145]:2434 [orientdb] [3.6.5] Initializing cluster partition table arrangement... [InternalPartitionService]                                                2017-05-29 14:44:19:234 INFO  Distributed coordinator server is 'node1' [OHazelcastPlugin]                                                                                                           2017-05-29 14:44:19:274 INFO  [node1] Loaded configuration for database 'OSystem' from disk: C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\config\default-distributed-db-config.json [ODist tedStorage]                                                                                                                                                                                          2017-05-29 14:44:19:290 WARNI [node1] Servers in cluster: [node1] [OHazelcastPlugin]                                                                                                                 2017-05-29 14:44:20:065 INFO  Loading configuration from: C:/software/orientdb-community-3.0.0-SNAPSHOT.20170526/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml]                2017-05-29 14:44:20:954 INFO  [node1] Opening database 'demodb'... [OHazelcastPlugin]                                                                                                                2017-05-29 14:44:20:956 INFO  [node1] Loaded configuration for database 'demodb' from disk: C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\config\default-distributed-db-config.json [ODistr edStorage]                                                                                                                                                                                           2017-05-29 14:44:20:965 INFO  [node1] Setting new distributed configuration for database: demodb (version=1)                                                                                                                                                                                                                                                                                              CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy)                                                                                                                                                  +--------+-----------+----------+                                                                                                                                                                    |CLUSTER |writeQuorum|readQuorum|                                                                                                                                                                    +--------+-----------+----------+                                                                                                                                                                    |*       |     1     |    1     |                                                                                                                                                                    |internal|     1     |    1     |                                                                                                                                                                    +--------+-----------+----------+                                                                                                                                                                                                                                                                                                                                                                          [ODistributedStorage]                                                                                                                                                                               2017-05-29 14:44:20:980 INFO  [node1] Distributed servers status:                                                                                                                                                                                                                                                                                                                                         +------+--------+---------+-----+---------+-----------------+-----------------+------------------------+                                                                                             |Name  |Status  |Databases|Conns|StartedOn|Binary           |HTTP             |UsedMemory              |                                                                                             +------+--------+---------+-----+---------+-----------------+-----------------+------------------------+                                                                                             |node1*|STARTING|         |0    |14:44:04 |192.168.56.1:2424|192.168.56.1:2480|25.69MB/455.50MB (5.64%)|                                                                                             +------+--------+---------+-----+---------+-----------------+-----------------+------------------------+                                                                                              [OHazelcastPlugin]                                                                                                                                                                                  2017-05-29 14:44:20:983 INFO  [node1] Current node started as MASTER for database 'demodb' [OHazelcastPlugin$6]                                                                                      2017-05-29 14:44:20:986 INFO  [node1] Adding node 'node1' in partition: [*] db=demodb v=3 [ODistributedDatabaseImpl$6]                                                                               2017-05-29 14:44:20:988 INFO  [node1] Setting new distributed configuration for database: demodb (version=3)                                                                                                                                                                                                                                                                                              CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy)                                                                                                                                                  +--------+-----------+----------+-------------+                                                                                                                                                      |        |           |          |   MASTER    |                                                                                                                                                      |        |           |          |NOT_AVAILABLE|                                                                                                                                                      |        |           |          |   static    |                                                                                                                                                      +--------+-----------+----------+-------------+                                                                                                                                                      |CLUSTER |writeQuorum|readQuorum|    node1    |                                                                                                                                                      +--------+-----------+----------+-------------+                                                                                                                                                      |*       |     1     |    1     |      X      |                                                                                                                                                      |internal|     1     |    1     |             |                                                                                                                                                      +--------+-----------+----------+-------------+                                                                                                                                                                                                                                                                                                                                                            [ODistributedStorage]                                                                                                                                                                               2017-05-29 14:44:21:001 INFO  [node1] Broadcasting new distributed configuration for database: demodb (version=3)                                                                                     [OHazelcastPlugin]                                                                                                                                                                                  2017-05-29 14:44:25:330 INFO  Previous maximum cache size was 310515 current maximum cache size is 184633. Cache state for storage C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\databases\ db will not be restored. [O2QCache]                                                                                                                                                                  2017-05-29 14:44:26:115 INFO  {db=demodb} [node1] Reassigning ownership of clusters for database demodb... [OHazelcastPlugin]                                                                        2017-05-29 14:44:26:119 INFO  {db=demodb} [node1] Reassignment of clusters for database 'demodb' completed (classes=36) [OHazelcastPlugin][node1] Error on starting distributed plugin               java.lang.NullPointerException                                                                                                                                                                               at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:713)                                                                                                  at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:697)                                                                                                  at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1599)                                            at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:697)                                                                                      at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:257)                                                                                                 at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1105)                                                                                                                    at com.orientechnologies.orient.server.OServer.activate(OServer.java:398)                                                                                                                            at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46)                                                                                                                                                                                                                                                                                                                     2017-05-29 14:44:26:127 INFO  - shutdown storage: demodb... [OrientDBEmbedded]com.orientechnologies.orient.server.distributed.ODistributedStartupException: Error on starting distributed plugin             at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:305)                                                                                                 at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1105)                                                                                                                    at com.orientechnologies.orient.server.OServer.activate(OServer.java:398)                                                                                                                            at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46)                                                                                                                Caused by: java.lang.NullPointerException                                                                                                                                                                    at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:713)                                                                                                  at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$6.call(OHazelcastPlugin.java:697)                                                                                                  at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1599)                                            at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadLocalDatabases(OHazelcastPlugin.java:697)                                                                                      at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:257)                                                                                                 ... 3 more                                                                                                                                                                                   hmallepa@HMALLEPA-T450 C:\software\orientdb-community-3.0.0-SNAPSHOT.20170526\bin                                                                                                                    $                                                                                                                                                                                                     </body>
		<created>2017-05-29 21:55:39</created>
		<closed>2017-06-28 15:30:35</closed>
	</bug>
	<bug>
		<id>7458</id>
		<title>Orient 3.0 - Issue in executing sql script on console (even from java shows similar behavior)</title>
		<body>### OrientDB Version: 3.0 snapshot ### Java Version: 1.8 ### OS:  Win 7  ## Expected behavior   Should be able to execute the script with MATCH without any problem.  ## Actual behavior   Steps and error is given below  ## Steps to reproduce    I tried to run simple script but somehow it doesn't work. Not sure if this is with latest snapshots or something.  Here is the script.  ``` script SQL CREATE CLASS Person extends V; CREATE VERTEX Person set name="Luca"; LET $a = (MATCH {class:Person, as:s} RETURN s); select expand($a.s); end ``` Here is the output, I don't understand why it should fail. other thing is that the error is thrice instead of once, so there is something missing here. I am using latest snapshots of orientdb 3.0  ``` orientdb {db=demo}&gt; script SQL [Started multi-line command. Type just 'end' to finish and execute]  Error: java.lang.StringIndexOutOfBoundsException: String index out of range: -1 CREATE CLASS Person extends V;  +----+------------+---------+ |#   |operation   |className| +----+------------+---------+ |0   |create class|Person   | +----+------------+---------+ Server side script executed in 0.070000 sec(s). Returned 1 recordsCREATE  VERTEX Person set name="Luca"; LET $a = (MATCH {class:Person, as:s} RETURN s); select expand($a.s); end Error:  com.orientechnologies.orient.core.exception.OCommandExecutionException: Class Person already exists     DB name="demo"     DB name="demo"   Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Class Person already exists     DB name="demo"     DB name="demo"   Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Class Person already exists     DB name="demo"     DB name="demo"    Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Class Person already exists     DB name="demo"     DB name="demo"  ```</body>
		<created>2017-05-29 20:11:49</created>
		<closed>2017-10-04 01:24:59</closed>
	</bug>
	<bug>
		<id>7457</id>
		<title>Per-page checksums are broken if there were page allocations past the EOF</title>
		<body>Allocations past the EOF enlarge the file size, the newly allocated pages are filled with zeros, but we expect there must be a valid magic number and a checksum.</body>
		<created>2017-05-29 13:15:22</created>
		<closed>2017-06-16 10:47:13</closed>
	</bug>
	<bug>
		<id>7453</id>
		<title>Orient 3.0 - Unique index on edge is not working as expected</title>
		<body>### OrientDB Version: 3.0 ### Java Version: 1.8 ### OS:  Win 7  ## Expected behavior   The constraint like this one below create property LIVES_IN.out LINK User; create property LIVES_IN.in LINK Address; create index UNIQUE_LIVES_IN on LIVES_IN(out,in) unique;  should ensure something like this  Luca LIVES_IN London Luca LIVES_IN Rome Luigi LIVES_IN Rome     work fine, and when we get same relation twice  say another  Luca LIVES_IN London   it should break  ## Actual behavior   it breaks right at 3rd line Luigi LIVES_IN Rome    ## Steps to reproduce   https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/java/com/orientdb/samples/test/OrientDBInvalidTxCounterTest.java and check createUser_gremlin() method, run it.   </body>
		<created>2017-05-26 07:16:33</created>
		<closed>2017-06-05 15:32:18</closed>
	</bug>
	<bug>
		<id>7451</id>
		<title>Orient 3.0 - No automatic rollbacks when exception happens</title>
		<body>### OrientDB Version: 3.0 ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior   We are using gremlin api (TP 3.0) and everything working fine with 3.0 with latest snapshots.  one issue we see is that we need to add rollback as a manual step, but as per my understanding,  graph.rollback() is not required (also we removed the graph.begin() as it seemed implicit)  ## Actual behavior   partial data is getting saved without proper rollback.  ## Steps to reproduce   Unit test to follow  </body>
		<created>2017-05-26 06:02:47</created>
		<closed>2017-06-12 13:37:06</closed>
	</bug>
	<bug>
		<id>7450</id>
		<title>NPE while trying to create vertex with no properties set</title>
		<body>### OrientDB Version: 3.0 snapshot ### Java Version: 1.8 ### OS: Win 7  ## Expected behavior   we should be able to create vertex without properties, as per logic, our application will feed properties later, but getting null pointer.  Same result from console and browser too.  ## Actual behavior   Throws up nullpointer  ## Steps to reproduce   CREATE CLASS Person EXTENDS V; CREATE PROPERTY Person.name String (default "test"); ### This fails CREATE VERTEX Person;   ### This one works though CREATE VERTEX Person SET name="Luca";  </body>
		<created>2017-05-25 23:30:08</created>
		<closed>2017-05-26 13:16:00</closed>
	</bug>
	<bug>
		<id>7449</id>
		<title>lockAllExclusive/unlockAllExclusive is broken in OOneEntryPerKeyLockManager and OIndexOneEntryPerKeyLockManager</title>
		<body>Proper `lockAllExclusive/unlockAllExclusive` implementation must be provided for `OOneEntryPerKeyLockManager` and `OIndexOneEntryPerKeyLockManager` since current implementation doesn't really lock all keys and it's prone to deadlocks.</body>
		<created>2017-05-25 13:34:38</created>
		<closed>2017-06-22 12:52:55</closed>
	</bug>
	<bug>
		<id>7448</id>
		<title>Index key locking is broken on mutable keys</title>
		<body>Some index keys, like ORIDs and OCompositeKeys containing ORIDs, may be mutated during the record insertion. As a result, key locking for such keys is not reliable. We already have the fix for that  micro transactions in `micro-tx` branch, but the locking order should be changed. First, we must lock the clusters, then update the record identities and then lock the indexes.  Micro transactions must be backported to 2.2.x with the fix mentioned above.</body>
		<created>2017-05-25 13:28:22</created>
		<closed>2017-06-22 12:55:08</closed>
	</bug>
	<bug>
		<id>7446</id>
		<title>Unable to create new users in distributed setup </title>
		<body>### OrientDB Version: 2.2.15 ### Java Version: 1.8 ### OS: CentOS 6.8  Identical to issue #6307 - doesn't appear to have been fixed in version 2.2.15</body>
		<created>2017-05-25 08:44:42</created>
		<closed>2017-05-29 19:27:20</closed>
	</bug>
	<bug>
		<id>7444</id>
		<title>Transaction rollback without giving right reason, every reason boils down to just "No Transaction Active"</title>
		<body>### OrientDB Version:  3.0 snapshot latest ### Java Version: 1.8 ### OS:   Win 7  ## Expected behavior   Transaction should happen or fail and appropriate error should be thrown, not some abstract "No Transaction Active",    When I debugged my code and orient db code,, found that there is a constraint that failed, but no where it is clear about the issue, the exception stack should provide actual reason and not some thing like the current one, in the stack trace, I should see it somewhere the actual reason.  ## Actual behavior   com.orientechnologies.orient.core.exception.ODatabaseException: No Transaction Active DB name="myapp" DB name="myapp" at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:1.8.0_121] at java.lang.reflect.Constructor.newInstance(Constructor.java:423) ~[?:1.8.0_121] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:324) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:281) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:197) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:159) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1637) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:224) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:210) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:274) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetryTimeout(OStorageRemote.java:210) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:238) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.client.remote.OStorageRemote.rollback(OStorageRemote.java:903) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.tx.OTransactionOptimistic$1.call(OTransactionOptimistic.java:148) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.tx.OTransactionOptimistic$1.call(OTransactionOptimistic.java:144) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.storage.OStorageAbstract.callInLock(OStorageAbstract.java:182) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.tx.OTransactionOptimistic.rollback(OTransactionOptimistic.java:144) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2609) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2565) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.commit(OrientGraph.java:523) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.mycompany.myapp.service.internal.PlanServiceImpl.createPlan(PlanServiceImpl.java:76) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:85) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.mycompany.myapp.audit.ApplicationAuditor.serviceMethodExecutionTime(ApplicationAuditor.java:42) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:629) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:618) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.sun.proxy.$Proxy96.createPlan(Unknown Source) [?:?] at com.mycompany.myapp.resource.PlanResource.createPlan(PlanResource.java:46) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:116) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:648) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-embed-websocket-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121] at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.lang.Thread.run(Thread.java:745) [?:1.8.0_121] Suppressed: com.orientechnologies.orient.core.exception.ODatabaseException: No Transaction Active DB name="myapp" at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeRollback(OConnectionBinaryExecutor.java:1217) ~[?:?] at com.orientechnologies.orient.client.remote.message.ORollbackTransactionRequest.execute(ORollbackTransactionRequest.java:51) ~[orientdb-client-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:247) ~[?:?] at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:176) ~[?:?] at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] 11:22:31.532 [http-nio-8084-exec-2] INFO  org.apache.tinkerpop.gremlin.orientdb.OrientGraph - Error during context close for db remote:localhost/myapp com.orientechnologies.orient.core.exception.OStorageException: Invalid value of TX counter DB name="myapp" at com.orientechnologies.orient.core.tx.OTransactionOptimistic.rollback(OTransactionOptimistic.java:129) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2609) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2565) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.close(OrientGraph.java:570) [orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.mycompany.myapp.data.dao.impl.BaseDaoImpl.closeGraph(BaseDaoImpl.java:79) [classes/:?] at com.mycompany.myapp.service.internal.AbstractBaseService.closeDatabase(AbstractBaseService.java:47) [classes/:?] at com.mycompany.myapp.service.internal.PlanServiceImpl.createPlan(PlanServiceImpl.java:81) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:85) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.mycompany.myapp.audit.ApplicationAuditor.serviceMethodExecutionTime(ApplicationAuditor.java:42) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:629) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:618) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.sun.proxy.$Proxy96.createPlan(Unknown Source) [?:?] at com.mycompany.myapp.resource.PlanResource.createPlan(PlanResource.java:46) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:116) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:648) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-embed-websocket-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121] at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.lang.Thread.run(Thread.java:745) [?:1.8.0_121] 11:22:31.538 [http-nio-8084-exec-2] ERROR com.orientechnologies.orient.core.db.document.ODatabaseDocumentRemote - Exception during commit of active transaction com.orientechnologies.orient.core.exception.OStorageException: Invalid value of TX counter DB name="myapp" at com.orientechnologies.orient.core.tx.OTransactionOptimistic.rollback(OTransactionOptimistic.java:129) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.rollback(ODatabaseDocumentAbstract.java:2666) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.close(ODatabaseDocumentAbstract.java:820) [orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.close(OrientGraph.java:581) [orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.mycompany.myapp.data.dao.impl.BaseDaoImpl.closeGraph(BaseDaoImpl.java:79) [classes/:?] at com.mycompany.myapp.service.internal.AbstractBaseService.closeDatabase(AbstractBaseService.java:47) [classes/:?] at com.mycompany.myapp.service.internal.PlanServiceImpl.createPlan(PlanServiceImpl.java:81) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:85) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.mycompany.myapp.audit.ApplicationAuditor.serviceMethodExecutionTime(ApplicationAuditor.java:42) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:629) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:618) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.sun.proxy.$Proxy96.createPlan(Unknown Source) [?:?] at com.mycompany.myapp.resource.PlanResource.createPlan(PlanResource.java:46) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:116) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:648) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-embed-websocket-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121] at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.lang.Thread.run(Thread.java:745) [?:1.8.0_121] 11:22:31.552 [http-nio-8084-exec-2] WARN  com.mycompany.myapp.data.dao.impl.BaseDaoImpl - Unable to close graph {} com.orientechnologies.orient.core.exception.OStorageException: Invalid value of TX counter DB name="myapp" at com.orientechnologies.orient.core.tx.OTransactionOptimistic.rollback(OTransactionOptimistic.java:129) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2609) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2565) ~[orientdb-core-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.close(OrientGraph.java:570) ~[orientdb-gremlin-3.0.0-SNAPSHOT.jar:3.0.0-SNAPSHOT] at com.mycompany.myapp.data.dao.impl.BaseDaoImpl.closeGraph(BaseDaoImpl.java:79) [classes/:?] at com.mycompany.myapp.service.internal.AbstractBaseService.closeDatabase(AbstractBaseService.java:47) [classes/:?] at com.mycompany.myapp.service.internal.PlanServiceImpl.createPlan(PlanServiceImpl.java:81) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:85) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.mycompany.myapp.audit.ApplicationAuditor.serviceMethodExecutionTime(ApplicationAuditor.java:42) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:629) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:618) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) [spring-aop-4.3.7.RELEASE.jar:4.3.7.RELEASE] at com.sun.proxy.$Proxy96.createPlan(Unknown Source) [?:?] at com.mycompany.myapp.resource.PlanResource.createPlan(PlanResource.java:46) [classes/:?] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_121] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_121] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_121] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_121] at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:116) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:648) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) [spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-embed-websocket-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11] at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121] at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11] at java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]   ## Steps to reproduce   Not the whole problem but a bit of it is in the unit test  https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/java/com/orientdb/samples/test/OrientDBInvalidTxCounterTest.java  Problem is simple i want to define a User and Address,  "LIVES_IN" edge,  added unique constraint on "LIVES_IN" with the assumption  there shouldnt be more than 1 "LIVES_IN" relation between a user and a address.   But it should let multiple people live in the same address.  test fails with duplicate key error.  com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record #44:1: found duplicated key 'OCompositeKey{keys=[#-1:-11, #-1:-8]}' in index 'UNIQUE_LIVES_IN' previously assigned to the record #44:0 DB name="demo" DB name="demo" INDEX=UNIQUE_LIVES_IN RID=#44:0 at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:423) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:324) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:281) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:197) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:159) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1637) at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:224) at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:210) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:274) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetryTimeout(OStorageRemote.java:210) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:238) at com.orientechnologies.orient.client.remote.OStorageRemote.commit(OStorageRemote.java:876) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:539) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:110) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2596) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2565) at org.apache.tinkerpop.gremlin.orientdb.OrientGraph.commit(OrientGraph.java:523) at com.orientdb.samples.test.OrientDBInvalidTxCounterTest.createUser_gremlin(OrientDBInvalidTxCounterTest.java:145) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:108) at org.testng.internal.Invoker.invokeMethod(Invoker.java:661) at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:869) at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1193) at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:126) at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109) at org.testng.TestRunner.privateRun(TestRunner.java:744) at org.testng.TestRunner.run(TestRunner.java:602) at org.testng.SuiteRunner.runTest(SuiteRunner.java:380) at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:375) at org.testng.SuiteRunner.privateRun(SuiteRunner.java:340) at org.testng.SuiteRunner.run(SuiteRunner.java:289) at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86) at org.testng.TestNG.runSuitesSequentially(TestNG.java:1301) at org.testng.TestNG.runSuitesLocally(TestNG.java:1226) at org.testng.TestNG.runSuites(TestNG.java:1144) at org.testng.TestNG.run(TestNG.java:1115) at org.testng.remote.AbstractRemoteTestNG.run(AbstractRemoteTestNG.java:132) at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:230) at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:76) Suppressed: com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record #44:1: found duplicated key 'OCompositeKey{keys=[#-1:-11, #-1:-8]}' in index 'UNIQUE_LIVES_IN' previously assigned to the record #44:0 DB name="demo" INDEX=UNIQUE_LIVES_IN RID=#44:0 at com.orientechnologies.orient.core.index.OIndexUnique$1.validate(OIndexUnique.java:47) at com.orientechnologies.orient.core.index.OIndexUnique$1.validate(OIndexUnique.java:37) at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.put(OSBTree.java:301) at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.validatedPut(OSBTree.java:248) at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.validatedPut(OSBTreeIndexEngine.java:170) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doValidatedPutIndexValue(OAbstractPaginatedStorage.java:1842) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.validatedPutIndexValue(OAbstractPaginatedStorage.java:1818) at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:80) at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:35) at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:931) at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:774) at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:746) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:1324) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1278) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:539) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:110) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2596) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentAbstract.commit(ODatabaseDocumentAbstract.java:2565) at com.orientechnologies.orient.server.OConnectionBinaryExecutor.executeCommit37(OConnectionBinaryExecutor.java:1183) at com.orientechnologies.orient.client.remote.message.OCommit37Request.execute(OCommit37Request.java:124) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:247) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:176) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)   </body>
		<created>2017-05-24 18:29:22</created>
		<closed>2017-06-09 14:09:06</closed>
	</bug>
	<bug>
		<id>7442</id>
		<title>OrientDB 3.0 Impossible to read a chunk of length:309751660 max allowed chunk length:16777216 </title>
		<body>### OrientDB Version: 3.0 snapshot ### Java Version: 1.8 ### OS:  Win 7  ## Expected behavior   Application should work normally  ## Actual behavior   Exception in thread "Thread-15" com.orientechnologies.common.io.OIOException: Impossible to read a chunk of length:309751660 max allowed chunk length:16777216 see NETWORK_BINARY_MAX_CONTENT_LENGTH settings  at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readBytes(OChannelBinary.java:161) at com.orientechnologies.orient.client.remote.OStorageRemotePushThread.run(OStorageRemotePushThread.java:41)  ## Steps to reproduce   Adding db constraints broke this. I cant share the original script, but just followed http://orientdb.com/docs/2.0/orientdb.wiki/Tutorial-Using-schema-with-graphs.html and added out and in for all edges I have defined in my product and also added unique  constraint for all edges.     </body>
		<created>2017-05-23 20:11:58</created>
		<closed>2017-05-24 20:34:04</closed>
	</bug>
	<bug>
		<id>7440</id>
		<title>DepthFirstTraverseStep.java minor typo in explain plan </title>
		<body>### OrientDB Version: 3.0 ### Java Version: 1.8 ### OS:  Windows 7/10  ## Expected behavior   There shouldnt be any typo.  ## Actual behavior   First is misspelt as FRIST in DepthFirstTraverseStep.java       result.append("+ DEPTH-FRIST TRAVERSE \n");  ## Steps to reproduce    DepthFirstTraverseStep.java </body>
		<created>2017-05-22 19:52:08</created>
		<closed>2017-05-23 07:41:44</closed>
	</bug>
	<bug>
		<id>7438</id>
		<title>OrientDB 3.0  delete doesnt work in a transaction</title>
		<body>### OrientDB Version:  3.0 ### Java Version: 1.8 ### OS:  Windows 7 /10  ## Expected behavior   Delete should work within a transaction scope (when  graph.begin() is used).  ## Actual behavior    Test case fails, delete doesn't work with graph.begin(), works without it.  ## Steps to reproduce    run the schema https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/resources/testSchema.sql  https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/java/com/orientdb/samples/test/OrientDbDeleteTransactionTest.java  test method deleteUsers should pass   </body>
		<created>2017-05-22 13:46:01</created>
		<closed>2017-05-26 07:17:29</closed>
	</bug>
	<bug>
		<id>7435</id>
		<title>Inline LinkList of Batch Variables in Vertex Creation</title>
		<body>### OrientDB Version: 2.2.18 ### Java Version: openjdk version "1.8.0_131" ### OS: Ubuntu 17.04  ## Expected behavior  Expect to be able to specify a LINKLIST inline in the SET clause of CREATE VERTEX, when this LINKLIST is composed by evaluating batch variables.  ## Actual behavior    I get the following OValidationException when I try to define the LinkList inline, rather than defining a batch variable to contain it.  `pyorient.exceptions.PyOrientCommandException: com.orientechnologies.orient.core.exception.OValidationException - The field 'bar.foos' has been declared as LINKLIST but the value is not a record or a record-id`  ## Steps to reproduce    Given this setup:  ``` CREATE CLASS foo EXTENDS V CREATE CLASS bar EXTENDS V CREATE PROPERTY bar.foos LinkList foo ```  This batch **does not** work: ``` BEGIN LET a = CREATE VERTEX foo LET b = CREATE VERTEX foo LET c = CREATE VERTEX foo CREATE VERTEX bar SET foos=[$a,$b,$c] COMMIT ```  Whereas this one **does**:  ``` BEGIN LET a = CREATE VERTEX foo LET b = CREATE VERTEX foo LET c = CREATE VERTEX foo LET foos = [$a,$b,$c] CREATE VERTEX bar SET foos=$foos COMMIT ``` </body>
		<created>2017-05-19 22:46:14</created>
		<closed>2017-05-24 14:41:02</closed>
	</bug>
	<bug>
		<id>7430</id>
		<title>Multiple vertices of same class do not get saved in single transaction - with sequence</title>
		<body>### OrientDB Version: 3.0 snapshot ### Java Version: 1.8 ### OS: windows  ## Expected behavior   Multiple vertices are not being saved, test case  creates multiple Vertices (of User and Bonus types)  in a single transaction but what gets saved is only one per type.  We had same problem with orientdb-graphdb api earlier and as per the suggestion moved to gremlin, but here too I seem to have problem.  my db schema definition defines a sequence for these vertex types so I would expect that to auto generate multiple ids as needed within the same transaction.  I think I am not looking for something complex here, this is a simple requirement and should be working fine.  Unit test attached with sandbox code  I would expect the test case to pass.  ## Actual behavior   test fails  ## Steps to reproduce   db schema: https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/resources/testSchema.sql  test case https://github.com/careerscale/orientdb-demo/blob/master/orientdb-java-sample/src/test/java/com/orientdb/samples/test/OrientDbTransactionTest.java  </body>
		<created>2017-05-18 19:33:14</created>
		<closed>2017-05-19 17:47:58</closed>
	</bug>
	<bug>
		<id>7427</id>
		<title>Possible NPE when switching from 2.2.19 to 2.2.20</title>
		<body>### OrientDB Version: 2.2.20 ### Java Version: OpenJDK 8   ### OS: linux  ## Expected behavior   There is the following SQL: ```sql select sum(myField.size()) as count from ClassA  ``` "myField" is LINKSET/LINKLIST. If this field is empty for all documents of ClassA this SQL should return 0  ## Actual behavior   Starting 2.2.20 this SQL began return "null" which might lead to NPE in consuming code.   Please let me know if starting 2.2.20 it's expected behavior. </body>
		<created>2017-05-18 05:12:42</created>
		<closed>2017-05-22 12:52:35</closed>
	</bug>
	<bug>
		<id>7426</id>
		<title>ArrayIndex out of bound error</title>
		<body>### OrientDB Version: &lt;version here&gt;   Newest ### Java Version: &lt;version here&gt;   8 ### OS: &lt;os here&gt;   Linux  com.orientechnologies.orient.core.exception.ODatabaseException: Error on retrieving record #18:23497 (cluster: node_1) DB name="OrientDB3" at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1926) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:220) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:194) at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:324) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1628) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:103) at com.orientechnologies.orient.core.id.ORecordId.getRecord(ORecordId.java:330) at com.tinkerpop.blueprints.impls.orient.OrientElementIterator.next(OrientElementIterator.java:62) at com.tinkerpop.blueprints.impls.orient.OrientElementIterator.next(OrientElementIterator.java:35) at main.java.com.bag.server.database.OrientDBDatabaseAccess.applyUpdate(OrientDBDatabaseAccess.java:272) at main.java.com.bag.operations.UpdateOperation.apply(UpdateOperation.java:34) at main.java.com.bag.server.AbstractRecoverable.executeCommit(AbstractRecoverable.java:527) at main.java.com.bag.server.GlobalClusterSlave.executeCommit(GlobalClusterSlave.java:246) at main.java.com.bag.server.GlobalClusterSlave.appExecuteBatch(GlobalClusterSlave.java:107) at bftsmart.tom.server.defaultservices.DefaultRecoverable.executeBatch(DefaultRecoverable.java:87) at bftsmart.tom.server.defaultservices.DefaultRecoverable.executeBatch(DefaultRecoverable.java:68) at bftsmart.tom.ServiceReplica.receiveMessages(ServiceReplica.java:432) at bftsmart.tom.core.DeliveryThread.deliverMessages(DeliveryThread.java:293) at bftsmart.tom.core.DeliveryThread.run(DeliveryThread.java:225) Caused by: java.lang.ArrayIndexOutOfBoundsException: -9 at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readFullEntry(OPaginatedCluster.java:1795) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:666) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:628) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doReadRecord(OAbstractPaginatedStorage.java:3329) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:2959) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1086) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3238) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1888)   </body>
		<created>2017-05-17 18:16:54</created>
		<closed>2017-09-21 12:17:14</closed>
	</bug>
	<bug>
		<id>7418</id>
		<title>Prepared params, IN clause, array of enums: stackoverflow exception</title>
		<body>### OrientDB Version: 2.2.20   `SELECT * FROM Project WHERE status in :status`  if status is enum array (tested with 2 elements), it will fall into infinite recursion during parsing named parameters, and end in stackoverflow.  This one works, if :status is Enum: `SELECT * FROM Project WHERE status = :status`   ``` // toParsedTree function  ...       while (iterator.hasNext()) {         Object o = iterator.next();         OExpression exp = new OExpression(-1);         exp.value = toParsedTree(o); //recursive call, returns itself, one time for each element in array         coll.expressions.add(exp);       } ... ```  Not particulary painfull, as I can map Enum to String on my own, but confusing, since status = :status, where status is enum works.  Part of stack:   &gt; ERROR [2017-05-15 09:54:47,472] io.dropwizard.jersey.errors.LoggingExceptionMapper: Error handling a request: f8918bc72cb46f84 &gt; ! java.lang.StackOverflowError: null &gt; ! at com.orientechnologies.common.collection.OMultiValue.isMultiValue(OMultiValue.java:50) &gt; ! at com.orientechnologies.common.collection.OMultiValue.isMultiValue(OMultiValue.java:62) &gt; ! at com.orientechnologies.orient.core.sql.parser.OInputParameter.toParsedTree(OInputParameter.java:77) &gt; ! at com.orientechnologies.orient.core.sql.parser.ONamedParameter.bindFromInputParams(ONamedParameter.java:49) &gt; ! at com.orientechnologies.orient.core.sql.parser.ONamedParameter.toString(ONamedParameter.java:31) &gt; ! at com.orientechnologies.orient.core.sql.parser.OExpression.toString(OExpression.java:104) &gt; ! at com.orientechnologies.orient.core.sql.parser.OCollection.toString(OCollection.java:35) &gt; ! at com.orientechnologies.orient.core.sql.parser.ONamedParameter.toString(ONamedParameter.java:39) &gt; ! at com.orientechnologies.orient.core.sql.parser.OExpression.toString(OExpression.java:104) &gt; ! at com.orientechnologies.orient.core.sql.parser.OCollection.toString(OCollection.java:35) &gt; ! at com.orientechnologies.orient.core.sql.parser.ONamedParameter.toString(ONamedParameter.java:39) &gt; ! at com.orientechnologies.orient.core.sql.parser.OExpression.toString(OExpression.java:104) &gt; ! at com.orientechnologies.orient.core.sql.parser.OCollection.toString(OCollection.java:35) &gt; ! at com.orientechnologies.orient.core.sql.parser.ONamedParameter.toString(ONamedParameter.java:39) &gt; ! at com.orientechnologies.orient.core.sql.parser.OExpression.toString(OExpression.java:104) &gt; ! at com.orientechnologies.orient.core.sql.parser.OCollection.toString(OCollection.java:35) &gt;  ...</body>
		<created>2017-05-15 10:20:40</created>
		<closed>2017-07-25 13:36:20</closed>
	</bug>
	<bug>
		<id>7416</id>
		<title>SQL Select returns wrong result if field ordered by is not in the selected fields.</title>
		<body>### OrientDB Version: 2.2.19 ### Java Version: 8 ### OS: Centos    ## Expected behavior   data returns in the order by  ## Actual behavior   returns ordered by @rid  ## Steps to reproduce   Hi guys,  I've been tracking a bug for a couple of hours and it seems that the SQL returns the wrong result if the field ordered by is not in the selected fields, had my head scratching for sometime. see the 2 queries below.. they are almost the same except the first one returns created_dt.  the first query is fetching data ordered by created_dt and has the same field returned, the result is correct.  SELECT user_box_id,_id, name, created_dt FROM MyTable WHERE ( user_id = "5916dd9c11d82a0369450424") ORDER BY created_dt desc LIMIT 5  In the following query, the result does not have created_dt and the order by is wrong. I've analyzed the data and it's ordering by the @rid. #213:3, #213:4, #213:5, #214:3, #214:4, when the field is missing.  SELECT user_box_id,_id, name FROM MyTable WHERE ( user_id = "5916dd9c11d82a0369450424") ORDER BY created_dt desc LIMIT 5  I haven't been doing SQL for sometime but I don't believe the field must be returned for an order by to work as that's the filtering after the fetch and not prior.  If I'm wrong on this, I prefer an error from the database to be honest than misleading result.  Thanks, Safwan  </body>
		<created>2017-05-13 12:26:48</created>
		<closed>2017-05-22 10:42:23</closed>
	</bug>
	<bug>
		<id>7403</id>
		<title>Strange working SQL GET query for fields with type OType.DATE</title>
		<body>### OrientDB Version: 2.2.19  in version 2.1.19 everything was fine ### Java Version: 7 OpenJDK  ### OS: Ubuntu 16.04 Case: strange working SQL GET query for fields with type OType.DATE.  ## Expected behavior   When we executing SQL query for getting documents from OrientDB like "SELECT FROM ${MyClass} WHERE ${MyField}='${MyDate}'" in OrientDB version 2.1.19 all works fine.  ## Actual behavior   When we executing that SQL query in OrientDB version 2.2.19 its don't work! For getting documents with fields type OType.DATE we must use SQL query like:  "SELECT FROM ${MyClass} WHERE ${MyField} LIKE '${MyDate}'".  For other OrientDB types all works fine.  ## Steps to reproduce   Execute SQL query for get documents from OClass with property type OType.DATE. SQL query like this: "SELECT FROM ${MyClass} WHERE ${MyField}='${MyDate}'"   ## Example SELECT FROM TestClass WHERE dateField='2017-05-09' </body>
		<created>2017-05-09 00:30:05</created>
		<closed>2017-05-09 11:27:00</closed>
	</bug>
	<bug>
		<id>7399</id>
		<title>Sequence Property Default Value Not Lazily Evaluated</title>
		<body>### OrientDB Version: 2.2.18 ### Java Version: openjdk version "1.8.0_121" ### OS: Ubuntu 17.04  ## Expected behavior    Trying to specify a class property's default value as the next item in a created sequence. Expect each new instance to get a different value.  ## Actual behavior    Two problems. The ALTER PROPERTY under **Steps to reproduce** gives a NullPointerException.  If I change the string delimiter in the sequence() call, the 'ALTER PROPERTY' succeeds, but each new sequenceditem gets the same id.  ## Steps to reproduce   Create a new database, then run the following SQL:  ``` CREATE CLASS sequenceditem EXTENDS V CREATE SEQUENCE item_ids TYPE ORDERED START -1 CREATE PROPERTY sequenceditem.id Long ALTER PROPERTY sequenceditem.id DEFAULT sequence("item_ids").next() ``` </body>
		<created>2017-05-05 23:18:45</created>
		<closed>2017-05-08 07:57:11</closed>
	</bug>
	<bug>
		<id>7398</id>
		<title>Saving an embedded list as null prevents the list from being updated later using the Object API.</title>
		<body>### OrientDB Version: 2.2.18 Enterprise  ### Java Version: 1.8  ### OS: SLES  ## Expected behavior   I should be able to save an embedded list property as null and update it later with a non-empty list using the object API.  ## Actual behavior   When I try to update the object with a non-empty list it's staying as null.  This doesn't happen if I initially set it to an empty list instead.  ## Steps to reproduce   Create an object with a null embedded list reference and try to update it to an non-empty list using the object API.  </body>
		<created>2017-05-05 14:50:54</created>
		<closed>2017-06-05 15:51:03</closed>
	</bug>
	<bug>
		<id>7395</id>
		<title>CI tests periodically fail with report that JVM was crashed</title>
		<body>### OrientDB Version: 2.2.x   ## Expected behavior   All maven tests should pass smoothly  ## Actual behavior   Periodically we see a message: "The forked VM terminated without properly saying goodbye. VM crash or System.exit called?"  ## Steps to reproduce   Run maven tests on CI envinroment several times.  </body>
		<created>2017-05-05 07:33:52</created>
		<closed>2017-05-05 08:27:05</closed>
	</bug>
	<bug>
		<id>7391</id>
		<title>Timeout on acquiring lock when insert duplicated record in distributed mode</title>
		<body>### OrientDB Version: 2.2.18   ### Java Version: 1.8.0_73   ### OS: el6  ## issue: when inserting duplicated record (with unique index) in distributed mode, have following exception: ODistributedRecordLockedException: Timeout (3938ms) on acquiring lock on record #13:1 on server 'node2'. It is locked by request 0.14 For version 2.1.x, OrientDB will throw ORecordDuplicatedException, which I think make sense. because I can handle it immediately without delay.   why v2.2.x does not throw ORecordDuplicatedException, did I miss something?   ## Expected behavior   should throw ORecordDuplicatedException  ## Actual behavior   ODistributedRecordLockedException: Timeout (3938ms) on acquiring lock on record #13:1 on server 'node2'. It is locked by request 0.14  ## Steps to reproduce   1. create unique index: drop class orion_v unsafe; create class orion_v extends v; create property orion_v.pk string; alter property orion_v.pk mandatory true; drop index idx_orion_v_pk; create index idx_orion_v_pk on orion_v(pk) unique_hash_index;  2. run java code: String pk1="11"; graph.addVertex("class:orion_v","pk",pk1); graph.addVertex("class:orion_v","pk",pk1); graph.commit(); </body>
		<created>2017-05-03 15:31:06</created>
		<closed>2017-05-19 14:55:17</closed>
	</bug>
	<bug>
		<id>7390</id>
		<title>Native memory leak because of usage direct byte buffer during WAL flush</title>
		<body>### OrientDB Version:  2.2.19  ## Expected behavior   If a disk cache is full and we perform data modification operations, direct memory consumption should not grow anymore.  ## Actual behavior   Direct memory consumption is increasing without any limits.  ## Steps to reproduce   Create a database which can not be fully cached on disk, start to modify records are placed inside of a database, or you also can rebuild index several times.  </body>
		<created>2017-05-03 13:11:16</created>
		<closed>2017-05-04 08:48:36</closed>
	</bug>
	<bug>
		<id>7388</id>
		<title>Log is filled with memory leak warnings</title>
		<body>### OrientDB Version: 2.2 ### Java Version: 1.8  After execution of test, https://slack-files.com/T04EMG7AY-F57929QRW-2ee6e8b0ef log is filled with warnings ```2017-05-03 04:16:38:598 SEVER OCachePointer.finalize: readers != 0 [OCachePointer]```</body>
		<created>2017-05-03 10:28:06</created>
		<closed>2017-07-13 14:25:33</closed>
	</bug>
	<bug>
		<id>7387</id>
		<title>MATCH Query not using index.</title>
		<body>### OrientDB Version: 2.2.19 ### Java Version: 8 ### OS: Centos    ## Expected behavior   should show that it used the unique index for _id.  ## Actual behavior   no index used to fetch the starting vertex.  ## Steps to reproduce   create a unique index on field _id on a schema (ex. channel). run the following query.  EXPLAIN MATCH {class: Channel, where: (_id="5904764211d82a05b0b5c7a8")}.outE("e_PERMISSIONS"){as: relationship} return relationship  the explain shows that no index was used.  </body>
		<created>2017-05-03 10:07:14</created>
		<closed>2017-05-03 14:52:29</closed>
	</bug>
	<bug>
		<id>7382</id>
		<title>Lucene's range queries on dates: timezone mismatch</title>
		<body>### OrientDB Version: 2.2.19   ### Java Version: all   ### OS: alll  ## Expected behavior   Lucene's range query on date should take care of timezone.   ## Actual behavior   The date passed in the query is parsed with timezone of the local JVM rather than the timezone of the database  ## Steps to reproduce    #7220  show the problem.   </body>
		<created>2017-04-30 10:41:06</created>
		<closed>2017-05-02 13:41:10</closed>
	</bug>
	<bug>
		<id>7376</id>
		<title>Can't save CSV from studio </title>
		<body>### OrientDB Version: 2.2.19   ### Java Version: 1.8.0_121  ### OS: OSX 10.11.6  ## Expected behavior   I'd like to save output from a query into a CSV file.  I changed the "Content Type" in the pulldown to "CSV" in Studio to run a query hopeful that it will save the output to a CSV file...   ## Actual behavior   I get an error message on the bottom of the screen that indicates "The command has not been executed".  I don't see any useful messages in the console log of the server.  ![screen shot 2017-04-27 at 11 05 28 am](https://cloud.githubusercontent.com/assets/263654/25495414/3d45034a-2b3a-11e7-9aff-5b993d2be79c.png)  ## Steps to reproduce   Create a simple database. Click the wrench icon next to the "Explain" button on the Browse tab.  Change Content Type to CSV Execute a query, such as SELECT FROM V Observer error message.      </body>
		<created>2017-04-27 17:11:45</created>
		<closed>2017-05-02 11:52:07</closed>
	</bug>
	<bug>
		<id>7375</id>
		<title>Trouble with order of params in graph.getVertices when using index</title>
		<body>### OrientDB Version: 2.2.18  ### Java Version: 8 ### OS: linux   ## Expected behavior    I perform a query for Tasks. Task is created as:  ``` CREATE CLASS Task extends V CREATE PROPERTY Task.projectId STRING (MANDATORY TRUE, NOTNULL, MAX 20) CREATE PROPERTY Task.seq SHORT ( MANDATORY TRUE, NOTNULL, MIN 0)  CREATE INDEX TaskPK ON Task (projectId, seq) UNIQUE ```  I performed a query in "wrong" (not index) order (yeah, I don't intend for it to stay this way)  `graph.getVertices(Task.CLASS, arrayOf(Task.SEQ, Task.PROJECT_ID), arrayOf(taskId.seq, taskId.projectId))`  OrientDb decides to use index here anyway. That would not be a problem, except that the order or keys is switched. This causes orientdb to try to cast taskId to String, and projectId to Short. That obviously causes the error.  Querry works perfectly after changing the order of parameters. `graph.getVertices(Task.CLASS, arrayOf(Task.SEQ, Task.PROJECT_ID), arrayOf(taskId.projectId, taskId.seq))`  In my original code, I will switch the order of Ikeys to correspond to Index, so that is not a problem for me in the slightest. I just wanted to share with you this oddity.  This would be bad if both of my parameters were of type string - then It would cause strange querry results, and would make the problem hard to pinpoint. I would better have an exception instead of this weird result.  Problem is here:   ```       Set&lt;OIndex&lt;?&gt;&gt; indexes = clazz.getInvolvedIndexes(Arrays.asList(iKey)); //finds index correctly       Iterator&lt;OIndex&lt;?&gt;&gt; iterator = indexes.iterator();  // iterate over it randomly, not caring about order of parameters       while (iterator.hasNext()) { ...           List&lt;Object&gt; keys = Arrays.asList(convertKeys(idx, iValue)); //and cast (the place that originally have thrown the error) ...  ```  ## Steps to reproduce   I will branch out my project if anyone finds this worth investigating.</body>
		<created>2017-04-27 09:35:09</created>
		<closed>2017-05-02 10:55:38</closed>
	</bug>
	<bug>
		<id>7373</id>
		<title>cannot query on an emmbedded-list (long) with the operator 'between x and y' </title>
		<body>### OrientDB Version: 2.2.17   ### Java Version: java 8 update 131 ### OS: Windows 10    I cannot query on an emmbedded-list (long) with the operator 'between x and y' and not with '&gt;=x and &lt;=y' (&gt;= alone - works, &lt;= alone - works) - the index is notUnique.  ## Expected behavior   if a record contains the value [2,3,4] in an 'emmbedded-list (long)' field called 'prop', I should get this record when perform a query serach with the condition like: 'prop between 1 and 4', 'prop between 2 and 3'  ## Actual behavior   an exception is thrown in orient server:  &gt; Error on using index EN70.EP70_4 in query 'SELECT * FROM EN70 WHERE (EP70_4 BETWEEN 1 AND 3 )'. Probably you need to rebuild indexes. Now executing query using cluster scan java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.lang.Long at com.orientechnologies.common.serialization.types.OLongSerializer.preprocess(OLongSerializer.java:36) at...  ## Steps to reproduce    1.   I have a vertex called: EN70 with a property: EP70_4 from type 'embedded list = LONG'. 2.   I added a record to this vertex with the value of [2,3,4] in this 'EP70_4' property. 3.   The index on this property: Not_Unique (sbtree). [must support range queries] 4.   SELECT * FROM EN70 WHERE (EP70_4 &gt;= 1) is working and returns my record. 5.   SELECT * FROM EN70 WHERE (EP70_4 &lt;= 3) is working and returns my record. 6.   The operator "Between" is not woking and throw exception: SELECT * FROM EN70 WHERE (EP70_4 BETWEEN 1 AND 3 ) 7.   I tried to simulate a "between" operator: SELECT * FROM EN70 WHERE ((EP70_4 &gt;= 1) AND (EP70_4 &lt;= 3)) IS NOT WORKING but it is not working.  both sections 6 and 7 throws an exception: Error on using index EN70.EP70_4 in query 'SELECT * FROM EN70 WHERE (EP70_4 BETWEEN 1 AND 3 )'. Probably you need to rebuild indexes. Now executing query using cluster scan java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.lang.Long at com.orientechnologies.common.serialization.types.OLongSerializer.preprocess(OLongSerializer.java:36) at...  See also: [http://stackoverflow.com/questions/43602699/using-beteen-operator-on-a-long-embedded-list-property-declared-in-orientdb-2](url)</body>
		<created>2017-04-26 10:49:00</created>
		<closed>2017-04-26 15:42:15</closed>
	</bug>
	<bug>
		<id>7368</id>
		<title>Concurrency problems in connection/database reuse on server</title>
		<body>Micro-transactions "relaxed" the locking during commits, there are no key locks anymore. Apparently, that also revealed concurrency problems in server connection/database reuse. `ConcurrentUpdatesTest#concurrentOptimisticUpdates` fails with "Error deserializing record", the real problem is that the database is closed from the other thread. Logging shows that one database instance is being accessed simultaneously by two server connection threads.  For now, I'm just disabling the test in `micro-tx` branch.</body>
		<created>2017-04-25 09:30:20</created>
		<closed>2017-06-13 09:57:44</closed>
	</bug>
	<bug>
		<id>7362</id>
		<title>SQL REMOVE of a field fails when followed by additional SQL synatx</title>
		<body>### OrientDB Version: 2.2 ### Java Version: 8   ### OS: Centos    ## Actual behavior   Database error that syntax is invalid.  ## Steps to reproduce   Found a bug as we translate our mongo code to Orient.  Look at fieldX, it's just a field that we want to remove, not an array.. if it's the last instruction in SQL before the WHERE it works, if it's followed by any other SQL syntax it'll fail.   this query will work  update Test ADD names="abc" SET AGE=1 remove names = "blah4", fieldX where @rid=#29:7  this query will break because fieldX is followed by an additional SQL syntax update Test ADD names="abc" remove names = "blah4", fieldX SET AGE=1 where @rid=#29:7</body>
		<created>2017-04-24 10:32:16</created>
		<closed>2017-04-24 14:25:15</closed>
	</bug>
	<bug>
		<id>7358</id>
		<title>Database name must be case insensitive</title>
		<body>### OrientDB Version: 2.2.18 ### Java Version: 8 ### OS: MacOSX   I  have created a database with name `Test5` on a server, but when I open it as test5 from studio, it says that the file is already locked.  Database names should be registered as case insensitive because on some OS (like Windows) there cannot be folders Test5 ans test5.</body>
		<created>2017-04-22 15:14:42</created>
		<closed>2017-04-22 17:23:08</closed>
	</bug>
	<bug>
		<id>7349</id>
		<title>Inconsistent/wrong query behaviour in distributed setup when using aggregate functions</title>
		<body>### OrientDB Version: 2.2.14-18  (community edition, distributed setup) ### Java Version: 1.8   ### OS: GNU/Linux    ## Expected behavior   Executing aggregate functions over an empty result set should return an empty result.  For example executing the following query over an empty table should return 0 items found .... in non-distributed setup the behaviour is the expected: ``` orientdb {db=TestDB}&gt; create class Test  Class created successfully. Total classes in database now: 12.  orientdb {db=TestDB}&gt; select sum(fieldA) as fieldA from Test where fieldB = true  0 item(s) found. Query executed in 0.003 sec(s). ``` Executing from Studio: ``` {     "result": [              ],     "notification": "Query executed in 0.067 sec. Returned 0 record(s)" } ```  ## Actual behavior   But in distributed setup the same query surprisingly return 1 item.  ## Steps to reproduce   ``` orientdb {db=TestDB}&gt; create class Test  Class created successfully. Total classes in database now: 12.  orientdb {db=TestDB}&gt; select sum(fieldA) as fieldA from Test where fieldB = true  +----+------+ |#   |fieldA| +----+------+ |0   |      | +----+------+  1 item(s) found. Query executed in 0.001 sec(s). ```  Executing from Studio return this: ``` {     "result": [         {             "@type": "d",             "@version": 0,             "sum": null         }     ],     "notification": "Query executed in 0.061 sec. Returned 1 record(s)" } ```  The same happen using max() and set() .... I didn't try other functions but I guess the problem is generalized.</body>
		<created>2017-04-18 21:03:41</created>
		<closed>2017-05-22 12:51:06</closed>
	</bug>
	<bug>
		<id>7344</id>
		<title>Exceptions on shutdown in 3.0</title>
		<body>Seems like databases are closed too early before the actual storage shutdown, or shutdown is being called twice, or there are multiple uncoordinated instances. Unit tests and CI tests are affected, logs on Jenkins are spammed with `NoSuchFileException` and similar exceptions.</body>
		<created>2017-04-18 08:03:55</created>
		<closed>2017-09-11 16:30:15</closed>
	</bug>
	<bug>
		<id>7339</id>
		<title>In Studio Creating edges in Graph view </title>
		<body>### OrientDB Version: 2.2.8 ### Java Version: 8 ### OS: Windows 7   ## Expected behavior   In Graph view when I create an edge between 2 veticies I shouldn't have to manually enter rid of each vertecy.  ## Actual behavior   In Graph view even though I visually selected 2 verticies to create an edge I am still asked to manually enter rids.  ## Steps to reproduce   Create and edge between 2 verticies in Graph view  </body>
		<created>2017-04-14 17:03:03</created>
		<closed>2017-04-18 11:08:41</closed>
	</bug>
	<bug>
		<id>7335</id>
		<title>Deadlock during transaction simultanios commit and index drop in distributed storage</title>
		<body>### OrientDB Version: 2.2    ## Expected behavior   During commit of data and drop of indexes both operations should run without deadlocking of each other  ## Actual behavior   Because of different order in which index and storage locks are acquired during commit in distributed storage we catch deadlock sometimes  Commit stack trace ``` at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:84)     at com.orientechnologies.orient.core.index.OIndexAbstract.acquireSharedLock(OIndexAbstract.java:1083)     at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:759)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:1479)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1443)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.commit(ODistributedStorage.java:1380 ``` Index drop stack trace ``` at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:142)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.startAtomicOperation(ODurableComponent.java:123)     at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.delete(OSBTree.java:349)     at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.delete(OSBTreeIndexEngine.java:87)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.deleteIndexEngine(OAbstractPaginatedStorage.java:1673)     at com.orientechnologies.orient.core.index.OIndexAbstract.delete(OIndexAbstract.java:649)     at com.orientechnologies.orient.core.index.OIndexAbstract.delete(OIndexAbstract.java:71)     at com.orientechnologies.orient.core.index.OIndexManagerShared.dropIndex(OIndexManagerShared.java:257) ```</body>
		<created>2017-04-14 08:15:07</created>
		<closed>2017-09-04 09:27:45</closed>
	</bug>
	<bug>
		<id>7331</id>
		<title>failed to  disable OAutomaticBackup</title>
		<body>### OrientDB Version: 2.2.18   ### Java Version: 1.8.0_101   ### OS: 2.6.32-431.el6.x86_64   ## Expected behavior   disable automatic backup database    ## Actual behavior   after orientdb running few minutes, automatic backup .....  then dserver.log show :  The server is frozen (usually is because a backup is running). Redirecting the request to another server^M         DB name="gacenter_tst". Reconnecting to 10.10.10.74:2424 (from=whrzx03 to=whrzx04)         at com.orientechnologies.agent.OEnterpriseAgent.onBeforeClientRequest(OEnterpriseAgent.java:404)         at com.orientechnologies.orient.server.plugin.OServerPluginHelper.invokeHandlerCallbackOnBeforeClientRequest(OServerPluginHelper.java:56)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:443)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:306)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:200)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)        ## Steps to reproduce   orientdb-server-config.xml :         &lt;handler class="com.orientechnologies.orient.server.handler.OAutomaticBackup"&gt;             &lt;parameters&gt;                 &lt;parameter value="false" name="enabled"/&gt;                 &lt;parameter value="${ORIENTDB_HOME}/config/automatic-backup.json" name="config"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;   </body>
		<created>2017-04-12 03:44:23</created>
		<closed>2017-04-12 12:58:07</closed>
	</bug>
	<bug>
		<id>7322</id>
		<title>Incorrect work of 'SELECT' query</title>
		<body>### OrientDB Version: 3.0.0-SNAPSHOT   ### Java Version: 1.8  ### OS: Ubuntu  Try to execute query "SELECT FROM ProductType WHERE id="74326f5e-ca9f-4e29-9e2c-a87da69e6f90""   ## Expected behavior   returns no documents. ## Actual behavior    Returns: {"@type":"d","@rid":"#25:-5","@version":0,"@class":"ProductType","description":"vegetables","id":"**99246056-882f-4ba4-8d3d-44543e8bc7ef**"}  ## Steps to reproduce   During transactions add document and try to search the document.   </body>
		<created>2017-04-09 20:29:22</created>
		<closed>2017-04-23 20:07:15</closed>
	</bug>
	<bug>
		<id>7320</id>
		<title>Memory Leak in Profiler: Disabling the profiler is still collecting stats, and holding the instance of deleted DB</title>
		<body>### OrientDB Version: 2.2.17   ### Java Version: open JDK 8.x.x ### OS: Windows all    ## Expected behavior   If Profiler is disabled then it should not collect any type of stats. And it should not hold the reference of deleted DB  ## Actual behavior   If OProfiler is disabled then its should not collect stats. In our application we are creating lots of temporary memory based DB(memory) and then when trying to delete it, Db is getting deleted but profiler is holding the reference of the DB. Thus profiler is preventing it in GC cycles. Application is going out of memory.  ## Steps to reproduce   Create many OMemory DBs on fly and then call delete on that datastore one after other. After some time take the heap dump of Java process, check if HashMap inside OProfilerStub is holding the reference of that DB  Please let me know if you have questions  </body>
		<created>2017-04-09 11:38:24</created>
		<closed>2017-05-03 15:37:40</closed>
	</bug>
	<bug>
		<id>7315</id>
		<title>3.0.0-497-snapshot: db upgrade + traverse -&gt; NPE</title>
		<body>Hi,  Part of the _3.0 Support Readiness_ process, I am testing database binary compatibility.   How to reproduce the issue:  1. download orientdb version of the panama-papers db (this has been created with 2.2): https://github.com/santo-it/panama-papers-orientdb 2. unzip the db in the `databases` directory 3. start the server and connect via `Studio` 4. execute the query  ``` TRAVERSE * FROM (MATCH {class: Officer, as: o, where:(name.toLowerCase() LIKE "pedro delgado")} RETURN o) MAXDEPTH 6 ```  Result:  ``` Internal server error:  java.lang.NullPointerException         at com.orientechnologies.orient.core.sql.executor.DepthFirstTraverseStep.fetchNextEntryPoints(DepthFirstTraverseStep.java:25)         at com.orientechnologies.orient.core.sql.executor.AbstractTraverseStep.fetchNextBlock(AbstractTraverseStep.java:97)         at com.orientechnologies.orient.core.sql.executor.AbstractTraverseStep.access$000(AbstractTraverseStep.java:15)         at com.orientechnologies.orient.core.sql.executor.AbstractTraverseStep$1.hasNext(AbstractTraverseStep.java:44)         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.fetchNext(OLocalResultSet.java:28)         at com.orientechnologies.orient.core.sql.parser.OLocalResultSet.&lt;init&gt;(OLocalResultSet.java:23)         at com.orientechnologies.orient.core.sql.parser.OTraverseStatement.execute(OTraverseStatement.java:77)         at com.orientechnologies.orient.core.sql.parser.OStatement.execute(OStatement.java:55)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentEmbedded.command(ODatabaseDocumentEmbedded.java:397)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.executeStatement(OServerCommandPostCommand.java:174)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:84)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:36)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:168)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:625)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  Thanks,  </body>
		<created>2017-04-06 23:32:00</created>
		<closed>2017-04-07 10:51:59</closed>
	</bug>
	<bug>
		<id>7308</id>
		<title>GraphAPI path: ONetworkProtocolBinary: Cannot serialize record</title>
		<body>### OrientDB Version: 2.2.17 ### Java Version: \jdk1.8.0_40 ### OS:  Windows 7 64bit  ## Expected behavior   Path returned to client  ## Actual behavior   Error on server side in ONetworkProtocolBinary: "Cannot serialize record" 2017-04-05 13:36:56:157 WARNI {db=GratefulDeadConcerts} Cannot serialize record: [v(Entity)[#81:0], v(Entity)[#83:0], v(Entity)[#81:1]] [ONetworkProtocolBinary]  ## Steps to reproduce   Setup:  - OrientDB as server, GratefulDeadConcerts database - java app as  client, accessing the remote database using tinkerpop 2.6 gremlin-groovy   ``` // Gremlin expression which returns a path OrientGraph graph = new OrientGraph("remote:localhost/GratefulDeadConcerts"); String gremlinCmd2 = "g.v('81:0').both.loop(1){it.loops&lt;5}{it.object.name=='Robert'}.simplePath.path"; Iterable&lt;?&gt; allVertices =  graph.command(new OCommandGremlin(gremlinCmd2)).execute(); Iterator&lt;?&gt; iterator = allVertices.iterator(); while (iterator.hasNext()) {         Object v = iterator.next();    // error here        System.out.println(v); } ``` On the client side, I receive in iterator.next()  java.util.NoSuchElementException at com.tinkerpop.blueprints.impls.orient.OrientDynaElementIterator.next(OrientDynaElementIterator.java:57)  On the server side I see  2017-04-05 13:39:04:287 WARNI {db=GratefulDeadConcerts} Cannot serialize record: [v(Entity)[#81:0], v(Entity)[#82:0], v(Entity)[#81:1]] [ONe tworkProtocolBinary]  Why can't the path be serialised?   I saw [1] which was solved in 2.2 (10/2016), so it's probably not the same problem.   [1] https://github.com/orientechnologies/orientdb/issues/5579</body>
		<created>2017-04-05 11:42:44</created>
		<closed>2017-06-05 15:19:47</closed>
	</bug>
	<bug>
		<id>7307</id>
		<title>oetl import does not rename mysql fields</title>
		<body>### OrientDB Version: 2.2.17   ### Java Version: 1.8.0_111   ### OS: debian 8  ## Expected behavior   I am importing tables from mysql to orientdb thanks to oetl.sh. I use the following setup : ``` {   "config": {     "log": "debug"   },   "extractor" : {     "jdbc": { "driver": "com.mysql.jdbc.Driver",               "url": "jdbc:mysql://localhost/DBFROM",               "userName": "mysqluser",               "userPassword": "mysqlpwd",               "query": "SELECT m.firstname, m.name as lastname FROM member m" }   },   "transformers" : [     {"vertex": { "class":"Member"}}   ],   "loader" : {     "orientdb": {       "dbType": "graph",       "dbURL": "remote:localhost/mydb",       "dbUser": "admin",       "dbPassword": "admin",       "serverUser": "root",       "serverPassword": "root",       "standardElementConstraints": false,       "dbAutoCreate": true     }   } } ```   ## Actual behavior    In orientdb studio, I query members : `SELECT FROM Member`  the result returns members with {firstname, name} fields and not {firstname,lastname}  If I look at Member class, the fields are well {firstname,lastname} though.  It looks like the fields are not the same in the class and in the data.   ## Steps to reproduce   see before  </body>
		<created>2017-04-05 10:16:52</created>
		<closed>2017-04-06 10:14:40</closed>
	</bug>
	<bug>
		<id>7302</id>
		<title>Listing databases on a replica member of a cluster</title>
		<body>### OrientDB Version: 2.2.17 ### Java Version: 8 ### OS: Ubuntu 16.04  **This is just a question:**  After creating a 3-node cluster (2 masters, 1 replica), all seems to work as expected. However, when I log into the replica's console, connect to the instance and `list databases`, the output only contains a new database that I created. **GratefulDeadConcerts** is missing, though I can see it under the `databases` folder.  If I perform the same action on a master node, I can see all the databases.   So the question is, is that normal for a replica node? If not, what could be the cause?  </body>
		<created>2017-04-05 04:24:09</created>
		<closed>2017-04-05 15:12:05</closed>
	</bug>
	<bug>
		<id>7295</id>
		<title>ALTER DATABASE command does not get replicated and gets OSecurityAccessException that always references 'writer' user</title>
		<body>### OrientDB Version: 2.2.17 Enterprise ### Java Version: 1.8 ### OS: SLES    ## Expected behavior   Running OrientDB distributed with 2 nodes, an alter database command run from node1 with root or admin or any user with update database permissions should replicate to node2 without an error.  For example ALTER DATABASE DATEFORMAT 'yyyy'  ## Actual behavior   The change is only made on node1 an exception like the following is thrown: com.orientechnologies.orient.core.exception.OSecurityAccessException: User 'writer' does not have permission to execute the operation 'Update' against the resource: ResourceGeneric [name=DATABASE, legacyName=database].null DB name="Entitlements-BDD"  The exception references user 'writer' no matter what user is actually logged in to node1 and for some reason has ".null" as the database resource.  The problem doesn't happen from node2 and it is currently only happening in one database and not others.   ## Steps to reproduce   1) Setup OrientDB with 2 nodes 2) Run node1 in single mode and use the import command to create a database 3) Start node1 and 2 in distributed mode which will replicate the database 4) Run an alter database command from node1 We have 2 databases that were created this way, and only 1 has the problem and the problem only happens on node1 so it may not be easy to reproduce.  </body>
		<created>2017-04-03 13:49:52</created>
		<closed>2018-08-27 12:56:05</closed>
	</bug>
	<bug>
		<id>7289</id>
		<title>Incorrect return value when formatting a list of dates</title>
		<body>### OrientDB Version: 2.2.14 ### Java Version: OpenJDK 8 ### OS: Linux  Setup: ``` CREATE CLASS Foo EXTENDS V CREATE CLASS Bar EXTENDS V CREATE PROPERTY Bar.event_date DATETIME  CREATE VERTEX Foo SET name = 'foo' CREATE VERTEX Bar SET name = 'bar1', event_date = '2016-01-01 00:00:01' CREATE VERTEX Bar SET name = 'bar2', event_date = '2016-01-02 00:00:02'  CREATE EDGE E FROM (SELECT * FROM Foo) TO (SELECT * FROM Bar) ```  ## Expected behavior   Consider the following two queries: ``` SELECT name AS foo_name, out('E').name AS bar_names, out('E').event_date AS bar_dates FROM Foo  SELECT name AS foo_name, out('E').name AS bar_names, out('E').event_date.format("YYYY-MM-DD'T'HH:mm:ssX") AS bar_dates FROM Foo ``` The `bar_dates` field should be a list of two elements in both queries: - In the first query, it should be a list of datetime objects (represented as strings in Studio: `["2016-01-02 00:00:02","2016-01-01 00:00:01"]`). - In the second query, it should be a list of ISO-8601 formatted datetime strings: `["2016-01-02T00:00:02Z","2016-01-01T00:00:01Z"]`.  ## Actual behavior   First query output for `bar_dates`: `["2016-01-02 00:00:02","2016-01-01 00:00:01"]` Second query output for `bar_dates`: `YYYY-MM-DD'T'HH:mm:ssX`  ## Steps to reproduce   See the setup and queries above.  </body>
		<created>2017-03-30 19:22:19</created>
		<closed>2017-04-02 14:06:18</closed>
	</bug>
	<bug>
		<id>7287</id>
		<title>NullPointerException from OQueryOperatorIn.executeIndexQuery</title>
		<body>### OrientDB Version: 2.2.17   ### Java Version: 8   ### OS: MacOS   ## Expected behavior   Uses index to get result    ## Actual behavior   Null pointer exception on server accessing index, scans cluster instead.    ## Steps to reproduce    Create a new database with an index: ``` create class V_Entity extends V; create property V_Entity.entityId STRING; create index entity_id_index ON V_Entity (entityId) UNIQUE; ``` Create a vertex : ``` create vertex V_Entity set entityId="user1" ```  Run following query. It's an excerpt of a more complex query that I can post if you think the query is problematic. I know this one looks odd, it's just the simplest reproduce:  ``` select from V_Entity      let $c = (select entityId from V_Entity          where entityId="user1")     where entityId in $c  ```  The query successfully returns the expected result, but on the server I get: ``` $ANSI{green {db=test2}} Error on using index entity_id_index in query 'SELECT FROM V_Entity LET $c = (SELECT entityId FROM V_Entity WHERE entityId = "user1") WHERE entityId IN $c'. Probably you need to rebuild indexes. Now executing query using cluster scan java.lang.NullPointerException at com.orientechnologies.orient.core.sql.operator.OQueryOperatorIn.executeIndexQuery(OQueryOperatorIn.java:92) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchForIndexes(OCommandExecutorSQLSelect.java:2184) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchInClasses(OCommandExecutorSQLSelect.java:1001) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.assignTarget(OCommandExecutorSQLResultsetAbstract.java:209) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.assignTarget(OCommandExecutorSQLSelect.java:530) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:512) &lt;snip&gt; ``` </body>
		<created>2017-03-30 13:24:55</created>
		<closed>2017-03-30 14:45:42</closed>
	</bug>
	<bug>
		<id>7284</id>
		<title>asBoolean() and convert('boolean') behave differently on an integer</title>
		<body>### OrientDB Version: 2.1.x ### Java Version: 1.8.0 ### OS: Ubuntu 14.04  Hi,  I've come across something that I'm not sure if it was done intentionally. Consider the following test case:  ```sql create class Test insert into Test content {"list": ["a", "b"]} ```  Then the following queries give different results: ```sql select list.size().asBoolean() as hasList from Test select list.size().convert('boolean') as hasList from Test ```  The first query: Studio says that 1 record is returned, but nothing is shown (**unexpected result**) The second query: returns one record with `hasList` attribute set to `true` (**expected result**)  Please, see if this is a problem or not.   </body>
		<created>2017-03-29 10:23:16</created>
		<closed>2017-03-29 13:25:22</closed>
	</bug>
	<bug>
		<id>7282</id>
		<title>OLocalRecordCache allows temporary  @RID dublication</title>
		<body>### OrientDB Version: 3.0.0-SNAPSHOT  ### Java Version: 1.8 ### OS: Ubuntu 16.10  ## Expected behavior    OLocalRecordCache must controll dubles.   ## Actual behavior   Rows from log. ``` [main] 08:25:36,430 DEBUG org.hibernate.ogm.datastore.orientdb.dialect.impl.OrientDBAssociationQueries: findRelationship: queryBuilder: SELECT FROM Pizza_Product WHERE pizzas_bKey=2  AND products_id='1c2a404e-c9ea-485e-b2b4-1b0c9d5e288a'  [main] 08:25:36,431 DEBUG org.hibernate.ogm.datastore.orientdb.utils.NativeQueryUtil: NonIdempotentQuery: loaded document: {"@type":"d",**"@rid":"#29:-20"**,"@version":0,"@class":"Pizza_Product","products_id":"1c2a404e-c9ea-485e-b2b4-1b0c9d5e288a","pizzas_bKey":2,"@fieldTypes":"pizzas_bKey=l"} [main] 08:25:36,432 DEBUG org.hibernate.ogm.datastore.orientdb.utils.NativeQueryUtil: NonIdempotentQuery: loaded document: {"@type":"d",**"@rid":"#29:-20"**,"@version":0,"@class":"Pizza_Product","products_id":"1c2a404e-c9ea-485e-b2b4-1b0c9d5e288a","pizzas_bKey":2,"@fieldTypes":"pizzas_bKey=l"} [main] 08:25:36,433 DEBUG org.hibernate.ogm.datastore.orientdb.utils.NativeQueryUtil: load documents: 2 [main] 08:25:36,433 DEBUG org.hibernate.ogm.datastore.orientdb.dialect.impl.OrientDBAssociationQueries: findRelationship: found: 2 ``` Query returns two documents with same @rid.  ## Steps to reproduce   &lt;add here&gt;    </body>
		<created>2017-03-29 05:34:57</created>
		<closed>2017-04-23 20:10:30</closed>
	</bug>
	<bug>
		<id>7281</id>
		<title>create database using console batch commands drops db on database exists</title>
		<body>### OrientDB Version: 2.2.17 ### Java Version: 1.7.0_91 ### OS: centos06  ## Expected behavior   Creating a database via the console batch commands. Expect that if I try to create it twice it will throw a database exists error but will not delete/drop the database  ## Actual behavior   If I try to create a database that already exists, if throws an error (as expected) but also seems to drop that database.  ## Steps to reproduce    run the following command multiple times (obviously change the path to wherever you have orientdb installed) ``` /home/creisle/applications/orientdb-community-2.2.17/bin/console.sh "set echo true; connect remote:localhost root root; list databases; CREATE DATABASE plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy root root" ```  this resulted in   ``` OrientDB console v.2.2.17 (build 2.2.x@rd9bace82ea8437117fd48114fc255e791056014b; 2017-02-16 17:20:27+0000) www.orientdb.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  orientdb&gt; set echo true   echo = true  orientdb&gt; connect remote:localhost root root  Connecting to remote Server instance [remote:localhost] with user 'root'...OK orientdb {server=remote:localhost/}&gt; list databases  Found 1 databases:  * GratefulDeadConcerts (plocal)  orientdb {server=remote:localhost/}&gt; CREATE DATABASE PLOCAL:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy root root PLOCAL  Creating database [PLOCAL:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy] using the storage type [PLOCAL]... Database created successfully.  Current database is: PLOCAL:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy ```  if I run it again I get   ``` OrientDB console v.2.2.17 (build 2.2.x@rd9bace82ea8437117fd48114fc255e791056014b; 2017-02-16 17:20:27+0000) www.orientdb.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  orientdb&gt; set echo true   echo = true  orientdb&gt; connect remote:localhost root root  Connecting to remote Server instance [remote:localhost] with user 'root'...OK orientdb {server=remote:localhost/}&gt; list databases  Found 2 databases:  * test_dummy (plocal) * GratefulDeadConcerts (plocal)  orientdb {server=remote:localhost/}&gt; CREATE DATABASE plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy root root  Creating database [plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy] using the storage type [plocal]... Error: com.orientechnologies.orient.core.exception.OStorageExistsException: Cannot create new storage 'plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy' because it already exists DB name="test_dummy" ```  which is what I expected. However if I run it a third time I find that the database I originally created is gone  ``` OrientDB console v.2.2.17 (build 2.2.x@rd9bace82ea8437117fd48114fc255e791056014b; 2017-02-16 17:20:27+0000) www.orientdb.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  orientdb&gt; set echo true   echo = true  orientdb&gt; connect remote:localhost root root  Connecting to remote Server instance [remote:localhost] with user 'root'...OK orientdb {server=remote:localhost/}&gt; list databases  Found 1 databases:  * GratefulDeadConcerts (plocal)  orientdb {server=remote:localhost/}&gt; CREATE DATABASE plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy root root  Creating database [plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy] using the storage type [plocal]... Database created successfully.  Current database is: plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test_dummy ```</body>
		<created>2017-03-29 01:06:38</created>
		<closed>2017-06-15 15:49:01</closed>
	</bug>
	<bug>
		<id>7272</id>
		<title>3.0.0-snapshot-464 - Preserve order of fields in OResult </title>
		<body>Hi,  It seems that if field.@Rid as Field_RID, is included, the order is not preserved. Wondering if an additional fix can resolve this.   Eg, for this query:  MATCH {Class: Profiles, as: profile, where: (Name='Santo' AND Surname='OrientDB')}-HasFriend-{Class: Profiles, as: friend}  RETURN friend.@Rid as Friend_RID, friend.Name as Friend_Name, friend.Surname as Friend_Surname   This is the result:  ![github_issue](https://cloud.githubusercontent.com/assets/14923389/24335187/f867cade-1278-11e7-9af6-b043eb99f634.PNG)  expected order:    Friend_RID,   Friend_Name,  Friend_Surname   Thanks,</body>
		<created>2017-03-26 21:12:16</created>
		<closed>2017-08-03 16:17:16</closed>
	</bug>
	<bug>
		<id>7269</id>
		<title>3.0.0-snapshot-459 - shortestpath</title>
		<body>Hi,  It seems that the shortestpath function is not working in 3.0. Has something changed?  SELECT expand(path) FROM (   SELECT shortestPath($from, $to) AS path    LET $from = (SELECT FROM Profiles WHERE Name='Santo' and Surname='OrientDB'), $to = (SELECT FROM Countries WHERE Name='United States')    UNWIND path )  --&gt; No function with name 'shortestpath', available names are :   works as expected in 2.2.17  this is related to the demo queries I am creating for the new demodb  Thanks,</body>
		<created>2017-03-25 21:59:14</created>
		<closed>2017-03-28 08:36:45</closed>
	</bug>
	<bug>
		<id>7266</id>
		<title>Incremental Restore not working</title>
		<body>Incremental backup apparently works and backup files are correctly written, but during the incremental restore a NPE is thrown.  Steps to reproduce:  connect remote:localhost/demodb admin admin  backup database /tmp/backup -incremental  insert into monuments(type,name) values ('monument','Colosseum')  backup database /tmp/backup -incremental  create database remote:localhost/test root root plocal graph -restore=/tmp/backup    </body>
		<created>2017-03-24 12:14:48</created>
		<closed>2017-04-24 06:58:02</closed>
	</bug>
	<bug>
		<id>7264</id>
		<title>3.0.0-snapshot-459, CI index on multiple properties</title>
		<body>### OrientDB Version: 3.0.0-snapshot-459 ### Java Version: 1.8 ### OS: win 10  ci index on multiple properties seems to not work it works well on a single property  it woks on 2.2.17 (on single and multiple properties)  </body>
		<created>2017-03-24 01:32:42</created>
		<closed>2017-03-28 10:48:45</closed>
	</bug>
	<bug>
		<id>7262</id>
		<title>Intersect Function Error and a performance question</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 1.8.0_40-b27 ### OS: OS X Yosemite  I am trying the GratefulDeadConcerts database that is coming with OrientDB installation and I came up with a problem. When I write a simple query that intersects followed_by relations between two songs there is no problem (select intersect(in('followed_by')) from [9:2,9:4]) but when I want to intersect three of them with this query --&gt; select intersect(in('followed_by')) from [9:2,9:4,9:6] OrientDB throws exception: java.lang.ClassCastException:java.util.HashSet cannot be cast to java.util.Iterator. I think It is a bug.  Another question is for the performance of intersections. Consider Catalog system. I want to fetch Catalogs with Brand Samsung which belongs to Accessories category but There may be thousands of Catalogs with Brand Samsung and millions of catalogs belongs to Accessories category. What would be the correct model to be able search and find results and can intersection function be considered for these cases? I tried intersect function with two vertexes having million edges but the elapsed time was too long (about 30 seconds)  Thanks in advance.   </body>
		<created>2017-03-23 12:05:22</created>
		<closed>2017-04-02 11:07:15</closed>
	</bug>
	<bug>
		<id>7256</id>
		<title>3.0.0-445-snapshot - change in behavior or bug - empty edge class takes precedence over vertex class</title>
		<body>### OrientDB Version: 3.0.0-445-snapshot ### Java Version: 1.8 ### OS:  wind 10   demodb v 0.75  consider this query  MATCH {class: Customers, as: customer, where: (OrderedId=1)}--{Class: Services}  RETURN $pathelements  in words:  find all services connected to customer with OrderedId=1,  regardless of the edge class  ## Expected behavior    all services connected to customer with OrderedId=1, (regardless of the edge class) are returned  this is what I get in 2.2.17 (correct):  ![new_bug_1_2217](https://cloud.githubusercontent.com/assets/14923389/24177938/0a7fa416-0ea6-11e7-9c96-00f45aed40be.PNG)  ## Actual behavior    this is what i get in 3.0-snapshot, it seems that empty edge class -- takes precedence over services class  ![new_bug_1_3000](https://cloud.githubusercontent.com/assets/14923389/24178011/9aaf3718-0ea6-11e7-961b-03694662cab7.PNG)  thanks,  </body>
		<created>2017-03-22 01:24:20</created>
		<closed>2017-03-22 11:05:52</closed>
	</bug>
	<bug>
		<id>7249</id>
		<title>3.0.0-snapshot-441 - both("HasFriend").size()  not working</title>
		<body>### OrientDB Version: 3.0.0-snapshot-441 ### Java Version: 1.8 ### OS: win 10  --  demodb v. 0.75  SELECT @rid, out("HasFriend").size() AS OutFriendsNumber, in("HasFriend").size() AS InFriendsNumber, both("HasFriend").size() as FriendTotalMethod1, (out("HasFriend").size() + in("HasFriend").size()) as FriendTotalMethod2 FROM `Profiles` LIMIT 10  ![luigi_github](https://cloud.githubusercontent.com/assets/14923389/24085773/101d795c-0d02-11e7-86a3-017583787742.PNG)  works fine in 2.2.  please add test  Thanks,</body>
		<created>2017-03-19 23:15:29</created>
		<closed>2017-03-22 10:25:46</closed>
	</bug>
	<bug>
		<id>7244</id>
		<title>db create exists error (http api) return content not a json</title>
		<body>### OrientDB Version: 2.2.17, 2.2.11  (community edition) ### Java Version: 1.7.0_91  ### OS: centos6   ## Expected behavior   I expected it to return something that could be decoded into a json like all the other error returns i've encountered so far   ## Actual behavior    but I got just a string. is this expected behaviour? why is the db create error different than all the others     Database 'plocal:/home/creisle/applications/orientdb-community-2.2.17/databases/test' already exists.  ## Steps to reproduce   start up orientdb server and sent post request to create the test database http://10.9.202.242:2480/database/test/plocal/graph  send it again to get the error  </body>
		<created>2017-03-16 17:16:10</created>
		<closed>2017-03-28 10:46:57</closed>
	</bug>
	<bug>
		<id>7236</id>
		<title>Ignored named parameters for some queries</title>
		<body>### OrientDB Version: 2.1.17 ### Java Version: openjdk version "1.8.0_121" ### OS: linux  I've prepared a query:   ` SELECT *, out('hasPermission').type as permissions FROM User WHERE login &gt;= :key AND out('hasPermission').type IN :permissions ORDER BY login ASC LIMIT :limit" `  I provide following params:  ` key: ""; limit: 3; permissions: ["USER"]; //array of strings ` ## Actual behavior   I receive no results from my database.  ## Expected behavior   I receive at least one result from my database. If I change the query to :   ` SELECT *, out('hasPermission').type as permissions FROM User WHERE login &gt;= :key AND out('hasPermission').type IN ["USER"] ORDER BY login ASC LIMIT :limit" `  I get the expected results.  I've tried passing an array (It works in another simpler query), list and joined string as a parameter. I've changed the name of not responding parameter. Nothing seems to work.  ## Steps to reproduce   clone https://bitbucket.org/kmierzej/fragaria-server/branch/orientdb-ignored-params ./gradlew run  Examine the output of those commands: ``` &gt;  wget -qO-  http://localhost:8080/api/admin/user?permission=USER&amp;limit=3   {"users": []} &gt;  wget -qO- http://localhost:8080/api/admin/user?limit=3   {"users": [{"login":"admin","email":"admin@gmail.com","permissions":["ADMIN","USER"],"fullname":"Admin - konto funkcyjne"},   {"login":"duke","email":"duke@gmail.com","permissions":["USER"],"fullname":"Duke Hufflepuff"},    {"login":"john","email":"john@gmail.com","permissions":["USER"],"fullname":"John Shephard"}]} ```</body>
		<created>2017-03-15 14:13:05</created>
		<closed>2017-03-15 15:52:17</closed>
	</bug>
	<bug>
		<id>7235</id>
		<title>OPartitionedDatabasePool when loaded with more than 20 threads returns same db connection with hashcode</title>
		<body>### OrientDB Version: 2.2.17 ### Java Version: 1.8.0_66 ### OS: Linux 2.6.32  ## Expected behavior   We were expecting when we use the pool.acquire method from OPartitionedDatabasePool class, it should provide a unique db connection and hashcode to be used in a multithreaded spring boot application which currently uses the orientdb spring data modules. But it seems like when number of users are more than 20 accessing the same we are getting the same db connection and hashcode which causes the following error:  org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.IllegalStateException: The current database instance (com. orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPooled@6ba64c61) is not active on the current thread (Thread[qtp1159114532-15,5,main]). Curr ent active database is: com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPooled@7ad45a17   ## Actual behavior   We should be getting a distinct db connection from the connection pool and the above error should not be happening.  ## Steps to reproduce   Using Jmeter if we run a load test to send more than 200 requests then this can be reproduced. We need to make sure jmeter thread count should be more than 20 or so. Here as shown below if you see thread number 15 and 17 both are getting the same database connection object 1099787001, which in turn makes one of the thread error out as shown above.   2017-03-14 16:05:45.936 DEBUG 31797 [qtp1159114532-15] --- .s.d.o.c.c.AbstractOrientDatabaseFactory : use existing db 1099787001 2017-03-14 16:05:45.936 DEBUG 31797 [qtp1159114532-17] --- o.s.d.o.c.core.OrientTransactionManager  : beginning transaction, db.hashCode() = 1099787001   </body>
		<created>2017-03-14 22:17:23</created>
		<closed>2017-08-31 10:42:23</closed>
	</bug>
	<bug>
		<id>7234</id>
		<title>When querying in range less than any value greater than max int (2147483647), integer rolls over to negative and returns zero values</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 8 ### OS: windows 7   ## Expected behavior   OrientDB should either return my results using max int value or display an error that value is too large.  ## Actual behavior   OrientDB takes a long time to query, then returns with 0 items found  ## Steps to reproduce   Query database with a range specified on integer property with a range value greater than 2147483647.  Example: SELECT * FROM logs WHERE time &gt;= 50000 AND time &lt;=3000000000 LIMIT -1  &gt;0 item(s) found. Query executed in 492.468 sec(s).  Note that the query time can be sped up by using a smaller dataset or using a limit. With our large dataset, this takes a very long time to compute despite being indexed. </body>
		<created>2017-03-14 19:07:08</created>
		<closed>2017-03-15 14:33:32</closed>
	</bug>
	<bug>
		<id>7225</id>
		<title>Unexpected behavior of "class:" clause when used with "while:" or "optional: true"</title>
		<body>### OrientDB Version: 2.2.14  ### Java Version:  OpenJDK 8 ### OS: Linux    ## Expected behavior   In a MATCH query, a `class: Bar` clause should be evaluated after any `while: ...` or `optional: true` clauses, and should behave indistinguishably from a `where: (@this instanceof Bar)` clause. This is consistent with the specification of `MATCH` and `instanceof` in the docs. Two concrete situations: - If a MATCH step is marked optional, and a particular traversal finds no vertex for that MATCH step, the `class: ...` clause should be ignored (exactly as the `where:` clause is ignored) and the result should contain `null` for that MATCH step. - In a MATCH step with `while: ...`, the `while:` is resolved before the `class:` clause -- some number of iterations are performed as the `while:` directs, and then the resulting vertices are tested for conformance with the `class:` clause.  ## Actual behavior   `class: Bar` does not behave the same way as `where: (@this instanceof Bar)`. Specifically: - Inside an optional MATCH step, in some cases `class: Bar` causes empty results to be returned, whereas `where: (@this instanceof Bar)` returns results with `null` for the optional step. - In MATCH steps with `while:` clauses, `class: Bar` causes the `while:` traversal to stop at the first vertex which is not a subclass of `Bar`, whereas `where: (@this instanceof Bar)` iterates fully and simply does not return non-`Bar` vertices in the end. In other words, with a `while:` depth of 4, for a set of vertices connected as: `Bar -&gt; Bar -&gt; Foo -&gt; Bar`, using `class:` will only return the first two `Bar`s whereas using the `where:` approach will return all three `Bar`s.  ## Steps to reproduce   Setup: ``` CREATE CLASS Base EXTENDS V CREATE CLASS Foo EXTENDS Base CREATE CLASS Bar EXTENDS Base  CREATE VERTEX Foo SET name = 'foo1' CREATE VERTEX Foo SET name = 'foo2' CREATE VERTEX Foo SET name = 'foo3' CREATE VERTEX Bar SET name = 'bar1' CREATE VERTEX Bar SET name = 'bar2' CREATE VERTEX Bar SET name = 'bar3'  CREATE EDGE E FROM (SELECT FROM Foo WHERE name = 'foo1') TO (SELECT FROM Bar WHERE name = 'bar2') CREATE EDGE E FROM (SELECT FROM Foo WHERE name = 'foo2') TO (SELECT FROM Bar WHERE name = 'bar3') CREATE EDGE E FROM (SELECT FROM Bar WHERE name = 'bar1') TO (SELECT FROM Foo WHERE name = 'foo2') CREATE EDGE E FROM (SELECT FROM Bar WHERE name = 'bar2') TO (SELECT FROM Foo WHERE name = 'foo3') ```  `Foo` vertices are only connected to `Bar` vertices, and vice versa. Edges always go from number `i` to `i+1`.  ### Unintuitive `optional: true` behavior with `class:` The following query returns one row with `end` set to `null`, as expected (the last edge is Bar to Bar, which doesn't exist): ``` MATCH {     class: Foo,     where: (name = 'foo1'),     as: start }.out('E') {     where: (name = 'bar2'),     as: mid }.out('E') {     optional: true,     where: (@this INSTANCEOF Bar)     as: end } RETURN $matches ```  However, using `class:` instead of the `where:` returns no rows: ``` MATCH {     class: Foo,     where: (name = 'foo1'),     as: start }.out('E') {     where: (name = 'bar2'),     as: mid }.out('E') {     class: Bar,     optional: true,     as: end } RETURN $matches ```  ### Unintuitive `while:` behavior with `class:` The following query returns two rows, as expected (one with `start = mid` and one with `mid` two hops away from `start`): ``` MATCH {     class: Foo,     where: (name = 'foo1'),     as: start }.out('E') {     while: ($depth &lt; 4),     where: (@this INSTANCEOF Foo),     as: mid } RETURN $matches ```  However, using `class:` instead of the `where:` returns only one row, the one with `start = mid`: ``` MATCH {     class: Foo,     where: (name = 'foo1'),     as: start }.out('E') {     class: Foo,     while: ($depth &lt; 4),     as: mid } RETURN $matches ```</body>
		<created>2017-03-10 22:57:21</created>
		<closed>2017-04-02 08:53:42</closed>
	</bug>
	<bug>
		<id>7216</id>
		<title>Index collation not applied with OR clause</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 1.8.0_92-b14 ### OS: Mac OSX 10.12.3  ## Expected behavior   When a class has an index with case insensitive collation, that index is properly applied for a simple query.    When querying two possibilities in an OR clause, the should be used and the index's collation property should be applied.  ## Actual behavior   The index appears appears to be identified, but not used and the collation property is ignored.  ## Steps to reproduce    In orientdb console: ``` create class C create property C.name create index C_IDX on C(name collate ci) NOTUNIQUE insert into C(name) values ('test')  select count(*) from C where name = 'TEST'  +----+-----+  |#   |count|  +----+-----+  |0   |1    |  +----+-----+ explain select count(*) from C where name = 'TEST'  {"@type":"d","@version":0,"projectionElapsed":0,"limit":-1,"compositeIndexUsed":0,"user":"#5:0","involvedIndexes":["C_IDX"],"elapsed":0.325355,"resultType":"collection","resultSize":1,"@fieldTypes":"projectionElapsed=l,compositeIndexUsed=l,user=x,involvedIndexes=e,elapsed=f"}  select count(*) from C where name = 'TEST' or name = 'TEST1'  +----+-----+  |#   |count|  +----+-----+  |0   |0    |  +----+-----+ explain select count(*) from C where name = 'TEST' or name = 'TEST1'  {"@type":"d","@version":0,"documentReads":1,"fullySortedByIndex":false,"documentAnalyzedCompatibleClass":1,"recordReads":1,"fetchingFromTargetElapsed":0,"indexIsUsedInOrderBy":false,"compositeIndexUsed":2,"current":"#25:0","involvedIndexes":["C_IDX"],"projectionElapsed":0,"limit":-1,"evaluated":1,"groupByElapsed":0,"user":"#5:0","elapsed":0.468799,"resultType":"collection","resultSize":1,"@fieldTypes":"documentReads=l,documentAnalyzedCompatibleClass=l,recordReads=l,fetchingFromTargetElapsed=l,compositeIndexUsed=l,current=x,involvedIndexes=e,projectionElapsed=l,evaluated=l,groupByElapsed=l,user=x,elapsed=f"} ```  May be related to https://github.com/orientechnologies/orientdb/issues/6014 </body>
		<created>2017-03-06 23:53:08</created>
		<closed>2017-03-08 09:27:09</closed>
	</bug>
	<bug>
		<id>7215</id>
		<title>select (match) group by</title>
		<body>### OrientDB Version: 2.2.17 &amp; 3.0.0-snapshot ### Java Version: 1.8.0_121 ### OS: Win 10    ## Expected behavior   results are grouped by the specified field  ## Actual behavior   results are not grouped and and 2.2 returned recordset is cut  ## Steps to reproduce    demodb   #initial match: works ``` match  { Class: Orders, as: order, where:(Id=2) }--{ Class: Customers, as: customer }-HasVisited-&gt;{ class: Locations, as: location } return customer, location ```  #select + match: works ``` select  location.Type as mytype, location.Id as myid  from (  match  { Class: Orders, as: order, where:(Id=2) }--{ Class: Customers, as: customer }-HasVisited-&gt;{ class: Locations, as: location } return customer, location  ) ```  #select + match + group by: does not works ``` select  location.Type as mytype, location.Id as myid  from (  match  { Class: Orders, as: order, where:(Id=2) }--{ Class: Customers, as: customer }-HasVisited-&gt;{ class: Locations, as: location } return customer, location  ) group by mytype ```  </body>
		<created>2017-03-05 12:53:07</created>
		<closed>2017-03-06 09:22:25</closed>
	</bug>
	<bug>
		<id>7213</id>
		<title>LiveQuery seems to bypass Record-level Security limit!!</title>
		<body>### OrientDB Version: 2.2.13 community   ### Java Version: 1.8.0_101   ### OS: linux    ## Expected behavior   When a record created, LiveQuery should catch nothing, if the user is restricted to access this record, even if he can access the class.  ## Actual behavior   normal select operation returns nothing, but LiveQuery returns the record.   ## Steps to reproduce   ---------step 1-------------------------------------------------------------- create class box alter class box superclass +ORestricted   //orientjs programm `db.liveQuery('LIVE SELECT FROM box') .on('live-create', function(data){     console.log("new record-&gt;",data.content); });`   ---------step 2-------------------------------------------------------------- insert into box set title=''not-for-z2'  orientjs programm output: D:\test&gt;node livequery.js user: z2 is listening... new record-&gt; { '@type': 'd',   '@class': 'messageBox',   timestamp: Fri Mar 03 2017 18:17:42 GMT+0800 (),   title: ''not-for-z2',   _allow: [ { [String: '#5:0'] cluster: 5, position: 0 } ] } ---------step 3-------------------------------------------------------------- orientdb console output: Connecting to database [remote:router.zhiguanyun.com/router] with user 'z2'...OK orientdb {db=router}&gt; select from box where title=''not-for-z2'  0 item(s) found. Query executed in 0.016 sec(s).  </body>
		<created>2017-03-03 10:45:05</created>
		<closed>2017-03-03 16:58:21</closed>
	</bug>
	<bug>
		<id>7211</id>
		<title>ReadOnly Constraint Prevents Editing of Nodes from Web Studio UI</title>
		<body>### OrientDB Version: &lt;version here&gt;   Studio version : 2.2 OrientDB version : 2.2.13 ### Java Version: &lt;version here&gt;   java version "1.8.0_121" ### OS: &lt;os here&gt;   Windows 7 ## Expected behavior   Edit Node Values &amp; Commit  ## Actual behavior   Looks like it works, but it does not after refresh of screen.  ## Steps to reproduce   CREATE PROPERTY V.creationDT Datetime (DEFAULT sysdate(), READONLY TRUE);  # Create a subclass of V CREATE CLASS Group EXTENDS V; CREATE PROPERTY Group.groupName STRING; CREATE PROPERTY Group.description STRING;  # Create and Edit a Node of Group using the "Graph" Tab from Web Studio using the GUI It will look like it works at first. Remove the Node from the screen, or simply clear the Canvas. Click the "Browse" Tab and then come back to the "Graph" Tab. select from v; You will notice the data has not changed, and no error message was given.  if you try to edit the node from the "Browse" tab, it will throw an error saying that since creationDT field was set to readonly, we cannot edit any other fields, which is a problem. ![readonlyerror](https://cloud.githubusercontent.com/assets/5331719/23518606/419956b0-ff31-11e6-9e5f-280a06d02841.PNG)   That is also another bug i think.  Thanks    </body>
		<created>2017-03-02 17:13:03</created>
		<closed>2017-03-27 15:53:39</closed>
	</bug>
	<bug>
		<id>7195</id>
		<title>Cannot see backups in Studio Backup Management </title>
		<body>### OrientDB Version: orientdb-enterprise-2.2.16  ### Java Version: 1.8.0_112 ### OS: Ubuntu 14.04 LTS   ## Expected behavior   Open Studio Backup Management and see in the calendar the full backups already performed from the same place.  ## Actual behavior   The calendar is empty although the folder specified in the "Directory" has backup folders performed by the systems.  ## Steps to reproduce   1.install orientdb-enterprise-2.2.16  2. load data 3. start server (bin/server.sh) 3. configure full backup ( Studio-&gt;BackupManagement ) 4. check the backup has been performed  5. open Studio-&gt;BackupManagement   ![image](https://cloud.githubusercontent.com/assets/12912432/23269987/fb0bcac4-f9fa-11e6-9950-95d60b30e400.png) ![image](https://cloud.githubusercontent.com/assets/12912432/23270003/08a23fec-f9fb-11e6-96bf-c085be442f95.png)  </body>
		<created>2017-02-23 17:07:16</created>
		<closed>2017-03-10 12:02:43</closed>
	</bug>
	<bug>
		<id>7194</id>
		<title>question about LINKSET usage: property should be array of RIDs</title>
		<body>### OrientDB Version: 2.2.17 ### Java Version: N/A   ### OS: Ubuntu 16  ## Expected behavior   I don't entirely understand how to use LINKSET properties in a class:  In my class "parents", I defined a property "childs"  of type LINKSET. ``` CREATE property parents.childs LINKSET (MANDATORY TRUE, NOTNULL FALSE) ```  I then create (using INSERT) a document of type "parents", with property "childs" equal to NULL. The RID of this "parents" document is #354:0  Then I want to add a RID of some document elsewhere, into this LINKSET property "childs": ``` update #354:0 ADD childs = #359:0 ```  but when I read the value for this "childs" property, it remains NULL: ``` SELECT childs FROM #354:0 {     "result": [         {             "@type": "d",             "@rid": "#-2:0",             "@version": 0         }     ],     "notification": "Query executed in 0.042 sec. Returned 1 record(s)" } ```  What am I doing wrong?</body>
		<created>2017-02-23 16:27:39</created>
		<closed>2017-05-02 15:05:06</closed>
	</bug>
	<bug>
		<id>7186</id>
		<title>java.io.IOException during OrientDB restart</title>
		<body>### OrientDB Version: 2.2.16     in version 2.1.19 everything was fine ### Java Version: OpenJDK, on Oracle it was not tested ### OS: Ubuntu 16.04   Case: we are using embedded version of OrientDB. Our application has ability for dynamic modules loading. To support this lifecycle full internal restart of app is needed. So we need to be able to stop OrientDB and then start it again. With 2.1.19 it was working perfectly. But during updating of OrientDB version to 2.2.16 we found that this functionality starts to fail with the following Exception in OrientDB core:  ```java 2017-02-21 21:05:31:139 INFO  OrientDB Server is active v2.2.16. [OServer]$ANSI{green {db=OrienteerFuture}} Error during data read for file 'internal.pcl' 1-th attempt java.io.IOException: Bad address at sun.nio.ch.FileDispatcherImpl.pread0(Native Method) at sun.nio.ch.FileDispatcherImpl.pread(FileDispatcherImpl.java:52) at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:220) at sun.nio.ch.IOUtil.read(IOUtil.java:192) at sun.nio.ch.FileChannelImpl.readInternal(FileChannelImpl.java:741) at sun.nio.ch.FileChannelImpl.read(FileChannelImpl.java:727) at com.orientechnologies.orient.core.storage.fs.OFileClassic.readByteBuffer(OFileClassic.java:872) at com.orientechnologies.orient.core.storage.fs.OFileClassic.read(OFileClassic.java:148) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.cacheFileContent(OWOWCache.java:1281) at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:656) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1113) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:353) at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.load(O2QCache.java:298) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:148) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:142) at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.open(OPaginatedCluster.java:217) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.openClusters(OAbstractPaginatedStorage.java:394) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:316) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:263) ``` </body>
		<created>2017-02-21 19:51:30</created>
		<closed>2017-07-04 09:58:30</closed>
	</bug>
	<bug>
		<id>7181</id>
		<title>Transaction not working</title>
		<body>### OrientDB Version: 2.2.16 - embedded mode ### Java Version: 1.8   ### OS: Windows 10  ## Expected behavior   ******total records in extension_grammar*****:19 ******total records in extension_grammar*****:20  ## Actual behavior   ******total records in extension_grammar*****:19 ******total records in extension_grammar*****:19  ## Steps to reproduce   public static void test3() { ODatabaseDocumentTx doctx=new ODatabaseDocumentTx("plocal:C:/GO/ArtiE/server/artielabs").open("artie","artie"); doctx.begin();  String query="select * from extension_grammar where scope = 'domain'";     OSQLSynchQuery&lt;OIdentifiable&gt; oquery = new OSQLSynchQuery&lt;OIdentifiable&gt;(query); List&lt;ODocument&gt; list=doctx.query(oquery); System.out.println("******total records in extension_grammar*****:"+list.size());  query="insert into extension_grammar(name,scope,sentence_type) values('new-instance1111','domain','test intent')";     doctx.command(new OCommandSQL(query)).execute();  query="select * from extension_grammar where scope = 'domain'";     oquery = new OSQLSynchQuery&lt;OIdentifiable&gt;(query); list=doctx.query(oquery); System.out.println("******total records in extension_grammar*****:"+list.size());  doctx.rollback(); }  </body>
		<created>2017-02-19 04:37:12</created>
		<closed>2017-11-06 08:07:59</closed>
	</bug>
	<bug>
		<id>7176</id>
		<title>In OrientDB-JBDC query SQL Keywords like "select", "count" should not be case sensitive</title>
		<body>### OrientDB Version: &lt;2.2.15&gt;   ### Java Version: &lt;1.8.1&gt;   ### OS: &lt;Windows 10&gt;    ## Expected behavior   In Java, while testing orientdb connections with jdbc on GratefulDeadConcerts this:      ResultSet rs = stmt.executeQuery("SELECT Count(*) FROM V");      int noofelements = rs.getInt(1); Should return 809, as it does in OrientDB Studio:      SELECT Count(*) FROM V ==&gt; it gives 809  ## Actual behavior   In Java it returns 0; It works **ONLY with all lowercases**:       ResultSet rs = stmt.executeQuery("select count(*) from V");      int noofelements = rs.getInt(1); // this gets the expected 809  ## Steps to reproduce   1. Create a plain java project in Ecilipse, add neccesary jars or all to buildpath. 2. Create a simple Java class which tries to esthablish jdbc connection either with orientdb running on localhost or with remote server.  3. In executeQuery paste above code/query.  &gt; It is not documented to be case sensitive or I may be missing it in documenation. I can share the whole ecilipse project. We were doing a demo trail in organization to use orientdb got this error, was not expecting it was issue so i took time to raise a issue. If it is indeed mentioned in documentation please ignore and close the issue  Thanks Prajwal </body>
		<created>2017-02-16 20:31:22</created>
		<closed>2017-02-20 11:12:42</closed>
	</bug>
	<bug>
		<id>7171</id>
		<title>Cannot move vertex to a new class or cluster</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 1.8 ### OS: Ubuntu  ## Expected behavior   - `vertex.moveToClass()` should move the vertex to a new class - `vertex.moveToCluster()` should move the vertex to a new cluster  ## Actual behavior   - The vertex is not moved to a new cluster - The vertex is not moved to a new cluster ## Steps to reproduce   ```java @Test public void testMoveToClass(){     String location = "memory:test_move_class";     OrientGraphNoTx graphNoTx = new OrientGraphNoTx(location);     OrientVertexType v2 = graphNoTx.createVertexType("V2");     graphNoTx.shutdown();          OrientGraph graph = new OrientGraph(location);     OrientVertex v = graph.addVertex(null);     assertEquals(graph.getVertexBaseType(), v.getType());     v.moveToClass("V2");     graph.commit();     assertEquals(v2, v.getType()); //fails }  @Test public void testMoveCluster(){     String location = "memory:test_move_cluster";     OrientGraph graph = new OrientGraph(location);     OrientVertex v = graph.addVertex("cluster:9");     graph.commit();     ORecordId original = (ORecordId) v.getId();     v.moveToCluster("10");     graph.commit();     assertNotEquals(original, v.getId()); //fails } ``` </body>
		<created>2017-02-14 22:59:33</created>
		<closed>2017-02-17 08:46:20</closed>
	</bug>
	<bug>
		<id>7170</id>
		<title>ORecordNotFoundException missing RID</title>
		<body>### OrientDB Version: 2.2.15    ## Expected behavior   When asking for a forged RID that doesn't exist OrientDB throw an ORecordNotFoundException. The error message is well formed :  The record with id '#999:999' was not found DB name="dbname" Even if non existent the ORID getRid() should be populated to permit other service to properly handle the event   ## Actual behavior   getRid() is null but the message contains the forged RID  ## Steps to reproduce   OrientBaseGraph.getVertex("999:999")   ## Notes This behavior only occurs if the Cluster doesn't exist. If the cluster exist but not the entity RID then no exception is thrown and a null object is returned.  </body>
		<created>2017-02-13 20:18:08</created>
		<closed>2017-02-22 13:41:33</closed>
	</bug>
	<bug>
		<id>7169</id>
		<title>Console scripts: consider to increase -Xmx512m as on server script</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 1.8 ### OS: Linux  In addition, I think we should also document such settings somewhere - explaining things as to a user that does not have any java background - giving them main concepts and guidelines for them to be able to understand the meaning of such settings, and change them, if appropriate</body>
		<created>2017-02-13 14:05:31</created>
		<closed>2017-02-13 14:17:04</closed>
	</bug>
	<bug>
		<id>7166</id>
		<title>NULL values are not visible in query with GROUP BY</title>
		<body>### OrientDB Version: 2.2.16   ### Java Version: 1.8.0_101  ### OS: Windows 10 Enterprise  ## Expected behavior   NULL values  should be visible in query with GROUP BY.  ## Actual behavior   NULL values are not visible in query with GROUP BY.  ## Steps to reproduce   When I run query select * from GenericClassName where propertyName IS NULL , I'm getting results. But when I run query SELECT propertyName FROM GenericClassName GROUP BY propertyName I don't have NULL group. propertyName is STRING.  </body>
		<created>2017-02-10 14:55:11</created>
		<closed>2017-05-08 08:44:23</closed>
	</bug>
	<bug>
		<id>7156</id>
		<title>Handle Exception for Lucene Index Cursor</title>
		<body>Lucene index implementation does not support Index Cursor  Throw a custom exception for a better error message</body>
		<created>2017-02-07 14:23:48</created>
		<closed>2017-03-16 11:46:46</closed>
	</bug>
	<bug>
		<id>7153</id>
		<title>huge files default.pcl</title>
		<body>### OrientDB Version: 2.2.x  I noticed that in each of our big database directories, a file "default.pcl" exists which has a huge size:  ``` databases$ du -sh * 7.2M    GratefulDeadConcerts 2.2M    OSystem 638G    cdrarch 548G    mobile 24G     navi databases$ ls -lh */default.pcl -rw-rw-r-- 1 orientdb orientdb  65K Jun 13  2016 GratefulDeadConcerts/default.pcl -rw-rw-r-- 1 orientdb orientdb  65K Jun 15  2016 OSystem/default.pcl -rw-rw-r-- 1 orientdb orientdb  85G Feb  5 00:16 cdrarch/default.pcl -rw-rw-r-- 1 orientdb orientdb 201G Feb  5 00:03 mobile/default.pcl -rw-r--r-- 1 orientdb orientdb 129K Nov 24 11:42 navi/default.pcl ```  For the case of "mobile", that file is almost half of the total size of the database directory! </body>
		<created>2017-02-06 18:59:53</created>
		<closed>2017-11-17 15:00:36</closed>
	</bug>
	<bug>
		<id>7152</id>
		<title>drop of large class gives Error during saving of record with rid #0:1</title>
		<body>### OrientDB Version: 2.2.15    ### Java Version: 1.8.0_92    ### OS: Ubuntu-16   - Started ODB on a single server, with the "dserver.sh" script, no 2nd server node is active so it runs entirely standalone. - opened "console.sh" connection to our dbase - dropped a small class "tmp1" with 8827 records, no problem - dropped a tiny class "rob_test" with 1 record, no problem - dropped a big class "mds_std_icx" with 350125677 records, fails with ```  Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #0:1         DB name="cdrarch"         DB name="cdrarch"  Error: com.orientechnologies.orient.core.exception.OStorageException: Error in data flush background thread, please restart database and send full stack trace inside of bug report         DB name="cdrarch"  Error: java.lang.NullPointerException ```  Server has 128GB RAM. Parameters in "server.sh" are:  -Xms1G -Xmx10G  -Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=512g -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 -Dstorage.openFiles.limit=1024 -Denvironment.dumpCfgAtStartup=true -Dstorage.diskCache.bufferSize=32000 -Dmemory.chunk.size=33554432 </body>
		<created>2017-02-06 15:23:08</created>
		<closed>2017-02-15 05:53:30</closed>
	</bug>
	<bug>
		<id>7151</id>
		<title>Updated record can be truncated in very rare cases</title>
		<body>### OrientDB Version: 2.2 ### Java Version: any ### OS: any  ## Expected behavior   In very rare cases when we perform record update if difference between free space of page which will be used to contain record and size of record itself is less than three (freeSapce - recordSize &lt; 3) a record can be truncated  ## Actual behavior   Page with such amount of free space should be replaced by new page with essential amount of free space  ## Steps to reproduce   May be reproduced in some internal test cases  </body>
		<created>2017-02-06 08:02:47</created>
		<closed>2017-02-06 15:06:17</closed>
	</bug>
	<bug>
		<id>7150</id>
		<title>NPE in ODocument creation</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 8     It's allowed to create ODocument with className null, but if you specify null oClass - it will through NPE.  ```java new ODocument((String)null);  // It's OK new ODocument((OClass)null); It's failing, **but in OrientDB 2.1.19 it was OK**. ``` </body>
		<created>2017-02-06 05:46:40</created>
		<closed>2017-02-07 11:55:41</closed>
	</bug>
	<bug>
		<id>7149</id>
		<title>ConcurrentModificationException when requesting the database size</title>
		<body>### OrientDB Version: v2.2.2 ### Java Version: Java 8 Update 111 ### OS: macOS Sierra 10.12.2  My app uses OrientJS  to communicate with OrientDB using the REST API. Their both run on the same machine, and there is only one single OrientDB instance.  ## Expected behavior   Return the size of the database  ## Actual behavior    Sometimes it return the db size, but sometimes there is:  ```  Error executing request java.util.ConcurrentModificationException   at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901)   at java.util.ArrayList$Itr.next(ArrayList.java:851)   at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getSize(OAbstractPaginatedStorage.java:2347)   at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sizeDatabase(ONetworkProtocolBinary.java:1069)   at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:373)   at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:199)   at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  ## Steps to reproduce    What my app does is upserting +20k items in the database (using the rest api) while regularly asking for the db size at the same time, in parallel. Sometimes it works, sometimes there is this exception.   Is that allowed/possible? or is there another way? </body>
		<created>2017-02-04 10:14:38</created>
		<closed>2017-02-06 04:41:16</closed>
	</bug>
	<bug>
		<id>7146</id>
		<title>Java Document api can not update a record with an immutable binary field</title>
		<body>### OrientDB Version: 2.2.15 ### Java Version: 1.8 ### OS: does not matter.  ## Expected behavior   should allow update.  ## Actual behavior   with java document api, the update failed:  com.orientechnologies.orient.core.exception.OValidationException: The field 'Test1.s' is immutable and cannot be altered. Field value is: [B@579cee6b DB name="C" DB name="C" at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:422) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:442) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:393) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:275) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:167) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2201) at com.orientechnologies.orient.client.remote.OStorageRemote$12.execute(OStorageRemote.java:769) at com.orientechnologies.orient.client.remote.OStorageRemote$12.execute(OStorageRemote.java:765) at com.orientechnologies.orient.client.remote.OStorageRemote$1.execute(OStorageRemote.java:165) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:238) at com.orientechnologies.orient.client.remote.OStorageRemote.asyncNetworkOperation(OStorageRemote.java:157) at com.orientechnologies.orient.client.remote.OStorageRemote.updateRecord(OStorageRemote.java:749) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2190) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:178) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2716) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:103) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1802) at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1793)      ## Steps to reproduce    At first, setup the following structure:  create class Test1 extends V create property Test1.a integer create property Test1.s binary (readonly true)      Then,  with sql, it is OK to update Test1. update Test1 set a=2   but with java document api, it will fail, it says Test1.s is immutable. In fact, if Test1.s is integer, then no problem. And if Test1 is not a Vertex, but a general class, then no problem. The problem occurs only when Test1 is a vertex and it has an immutable binary field.  I have not looked at the code at the server side, so I have no idea, what is really wrong.  Jack. </body>
		<created>2017-02-03 10:44:03</created>
		<closed>2017-02-28 12:54:04</closed>
	</bug>
	<bug>
		<id>7145</id>
		<title>OrientGraphNoTx commits updates to OrientElement even if OValidationException is thrown</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 1.8   ### OS: Ubuntu  ## Expected behavior   When using a non-transactional graph, an exception should be thrown when you try to update an element in a way that would violate a constraint, and the update should not commit.  ## Actual behavior   The exception is thrown but the update commits and there is no way to roll back.   ## Steps to reproduce   ``` @Test public void testNoTxGraphConstraints() {     String location = "memory:test_noTxConstraints";     OrientGraphNoTx graphNoTx = new OrientGraphNoTx(location);     OrientVertexType testType = graphNoTx.createVertexType("Test");     OProperty age= testType.createProperty("age", OType.INTEGER).setMax("3");     OrientVertex vert1 = graphNoTx.addVertex("class:Test", "age", 2);      try {         vert1.setProperty("age", 4);     } catch (OValidationException e) {         Assert.assertEquals(vert1.getProperty("age"), 2); //this fails     } finally {         graphNoTx.drop();     } } ```  </body>
		<created>2017-02-03 00:18:27</created>
		<closed>2017-02-13 13:10:00</closed>
	</bug>
	<bug>
		<id>7144</id>
		<title>ReadOnly Constraint not enforced on OrientElements</title>
		<body>### OrientDB Version: 2.2.16 ### Java Version: 1.8   ### OS: Ubuntu  ## Expected behavior   ReadOnly properties should throw an exception if you try to update them  ## Actual behavior   No exception is thrown and the update is committed to the graph  ## Steps to reproduce   ``` @Test(expected=OValidationException.class) public void testPropertyReadOnly() {     String location = "memory:test_readOnly";     OrientGraphNoTx graphNoTx = new OrientGraphNoTx(location);     OrientVertexType testType = graphNoTx.createVertexType("Test");     OProperty prop = testType.createProperty("name", OType.STRING).setReadonly(true);     graphNoTx.shutdown();      Assert.assertTrue(prop.isReadonly()); //this one passes      OrientGraph graph = new OrientGraph(location);     try {         OrientVertex vert1 = graph.addVertex("class:Test", "name", "Sam");         graph.commit();          vert1.setProperty("name", "Ben"); //should throw an exception         graph.commit();          Assert.assertEquals(vert1.getProperty("name"), "Sam");  //fails     } finally {         graph.drop();     } } ```  </body>
		<created>2017-02-02 23:58:43</created>
		<closed>2017-02-13 13:10:41</closed>
	</bug>
	<bug>
		<id>7133</id>
		<title>Rollback of remote transaction is not work!</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ] -v3.0 SNAPSHOT[ x]  ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior I try to rollback transaction in 'in-memory' database. State of transaction is: [main] 07:51:18,184 DEBUG org.hibernate.ogm.datastore.orientdb.transaction.impl.OrientDBLocalTransactionCoordinator: transaction info: OTransactionOptimistic [id=2, status=BEGUN, recEntries=1, idxEntries=1] Then I execute same code for 'rremote' database I get next string in log: [main] 07:54:38,332 DEBUG org.hibernate.ogm.datastore.orientdb.transaction.impl.OrientDBLocalTransactionCoordinator: transaction info: OTransactionOptimistic [id=2, status=BEGUN, recEntries=0, idxEntries=0] ## Steps to reproduce the problem public static void main(String[] args) {         ODatabaseDocumentTx db = new ODatabaseDocumentTx("remote:localhost/trtest").                 open("admin", "admin");         db.getMetadata().reload();         System.out.println(db.getMetadata().getFunctionLibrary().getFunctionNames());         db.begin(OTransaction.TXTYPE.OPTIMISTIC);                 OFunction func = db.getMetadata().getFunctionLibrary().getFunction("executeQuery".toUpperCase());         HashMap&lt;Object,Object&gt; funcArgs = new HashMap&lt;&gt;();         funcArgs.put("insertQuery", "insert into Poem content {\"name\":\"Wazaaaaa2\",\"id\":\"84d33e4f-7f43-4181-9a69-ebeb9e628ccc\"};");         func.execute(funcArgs);         System.out.println(db.getTransaction().toString());         db.rollback(true);         //db.commit(true);          db.close();     } Code of function is: return orient.getDatabase().command(insertQuery);  Result of execution of the Java example is rollback not work and You can see new record.</body>
		<created>2017-01-29 06:06:19</created>
		<closed>2017-03-18 07:57:23</closed>
	</bug>
	<bug>
		<id>7129</id>
		<title>unable to create a new index on property after drop of previous</title>
		<body>OrientDB 3.0.0-SNAPSHOT  - start the server - download the movies rating db - drop the index on title for class movie - try to create a lucene index on title  - got:  ``` com.orientechnologies.orient.core.index.OIndexException: Cannot create the index 'Movies.title'  DB name="MovieRatings"  --&gt; com.orientechnologies.orient.core.exception.OStorageException: File with given name already exists but has different id 73 vs. proposed 1797642017526775893  DB name="MovieRatings" ```</body>
		<created>2017-01-27 15:58:59</created>
		<closed>2017-01-31 10:21:18</closed>
	</bug>
	<bug>
		<id>7128</id>
		<title>Unexpected behavior for creation/query of kebab-case property keys.</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .14[x]  ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior Background: I am writing a Clojure wrapper for OrientDB.  Clojure makes frequent use of kebab-case names.  I can create a vertex with a property in kebab-case v1 = graph.addVertex(null, "string-key", "value")  But on query, the key must be escaped in backticks  graph.getVertices("string-key", "value") =&gt; empty collection graph.getVertices("`string-key`", "value") =&gt; collection containing v1 graph.getVertices("string-key", null) =&gt; collection containing v1  I would expect the create and query interfaces to behave the same.  Either throwing an error when you try to create a property key that needs to be escaped, or handling the escaping on query.  ## Steps to reproduce the problem See above.</body>
		<created>2017-01-27 15:42:44</created>
		<closed>2017-01-30 22:54:46</closed>
	</bug>
	<bug>
		<id>7126</id>
		<title>Fixes in JDBC DatabaseMetaData</title>
		<body>We try to use the JDBC.DatabaseMetaData to discover database structure. For this we call getSchemas() getTables() getColumns() getIndexes(), etc. After getSchemas() we receive an error 'The database instance is not set in the current thread'. Could you please set this directly in the JDBC driver ? Since we pass in the JDBC URL the database name, I think the driver should take care about it. If we succeed to fix all this methods we will have a database design tool compatible with OrientDb ( the tool is dbschema.com ).</body>
		<created>2017-01-26 16:50:05</created>
		<closed>2017-03-16 13:41:33</closed>
	</bug>
	<bug>
		<id>7125</id>
		<title>All the metadata of indexes are lost after automatic index rebuilds</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [x] Linux  ## Expected behavior and actual behavior All the metadata of indexes are lost after automatic index rebuilds...  We set the metadata  ``` allowLeadingWildcard":true ```  for all of our Lucene indexes.  After a restart of our server (we had a sudden death of the system), a rebuild was started of nearly all of the indexes, including the Lucene indexes. Now, I notice that such rebuilt Lucene indexes have not these metadata anymore. Obviously resulting in errors for our queries where we use such wildcards. </body>
		<created>2017-01-26 10:54:41</created>
		<closed>2017-02-13 17:13:25</closed>
	</bug>
	<bug>
		<id>7122</id>
		<title>SQL parser fails on expression with brackets before expression with NOT IN condition</title>
		<body>## OrientDB Version, operating system, or hardware. v2.2.15  ## Operating System Linux  Hi,  I think I found an issue with SQL parser which is specific to using brackets before an expression, which contains `not in` condition.  Steps to reproduce:  **Schema** ``` create class Test extends V create property Test.val1 integer create property Test.val2 string  insert into Test content {"val1": 10, "val2": "foo" } insert into Test content {"val1": 20, "val2": "bar" } ```  **FAILED** ``` select from Test  where (val1 &lt; 100) and val2 not in ['bar'] ```  **SUCCEEDED** ``` select from Test  where val1 &lt; 100 and val2 not in ['bar']  select from Test  where  val2 not in ['bar']  and (val1 &lt; 100) ```  The **FAILED** SQL above will throw at least one exception in the log (i think as many record it matches, as many errors it throws). Exception is as follows:  ``` 2017-01-25 12:58:58:286 FINE  {db=test} Read record #102:1 v.1 size=24 bytes [OLocalPaginatedStorage]$ANSI{green {db=test}} Error on evaluating expression ((val2 NOT IN)) java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Boolean         at com.orientechnologies.orient.core.sql.operator.OQueryOperatorNot.evaluateRecord(OQueryOperatorNot.java:55)         at com.orientechnologies.orient.core.sql.filter.OSQLFilterCondition.evaluate(OSQLFilterCondition.java:149)         at com.orientechnologies.orient.core.sql.filter.OSQLFilterCondition.evaluate(OSQLFilterCondition.java:380)         at com.orientechnologies.orient.core.sql.filter.OSQLFilterCondition.evaluate(OSQLFilterCondition.java:94)         at com.orientechnologies.orient.core.sql.filter.OSQLFilter.evaluate(OSQLFilter.java:103)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.evaluateRecord(OCommandExecutorSQLResultsetAbstract.java:419)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.filter(OCommandExecutorSQLResultsetAbstract.java:409)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:612)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1619)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1566)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:525)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:488)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2592)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2538)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:169)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:622)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  </body>
		<created>2017-01-25 13:02:15</created>
		<closed>2017-09-27 10:05:18</closed>
	</bug>
	<bug>
		<id>7121</id>
		<title>Changing schema from double to decimal doesnt seem to work (v2.1.x)</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.1.25  ## Operating System Linux  Hi,  I was changing schema from some of the classes' attributes from `double` to `decimal` using an sql script through console (there are a bunch of attributes that needed conversion).   At my first attempt to run the script database got corrupted throwing some error regarding `BigDecimal`.  I've rearranged the commands in the SQL script a little bit and seem to be able to run it through. However, on my first attempt to update a record I've got an exception (see below). And as a result of the records of that class cannot be updated now.  **Question**: is that something known in Orient 2.1.x or might this be a bug? If initial schema is needed, I can send it by email only. Company policy, of course :)  I'm still trying out different ways to make it work. If I find more info, I'll send it  ``` com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record #125:0         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2048)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:160)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2526)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:122)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1750)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLUpdate.result(OCommandExecutorSQLUpdate.java:342)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.pushResult(OCommandExecutorSQLResultsetAbstract.java:267)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:703)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:610)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:559)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1480)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:488)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:446)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1433)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1406)         at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:72)         at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:743)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLUpdate.execute(OCommandExecutorSQLUpdate.java:264)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1433)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1406)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:81)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:180)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:627)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.ClassCastException: java.lang.Float cannot be cast to java.math.BigDecimal         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:576)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:258)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:565)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeEmbeddedCollection(ORecordSerializerBinaryV0.java:761)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:573)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:258)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2287)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:662)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1938)         ... 28 more ```   </body>
		<created>2017-01-25 11:12:17</created>
		<closed>2017-02-03 03:31:47</closed>
	</bug>
	<bug>
		<id>7119</id>
		<title>Import from JSON throws NPE</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.15 ## Operating System - [ ] Linux - [ ] MacOSX - [x ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior Trying to import data from JSON, just using the example in the docs (Administration --&gt; ETL --&gt; Import from JSON) throws Null Pointer Exception with no helpful error message (at least nothing helpful to me unless I looked at the source code).  No database is created (and of course nothing is imported).  ## Steps to reproduce the problem json source (%ORIENTDB_HOME%/temp/accounts.json): `[  {   "name": "Joe",   "id": 1,   "friends": [2,4,5],   "enemies": [6]  },  {   "name": "Suzie",   "id": 2,   "friends": [1,4,6],   "enemies": [5,2]  } ]`  import config source (%ORIENTDB_HOME%/temp/import_accounts.json): `{   "config": {     "log": "debug"   },   "source" : {     "file": { "path": "../temp/accounts.json" }   },   "extractor" : {     "json": {}   },   "transformers" : [     { "merge": { "joinFieldName": "id", "lookup": "Account.id" } },     { "vertex": { "class": "Account"} },     { "edge": {       "class": "Friend",       "joinFieldName": "friends",       "lookup": "Account.id",       "unresolvedLinkAction": "CREATE"     } },     { "edge": {       "class": "Enemy",       "joinFieldName": "enemies",       "lookup": "Account.id",       "unresolvedLinkAction": "CREATE"     } }   ],   "loader" : {     "orientdb": {       "dbURL": "plocal:../databases/db",       "dbUser": "admin",       "dbPassword": "admin",       "dbAutoDropIfExists": true,       "dbAutoCreate": true,       "standardElementConstraints": false,       "tx": false,       "wal": false,       "batchCommit": 1000,       "dbType": "graph",       "classes": [{"name": "Account", "extends":"V"}, {"name": "Friend", "extends":"E"}, {"name": 'Enemy', "extends":"E"}],       "indexes": [{"class":"Account", "fields":["id:integer"], "type":"UNIQUE_HASH_INDEX" }]     }   } }`  from the OrientDB bin directory, issue the command: `oetl.bat ..\temp\import_accounts.json`  Result: `C:\Development\orientdb-community-2.2.15\bin&gt;oetl.bat ..\temp\import_accounts.json OrientDB etl v.2.2.15 (build 2.2.x@rebf7b80c08613e871633edeb39c5c985e26b176c; 2017-01-19 07:39:00+0000) www.orientdb.com [orientdb] INFO Dropping existent database 'plocal:../databases/db'... Exception in thread "main" com.orientechnologies.orient.core.exception.OConfigurationException: Error on creating ETL processor         DB name="plocal:../databases/db"         at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:237)         at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:177)         at com.orientechnologies.orient.etl.OETLProcessor.parseConfigAndParameters(OETLProcessor.java:145)         at com.orientechnologies.orient.etl.OETLProcessor.main(OETLProcessor.java:109) Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.get(ODatabaseDocumentTx.java:1535)         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.readDatabaseConfiguration(OrientBaseGraph.java:1915)         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:150)         at com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx.&lt;init&gt;(OrientGraphNoTx.java:62)         at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory$2.getGraph(OrientGraphFactory.java:116)         at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getNoTx(OrientGraphFactory.java:240)         at com.orientechnologies.orient.etl.loader.OOrientDBLoader.configureGraphDB(OOrientDBLoader.java:407)         at com.orientechnologies.orient.etl.loader.OOrientDBLoader.configure(OOrientDBLoader.java:345)         at com.orientechnologies.orient.etl.OETLProcessor.configureComponent(OETLProcessor.java:476)         at com.orientechnologies.orient.etl.OETLProcessor.configureLoader(OETLProcessor.java:289)         at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:221)         ... 3 more C:\Development\orientdb-community-2.2.15\bin&gt;`  Notes: There is no database named "db" in the databases folder. Just FYI, because even this simple example doesn't work, I can't import our actual JSON data so OrientDB is out of consideration for our new product.  Ah well.</body>
		<created>2017-01-24 20:05:35</created>
		<closed>2017-01-30 09:20:33</closed>
	</bug>
	<bug>
		<id>7118</id>
		<title>Deletion of vertex does not properly delete attached edges in 2.2.15</title>
		<body>## OrientDB Version, operating system, or hardware. 2.2.15  ## Operating System MacOSX  ## Expected behavior and actual behavior Deletion of a vertex in 2.2.15 does not automatically lead to correct deletion of attached edges. An attempt to delete the edge afterwards results in a NullPointer. ` Exception in thread "main" java.lang.NullPointerException at com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx.removeEdgeInternal(OrientGraphNoTx.java:321) at com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx.removeEdgeInternal(OrientGraphNoTx.java:292) at com.tinkerpop.blueprints.impls.orient.OrientEdge.remove(OrientEdge.java:382) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.removeEdge(OrientBaseGraph.java:1094) at DeleteVertexTest.main(DeleteVertexTest.java:37) `  ## Steps to reproduce the problem The following code runs fine on 2.2.11 but gives the exception on 2.2.15.  ` public static void main(String[] args) {  String url = "remote:localhost/test"; String user = "root"; String password = "root"; int minPoolSize = 1; int maxPoolSize = 5; OrientGraphFactory factory = new OrientGraphFactory(url, user, password).setupPool(minPoolSize, maxPoolSize);  Graph graph = factory.getNoTx();          Vertex x = graph.addVertex(null);         Vertex y = graph.addVertex(null);                  graph.addEdge(null, x, y, "connected_to");                  for (Vertex v : graph.getVertices()) {             graph.removeVertex(v);         }                  for (Edge e : graph.getEdges()) {             System.out.println("e: " + e);         }                  graph.shutdown();                  graph = factory.getNoTx();                  for (Edge e : graph.getEdges()) {             graph.removeEdge(e);         }                  graph.shutdown(); } `  We've been using OrientDB for production for a while now, but it heavily worries me that such straightforward functionality breaks with a micro version.</body>
		<created>2017-01-24 15:08:15</created>
		<closed>2017-01-24 18:56:10</closed>
	</bug>
	<bug>
		<id>7116</id>
		<title>Call to uuid() returns base64 encoded Java object name</title>
		<body>## OrientDB Version, operating system, or hardware. v2.2.15  ## Operating System Linux  It seems that a call to `uuid()` returns a base64 encoded java object name.   For instance, `select uuid()` returns smth like `rO0ABXNyAA5qYXZhLnV0aWwuVVVJRLyZA/eYbYUvAgACSgAMbGVhc3RTaWdCaXRzSgALbW9zdFNpZ0JpdHN4cImuHII+7ojuLqk+WyT1Rw0=`.   When decoded it gives `srjava.util.UUIDm/JleastSigBitsJmostSigBitsxp&gt;.&gt;[$G`</body>
		<created>2017-01-24 08:25:40</created>
		<closed>2017-01-31 23:46:38</closed>
	</bug>
	<bug>
		<id>7110</id>
		<title>Load balancing not working with ROUND_ROBIN_CONNECT strategy</title>
		<body>## OrientDB Version, operating system, or hardware. v2.2.14  ## Operating System Linux  ## Expected behavior and actual behavior I have tried the steps given in Load Balancing section of http://orientdb.com/docs/2.2/Distributed-Configuration.html  `final OrientGraphFactory factory = new OrientGraphFactory("remote:localhost/demo"); factory.setConnectionStrategy(OStorageRemote.CONNECTION_STRATEGY.ROUND_ROBIN_CONNECT.toString()); OrientGraphNoTx graph = factory.getNoTx();`  Requests are going only one of the nodes though I have provides multiple orientdb nodes in the remote server url. Load balancing is not happening.   I tried to use a work around. I use the below code, as the connection strategy at Pool level is being used while creating connection, but still the same issue  `OPartitionedDatabasePool pool = new OPartitionedDatabasePool(url, userid, pass);         pool.setProperty(PARAM_CONNECTION_STRATEGY.toLowerCase(),             OStorageRemote.CONNECTION_STRATEGY.ROUND_ROBIN_CONNECT.toString()); OrientGraphFactory factory = new OrientGraphFactory(url, userid, pass, pool);`  ## Steps to reproduce the problem  Debug the method OStorageRemote.getNextAvailableServerURL. This always returns the same node irrespective of the strategy being used for Load balancing.</body>
		<created>2017-01-23 13:51:23</created>
		<closed>2017-02-28 17:55:26</closed>
	</bug>
	<bug>
		<id>7109</id>
		<title>Error on creating ETL processor</title>
		<body>Hi, I'm trying to upload graph from JSON with JSON ETL. System parameters: OrientDB 2.2.14, ubuntu 14.04 64 bit, JAVA 1.8  I am gating the followings errors -  Exception in thread "main" com.orientechnologies.orient.core.exception.OConfigurationException: Error on creating ETL processor DB name="plocal:/tmp/databases/testdb" at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:245) at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:186) at com.orientechnologies.orient.etl.OETLProcessor.parseConfigAndParameters(OETLProcessor.java:176) at com.orientechnologies.orient.etl.OETLProcessor.main(OETLProcessor.java:140) Caused by: java.lang.NullPointerException at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.get(ODatabaseDocumentTx.java:1468) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.readDatabaseConfiguration(OrientBaseGraph.java:1851) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:146) at com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx.&lt;init&gt;(OrientGraphNoTx.java:62) at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory$2.getGraph(OrientGraphFactory.java:116) at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getNoTx(OrientGraphFactory.java:240) at com.orientechnologies.orient.etl.loader.OOrientDBLoader.configureGraphDB(OOrientDBLoader.java:407) at com.orientechnologies.orient.etl.loader.OOrientDBLoader.configure(OOrientDBLoader.java:345) at com.orientechnologies.orient.etl.OETLProcessor.configureComponent(OETLProcessor.java:484) at com.orientechnologies.orient.etl.OETLProcessor.configureLoader(OETLProcessor.java:297) at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:229) ... 3 more </body>
		<created>2017-01-23 11:16:40</created>
		<closed>2017-01-31 10:36:42</closed>
	</bug>
	<bug>
		<id>7108</id>
		<title>Error on flushing Lucene index</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [x] Linux  ## Expected behavior and actual behavior After index rebuild, the message appears (was told to be resolved in 2.2.14):  ``` Error on flushing Lucene index java.lang.NullPointerException         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.flush(OLuceneIndexEngineAbstract.java:282)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:2261)         at com.orientechnologies.orient.core.index.OIndexManagerShared$RecreateIndexesTask.run(OIndexManagerShared.java:527)         at java.lang.Thread.run(Thread.java:745) ```</body>
		<created>2017-01-23 08:07:29</created>
		<closed>2017-07-12 07:04:07</closed>
	</bug>
	<bug>
		<id>7105</id>
		<title>Async save returns invalid ORecordId</title>
		<body>## OrientDB Version, operating system, or hardware. - v    2.2.15   ## Operating System - [X] Linux   ## Expected behavior and actual behavior  When I'm running an async save on callback it returns an invalid **rid**.  ## Steps to reproduce the problem  ```java        ODocument document = new ODocument("Name");        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();         map.put("name", "Poliana");         map.put("city", "Salvador");         entityValues.keySet().stream().forEach(k -&gt; document.field(k, entityValues.get(k)));        ORecordCallback&lt;Number&gt; createCallBack = (a, b) -&gt; {             System.out.println(a.toString());//#-1:-1         };         ORecordCallback&lt;Integer&gt; updateCallback = (a, b) -&gt; callBack.accept(entity);         tx.save(document, null, ASYNCHRONOUS, false, createCallBack, updateCallback);  ```  </body>
		<created>2017-01-20 22:47:23</created>
		<closed>2017-01-24 13:24:08</closed>
	</bug>
	<bug>
		<id>7103</id>
		<title>A* SQL function returns paths of increasing length for consecutive, identical queries</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior When sending the same query (e.g. 'SELECT astar(#23:19965, #23:19187, 'length')') more than once, only the first result is correct. The consecutive results are longer and longer paths until it seems to either plateau or return no path at all.   So e.g. the shortest path contains 5 nodes. The first query would return the 5 nodes. The second would return 10. Then 17. And then it returns 21 for every query past that point.  ## Steps to reproduce the problem - Start the server, or connect to a local database.  - Send a query like 'SELECT astar(#23:19965, #23:19187, 'length')' multiple times WITHOUT restarting the server in between each query.  ## Possible solutions The problem seems to be, that in com.orientechnologies.orient.graph.sql.functions.OSQLFunctionAstar 'PriorityQueue&lt;OrientVertex&gt; open' and 'Set&lt;OrientVertex&gt; closedSet' are carried over from the last execution of the algorithm. It seems like ... ... either .clear() should be called for 'open' and 'closedSet' before each execution ... or a new instance of OSQLFunctionAstar should be created, every time the function is executed.  ## Misc This is not the case with Dijkstra's algorithm, because a new instance of A* is created each time.</body>
		<created>2017-01-20 19:10:19</created>
		<closed>2017-01-31 09:06:17</closed>
	</bug>
	<bug>
		<id>7100</id>
		<title>Teleporter: NameResolver does not handle correctly a specific pattern name</title>
		<body>NameResolver does not handle correctly a specific pattern name. Here the pattern:  tableName_  each table with a name ending with '_' generates the process termination. </body>
		<created>2017-01-20 10:47:53</created>
		<closed>2017-01-23 13:22:36</closed>
	</bug>
	<bug>
		<id>7096</id>
		<title>Gremlin Query does not run in a Function</title>
		<body>## OrientDB Version, operating system, or hardware.  - v2.2.13  ## Operating System - [ ] Linux - [X ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior I have a Gremlin pipeline as such  &lt;pre&gt;&lt;code&gt; g.v('41:0').outE('AE_Cat_SubCat').inV().transform{[id:it.id, text:it.text]}.gather &lt;/code&gt;&lt;/pre&gt;  This produces the following output in Gremlin console [{id=#46:0, text=Physics}, {id=#45:0, text=General Science}, {id=#47:0, text=Sports}]  However, I created a function in the OrientDB web console and used the following code &lt;pre&gt;&lt;code&gt; def mydb = orient.getGraph(); def queryOutput, results; try{   def query = "g.v(\'${CategoryId}\').outE(\'AE_Cat_SubCat\').inV().transform{[\'id\':it.id, \'text\':it.text]}.gather";   println query   queryOutput = mydb.command('gremlin', query);   println queryOutput     }catch(err){   return err;   } return queryOutput; &lt;/code&gt;&lt;/pre&gt;  And I get the following result  [     {         "@type": "d",         "@version": 0,         "value": [             null,             null,             null         ]     } ]   Output in the console is  g.v('41:0').outE('AE_Cat_SubCat').inV().transform{['id':it.id, 'text':it.text]}.gather [null, null, null]  Please note the the Gremlin query and transform is identical. I have tried with and without the quotes in the transform also.  However, if we remove the transform step, now I get the expected result but a bit too verbose for practical use.  &lt;pre&gt;&lt;code&gt; def mydb = orient.getGraph(); def queryOutput, results; try{   def query = "g.v(\'${CategoryId}\').outE(\'AE_Cat_SubCat\').inV().gather";   println query   queryOutput = mydb.command('gremlin', query);   println queryOutput     }catch(err){   return err;   } return queryOutput; &lt;/code&gt;&lt;/pre&gt;  Gives me back [     {         "@type": "d",         "@rid": "#46:0",         "@version": 2,         "@class": "A_SubCategory",         "text": "Physics",         "in_AE_Cat_SubCat": [             "#53:0"         ],         "@fieldTypes": "in_AE_Cat_SubCat=g"     },     {         "@type": "d",         "@rid": "#45:0",         "@version": 2,         "@class": "A_SubCategory",         "text": "General Science",         "in_AE_Cat_SubCat": [             "#54:0"         ],         "@fieldTypes": "in_AE_Cat_SubCat=g"     },     {         "@type": "d",         "@rid": "#47:0",         "@version": 5,         "@class": "A_SubCategory",         "out_AE_SubCat_Question": [             "#73:0",             "#74:0",             "#75:0"         ],         "text": "Sports",         "in_AE_Cat_SubCat": [             "#55:0"         ],         "@fieldTypes": "out_AE_SubCat_Question=g,in_AE_Cat_SubCat=g"     } ]  ## Steps to reproduce the problem  I suspect the transform stage of the pipeline does not work in Functions.  You can try to apply any type of transform and it will likely fail.   Is there a better way to accomplish what I need?  I am merely trying to clean up the output such that we get only the data that the front end would need and be interested in.  Thanks </body>
		<created>2017-01-19 03:54:55</created>
		<closed>2017-02-14 16:31:32</closed>
	</bug>
	<bug>
		<id>7095</id>
		<title>file lock is null</title>
		<body>Not sure if this is a debug or not. Seeing debug errors.  ## OrientDB Version, operating system, or hardware. - v2.2.15  ## Operating System - [ X] Linux   ## Expected behavior and actual behavior  2017-01-18 15:46:11.707 INFO  - - shutdown storage: archiva$lf... 2017-01-18 15:46:11.754 ERROR - File lock is null , file lock is not released ```  @Override public void close() throws DatabaseException { if (connected.compareAndSet(true, false)) {     OStorage storage = databaseUtils.getGraphFactory().getDatabase().getStorage();     storage.close(true,false); databaseUtils.getGraphFactory().getDatabase().close(); databaseUtils.getGraphFactory().close(); } } ``` ## Steps to reproduce the problem </body>
		<created>2017-01-18 15:50:09</created>
		<closed>2017-01-20 05:06:37</closed>
	</bug>
	<bug>
		<id>7088</id>
		<title>NullPointerException OEngineLocalPaginated.changeCacheSize</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.15-Snapshot  ## Operating System - [X ] Linux   ## Expected behavior and actual behavior  ``` 2017-01-17 07:38:11.472 INFO  - OrientDB auto-config DISKCACHE=5,461MB (heap=5,461MB direct=5,461MB os=32,174MB), assuming maximum direct memory size equals to maximum JVM heap size 2017-01-17 07:38:11.472 ERROR - java.lang.NullPointerException 2017-01-17 07:38:11.472 ERROR - java.lang.NullPointerException 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.local.OEngineLocalPaginated.changeCacheSize(OEngineLocalPaginated.java:80) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.local.OEngineLocalPaginated.changeCacheSize(OEngineLocalPaginated.java:80) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.config.OGlobalConfiguration$1.change(OGlobalConfiguration.java:114) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.config.OGlobalConfiguration$1.change(OGlobalConfiguration.java:114) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.config.OGlobalConfiguration.setValue(OGlobalConfiguration.java:1056) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.config.OGlobalConfiguration.setValue(OGlobalConfiguration.java:1056) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer.configureDefaultDiskCacheSize(OMemoryAndLocalPaginatedEng inesInitializer.java:89) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer.configureDefaultDiskCacheSize(OMemoryAndLocalPaginatedEng inesInitializer.java:89) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer.configureDefaults(OMemoryAndLocalPaginatedEnginesInitiali zer.java:63) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer.configureDefaults(OMemoryAndLocalPaginatedEnginesInitiali zer.java:63) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer.initialize(OMemoryAndLocalPaginatedEnginesInitializer.jav a:52) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer.initialize(OMemoryAndLocalPaginatedEnginesInitializer.jav a:52) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.local.OEngineLocalPaginated.startup(OEngineLocalPaginated.java:56) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.engine.local.OEngineLocalPaginated.startup(OEngineLocalPaginated.java:56) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.Orient.startEngine(Orient.java:858) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.Orient.startEngine(Orient.java:858) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.Orient.loadStorage(Orient.java:466) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.Orient.loadStorage(Orient.java:466) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.&lt;init&gt;(ODatabaseDocumentTx.java:174) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.&lt;init&gt;(ODatabaseDocumentTx.java:174) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.&lt;init&gt;(ODatabaseDocumentTx.java:155) 2017-01-17 07:38:11.473 ERROR -         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.&lt;init&gt;(ODatabaseDocumentTx.java:155) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.openOrCreate(OrientBaseGraph.java:1940) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.openOrCreate(OrientBaseGraph.java:1940) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:163) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.&lt;init&gt;(OrientBaseGraph.java:163) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:102) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:102) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:98) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.&lt;init&gt;(OrientTransactionalGraph.java:98) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:76) 2017-01-17 07:38:11.473 ERROR -         at com.tinkerpop.blueprints.impls.orient.OrientGraph.&lt;init&gt;(OrientGraph.java:76) ```</body>
		<created>2017-01-17 09:18:50</created>
		<closed>2017-01-18 12:50:44</closed>
	</bug>
	<bug>
		<id>7087</id>
		<title>SEVERE: finalize: readers != 0</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ X] Linux  ## Expected behavior and actual behavior  17-Jan-2017 07:40:32.774 SEVERE [Finalizer] null.null OCachePointer.finalize: readers != 0 17-Jan-2017 07:40:32.775 SEVERE [Finalizer] com.orientechnologies.common.log.OLogManager.log OCachePointer.finalize : readers != 0  ## Steps to reproduce the problem </body>
		<created>2017-01-17 08:55:51</created>
		<closed>2017-01-19 11:35:58</closed>
	</bug>
	<bug>
		<id>7085</id>
		<title>thread local leak?</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  ``` logs/catalina.2017-01-13.log:13-Jan-2017 20:25:01.776 SEVERE [localhost-startStop-2] org.apache.catalina.loader.Web appClassLoaderBase.checkThreadLocalMapForLeaks The web application [ROOT] created a ThreadLocal with key of type [c om.orientechnologies.common.concur.lock.OReadersWriterSpinLock.InitOModifiableInteger] (value [com.orientechnologie s.common.concur.lock.OReadersWriterSpinLock$InitOModifiableInteger@562538c9]) and a value of type [com.orientechnol ogies.common.types.OModifiableInteger] (value [0]) but failed to remove it when the web application was stopped. Th reads are going to be renewed over time to try and avoid a probable memory leak. logs/catalina.2017-01-13.log:13-Jan-2017 20:25:01.776 SEVERE [localhost-startStop ```  ## Steps to reproduce the problem </body>
		<created>2017-01-16 19:18:36</created>
		<closed>2017-01-30 12:06:18</closed>
	</bug>
	<bug>
		<id>7084</id>
		<title>Wrong placing of `-Xmx` option  in console.sh</title>
		<body>[The setting of the `-Xmx` option in the `SSL_OPTS` inside `console.sh`](https://github.com/orientechnologies/orientdb/blob/master/graphdb/script/console.sh#L41) is  problematic: [because this is overriding any other option set in the `JAVA_OPTS` variable](http://stackoverflow.com/questions/22095305/java-daemons-launched-with-multiple-xmx-option-hadoop)    p.s Also, could you just stick with reserving the `ORIENTDB_OPTS_MEMORY` or any `ORIENTDB_OPTS` variable in all your `.sh` scripts for the user to set. I've found an incoherent use of those variables, which range from `ORIENTDB_OPTS_MEMORY`,  `JAVA_OPTIONS` and `JAVA_OPTS`, depending on the script among `console.sh`, `server.sh` and `gremlin.sh`. Thanks  </body>
		<created>2017-01-16 14:26:27</created>
		<closed>2017-01-31 10:30:58</closed>
	</bug>
	<bug>
		<id>7075</id>
		<title>Error on closing file</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [x] Linux  Somehow one of the cluster files has got into troubles: During a query from class "cdr_icx_20170108" the following server logs are spawned:  ``` Error on closing file /opt/orientdb/databases/cdrarch/cl_cdr_icx_20170108_p1.pcl java.io.IOException: Stream Closed         at java.io.RandomAccessFile.length(Native Method)         at com.orientechnologies.orient.core.storage.fs.OFileClassic.close(OFileClassic.java:643)         at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeClosed(OClosableEntry.java:168)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.evict(OClosableLinkedContainer.java:707)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.access$400(OClosableLinkedContainer.java:33)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer$LogOpen.run(OClosableLinkedContainer.java:775)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.drainWriteBuffer(OClosableLinkedContainer.java:666)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.drainBuffers(OClosableLinkedContainer.java:617)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.tryToDrainBuffers(OClosableLinkedContainer.java:606)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.afterWrite(OClosableLinkedContainer.java:549)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.logOpen(OClosableLinkedContainer.java:510)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:284)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicalFuzzyCheckpointTask.run(OWOWCache.java:1768)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745) Error during fuzzy checkpoint com.orientechnologies.common.io.OIOException: Error on closing file /opt/orientdb/databases/cdrarch/cl_cdr_icx_20170108_p1.pcl         at com.orientechnologies.orient.core.storage.fs.OFileClassic.close(OFileClassic.java:659)         at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeClosed(OClosableEntry.java:168)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.evict(OClosableLinkedContainer.java:707)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.access$400(OClosableLinkedContainer.java:33)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer$LogOpen.run(OClosableLinkedContainer.java:775)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.drainWriteBuffer(OClosableLinkedContainer.java:666)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.drainBuffers(OClosableLinkedContainer.java:617)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.tryToDrainBuffers(OClosableLinkedContainer.java:606)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.afterWrite(OClosableLinkedContainer.java:549)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.logOpen(OClosableLinkedContainer.java:510)         at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:284)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicalFuzzyCheckpointTask.run(OWOWCache.java:1768)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: Stream Closed         at java.io.RandomAccessFile.length(Native Method)         at com.orientechnologies.orient.core.storage.fs.OFileClassic.close(OFileClassic.java:643)         ... 18 more ```  That query now runs very slow.  Is that file corrupted ? If so, how to fix it? If not, why these messages? </body>
		<created>2017-01-12 18:13:12</created>
		<closed>2017-01-27 13:46:18</closed>
	</bug>
	<bug>
		<id>7074</id>
		<title>java.lang.NullPointerException at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.deserializeFromDirectMemory(ODurablePage.java:164)</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [X ] Linux  java version "1.8.0_112" Java(TM) SE Runtime Environment (build 1.8.0_112-b15) Java HotSpot(TM) 64-Bit Server VM (build 25.112-b15, mixed mode)  ## Expected behavior and actual behavior  ``` 2017-01-12 15:17:07 t.c.s.a.c.e.AbstractEWSExchangeLink [ERROR] failed to create item  Caused by: java.lang.NullPointerException: null         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.deserializeFromDirectMemory(ODurablePage.java:164)         at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiBucket.getEntry(OSBTreeBonsaiBucket.java:280)         at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.findBucket(OSBTreeBonsaiLocal.java:1359)         at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.loadEntriesMajor(OSBTreeBonsaiLocal.java:774)         at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.getRealBagSize(OSBTreeBonsaiLocal.java:1462)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.updateSize(OSBTreeRidBag.java:1029)         at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.size(OSBTreeRidBag.java:748)         at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.size(ORidBag.java:191)         at com.tinkerpop.blueprints.impls.orient.OrientVertex.getEdges(OrientVertex.java:840)         at com.tinkerpop.blueprints.impls.orient.OrientVertex.getEdges(OrientVertex.java:768)         at com.tinkerpop.blueprints.util.DefaultVertexQuery$DefaultVertexQueryIterable.&lt;init&gt;(DefaultVertexQuery.java:110)         at com.tinkerpop.blueprints.util.DefaultVertexQuery.edges(DefaultVertexQuery.java:80)         at com.tinkerpop.pipes.transform.VertexQueryPipe.processNextStart(VertexQueryPipe.java:113)         at com.tinkerpop.pipes.transform.VertexQueryPipe.processNextStart(VertexQueryPipe.java:19)         at com.tinkerpop.pipes.AbstractPipe.hasNext(AbstractPipe.java:98)         at com.tinkerpop.pipes.transform.OrderPipe.processNextStart(OrderPipe.java:86)         at com.tinkerpop.pipes.AbstractPipe.next(AbstractPipe.java:89)         at com.tinkerpop.pipes.filter.FilterFunctionPipe.processNextStart(FilterFunctionPipe.java:23)         at com.tinkerpop.pipes.AbstractPipe.hasNext(AbstractPipe.java:98)         at com.tinkerpop.pipes.util.Pipeline.hasNext(Pipeline.java:105)         at  ```  Here are startup options  ``` export CATALINA_OPTS="-Dversion=enterpriseedition -Xmx6g -Xms256m -XX:MaxDirectMemorySize=512g -Dgraphdb.cache.size=64 -Dstorage.diskCache.bufferSize=409 6 -Xloggc:/var/log/gc-$(date +%Y_%m_%d-%H_%M).log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=5 -XX:GCLogFileSize=1G -XX:+PrintGCDetails -XX:+PrintG CTimeStamps -XX:+PrintGCDateStamps -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -XX:HeapDumpPath=/mnt/archive-four/java_pid%p.hprof  -XX:+HeapDumpOnOutOfMemoryError" ```  Note: -XX:MaxDirectMemorySize=512g  ``` &gt;get -i * #mbean = java.nio:type=BufferPool,name=direct: Name = direct; (Name)  Count = 431; (Count)  TotalCapacity = 5275964398; (TotalCapacity)  MemoryUsed = 5275964398; (MemoryUsed)  ObjectName = java.nio:type=BufferPool,name=direct; (ObjectName)  $&gt;bean java.lang:type=Memory #bean is set to java.lang:type=Memory $&gt;get -i * #mbean = java.lang:type=Memory: Verbose = true; (Verbose) #mbean = java.lang:type=Memory: HeapMemoryUsage = {    committed = 5974261760; (committed)   init = 268435456; (init)   max = 5974261760; (max)   used = 2898740464; (used)  }; (HeapMemoryUsage) NonHeapMemoryUsage = {    committed = 323182592; (committed)   init = 2555904; (init)   max = -1; (max)   used = 313671344; (used)  }; (NonHeapMemoryUsage) ObjectPendingFinalizationCount = 0; (ObjectPendingFinalizationCount) ObjectName = java.lang:type=Memory; (ObjectName) $&gt;bean com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean #bean is set to com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean $&gt;get -i * #mbean = com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean: OverflowBufferCount = 0; (OverflowBufferCount) AllocatedMemory = 4294967296; (AllocatedMemory) BufferSize = 65536; (BufferSize) AllocatedBufferCount = 55772; (AllocatedBufferCount) AllocatedMemoryInGB = 4.0; (AllocatedMemoryInGB) BuffersInThePool = 67; (BuffersInThePool) AllocatedMemoryInMB = 4096; (AllocatedMemoryInMB) $&gt;bean java.nio:name=mapped,type=BufferPool #bean is set to java.nio:name=mapped,type=BufferPool $&gt;get -i * #mbean = java.nio:name=mapped,type=BufferPool: Name = mapped; (Name) Count = 2058; (Count) TotalCapacity = 97291919684; (TotalCapacity) MemoryUsed = 97291919684; (MemoryUsed) ObjectName = java.nio:type=BufferPool,name=mapped; (ObjectName) ``` ## Steps to reproduce the problem </body>
		<created>2017-01-12 15:34:06</created>
		<closed>2017-01-13 13:37:10</closed>
	</bug>
	<bug>
		<id>7073</id>
		<title>Synchronization in a cluster fails</title>
		<body>## OrientDB Version, operating system, or hardware. 2.2.15-SNAPSHOT  ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior This issue I have faced when I tested the issue https://github.com/orientechnologies/orientdb/issues/6999 after I was fixed.   There is an example. We have node-1 and after node-2, we write a value "1" to a document when node-1 and node-2 are up. We shut down node-2 and write value "2", after we shut down node-1 as well. When we start node-2 and after node-1 data is being synchronized, but we get the following issues:  - I see strange logs which tell that node-1 does not see node-2, although replication works fine. - When I restart node-1 it does not join the cluster and does not see node-2.  Only when we restart all the cluster everything start working fine.  This are the logs from node-1: ``` 2017-01-12 16:08:46.982 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.mobius.content.rest.api.config.StorageConfiguration$$EnhancerBySpringCGLIB$$413377f4:startEmbeddedOrientDbServerIfConfigured - Starting embedded OrientDB database... 2017-01-12 16:08:47.858 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.config.OServerConfigurationLoaderXml - Loading configuration from input stream 2017-01-12 16:08:49.084 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.OServer - OrientDB Server v2.2.15-SNAPSHOT is starting up... 2017-01-12 16:08:49.105 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.OServer - Databases directory: C:\Users\ppoh\asg\mobius\data\orientdb\databases 2017-01-12 16:08:49.252 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.core.engine.OMemoryAndLocalPaginatedEnginesInitializer - OrientDB auto-config DISKCACHE=3,614MB (heap=3,614MB direct=3,614MB os=16,260MB), assuming maximum direct memory size equals to maximum JVM heap size 2017-01-12 16:08:49.626 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.network.OServerNetworkListener - Listening $ANSI{green binary} connections on $ANSI{green 0.0.0.0:2424} (protocol v.36, socket=default) 2017-01-12 16:08:49.636 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.network.OServerNetworkListener - Listening $ANSI{green http} connections on $ANSI{green 0.0.0.0:2480} (protocol v.10, socket=default) 2017-01-12 16:08:49.656 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.plugin.OServerPluginManager - Installing dynamic plugin 'studio-2.2.zip'... 2017-01-12 16:08:49.666 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.security.authenticator.ODefaultPasswordAuthenticator - ODefaultPasswordAuthenticator is active 2017-01-12 16:08:49.676 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.security.authenticator.OServerConfigAuthenticator - OServerConfigAuthenticator is active 2017-01-12 16:08:49.676 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.security.authenticator.OSystemUserAuthenticator - OSystemUserAuthenticator is active 2017-01-12 16:08:49.716 [WARN ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.graph.gremlin.OGremlinHelper - GREMLIN language not available (not in classpath) 2017-01-12 16:08:51.813 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - Found 'replicator' user. Starting from OrientDB v2.2 this internal user is no needed anymore. Removing it... 2017-01-12 16:08:51.813 [WARN ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - Assigning distributed node name: node-1 2017-01-12 16:08:51.933 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.config.FileSystemXmlConfig - Configuring Hazelcast from 'C:\Users\ppoh\asg\mobius\config\orientdb\hazelcast.xml'. 2017-01-12 16:08:52.797 [WARN ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.config.AbstractXmlConfigHelper - Name of the hazelcast schema location incorrect using default 2017-01-12 16:08:53.651 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.instance.DefaultAddressPicker - [LOCAL] [orientdb] [3.7.3] Prefer IPv4 stack is true. 2017-01-12 16:08:53.780 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.instance.DefaultAddressPicker - [LOCAL] [orientdb] [3.7.3] Picked [10.129.235.254]:2434, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=2434], bind any local is true 2017-01-12 16:08:53.837 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.system - [10.129.235.254]:2434 [orientdb] [3.7.3] Hazelcast 3.7.3 (20161117 - 8166eea) starting at [10.129.235.254]:2434 2017-01-12 16:08:53.847 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.system - [10.129.235.254]:2434 [orientdb] [3.7.3] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. 2017-01-12 16:08:53.847 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.system - [10.129.235.254]:2434 [orientdb] [3.7.3] Configured Hazelcast Serialization version : 1 2017-01-12 16:08:54.718 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.spi.impl.operationservice.impl.BackpressureRegulator - [10.129.235.254]:2434 [orientdb] [3.7.3] Backpressure is disabled 2017-01-12 16:08:57.205 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.instance.Node - [10.129.235.254]:2434 [orientdb] [3.7.3] Creating MulticastJoiner 2017-01-12 16:08:57.222 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.core.LifecycleService - [10.129.235.254]:2434 [orientdb] [3.7.3] [10.129.235.254]:2434 is STARTING 2017-01-12 16:08:57.790 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.spi.impl.operationexecutor.impl.OperationExecutorImpl - [10.129.235.254]:2434 [orientdb] [3.7.3] Starting 1 partition threads 2017-01-12 16:08:57.790 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.spi.impl.operationexecutor.impl.OperationExecutorImpl - [10.129.235.254]:2434 [orientdb] [3.7.3] Starting 2 generic threads (1 dedicated for priority tasks) 2017-01-12 16:08:57.800 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.nio.tcp.nonblocking.NonBlockingIOThreadingModel - [10.129.235.254]:2434 [orientdb] [3.7.3] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads 2017-01-12 16:09:00.087 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.internal.cluster.impl.MulticastJoiner - [10.129.235.254]:2434 [orientdb] [3.7.3]    Members [1] { Member [10.129.235.254]:2434 - 4f072f95-a4d7-430f-8503-5a2e86b22e2d this }  2017-01-12 16:09:00.227 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.core.LifecycleService - [10.129.235.254]:2434 [orientdb] [3.7.3] [10.129.235.254]:2434 is STARTED 2017-01-12 16:09:00.227 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - Starting distributed server 'node-1' (hzID=4f072f95-a4d7-430f-8503-5a2e86b22e2d)... 2017-01-12 16:09:00.227 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - Distributed cluster time=Thu Jan 12 16:09:00 EET 2017 (delta from local node=0)... 2017-01-12 16:09:00.425 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.internal.partition.impl.PartitionStateManager - [10.129.235.254]:2434 [orientdb] [3.7.3] Initializing cluster partition table arrangement... 2017-01-12 16:09:00.580 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - Distributed coordinator server is 'node-1' 2017-01-12 16:09:00.640 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - [node-1] Loaded configuration for database 'OSystem' from disk: C:\Users\ppoh\asg\mobius\config\orientdb\default-distributed-db-config.json 2017-01-12 16:09:00.660 [WARN ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Servers in cluster: [node-1] 2017-01-12 16:09:01.310 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Opening database 'mobius'... 2017-01-12 16:09:01.320 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - [node-1] Loaded configuration for database 'mobius' from disk: C:\Users\ppoh\asg\mobius\data\orientdb\databases\mobius\distributed-config.json 2017-01-12 16:09:01.340 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+--------+---------+-----+---------+----------------+----------------+-------------------------+ |Name   |Status  |Databases|Conns|StartedOn|Binary          |HTTP            |UsedMemory               | +-------+--------+---------+-----+---------+----------------+----------------+-------------------------+ |node-1*|STARTING|         |0    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|1010.01MB/3.53GB (27.94%)| +-------+--------+---------+-----+---------+----------------+----------------+-------------------------+  2017-01-12 16:09:01.340 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$4 - [node-1] Current node started as MASTER for database 'mobius' 2017-01-12 16:09:01.735 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Reassigning ownership of clusters for database mobius... 2017-01-12 16:09:01.735 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Reassignment of clusters for database 'mobius' completed (classes=22) 2017-01-12 16:09:01.759 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Publishing ONLINE status for database node-1.mobius... 2017-01-12 16:09:01.760 [WARN ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Updated node status to 'ONLINE' 2017-01-12 16:09:01.760 [WARN ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.handler.OServerSideScriptInterpreter - Authenticated clients can execute any kind of code into the server by using the following allowed languages: [sql] 2017-01-12 16:09:01.949 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.OServer - OrientDB Studio available at $ANSI{blue http://10.33.77.70:2480/studio/index.html} 2017-01-12 16:09:01.949 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.orientechnologies.orient.server.OServer - $ANSI{green:italic OrientDB Server is active} v2.2.15-SNAPSHOT. 2017-01-12 16:09:02.032 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=1, source=/127.0.0.1:55948, since=1484230142032] 2017-01-12 16:09:02.145 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.instance.DefaultAddressPicker:log - [LOCAL] [dev] [3.7.3] Prefer IPv4 stack is true. 2017-01-12 16:09:02.223 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.instance.DefaultAddressPicker:log - [LOCAL] [dev] [3.7.3] Picked [10.129.235.254]:5701, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=5701], bind any local is true 2017-01-12 16:09:02.244 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.system:log - [10.129.235.254]:5701 [dev] [3.7.3] Hazelcast 3.7.3 (20161117 - 8166eea) starting at [10.129.235.254]:5701 2017-01-12 16:09:02.244 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.system:log - [10.129.235.254]:5701 [dev] [3.7.3] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. 2017-01-12 16:09:02.244 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.system:log - [10.129.235.254]:5701 [dev] [3.7.3] Configured Hazelcast Serialization version : 1 2017-01-12 16:09:02.266 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.spi.impl.operationservice.impl.BackpressureRegulator:log - [10.129.235.254]:5701 [dev] [3.7.3] Backpressure is disabled 2017-01-12 16:09:02.570 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.instance.Node:log - [10.129.235.254]:5701 [dev] [3.7.3] Creating MulticastJoiner 2017-01-12 16:09:02.580 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.core.LifecycleService:log - [10.129.235.254]:5701 [dev] [3.7.3] [10.129.235.254]:5701 is STARTING 2017-01-12 16:09:02.610 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.spi.impl.operationexecutor.impl.OperationExecutorImpl:log - [10.129.235.254]:5701 [dev] [3.7.3] Starting 4 partition threads 2017-01-12 16:09:02.620 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.spi.impl.operationexecutor.impl.OperationExecutorImpl:log - [10.129.235.254]:5701 [dev] [3.7.3] Starting 3 generic threads (1 dedicated for priority tasks) 2017-01-12 16:09:02.640 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.nio.tcp.nonblocking.NonBlockingIOThreadingModel:log - [10.129.235.254]:5701 [dev] [3.7.3] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads 2017-01-12 16:09:04.836 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.internal.cluster.impl.MulticastJoiner:log - [10.129.235.254]:5701 [dev] [3.7.3]    Members [1] { Member [10.129.235.254]:5701 - 932f08b9-4e83-4908-90da-c8fccff9c99a this }  2017-01-12 16:09:04.863 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.core.LifecycleService:log - [10.129.235.254]:5701 [dev] [3.7.3] [10.129.235.254]:5701 is STARTED 2017-01-12 16:09:05.471 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - $ANSI{green {db=mobius}} Remote client connected from: OClientConnection [id=2, source=/127.0.0.1:55948, since=1484230145471] 2017-01-12 16:09:05.501 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=2, source=/127.0.0.1:55948, since=1484230145471] 2017-01-12 16:09:05.911 [INFO ]    [RMI TCP Connection(3)-127.0.0.1] com.hazelcast.internal.partition.impl.PartitionStateManager:log - [10.129.235.254]:5701 [dev] [3.7.3] Initializing cluster partition table arrangement... 2017-01-12 16:09:07.071 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=3, source=/127.0.0.1:55948, since=1484230147071] 2017-01-12 16:09:07.071 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=3, source=/127.0.0.1:55948, since=1484230147071] 2017-01-12 16:09:07.081 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=4, source=/127.0.0.1:55948, since=1484230147081] 2017-01-12 16:09:07.091 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55948)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=4, source=/127.0.0.1:55948, since=1484230147081] 2017-01-12 16:09:07.101 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55967)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=5, source=/127.0.0.1:55967, since=1484230147101] 2017-01-12 16:09:07.102 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:55967)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=5, source=/127.0.0.1:55967, since=1484230147101] 2017-01-12 16:09:07.348 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+------+----------------------+-----+---------+----------------+----------------+------------------------+ |Name   |Status|Databases             |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +-------+------+----------------------+-----+---------+----------------+----------------+------------------------+ |node-1*|ONLINE|mobius=ONLINE (MASTER)|1    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|523.00MB/3.53GB (14.47%)| +-------+------+----------------------+-----+---------+----------------+----------------+------------------------+  2017-01-12 16:11:32.176 [INFO ]    [hz._hzInstance_1_orientdb.IO.thread-Acceptor] com.hazelcast.nio.tcp.SocketAcceptorThread - [10.129.235.254]:2434 [orientdb] [3.7.3] Accepting socket connection from /10.129.235.254:56068 2017-01-12 16:11:32.187 [INFO ]    [hz._hzInstance_1_orientdb.cached.thread-3] com.hazelcast.nio.tcp.TcpIpConnectionManager - [10.129.235.254]:2434 [orientdb] [3.7.3] Established socket connection between /10.129.235.254:2434 and /10.129.235.254:56068 2017-01-12 16:11:39.181 [INFO ]    [hz._hzInstance_1_orientdb.priority-generic-operation.thread-0] com.hazelcast.internal.cluster.ClusterService - [10.129.235.254]:2434 [orientdb] [3.7.3]   Members [2] { Member [10.129.235.254]:2434 - 4f072f95-a4d7-430f-8503-5a2e86b22e2d this Member [10.129.235.254]:2435 - 9a34fa8e-642a-4c6d-8376-905883b0bc72 }  2017-01-12 16:11:39.182 [WARN ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Added new node id=Member [10.129.235.254]:2435 - 9a34fa8e-642a-4c6d-8376-905883b0bc72 name=ext:9a34fa8e-642a-4c6d-8376-905883b0bc72 2017-01-12 16:11:39.425 [INFO ]    [hz._hzInstance_1_orientdb.migration] com.hazelcast.internal.partition.impl.MigrationManager - [10.129.235.254]:2434 [orientdb] [3.7.3] Re-partitioning cluster data... Migration queue size: 271 2017-01-12 16:11:41.228 [INFO ]    [hz._hzInstance_1_orientdb.migration] com.hazelcast.internal.partition.impl.MigrationThread - [10.129.235.254]:2434 [orientdb] [3.7.3] All migration tasks have been completed, queues are empty. 2017-01-12 16:11:41.343 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[ext:9a34fa8e-642a-4c6d-8376-905883b0bc72] Received updated about registered nodes 2017-01-12 16:11:41.758 [INFO ]    [OrientDB (/10.33.77.70:2424) &lt;- BinaryClient (/10.33.77.70:56075)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=6, source=/10.33.77.70:56075, since=1484230301758] 2017-01-12 16:11:41.761 [INFO ]    [OrientDB (/10.33.77.70:2424) &lt;- BinaryClient (/10.33.77.70:56076)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=7, source=/10.33.77.70:56076, since=1484230301761] 2017-01-12 16:11:41.769 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Added node configuration id=Member [10.129.235.254]:2435 - 9a34fa8e-642a-4c6d-8376-905883b0bc72 name=node-2, now 2 nodes are configured 2017-01-12 16:11:41.771 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+--------+----------------------+-----+---------+----------------+----------------+------------------------+ |Name   |Status  |Databases             |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +-------+--------+----------------------+-----+---------+----------------+----------------+------------------------+ |node-1*|ONLINE  |mobius=ONLINE (MASTER)|4    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|847.51MB/3.53GB (23.45%)| |node-2 |STARTING|                      |0    |16:11:27 |10.33.77.70:2425|10.33.77.70:2481|587.21MB/3.53GB (16.25%)| +-------+--------+----------------------+-----+---------+----------------+----------------+------------------------+  2017-01-12 16:11:42.161 [INFO ]    [OrientDB DistributedWorker node=node-1 db=OSystem id=0] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - [node-1] Setting new distributed configuration for database: OSystem (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+ |CLUSTER |writeQuorum|readQuorum| +--------+-----------+----------+ |*       |     1     |    1     | |internal|     1     |    1     | +--------+-----------+----------+   2017-01-12 16:11:42.243 [ERROR]    [OrientDB DistributedWorker node=node-1 db=mobius id=0] com.orientechnologies.orient.server.distributed.impl.task.OSyncDatabaseDeltaTask - [node-1]--[node-2] Skip deploying delta database 'mobius' because the requesting server has a most recent database (requester LastOperationOn=2017-01-12 16:07:43.280 current LastOperationOn=2017-01-12 16:05:12.621) 2017-01-12 16:11:42.259 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Received new status node-2.mobius=ONLINE 2017-01-12 16:11:42.261 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Received updated status node-1.mobius=NOT_AVAILABLE 2017-01-12 16:11:42.262 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+--------+-----------------------------+-----+---------+----------------+----------------+------------------------+ |Name   |Status  |Databases                    |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +-------+--------+-----------------------------+-----+---------+----------------+----------------+------------------------+ |node-1*|ONLINE  |mobius=NOT_AVAILABLE (MASTER)|6    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|911.90MB/3.53GB (25.23%)| |node-2 |STARTING|                             |0    |16:11:27 |10.33.77.70:2425|10.33.77.70:2481|594.44MB/3.53GB (16.45%)| +-------+--------+-----------------------------+-----+---------+----------------+----------------+------------------------+  2017-01-12 16:11:42.474 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=8, source=/127.0.0.1:56078, since=1484230302474] 2017-01-12 16:11:42.520 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1] Trying to recover current server for database 'mobius'... 2017-01-12 16:11:42.535 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$3 - [node-1] Current node is a MASTER for database 'mobius' 2017-01-12 16:11:42.540 [WARN ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]-&gt;[[node-2]] requesting delta database sync for 'mobius' on local server... 2017-01-12 16:11:42.541 [INFO ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]-&gt;[node-2] Requesting database delta sync for 'mobius' LSN=LSN{segment=0, position=17829}... 2017-01-12 16:11:43.061 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Received updated status node-1.mobius=SYNCHRONIZING 2017-01-12 16:11:43.062 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+--------+-----------------------------+-----+---------+----------------+----------------+------------------------+ |Name   |Status  |Databases                    |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +-------+--------+-----------------------------+-----+---------+----------------+----------------+------------------------+ |node-1*|ONLINE  |mobius=SYNCHRONIZING (MASTER)|6    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|911.90MB/3.53GB (25.23%)| |node-2 |STARTING|                             |0    |16:11:27 |10.33.77.70:2425|10.33.77.70:2481|594.44MB/3.53GB (16.45%)| +-------+--------+-----------------------------+-----+---------+----------------+----------------+------------------------+  2017-01-12 16:11:43.091 [WARN ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Error on installing database delta for 'mobius' (err=Requested database delta sync with LSN=LSN{segment=0, position=17829} but not found in database) 2017-01-12 16:11:43.091 [WARN ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Requesting full database 'mobius' sync... 2017-01-12 16:11:43.092 [ERROR]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]-&gt;[node-2] Error on asking delta backup of database 'mobius' (err=Requested database delta sync with LSN=LSN{segment=0, position=17829} but not found in database) 2017-01-12 16:11:43.097 [INFO ]    [hz._hzInstance_2_dev.IO.thread-Acceptor] com.hazelcast.nio.tcp.SocketAcceptorThread:log - [10.129.235.254]:5701 [dev] [3.7.3] Accepting socket connection from /10.129.235.254:56093 2017-01-12 16:11:43.106 [INFO ]    [hz._hzInstance_2_dev.cached.thread-6] com.hazelcast.nio.tcp.TcpIpConnectionManager:log - [10.129.235.254]:5701 [dev] [3.7.3] Established socket connection between /10.129.235.254:5701 and /10.129.235.254:56093 2017-01-12 16:11:43.648 [WARN ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]-&gt;[[node-2]] Requesting deploy of database 'mobius' on local server... 2017-01-12 16:11:43.650 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - [node-1] Downloaded configuration for database 'mobius' from the cluster 2017-01-12 16:11:43.656 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - [node-1] Setting new distributed configuration for database: mobius (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +---------------------+-----------+----------+-------------+-------+ |                     |           |          |   MASTER    |MASTER | |                     |           |          |SYNCHRONIZING|ONLINE | |                     |           |          |   dynamic   |dynamic| +---------------------+-----------+----------+-------------+-------+ |CLUSTER              |writeQuorum|readQuorum|   node-1    |node-2 | +---------------------+-----------+----------+-------------+-------+ |*                    |     1     |    1     |      X      |   o   | |_studio              |     1     |    1     |      o      |   X   | |_studio_1            |     1     |    1     |      o      |   X   | |aclentity            |     1     |    1     |      o      |   X   | |aclentity_1          |     1     |    1     |      o      |   X   | |configurationentry   |     1     |    1     |      o      |   X   | |configurationentry_3 |     1     |    1     |      o      |   X   | |e                    |     1     |    1     |      o      |   X   | |e_1                  |     1     |    1     |      o      |   X   | |extractfilterentity_1|     1     |    1     |      o      |   X   | |extractfilterentity_2|     1     |    1     |      o      |   X   | |favoriteentity       |     1     |    1     |      o      |   X   | |favoriteentity_3     |     1     |    1     |      o      |   X   | |internal             |     1     |    1     |             |       | |odocumentwrapper     |     1     |    1     |      o      |   X   | |odocumentwrapper_2   |     1     |    1     |      o      |   X   | |ofunction_0          |     1     |    1     |      o      |   X   | |orole_0              |     1     |    1     |      o      |   X   | |oschedule_0          |     1     |    1     |      o      |   X   | |osequence_0          |     1     |    1     |      o      |   X   | |ouser_0              |     1     |    1     |      o      |   X   | |principalentity      |     1     |    1     |      o      |   X   | |principalentity_1    |     1     |    1     |      o      |   X   | |roleentity           |     1     |    1     |      o      |   X   | |roleentity_1         |     1     |    1     |      o      |   X   | |rulemodelentity_1    |     1     |    1     |      o      |   X   | |rulemodelentity_3    |     1     |    1     |      o      |   X   | |savedsearchentity    |     1     |    1     |      o      |   X   | |savedsearchentity_3  |     1     |    1     |      o      |   X   | |v                    |     1     |    1     |      o      |   X   | |v_3                  |     1     |    1     |      o      |   X   | +---------------------+-----------+----------+-------------+-------+   2017-01-12 16:11:43.672 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Received updated status node-2.mobius=BACKUP 2017-01-12 16:11:45.951 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Received updated status node-2.mobius=ONLINE 2017-01-12 16:11:46.110 [WARN ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Moving existent database 'mobius' in 'C:/Users/ppoh/asg/mobius/data/orientdb/databases/mobius' to 'C:/Users/ppoh/asg/mobius/data/orientdb/databases//../backup/databases/mobius' and get a fresh copy from a remote node... 2017-01-12 16:11:46.111 [ERROR]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Error on moving existent database 'mobius' located in 'C:/Users/ppoh/asg/mobius/data/orientdb/databases/mobius' to 'C:\Users\ppoh\asg\mobius\data\orientdb\databases\..\backup\databases\mobius'. Deleting old database... 2017-01-12 16:11:46.115 [INFO ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Copying remote database 'mobius' to: C:/Tomcats/tomcat_2443/temp/orientdb/install_mobius.zip 2017-01-12 16:11:46.141 [INFO ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1]&lt;-[node-2] Installing database 'mobius' to: C:/Users/ppoh/asg/mobius/data/orientdb/databases/mobius... 2017-01-12 16:11:46.141 [INFO ]    [OrientDB installDatabase node=node-1 db=mobius] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] - writing chunk #1 offset=0 size=389.02KB 2017-01-12 16:11:46.144 [INFO ]    [OrientDB installDatabase node=node-1 db=mobius] com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$4 - [node-1] Database copied correctly, size=389.02KB 2017-01-12 16:11:47.699 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+------+---------+-----+---------+----------------+----------------+------------------------+ |Name   |Status|Databases|Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +-------+------+---------+-----+---------+----------------+----------------+------------------------+ |node-1*|ONLINE|         |6    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|911.90MB/3.53GB (25.23%)| |node-2 |ONLINE|         |2    |16:11:27 |10.33.77.70:2425|10.33.77.70:2481|748.65MB/3.53GB (20.71%)| +-------+------+---------+-----+---------+----------------+----------------+------------------------+  2017-01-12 16:11:49.102 [INFO ]    [hz._hzInstance_2_dev.priority-generic-operation.thread-0] com.hazelcast.internal.cluster.ClusterService:log - [10.129.235.254]:5701 [dev] [3.7.3]   Members [2] { Member [10.129.235.254]:5701 - 932f08b9-4e83-4908-90da-c8fccff9c99a this Member [10.129.235.254]:5702 - 060a097f-8d80-43d6-9df3-a26803e8d5b2 }  2017-01-12 16:11:49.102 [DEBUG]    [hz._hzInstance_2_dev.event-2] com.mobius.content.rm.service.dispatchers.EventDispatcherDistributed:memberAdded - New server's node added: MembershipEvent {member=Member [10.129.235.254]:5702 - 060a097f-8d80-43d6-9df3-a26803e8d5b2,type=added} 2017-01-12 16:11:49.150 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - $ANSI{green {db=mobius}} Remote client connected from: OClientConnection [id=9, source=/127.0.0.1:56078, since=1484230309150] 2017-01-12 16:11:49.296 [WARN ]    [Timer-1] com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=mobius}} Storage 'mobius' was not closed properly. Will try to recover from write ahead log 2017-01-12 16:11:49.297 [ERROR]    [Timer-1] com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=mobius}} Restore is not possible because write ahead log is empty. 2017-01-12 16:11:49.297 [INFO ]    [Timer-1] com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage - $ANSI{green {db=mobius}} Storage data recover was completed 2017-01-12 16:11:49.586 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - $ANSI{green {db=mobius}} [node-1] Downloaded configuration for database 'mobius' from the cluster 2017-01-12 16:11:49.586 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - $ANSI{green {db=mobius}} [node-1] Downloaded configuration for database 'mobius' from the cluster 2017-01-12 16:11:49.591 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - $ANSI{green {db=mobius}} [node-1] Setting new distributed configuration for database: mobius (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +---------------------+----+-----------+----------+-------------+-------+ |                     |    |           |          |   MASTER    |MASTER | |                     |    |           |          |SYNCHRONIZING|ONLINE | |                     |    |           |          |   dynamic   |dynamic| +---------------------+----+-----------+----------+-------------+-------+ |CLUSTER              |  id|writeQuorum|readQuorum|   node-1    |node-2 | +---------------------+----+-----------+----------+-------------+-------+ |*                    |    |     1     |    1     |      X      |   o   | |_studio              |  58|     1     |    1     |      o      |   X   | |_studio_1            |  59|     1     |    1     |      o      |   X   | |aclentity            |  33|     1     |    1     |      o      |   X   | |aclentity_1          |  34|     1     |    1     |      o      |   X   | |configurationentry   |  29|     1     |    1     |      o      |   X   | |configurationentry_3 |  32|     1     |    1     |      o      |   X   | |e                    |  13|     1     |    1     |      o      |   X   | |e_1                  |  14|     1     |    1     |      o      |   X   | |extractfilterentity_1|  42|     1     |    1     |      o      |   X   | |extractfilterentity_2|  43|     1     |    1     |      o      |   X   | |favoriteentity       |  45|     1     |    1     |      o      |   X   | |favoriteentity_3     |  48|     1     |    1     |      o      |   X   | |internal             |   0|     1     |    1     |             |       | |odocumentwrapper     |  17|     1     |    1     |      o      |   X   | |odocumentwrapper_2   |  19|     1     |    1     |      o      |   X   | |ofunction_0          |  55|     1     |    1     |      o      |   X   | |orole_0              |  56|     1     |    1     |      o      |   X   | |oschedule_0          |  53|     1     |    1     |      o      |   X   | |osequence_0          |  54|     1     |    1     |      o      |   X   | |ouser_0              |  57|     1     |    1     |      o      |   X   | |principalentity      |  25|     1     |    1     |      o      |   X   | |principalentity_1    |  26|     1     |    1     |      o      |   X   | |roleentity           |  21|     1     |    1     |      o      |   X   | |roleentity_1         |  22|     1     |    1     |      o      |   X   | |rulemodelentity_1    |  38|     1     |    1     |      o      |   X   | |rulemodelentity_3    |  40|     1     |    1     |      o      |   X   | |savedsearchentity    |  49|     1     |    1     |      o      |   X   | |savedsearchentity_3  |  52|     1     |    1     |      o      |   X   | |v                    |   9|     1     |    1     |      o      |   X   | |v_3                  |  12|     1     |    1     |      o      |   X   | +---------------------+----+-----------+----------+-------------+-------+   2017-01-12 16:11:49.597 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=9, source=/127.0.0.1:56078, since=1484230309150] 2017-01-12 16:11:49.613 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedStorage - $ANSI{green {db=mobius}} [node-1] Setting new distributed configuration for database: mobius (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +---------------------+----+-----------+----------+-------------+-------+ |                     |    |           |          |   MASTER    |MASTER | |                     |    |           |          |SYNCHRONIZING|ONLINE | |                     |    |           |          |   dynamic   |dynamic| +---------------------+----+-----------+----------+-------------+-------+ |CLUSTER              |  id|writeQuorum|readQuorum|   node-1    |node-2 | +---------------------+----+-----------+----------+-------------+-------+ |*                    |    |     1     |    1     |      X      |   o   | |_studio              |  58|     1     |    1     |      o      |   X   | |_studio_1            |  59|     1     |    1     |      o      |   X   | |aclentity            |  33|     1     |    1     |      o      |   X   | |aclentity_1          |  34|     1     |    1     |      o      |   X   | |configurationentry   |  29|     1     |    1     |      o      |   X   | |configurationentry_3 |  32|     1     |    1     |      o      |   X   | |e                    |  13|     1     |    1     |      o      |   X   | |e_1                  |  14|     1     |    1     |      o      |   X   | |extractfilterentity_1|  42|     1     |    1     |      o      |   X   | |extractfilterentity_2|  43|     1     |    1     |      o      |   X   | |favoriteentity       |  45|     1     |    1     |      o      |   X   | |favoriteentity_3     |  48|     1     |    1     |      o      |   X   | |internal             |   0|     1     |    1     |             |       | |odocumentwrapper     |  17|     1     |    1     |      o      |   X   | |odocumentwrapper_2   |  19|     1     |    1     |      o      |   X   | |ofunction_0          |  55|     1     |    1     |      o      |   X   | |orole_0              |  56|     1     |    1     |      o      |   X   | |oschedule_0          |  53|     1     |    1     |      o      |   X   | |osequence_0          |  54|     1     |    1     |      o      |   X   | |ouser_0              |  57|     1     |    1     |      o      |   X   | |principalentity      |  25|     1     |    1     |      o      |   X   | |principalentity_1    |  26|     1     |    1     |      o      |   X   | |roleentity           |  21|     1     |    1     |      o      |   X   | |roleentity_1         |  22|     1     |    1     |      o      |   X   | |rulemodelentity_1    |  38|     1     |    1     |      o      |   X   | |rulemodelentity_3    |  40|     1     |    1     |      o      |   X   | |savedsearchentity    |  49|     1     |    1     |      o      |   X   | |savedsearchentity_3  |  52|     1     |    1     |      o      |   X   | |v                    |   9|     1     |    1     |      o      |   X   | |v_3                  |  12|     1     |    1     |      o      |   X   | +---------------------+----+-----------+----------+-------------+-------+   2017-01-12 16:11:49.627 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=10, source=/127.0.0.1:56078, since=1484230309626] 2017-01-12 16:11:50.422 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=10, source=/127.0.0.1:56078, since=1484230309626] 2017-01-12 16:11:50.434 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=11, source=/127.0.0.1:56078, since=1484230310434] 2017-01-12 16:11:50.435 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=11, source=/127.0.0.1:56078, since=1484230310434] 2017-01-12 16:11:50.437 [INFO ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Installed database 'mobius' (LSN=LSN{segment=0, position=86}) 2017-01-12 16:11:50.440 [INFO ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Reassigning ownership of clusters for database mobius... 2017-01-12 16:11:50.455 [INFO ]    [Timer-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Reassignment of clusters for database 'mobius' completed (classes=22) 2017-01-12 16:11:50.456 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Publishing ONLINE status for database node-1.mobius... 2017-01-12 16:11:50.456 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=12, source=/127.0.0.1:56078, since=1484230310456] 2017-01-12 16:11:50.457 [INFO ]    [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:56078)] com.orientechnologies.orient.server.OClientConnectionManager - Remote client connected from: OClientConnection [id=12, source=/127.0.0.1:56078, since=1484230310456] 2017-01-12 16:11:50.459 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Received updated status node-1.mobius=ONLINE 2017-01-12 16:11:50.472 [INFO ]    [hz._hzInstance_1_orientdb.event-1] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin - [node-1] Distributed servers status:  +-------+------+----------------------+-----+---------+----------------+----------------+------------------------+ |Name   |Status|Databases             |Conns|StartedOn|Binary          |HTTP            |UsedMemory              | +-------+------+----------------------+-----+---------+----------------+----------------+------------------------+ |node-1*|ONLINE|mobius=ONLINE (MASTER)|6    |16:08:49 |10.33.77.70:2424|10.33.77.70:2480|911.90MB/3.53GB (25.23%)| |node-2 |ONLINE|mobius=ONLINE (MASTER)|2    |16:11:27 |10.33.77.70:2425|10.33.77.70:2481|748.65MB/3.53GB (20.71%)| +-------+------+----------------------+-----+---------+----------------+----------------+------------------------+  2017-01-12 16:11:50.484 [INFO ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1] Recover complete for database 'mobius'... 2017-01-12 16:11:50.986 [INFO ]    [hz._hzInstance_2_dev.migration] com.hazelcast.internal.partition.impl.MigrationManager:log - [10.129.235.254]:5701 [dev] [3.7.3] Re-partitioning cluster data... Migration queue size: 271 2017-01-12 16:11:52.939 [INFO ]    [hz._hzInstance_2_dev.migration] com.hazelcast.internal.partition.impl.MigrationThread:log - [10.129.235.254]:5701 [dev] [3.7.3] All migration tasks have been completed, queues are empty. 2017-01-12 16:12:10.488 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (20002ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.2 task=heartbeat timestamp: 1484230310486) 2017-01-12 16:12:10.489 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:12:20.797 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10002ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.3 task=heartbeat timestamp: 1484230330795) 2017-01-12 16:12:20.797 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:12:31.113 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10001ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.4 task=heartbeat timestamp: 1484230341112) 2017-01-12 16:12:31.113 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:12:41.432 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10001ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.5 task=heartbeat timestamp: 1484230351431) 2017-01-12 16:12:41.432 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:12:51.736 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10002ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.6 task=heartbeat timestamp: 1484230361734) 2017-01-12 16:12:51.736 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:13:02.047 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10002ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.7 task=heartbeat timestamp: 1484230372045) 2017-01-12 16:13:02.047 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:13:12.364 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10001ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.8 task=heartbeat timestamp: 1484230382363) 2017-01-12 16:13:12.364 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.OClusterHealthChecker - [node-1]-&gt;[node-2] Server 'node-2' did not respond to the heartbeat message (db=mobius, timeout=10000ms), but cannot be set OFFLINE by configuration 2017-01-12 16:13:22.676 [WARN ]    [Timer-1] com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl - [node-1] Timeout (10001ms) on waiting for synchronous responses from nodes=[node-2] responsesSoFar=[] request=(id=0.9 task=heartbeat timestamp: 1484230392675) ``` </body>
		<created>2017-01-12 15:06:58</created>
		<closed>2017-01-25 15:57:20</closed>
	</bug>
	<bug>
		<id>7071</id>
		<title>java.lang.ClassNotFoundException: com.orientechnologies.orient.server.distributed.ODistributedException</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  Exception from the client side: ``` Jan 11, 2017 11:45:47 AM com.orientechnologies.common.log.OLogManager log SEVERE: Error during exception deserialization java.lang.ClassNotFoundException: com.orientechnologies.orient.server.distributed.ODistributedException at java.net.URLClassLoader.findClass(URLClassLoader.java:381) at java.lang.ClassLoader.loadClass(ClassLoader.java:424) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331) at java.lang.ClassLoader.loadClass(ClassLoader.java:357) at java.lang.Class.forName0(Native Method) at java.lang.Class.forName(Class.java:348) at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:628) at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1620) at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1521) at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1781) at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1353) at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2018) at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:503) at java.lang.Throwable.readObject(Throwable.java:914) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1058) at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1909) at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1808) at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1353) at java.io.ObjectInputStream.readObject(ObjectInputStream.java:373) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:429) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:393) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:275) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:167) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2167) at com.orientechnologies.orient.client.remote.OStorageRemote$6.execute(OStorageRemote.java:548) at com.orientechnologies.orient.client.remote.OStorageRemote$6.execute(OStorageRemote.java:542) at com.orientechnologies.orient.client.remote.OStorageRemote$1.execute(OStorageRemote.java:164) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235) at com.orientechnologies.orient.client.remote.OStorageRemote.asyncNetworkOperation(OStorageRemote.java:156) at com.orientechnologies.orient.client.remote.OStorageRemote.createRecord(OStorageRemote.java:528) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2117) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:235) at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:168) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2649) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2583) at OrientTest.lambda$run$0(OrientTest.java:78) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745)  ```  Exception from the server side (node1 only) ``` Error executing request java.lang.NullPointerException at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.waitDistribuedIsOnline(ONetworkProtocolBinary.java:449) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:420) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:303) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  I'm also seeing a lot of these in the node1 logs. ``` 2017-01-11 11:45:47:397 INFO  Local node 'node1' is not the owner for cluster 'Party_node2' (it is 'node2'). Switching to a valid cluster of the same class: 'Party_node2' [ODistributedStorage] 2017-01-11 11:45:47:399 INFO  Local node 'node1' is not the owner for cluster 'Party_node2' (it is 'node2'). Switching to a valid cluster of the same class: 'Party_node3' [ODistributedStorage] 2017-01-11 11:45:48:935 INFO  Local node 'node1' is not the owner for cluster 'Party_node2' (it is 'node2'). Switching to a valid cluster of the same class: 'Party_node3' [ODistributedStorage] 2017-01-11 11:45:48:935 INFO  Local node 'node1' is not the owner for cluster 'Party_node2' (it is 'node2'). Switching to a valid cluster of the same class: 'Party_node1' [ODistributedStorage] 2017-01-11 11:45:48:935 INFO  Local node 'node1' is not the owner for cluster 'Party_node2' (it is 'node2'). Switching to a valid cluster of the same class: 'Party_node2' [ODistributedStorage]  ```  ## Steps to reproduce the problem Three nodes (node1, node2, node3) started in distributed mode, each with the same config as below.  There seems to be an issue with cluster ownership though, despite the config and naming convention of the clusters.  ``` LIST CLUSTERS ... |35  |party_node1|  43|Party    |                 | 5058|   node1    |[node2,node3]|        true        | |36  |party_node2|  44|Party    |                 |    0|   node1    |[node2,node3]|        true        | |37  |party_node3|  51|Party    |                 |    0|   node1    |[node2,node3]|        true        | ... ```   ```         for (int i = 0; i &lt; count; i++) {             completionService.submit(() -&gt; {                 ODatabaseDocumentTx conn = pool.acquire();                 try {                     conn.activateOnCurrentThread();                     ODocument party = new ODocument("Party");                     party.field("name", "Test");                     party.field("type", "TEST");                      String cluster = Thread.currentThread().getId() % 2 == 0 ? "Party_node1" : "Party_node2";                     conn.save(party, cluster);                  } finally {                     conn.close();                 }             }, null);         } ``` ```     "Party_node1": {       "@type": "d",       "@version": 0,       "servers": [         "node1",         "node2",         "node3",         "&lt;NEW_NODE&gt;"       ]     },     "Party_node2": {       "@type": "d",       "@version": 0,       "servers": [         "node2",         "node1",         "node3",         "&lt;NEW_NODE&gt;"       ]     },     "Party_node3": {       "@type": "d",       "@version": 0,       "servers": [         "node3",         "node1",         "node2",         "&lt;NEW_NODE&gt;"       ]     } ```</body>
		<created>2017-01-11 20:03:50</created>
		<closed>2017-02-18 08:21:16</closed>
	</bug>
	<bug>
		<id>7065</id>
		<title>Cannot setDescription while creating class schema</title>
		<body>## OrientDB Version, operating system, or hardware.  - v2.2.14  ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  While creating my classes schema I set the description but I get null if I try to read the description later on.  ## Steps to reproduce the problem  `oClass.setDescription("My Description");`     Debugging OrientDB code seems that you use the wrong command in **OClassImpl** row 694 and 698  `final String cmd = String.format("alter class `%s` description %s", name, shortName);`  **shortName** should be **iDescription**</body>
		<created>2017-01-10 11:21:10</created>
		<closed>2017-12-07 12:55:06</closed>
	</bug>
	<bug>
		<id>7062</id>
		<title>NullPointerException in waitDistribuedIsOnline() for 2.2.14</title>
		<body>## OrientDB Version, operating system, or hardware. 2.2.14  - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [X ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  When using 2.2.14, get a null ptr exception in waitDistribuedIsOnline():  ``` odb-master_1   | Error executing request odb-master_1   | java.lang.NullPointerException odb-master_1   | at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.waitDistribuedIsOnline(ONetworkProtocolBinary.java:449) odb-master_1   | at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeOperationalRequest(ONetworkProtocolBinary.java:420) odb-master_1   | at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:303) odb-master_1   | at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197) odb-master_1   | at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  With basic config: ``` {   "autoDeploy": true,   "executionMode": "undefined",   "readQuorum": 1,   "writeQuorum": 2,   "readYourWrites": true,   "newNodeStrategy": "static",   "servers": {     "*": "master"   },   "clusters": {     "internal": {     },     "index": {     },     "*": {       "servers": ["&lt;NEW_NODE&gt;"]     }   } } ```   If I downgrade to 2.2.13 problem goes away. Seems to be a lot of changes in waitDistribuedIsOnline() for 2.2.14 release in commit: https://github.com/orientechnologies/orientdb/commit/4e731190dd2a6ad8ba1f89d05cbf4cc77edc99ea#diff-2d0549cc3c4950165888be0e16104d5f    ## Steps to reproduce the problem Bring up cluster in distributed mode. Seems to work fine for a min or so. Then error starts appearing. </body>
		<created>2017-01-09 02:33:14</created>
		<closed>2017-01-30 22:14:15</closed>
	</bug>
	<bug>
		<id>7061</id>
		<title>Teleporter [question]: unable to view the imported database in studio</title>
		<body>## OrientDB Version, operating system, or hardware. orientdb-enterprise-2.2.14 [x]  ## Operating System - [x ] MacOSX  ## Steps to reproduce the problem  1. start  the server.sh  2. start the Teleporter (localhost:2480-&gt; Server Management -&gt; Teleporter)  3. populate the fields:     driver: mysql     url: jdbc:mysql://localhost:3306/testdb     username: xxxxx     password: xxxxx     orientdb url: plocal:$ORIENTDB-HOME/databases/testdb  4. click on "test connection"  and it should display "connection is alive"   5. click on "run"  6. result:  &lt;img width="856" alt="screen shot 2017-01-07 at 8 44 26 am" src="https://cloud.githubusercontent.com/assets/1167566/21742478/ab45a7cc-d4b5-11e6-88d3-53666ecbaad3.png"&gt;   ## Expected behavior and actual behavior Teleporter imported the mysql database successfully  Tried to view the imported database in Studio but did not see the imported database option in the dropdown control  ## Question:  How to view the imported database in studio?  ========  Thanks!!!       </body>
		<created>2017-01-07 14:53:01</created>
		<closed>2017-01-11 07:31:21</closed>
	</bug>
	<bug>
		<id>7059</id>
		<title>Error on registering local node on cluster</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ ] Linux  ## Expected behavior and actual behavior  Starting node in cluster for the first time ./dserver.sh (default configuration) ## Steps to reproduce the problem  Error on publishing local server configuration [OHazelcastPlugin]  ``` 2017-01-05 12:35:36:350 SEVER [node1483612532316] Error on publishing local server configuration [OHazelcastPlugin] 2017-01-05 12:35:36:350 SEVER [node1483612532316] Error on registering local node on cluster [OHazelcastPlugin][node1483612532316] Error on starting distributed plugin com.orientechnologies.orient.server.distributed.ODistributedStartupException: Error on registering local node on cluster         at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:213)         at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1242)         at com.orientechnologies.orient.server.OServer.activate(OServer.java:397)         at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) com.orientechnologies.orient.server.distributed.ODistributedStartupException: Error on starting distributed plugin         at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:262)         at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1242)         at com.orientechnologies.orient.server.OServer.activate(OServer.java:397)         at com.orientechnologies.orient.server.OServerMain$1.run(OServerMain.java:46) Caused by: com.orientechnologies.orient.server.distributed.ODistributedStartupException: Error on registering local node on cluster         at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:213)         ... 3 more  Error on publishing local server configuration [OHazelcastPlugin] ```  Any help would be appreciate ! Thanks !   </body>
		<created>2017-01-05 10:39:38</created>
		<closed>2017-01-25 17:45:19</closed>
	</bug>
	<bug>
		<id>7057</id>
		<title>Security Issue: "writer" has no rights to create a class, but can import whole DB</title>
		<body>Pretty strange situation: writer by default can't create a class due to absence of SYSTEM_CLUSTERS permissions, but at the same time he can easily import whole DB. Security Issue? Probably ODatabaseImport class needs more security checks.  ## OrientDB Version, operating system, or hardware. 2.1.19</body>
		<created>2017-01-05 07:07:45</created>
		<closed>2017-01-30 22:52:20</closed>
	</bug>
	<bug>
		<id>7056</id>
		<title>gremlin.sh misses logic to figure out symlinks</title>
		<body>With 2.2.14, the `gremlin.sh` misses logic to resolve `$0` if it is symlinked. Homebrew on OSX symlinks this command, and is broken. </body>
		<created>2017-01-04 14:57:26</created>
		<closed>2017-01-16 08:38:05</closed>
	</bug>
	<bug>
		<id>7055</id>
		<title>Cannot set the root password</title>
		<body>## OrientDB Version, operating system, or hardware.  - v2.2.14, installed via macos homebrew  ## Operating System - [x] MacOSX  ## Expected behavior and actual behavior  After first start I expected to be asked for the root password, but I was not.  ## Steps to reproduce the problem  `$ /usr/local/Cellar/orientdb/2.2.14/bin/orientdb start`  (orientdb starts but doesn't ask for a password)  `$ /usr/local/Cellar/orientdb/2.2.14/bin/orientdb stop`  1. edit `/usr/local/Cellar/orientdb/2.2.14/libexec/config/orientdb-server-config.xml` 2. remove the `&lt;user&gt;` entries 3. set `isAfterFirstTime` to `false` 4. `$ /usr/local/Cellar/orientdb/2.2.14/bin/orientdb start` 5. not asked for password</body>
		<created>2017-01-04 09:05:32</created>
		<closed>2017-01-17 08:30:22</closed>
	</bug>
	<bug>
		<id>7053</id>
		<title>NullPointerException at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.findBucket (OSBTree.java:1754)</title>
		<body>## OrientDB Version, operating system, or hardware. v2.2.14   ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  We do not expect to receive null ptr exceptions.  017-01-03 13:04:38 c.s.a.te [ERROR] null java.lang.NullPointerException: null         at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.findBucket(OSBTree.java:1754)         at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.get(OSBTree.java:200)         at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.get(OSBTreeIndexEngine.java:128)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:1777)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:1766)         at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:56)         at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:40)         at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.get(OIndexAbstractDelegate.java:58)         at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:262)         at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:40)         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertices(OrientBaseGraph.java:813)       ..         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.run(FutureTask.java:266)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)  ## Steps to reproduce the problem </body>
		<created>2017-01-03 13:08:34</created>
		<closed>2017-01-13 14:01:34</closed>
	</bug>
	<bug>
		<id>7052</id>
		<title>Parameter fromInclusive is ignored for iterateEntriesMajor function inside transaction</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .13[X] .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Steps to reproduce the problem In a transaction save some data which will affect an index. Try to the index iterate it with `idx.iterateEntriesMajor(key, false, true)` using the same value as for the saved record as a key.  ## Expected behavior and actual behavior As a result the saved item will be included in the selection ignoring the fact that the second parameter (fromInclusive) is false.  It should not be included since the key is the same.  The problem happens due to the code in OIndexTxAwareMultiValue: ```  public PureTxBetweenIndexForwardCursor(Object fromKey, boolean fromInclusive, Object toKey, boolean toInclusive,         OTransactionIndexChanges indexChanges) {       this.indexChanges = indexChanges;        fromKey = enhanceFromCompositeKeyBetweenAsc(fromKey, fromInclusive);       toKey = enhanceToCompositeKeyBetweenAsc(toKey, toInclusive);        if (toInclusive)         firstKey = indexChanges.getCeilingKey(fromKey);       else         firstKey = indexChanges.getHigherKey(fromKey);        if (fromInclusive)         lastKey = indexChanges.getFloorKey(toKey);       else         lastKey = indexChanges.getLowerKey(toKey);        nextKey = firstKey;     } ``` toInclusive and fromInclusive should be swapped with each other because here toInclusive is applied to fromKey and fromInclusive to toKey. I suppose it should be vice versa.   The same problem is for PureTxBetweenIndexBackwardCursor.</body>
		<created>2017-01-03 00:22:20</created>
		<closed>2017-01-05 07:01:43</closed>
	</bug>
	<bug>
		<id>7048</id>
		<title>ALTER SEQUENCE &lt;seq&gt; START  NOT WORKING </title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ ] Linux   ## Expected behavior and actual behavior select from OSequence should show something like this 0   |#7:1|OSequence|100  |1   |100  |ORDERED|pidseq| the result is that start is set to 0  ## Steps to reproduce the problem create sequence pidseq ordered alter sequence pidseq start 100 increment 1 </body>
		<created>2016-12-29 14:12:09</created>
		<closed>2016-12-29 14:34:14</closed>
	</bug>
	<bug>
		<id>7047</id>
		<title>Server seems deadlock with multiple concurrent binary clients</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [ ] Linux   1. The first problem is similar with #5821. All server connection with binary clients are waiting for lock. With jstack I can't find any deadlock information, but all connection are waiting. So I think it's a deadlock problem.  Jstack information: https://gist.github.com/weixliu/281f154908ed52ba65daa4b82c24db0d  When I encounter this problem, I found that if I continue all the client connection, eventually after a long time [ about 1 hour] I got this information (https://gist.github.com/weixliu/4fb7878fecd237d8c26c7ec98a79c356) in client. Then it seems that some server connection resume runnable.  Finally there exists no useful information in server log , there exists no today or yestoday information in the server log, so I think it's no meaning show the log.  2. Also I have a question, my server start script i set Xmx 10G, but when I using top I found that orientdb consume a lot memory.( top command show it consum 54.6% memory, about 30G+ )I think the memory is too heavy. I don't know whick part apply so much memory( directed Memory config?).  `top command result :  1466 root      20   0 64.6g  34g 1852 S  8.3 54.6 574:28.92 java `   Finally I paste my orientdb config: https://gist.github.com/weixliu/4f884d976dbab2d2bf2d65fdcae676ed </body>
		<created>2016-12-29 03:21:28</created>
		<closed>2017-01-22 17:44:42</closed>
	</bug>
	<bug>
		<id>7045</id>
		<title>Async and nonblocking queries leak connections when upgrading from 2.1.17 to 2.2.14</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14  ## Operating System - [ ] Linux  ## Expected behavior and actual behavior  Orientdb is leaking connections when upgrading from 2.1.17 to 2.2.14. In 2.1.17 we were using Async queries and there was no problem with concurrent connections after upgrading to 2.2.13 and  2.2.14 the application becomes unresponsive after less than an hour.  Please note we are shutting all connections after use with finally {graph.shutdown();} and this was all working perfectly in 2.1.17. The same thing is happening when using non-blocking queries!  This is definitely a show stopper and prevents us from upgrading to 2.2.x  When looking at the orientdb logs at first its empty, even though its not possible to connect to the db, then when trying to connect with orientdb studio below warnings show up.  It seems like it has reached max connections long before its actually showing the warning in the log file, the first warning starts with current=4984 which seems odd. The connections are not released again and the db has to be restarted before it will accept new connections.  2016-12-27 09:20:18:166 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58086 [OServerNetworkListener] 2016-12-27 09:20:18:268 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58087 [OServerNetworkListener] 2016-12-27 09:20:18:371 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58088 [OServerNetworkListener] 2016-12-27 09:20:19:612 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58093 [OServerNetworkListener] 2016-12-27 09:20:19:714 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58092 [OServerNetworkListener] 2016-12-27 09:20:19:962 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58094 [OServerNetworkListener] 2016-12-27 09:20:25:202 WARNI Reached maximum number of concurrent connections (max=1000, current=4984), reject incoming connection from /109.53.171.60:58109 [OServerNetworkListener] 2016-12-27 09:20:55:596 WARNI Reached maximum number of concurrent connections (max=1000, current=4992), reject incoming connection from /109.53.171.60:58170 [OServerNetworkListener]   ## Steps to reproduce the problem Use async or non blocking queries  </body>
		<created>2016-12-27 11:29:15</created>
		<closed>2020-05-26 19:19:30</closed>
	</bug>
	<bug>
		<id>7042</id>
		<title>sun.nio.ch import in artifact orientdb-core</title>
		<body>Hi! I'm using Apache Karaf 4.x as OSGi container with embedded OrientDB. After upgrading from _2.2.13_ to _2.2.14_ now I have the classloader issue associated with package `sun.nio.ch`. This package is declared in `Import-Package` section inside of artifact `orientdb-core-2.2.14` as non-optional. Artifact `orientdb-core-2.2.13` doesn't have this declaration.   Upgrading was important for me due to issue #4439. Of course, I can solve classloading issue using `bootdelegation` concept of Karaf/Felix but this makes my solution unportable to non-Oracle JVM like IBM J9.  Here is the commit 056b4bc30abe1a48b6e1a5f518b7652fbb984c4c with the import of `sun.nio.ch` package.</body>
		<created>2016-12-24 15:36:09</created>
		<closed>2016-12-27 21:21:16</closed>
	</bug>
	<bug>
		<id>7039</id>
		<title>java.lang.IllegalArgumentException: Vertex id can not be null</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior In version 2.2.0 and older, I can query for edge in Graph Editor. The Graph Editor can shows the edge with its in &amp; out vertices. After upgrade to version 2.2.13, the Graph Editor pops up the error, java.lang.IllegalArgumentException: Vertex id can not be null and does not show anything on panel. ## Steps to reproduce the problem To execute `SELECT FROM E`</body>
		<created>2016-12-23 12:21:00</created>
		<closed>2016-12-28 11:59:55</closed>
	</bug>
	<bug>
		<id>7033</id>
		<title>NPE if OFunction name is empty</title>
		<body>## OrientDB Version, operating system, or hardware.  - v2.1.19 - v2.2 - only sources checked - issue exists  ## Expected behavior and actual behavior  OFunction.name property defined without "notNull" flag: https://github.com/orientechnologies/orientdb/blob/862dd179ca269d1f9207e2d401f825dd56682c28/core/src/main/java/com/orientechnologies/orient/core/metadata/function/OFunctionLibraryImpl.java#L121-L127  But that throws NullPointerException here if for some reason user didn't specify name. https://github.com/orientechnologies/orientdb/blob/862dd179ca269d1f9207e2d401f825dd56682c28/core/src/main/java/com/orientechnologies/orient/core/metadata/function/OFunctionLibraryImpl.java#L80  </body>
		<created>2016-12-22 07:08:21</created>
		<closed>2016-12-23 10:14:35</closed>
	</bug>
	<bug>
		<id>7018</id>
		<title>expand(outE()) throws a nullpointer exception in orientdb server side</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [ ] Linux  ## Expected behavior and actual behavior  select expand(outE()) from #38:0 This query used to work in 2.1.17 but not in 2.2.13 It throws the following nullpointer exception   java.lang.NullPointerException at com.tinkerpop.blueprints.impls.orient.OrientEdgeIterator.createGraphElement(OrientEdgeIterator.java:109) at com.tinkerpop.blueprints.impls.orient.OrientEdgeIterator.createGraphElement(OrientEdgeIterator.java:41) at com.orientechnologies.orient.core.iterator.OLazyWrapperIterator.hasNext(OLazyWrapperIterator.java:93) at com.orientechnologies.common.collection.OMultiCollectionIterator.hasNextInternal(OMultiCollectionIterator.java:97) at com.orientechnologies.common.collection.OMultiCollectionIterator.hasNext(OMultiCollectionIterator.java:78) at com.orientechnologies.common.collection.OMultiCollectionIterator.hasNextInternal(OMultiCollectionIterator.java:97) at com.orientechnologies.common.collection.OMultiCollectionIterator.hasNext(OMultiCollectionIterator.java:78) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.getResult(OCommandExecutorSQLResultsetAbstract.java:254) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:495) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2577) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2523) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106) at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:169) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:621) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  </body>
		<created>2016-12-17 17:05:05</created>
		<closed>2017-01-31 10:23:00</closed>
	</bug>
	<bug>
		<id>7016</id>
		<title>List&lt;Object&gt; gets converted to List&lt;ODocument&gt;</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [x] Linux  ## Expected behavior and actual behavior Take a look at this [test](https://github.com/maseev/orient/blob/master/src/test/java/io/github/maseev/OrientDBTest.java#L40). I expect the same collection (the type parameter of this collection was chosen as `java.lang.Object` on purpose) of possessions back when I save my `Person` object to the database. Unfortunately, I get a list of `ODocument` objects instead. Here's another [test](https://github.com/maseev/orient/blob/master/src/test/java/io/github/maseev/OrientDBTest.java#L54) which does absolutely the same but instead of using a list of `java.lang.Object` this list specifies the type parameter as `io.github.maseev.Passenger`. The first test fails when the second one passes successfully.  ## Steps to reproduce the problem Clone this [repo](https://github.com/maseev/orient) and run the tests with `mvn test`.</body>
		<created>2016-12-17 15:07:49</created>
		<closed>2017-11-22 19:23:16</closed>
	</bug>
	<bug>
		<id>7013</id>
		<title>Inserting a vertex or an edge with a property of type double by using SET doesn't work</title>
		<body>## OrientDB Version, operating system, or hardware. v. 2.2.13  ## Operating System - [ ] Windows  ## Expected behavior and actual behavior Error: `java.lang.IllegalArgumentException: Property value can not be null`  ## Steps to reproduce the problem `CREATE EDGE E FROM #21:20 TO #21:22 SET factor = 1e-06` Error: `java.lang.IllegalArgumentException: Property value can not be null`  `CREATE VERTEX V SET factor = 1e-06` -&gt; factor has no value  With the json syntax, it works: ``` CREATE VERTEX V CONTENT { "factor" : 1E-06 } CREATE EDGE E FROM #21:20 TO #21:22  CONTENT {  "factor" : 1E-06 } ```  Note that this means that [OrientDB-NET.binary](https://github.com/orientechnologies/OrientDB-NET.binary) doesn't work either since it doesn't use the json syntax.</body>
		<created>2016-12-16 09:07:55</created>
		<closed>2016-12-28 09:49:35</closed>
	</bug>
	<bug>
		<id>7007</id>
		<title>Offheap memory is leaking</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ x] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [ x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  We are using recommended settings for off-heap storage (-XX:MaxDirectMemorySize=512g) and limit storage.diskCache.bufferSize to 2G  Running jmxterm and querying OByteBufferPoolMXBean  ```  #bean is set to com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean $&gt;get -i * #mbean = com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean: BufferSize = 65536; (BufferSize) AllocatedBufferCount = 23922; (AllocatedBufferCount) OverflowBufferCount = 0; (OverflowBufferCount) BuffersInThePool = 0; (BuffersInThePool) AllocatedMemory = 2147483648; (AllocatedMemory) AllocatedMemoryInMB = 2048; (AllocatedMemoryInMB) AllocatedMemoryInGB = 2.0; (AllocatedMemoryInGB)  ```  Looks reasonable. But looking at the JVM's own view of memory consumption, things do not look so cheerful:  ```  $&gt;bean java.lang:type=Memory #bean is set to java.lang:type=Memory $&gt;get -i *                   #mbean = java.lang:type=Memory: Verbose = false; (Verbose)  ObjectPendingFinalizationCount = 0; (ObjectPendingFinalizationCount)  HeapMemoryUsage = {    committed = 5359796224; (committed)   init = 5368709120; (init)   max = 5359796224; (max)   used = 1782962328; (used)  }; (HeapMemoryUsage)  NonHeapMemoryUsage = {    committed = 2903453696; (committed)   init = 2555904; (init)   max = -1; (max)   used = 1175846984; (used)  }; (NonHeapMemoryUsage)  ObjectName = java.lang:type=Memory; (ObjectName)  ``` Heap memory allocation is stable and obeys the set maximum  ( -Xms5g -Xmx5g ) Committed non-heap memory usage is almost 3G now and is climbing without any limit especially during high write throughput. This eventually leads to system OOM killer just shutting down the process altogether. Sometimes with unfortunate consequences to the integrity of the database. </body>
		<created>2016-12-13 22:55:54</created>
		<closed>2017-01-22 17:45:18</closed>
	</bug>
	<bug>
		<id>6997</id>
		<title>If a Lucene index exists, Parser defaults to Lucene ---- even when the selected index is not Lucene</title>
		<body>Except where specified, we are using com.tinkerpop.blueprints.impls.orient.OrientBaseGraph and associated APIs.   We have a vertex class called Foo, with a single property "value". We have two indexes called Foo.value, and Foo.value_fulltext_lucene. The first is an SBTREE UNIQUE index, and the latter is a LUCENE FULLTEXT index; both have the keyproperty "value". We make a call to OrientBaseGraph.getVertices(final String iKey, Object iValue), with parameters iKey = "Foo.value" and iValue = "blahblah / foobar". (This vertex exists in the DB and can be verified through OrientDB Studio.) The result is unexpected:   Exception in thread "main" com.orientechnologies.orient.core.index.OIndexEngineException: Error parsing lucene query &lt;snip&gt; Caused by: com.orientechnologies.orient.core.sql.parser.ParseException: Cannot parse 'blahblah / foobar': Lexical error at line 1, column 36.  Encountered: &lt;EOF&gt; after : "/ foobar"   It seems like the query value is being treated as a Lucene query, and the parser breaks down because the Lucene regex doesn't have a closing / character. If I properly escape the / character, then nothing "breaks", but it's still being parsed as a Lucene query and returns hundreds of records (instead of the single match). But I don't want to be using a Lucene query here! Any ideas? Is there maybe some setting for the "default index" or "default query parser" on the DB itself?   * If I query a Vertex class/index that does NOT have a Lucene index (e.g. has only the SBTREE UNIQUE index Bar.value) then the query works as expected. In this case, / is not treated as a special Lucene character, it returns a single vertex, etc. * The same (broken) behavior happens if I use OrientBaseGraph.getVertices(final String label, final String[] iKey, Object[] iValue).</body>
		<created>2016-12-12 19:48:58</created>
		<closed>2016-12-13 10:13:51</closed>
	</bug>
	<bug>
		<id>6988</id>
		<title>Schema-based default datetime value with sysdate() throws ClassCastException, if attribute is not specified explicitly</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - Linux  Hi,  Seems like there's a problem with setting a default date through the schema. Consider the following:  ``` create class Test2 extends V  create property Test2.myUuid string alter property Test2.myUuid default uuid()  create property Test2.myDate datetime alter property Test2.myDate default sysdate() ```  Running `insert into Test2 content { }` will throw a `ClassCastException` (no idea why). However, `insert into Test2 content { "myDate": "2016-01-01" }` works very well.   This one might somehow also be related to issue #6978 </body>
		<created>2016-12-09 15:46:31</created>
		<closed>2016-12-14 15:30:54</closed>
	</bug>
	<bug>
		<id>6985</id>
		<title>Error on "delete batch 1000"</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13 SNAPSHOT[* ]   ## Operating System - [ *] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior Run "delete edge tb_edge1 where tag like '%thread-6%' batch 1000",  while responding as below: 2016-12-09 11:35:42:300 SEVER Internal server error: Error parsing query: select from tb_edge1 WHERE   tag LIKE '%thread-6%' BATCH 1000                                                        ^ Encountered " &lt;BATCH&gt; "BATCH "" at line 1, column 52. Was expecting one of:     &lt;EOF&gt;      &lt;AND&gt; ...     &lt;OR&gt; ...     &lt;ORDER&gt; ...     &lt;GROUP&gt; ...     &lt;LIMIT&gt; ...   ## Steps to reproduce the problem </body>
		<created>2016-12-09 03:57:24</created>
		<closed>2016-12-28 09:13:27</closed>
	</bug>
	<bug>
		<id>6984</id>
		<title>Error fetching record java.lang.StringIndexOutOfBoundsException</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12  ## Operating System - [x] Linux - [x] MacOSX  ## Expected behavior and actual behavior  When I go to query for a particular user record I have I get an exception.   ``` Fetching error on record #39:18 java.lang.StringIndexOutOfBoundsException: String index out of range: -60 at java.lang.String.checkBounds(String.java:381) at java.lang.String.&lt;init&gt;(String.java:425) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.stringFromBytes(ORecordSerializerBinaryV0.java:990) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.readString(ORecordSerializerBinaryV0.java:947) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserializeValue(ORecordSerializerBinaryV0.java:406) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.readEmbeddedMap(ORecordSerializerBinaryV0.java:571) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserializeValue(ORecordSerializerBinaryV0.java:467) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.readEmbeddedMap(ORecordSerializerBinaryV0.java:571) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserializeValue(ORecordSerializerBinaryV0.java:467) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.readEmbeddedList(ORecordSerializerBinaryV0.java:648) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserializeValue(ORecordSerializerBinaryV0.java:449) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserializePartial(ORecordSerializerBinaryV0.java:148) at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.fromStream(ORecordSerializerBinary.java:78) at com.orientechnologies.orient.core.record.impl.ODocument.deserializeFields(ODocument.java:1851) at com.orientechnologies.orient.core.record.impl.ODocument.checkForFields(ODocument.java:2625) at com.orientechnologies.orient.core.record.impl.ODocument.rawField(ODocument.java:773) at com.orientechnologies.orient.core.fetch.OFetchHelper.processRecord(OFetchHelper.java:298) at com.orientechnologies.orient.core.fetch.OFetchHelper.fetch(OFetchHelper.java:75) at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerJSON.toString(ORecordSerializerJSON.java:343) at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerStringAbstract.toString(ORecordSerializerStringAbstract.java:664) at com.orientechnologies.orient.core.record.ORecordAbstract.toJSON(ORecordAbstract.java:191) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse.formatMultiValue(OHttpResponse.java:413) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse.writeRecordsOnStream(OHttpResponse.java:362) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse.access$000(OHttpResponse.java:44) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse$2.call(OHttpResponse.java:337) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse$2.call(OHttpResponse.java:332) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse.sendStream(OHttpResponse.java:507) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse.writeRecords(OHttpResponse.java:332) at com.orientechnologies.orient.server.network.protocol.http.OHttpGraphResponse.writeRecords(OHttpGraphResponse.java:59) at com.orientechnologies.orient.server.network.protocol.http.OHttpResponse.writeResult(OHttpResponse.java:229) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:134) at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:168) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:616) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  I'm not sure how to fix this issue. I can't remove the record, update the record or even query the record without getting the above exception.   When I try from the web studio console I get   ``` SEVER Internal server error: java.lang.StringIndexOutOfBoundsException: String index out of range: -60 [ONetworkProtocolHttpDb] WARNI {db=####} Error deserializing record with id #39:18 send this data for debugging: AAh1c2Vy9QEAAAJusQEAAAJvswEAAAJ2tQEAAAJ3twEAAAKAYwAAApplAAACnL0BAAACndkBAAAC38kBAAAC6csBAAA.... ````  I've tried to Base64 decode the data it says for debugging but I can't really make out what it is, It looks like it's binary of some sort.   I'm not sure what the user did to get the data in a bad state like this or how to reproduce the problem. I'm kind of all out of ideas on what to do.   Thanks.     </body>
		<created>2016-12-08 19:41:12</created>
		<closed>2016-12-15 15:00:59</closed>
	</bug>
	<bug>
		<id>6983</id>
		<title>MATCH optimization is broken: MATCH does not work with multiple class: statements</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12  ## Operating System - [ x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  Adding class: qualifiers to the intermediate clauses in the MATCH query should not cause query to return no results.  ## Steps to reproduce the problem  Start with very simple schema with two vertex classes and an edge ```  create class V1 extends V create class V2 extends V create class E1 extends E  create vertex V1 set name = 'foo' create vertex V2 set name = 'bar1' create vertex V2 set name = 'bar2'  create edge E1 from (SELECT FROM V1) to (SELECT FROM V2)  ```  a simple query that roundtrips through E1 works  ```  MATCH { class: V2, as: origin }.in('E1') { as: middle }.out('E1') { as: dest, where: (@rid = $matched.origin.@rid) } RETURN origin, middle, dest  ```  and returns 2 results.  Adding a class specified to the middle clause   ```  MATCH { class: V2, as: origin }.in('E1') {         class: V1, as: middle }.out('E1') { as: dest, where: (@rid = $matched.origin.@rid) } RETURN origin, middle, dest  ```  causes the query to return no results, even through "middle" results from the first query are of class V1. Removing the where: clause from the third clause causes the query to return (unfiltered) results  ```  MATCH { class: V2, as: origin }.in('E1') {         class: V1, as: middle }.out('E1') { as: dest } RETURN origin, middle, dest  ```  And the most interesting thing is that we can make this query to work in a very non-obvious way:   ```  create vertex V1 set name='foo2' create vertex V1 set name='foo3' create vertex V1 set name='foo4'  MATCH { class: V2, as: origin }.in('E1') {         class: V1, as: middle }.out('E1') { as: dest, where: ($matched.origin.@rid = @rid) } RETURN origin, middle, dest  ```  And the query has started to work!  Running with the real data of the similar shape, the warning messages that we get when the query fails indicate that this is caused by the query optimizer starting evaluation from the middle clause. </body>
		<created>2016-12-08 19:30:48</created>
		<closed>2016-12-28 08:06:02</closed>
	</bug>
	<bug>
		<id>6980</id>
		<title>NPE when querying edges through gremlin API, with an index named "notAnOClass.otherStuff"</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.11  ## Operating System - [x ] Linux  ## Expected behavior and actual behavior I run a query on orient-studio with gremlin language : g.E()  Expected :  to see some edges !  Actual : Null Pointer Exception, see stackTrace bellow. It seems that the getIndexedKeys method in stacktrace bellow makes the false assumption that an index named &lt;something&gt;.&lt;otherStuff&gt; should ever mean &lt;something&gt; is a class name... Is it documented somewhere ?  ## Steps to reproduce the problem  Create an index with name "lucene.someClass.someField" go to orient studio and query "g.E()"  ##workaround  Call my index someClass.someField.lucene should work, remains to be tested.  ## Stack trace ``` com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of the GREMLIN script DB name="orient" at com.orientechnologies.orient.graph.gremlin.OGremlinHelper.execute(OGremlinHelper.java:161) at com.orientechnologies.orient.graph.gremlin.OGremlinHelper.execute(OGremlinHelper.java:81) at com.orientechnologies.orient.graph.gremlin.OCommandGremlinExecutor.execute(OCommandGremlinExecutor.java:58) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2672) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2618) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:106) at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:168) at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:616) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.NullPointerException: null at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getIndexedKeys(OrientBaseGraph.java:1744) at com.tinkerpop.blueprints.impls.orient.OrientGraphQuery$OrientGraphQueryIterable.getIndexedKeys(OrientGraphQuery.java:83) at com.tinkerpop.blueprints.util.DefaultGraphQuery$DefaultGraphQueryIterable.getElementIterable(DefaultGraphQuery.java:145) at com.tinkerpop.blueprints.util.DefaultGraphQuery$DefaultGraphQueryIterable.&lt;init&gt;(DefaultGraphQuery.java:82) at com.tinkerpop.blueprints.impls.orient.OrientGraphQuery$OrientGraphQueryIterable.&lt;init&gt;(OrientGraphQuery.java:74) at com.tinkerpop.blueprints.impls.orient.OrientGraphQuery.edges(OrientGraphQuery.java:239) at com.tinkerpop.pipes.transform.GraphQueryPipe.processNextStart(GraphQueryPipe.java:49) at com.tinkerpop.pipes.transform.GraphQueryPipe.processNextStart(GraphQueryPipe.java:17) at com.tinkerpop.pipes.AbstractPipe.hasNext(AbstractPipe.java:98) at com.tinkerpop.pipes.util.Pipeline.hasNext(Pipeline.java:105) at com.orientechnologies.orient.graph.gremlin.OGremlinHelper.execute(OGremlinHelper.java:129) ... 10 common frames omitted  ```</body>
		<created>2016-12-07 18:19:41</created>
		<closed>2016-12-12 11:12:26</closed>
	</bug>
	<bug>
		<id>6979</id>
		<title>Backup with non-tx operation could create an invalid copy of non indexed elements</title>
		<body>This could happen because the indexing is done at DB level, while the backup is at storage level. By testing in HA configuration, the backup could copy records before they are indexed, restoring the database on another server with broken indexes.</body>
		<created>2016-12-07 14:53:56</created>
		<closed>2017-06-22 12:49:59</closed>
	</bug>
	<bug>
		<id>6977</id>
		<title>Export and import with lucene index creates empty index</title>
		<body>The test `LuceneExportImportTest` seems to not index reimported data.</body>
		<created>2016-12-07 10:28:40</created>
		<closed>2016-12-28 14:30:23</closed>
	</bug>
	<bug>
		<id>6963</id>
		<title>Errors when adding edges  using multithread</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13 SNAPSHOT  ## Operating System - [*] Linux  ## Expected behavior and actual behavior  ``` The same record (rid) had different versions on individual nodes as below: **orientdb** {db=test_w}&gt; connect remote:t1s1/test_w root 123456  Disconnecting from the database [test_w]...OK Connecting to database [remote:t1s1/test_w] with user 'root'...OK  CONFIGURED SERVERS +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ |#   |Name    |Status|Connections|StartedOn          |Binary            |HTTP              |UsedMemory       |FreeMemory     |MaxMemory| +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ |0   |govnet02|ONLINE|7          |2016-12-02 17:45:36|192.168.3.202:2424|192.168.3.202:2480|501.40MB (12.51%)|3.43GB (87.49%)|3.92GB   | |1   |govnet03|ONLINE|5          |2016-12-02 17:46:35|192.168.3.203:2424|192.168.3.203:2480|477.22MB (11.97%)|3.43GB (88.03%)|3.89GB   | |2   |govnet01|ONLINE|6          |2016-12-02 17:45:17|192.168.3.201:2424|192.168.3.201:2480|1.05GB (27.00%)  |2.84GB (73.00%)|3.89GB   | +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ **orientdb** {db=test_w}&gt; select *, @version from #116:428        +----+--------+--------------+-----------+----+---------------+-------+ |#   |@RID    |@CLASS        |in_tb_edge1|uid |uname          |version| +----+--------+--------------+-----------+----+---------------+-------+ |0   |#116:428|tb_multithread|[]         |990 |pool-1-thread-1|33     | +----+--------+--------------+-----------+----+---------------+-------+  1 item(s) found. Query executed in 0.002 sec(s).  **orientdb** {db=test_w}&gt; connect remote:t1s2/test_w root 123456  Disconnecting from the database [test_w]...OK Connecting to database [remote:t1s2/test_w] with user 'root'...OK  CONFIGURED SERVERS +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ |#   |Name    |Status|Connections|StartedOn          |Binary            |HTTP              |UsedMemory       |FreeMemory     |MaxMemory| +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ |0   |govnet02|ONLINE|7          |2016-12-02 17:45:36|192.168.3.202:2424|192.168.3.202:2480|513.02MB (12.80%)|3.41GB (87.20%)|3.92GB   | |1   |govnet03|ONLINE|5          |2016-12-02 17:46:35|192.168.3.203:2424|192.168.3.203:2480|480.41MB (12.05%)|3.42GB (87.95%)|3.89GB   | |2   |govnet01|ONLINE|6          |2016-12-02 17:45:17|192.168.3.201:2424|192.168.3.201:2480|1.06GB (27.12%)  |2.84GB (72.88%)|3.89GB   | +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ **orientdb** {db=test_w}&gt; select *, @version from #116:428        +----+--------+--------------+-----------+----+---------------+-------+ |#   |@RID    |@CLASS        |in_tb_edge1|uid |uname          |version| +----+--------+--------------+-----------+----+---------------+-------+ |0   |#116:428|tb_multithread|[]         |990 |pool-1-thread-1|33     | +----+--------+--------------+-----------+----+---------------+-------+  1 item(s) found. Query executed in 0.003 sec(s).   **orientdb** {db=test_w}&gt; connect remote:t1s3/test_w root 123456  Disconnecting from the database [test_w]...OK Connecting to database [remote:t1s3/test_w] with user 'root'...OK  CONFIGURED SERVERS +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ |#   |Name    |Status|Connections|StartedOn          |Binary            |HTTP              |UsedMemory       |FreeMemory     |MaxMemory| +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ |0   |govnet02|ONLINE|8          |2016-12-02 17:45:36|192.168.3.202:2424|192.168.3.202:2480|522.10MB (13.02%)|3.41GB (86.98%)|3.92GB   | |1   |govnet03|ONLINE|5          |2016-12-02 17:46:35|192.168.3.203:2424|192.168.3.203:2480|490.20MB (12.29%)|3.42GB (87.71%)|3.89GB   | |2   |govnet01|ONLINE|5          |2016-12-02 17:45:17|192.168.3.201:2424|192.168.3.201:2480|1.06GB (27.29%)  |2.83GB (72.71%)|3.89GB   | +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+---------------+---------+ **orientdb** {db=test_w}&gt; select *, @version from #116:428        +----+--------+--------------+-----------+----+---------------+-------+ |#   |@RID    |@CLASS        |in_tb_edge1|uid |uname          |version| +----+--------+--------------+-----------+----+---------------+-------+ |0   |#116:428|tb_multithread|[]         |990 |pool-1-thread-1|13     | +----+--------+--------------+-----------+----+---------------+-------+  1 item(s) found. Query executed in 0.004 sec(s). ```  **orientdb.err on node govnet03**  ``` 2016-12-03 11:30:32:380 WARNI [govnet03]-&gt;[govnet01] Sending undo message (tx-completed origReqId: 2.156164 type: fix (3 ops) [[fix_record_update(#122:102 v.1 realV.-2147483647), fix_record_update(#121:0 v.191 realV.-2147483457), fix_record_create(#90:642)]]) for request (id=2.156164 task=tx) to server govnet01 [ODistributedResponseManager] 2016-12-03 11:30:32:501 WARNI [govnet03]-&gt;[govnet01] Received response from undo message (tx-completed origReqId: 2.156164 type: fix (3 ops) [[fix_record_update(#122:102 v.1 realV.-2147483647), fix_record_update(#121:0 v.191 realV.-2147483457), fix_record_create(#90:642)]]) for request (id=2.156164 task=tx) to server govnet01: result [ODistributedResponseManager] 2016-12-03 11:30:38:867 INFO  [govnet03]&lt;-[govnet02] Error on auto repairing record #89:638 on servers govnet02 (error=com.orientechnologies.orient.server.distributed.task.ODistributedRecordLockedException: Timeout (900ms) on acquiring lock on record #116:428. It is locked by request 1.150669 DB name="test_w") [OConflictResolverDatabaseRepairer] 2016-12-03 11:30:47:409 WARNI [govnet03]-&gt;[govnet02] Sending undo message (tx-completed origReqId: 2.156215 type: fix (3 ops) [[fix_record_update(#106:129 v.1 realV.-2147483647), fix_record_update(#115:128 v.1 realV.-2147483647), fix_record_create(#89:643)]]) for request (id=2.156215 task=tx) to server govnet02 [ODistributedResponseManager] 2016-12-03 11:30:47:709 WARNI [govnet03]-&gt;[govnet02] Sending undo message (tx-completed origReqId: 2.156217 type: fix (3 ops) [[fix_record_update(#122:128 v.1 realV.-2147483647), fix_record_update(#121:0 v.191 realV.-2147483457), fix_record_create(#90:645)]]) for request (id=2.156217 task=tx) to server govnet02 [ODistributedResponseManager] 2016-12-03 11:30:48:011 WARNI [govnet03]-&gt;[govnet02] Received response from undo message (tx-completed origReqId: 2.156215 type: fix (3 ops) [[fix_record_update(#106:129 v.1 realV.-2147483647), fix_record_update(#115:128 v.1 realV.-2147483647), fix_record_create(#89:643)]]) for request (id=2.156215 task=tx) to server govnet02: result [ODistributedResponseManager] 2016-12-03 11:30:48:012 WARNI [govnet03]-&gt;[govnet02] Received response from undo message (tx-completed origReqId: 2.156217 type: fix (3 ops) [[fix_record_update(#122:128 v.1 realV.-2147483647), fix_record_update(#121:0 v.191 realV.-2147483457), fix_record_create(#90:645)]]) for request (id=2.156217 task=tx) to server govnet02: result [ODistributedResponseManager] 2016-12-03 11:30:49:614 INFO  [govnet03]-&gt;[[govnet02, govnet01, govnet03]] Auto repairing completed. Sent 2 fix messages for 17 records (reqId=2.156225) [OConflictResolverDatabaseRepairer] ```  ## Steps to reproduce the problem  **config/default-distributed-db-config.json**  ```json {   "autoDeploy": true,   "readQuorum": 1,   "writeQuorum": "all",   "executionMode": "synchronous",   "readYourWrites": false,   "newNodeStrategy": "dynamic",   "servers": {     "*": "master"   },   "clusters": {     "internal": {     },     "*": {       "servers": ["&lt;NEW_NODE&gt;"]     }   } } ```  **databases/test_w/distributed-config.json**   ```json {"@type":"d","@version":0,"autoDeploy":true,"readQuorum":1,"writeQuorum":"all","executionMode":"synchronous","readYourWrites":false,"newNodeStrategy":"dynamic","servers":{"@type":"d","@version":0,"*":"master"},"clusters":{"@type":"d","@version":0,"internal":{"@type":"d","@version":0},"*":{"@type":"d","@version":0,"servers":["govnet02","govnet03","govnet01","&lt;NEW_NODE&gt;"]},"orole_0":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"orole_1":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"ofunction_0":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"ofunction_1":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"osequence_0":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"osequence_1":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"oschedule_0":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"oschedule_1":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_2":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_7":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_8":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_5":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_6":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_17":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_16":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_15":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"v_14":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_22":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_13":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_12":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_21":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_11":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_10":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"v_23":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"ouser_0":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"ouser_1":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_18":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_17":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_19":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_8":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_15":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_20":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_16":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_21":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_22":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_13":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_23":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_14":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"e_11":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_12":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_1":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"e_10":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_18":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_19":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_16":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_17":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_14":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_15":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_2":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_1":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_multithread_4":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_3":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_6":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_22":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_13":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_5":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_12":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_multithread_21":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_edge1_10":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_edge1_9":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_edge1_8":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_edge1":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_edge1_5":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_edge1_4":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_edge1_7":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_edge1_6":{"@type":"d","@version":0,"servers":["govnet03","govnet02","govnet01","&lt;NEW_NODE&gt;"]},"tb_vertex2":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_vertex2_4":{"@type":"d","@version":0,"servers":["govnet01","govnet02","govnet03","&lt;NEW_NODE&gt;"]},"tb_vertex2_3":{"@ ```  **bin/server.sh** ``` ORIENTDB_SETTINGS="-Dstorage.diskCache.bufferSize=8192 -DridBag.embeddedToSbtreeBonsaiThreshold=2147483647" ```  **java code**  ```java initiate OrientGraph &amp; ExecutorService : OGlobalConfiguration.RID_BAG_EMBEDDED_TO_SBTREEBONSAI_THRESHOLD.setValue(Integer.MAX_VALUE); OGlobalConfiguration.SQL_GRAPH_CONSISTENCY_MODE.setValue("tx"); threadspool.submit(new GraphClientEdge(new OrientGraph(sconn, user, pwd)));  implement Runnable: String bsql = "create edge tb_edge1 from " +         "(select from tb_multithread where uid="+ (lseq) + ") to " +         "(select from tb_multithread where uid="+ (lseq+lrandom) + ") set " +         "tag ='" + Thread.currentThread().getName() + System.currentTimeMillis() +"' " +         "retry 20 wait 1000\n"; getGraph.command(new OCommandSQL(bsql)).execute(); getGraph.commit(); ```  </body>
		<created>2016-12-03 06:43:37</created>
		<closed>2017-01-30 22:07:16</closed>
	</bug>
	<bug>
		<id>6962</id>
		<title>Logging as java.util.Class</title>
		<body>## OrientDB Version, operating system, or hardware. 2.2.12  ## Operating System all  ## Expected behavior and actual behavior Our logs are spammed with following: `2016-12-01 16:41:27,502 [DefaultExecutorService-1] 478278 WARN  java.lang.Class - MaxDirectMemorySize JVM option is not set or has invalid value, that may cause out of memory errors. Please set the -XX:MaxDirectMemorySize=16068m option when you start the JVM.`  **We can't increase logger level for this one because Orient logs this as "java.util.Class"** The bug is in OMemory:128: `OLogManager.instance().warn(OMemory.class, "..."` instead of probably: `OLogManager.instance().warn(null, "..."`  ## Steps to reproduce the problem Startup any database with global log level set to WARN</body>
		<created>2016-12-02 04:45:24</created>
		<closed>2016-12-27 14:15:47</closed>
	</bug>
	<bug>
		<id>6959</id>
		<title>Query defaults to LUCENE parsing when lucene index is available</title>
		<body>## OrientDB Version, operating system, or hardware. - [x] v2.2.4  ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior Except where specified, we are using com.tinkerpop.blueprints.impls.orient.OrientBaseGraph and associated APIs.  We have a vertex class called Foo, with a single property "value". We have two indexes called Foo.value, and Foo.value_fulltext_lucene. The first is an SBTREE UNIQUE index, and the latter is a LUCENE FULLTEXT index; both have the keyproperty "value". We make a call to `OrientBaseGraph.getVertices(final String iKey, Object iValue)`, with parameters `iKey = "Foo.value"` `and iValue = "blahblah / foobar"`. (This vertex exists in the DB and can be verified through OrientDB Studio.)  **Expected behavior:** Returns 1 vertex  **Actual Behavior:** ``` Exception in thread "main" com.orientechnologies.orient.core.index.OIndexEngineException: Error parsing lucene query &lt;full traceback snipped&gt; Caused by: com.orientechnologies.orient.core.sql.parser.ParseException: Cannot parse 'blahblah / foobar': Lexical error at line 1, column 36.  Encountered: &lt;EOF&gt; after : "/ foobar" ```  **Comments:** It seems like the query value is being treated as a Lucene query, and the parser breaks down because the Lucene regex doesn't have a closing / character. If I properly escape the / character, then nothing "breaks", but it's still being parsed as a Lucene query and returns hundreds of records. But I don't want to be using a Lucene query here! Any ideas?  * If I query a Vertex class/index that does NOT have a Lucene index (e.g. has only the SBTREE UNIQUE index Bar.value) then the query works as expected. In this case, / is not treated as a special Lucene character, it returns a single vertex, etc. * The same (broken) behavior happens if I use OrientBaseGraph.getVertices(final String label, final String[] iKey, Object[] iValue).</body>
		<created>2016-12-01 19:51:21</created>
		<closed>2016-12-13 15:25:50</closed>
	</bug>
	<bug>
		<id>6958</id>
		<title>DeadLock When insert massive graph record</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [ ] Linux  ## actual behavior I insert massive record from 172.16.124.9 with multi-thread, When I can't insert record any more, I try to request studio from 172.23.4.15 and I can't get any information. So I use jstack get orientdb thread dump. It said there exists a deadlock. I think before I request studio the deadlock has already generated, because I can't insert any data any more. Want help why deadlock?  ## thread dump https://gist.github.com/laa/fd542c08b796f9221a1f4a01c78224c9</body>
		<created>2016-12-01 16:08:05</created>
		<closed>2016-12-07 06:52:26</closed>
	</bug>
	<bug>
		<id>6957</id>
		<title>DROP CLASS IF EXISTS throws error on nonexistent class</title>
		<body>## OrientDB Version, operating system, or hardware. OrientDB Server v2.2.13 (build 2.2.x@r90d7caa1e4af3fad86594e592c64dc1202558ab1; 2016-11-15 12:04:05+0000)  ## Operating System - [ ] Linux - [ ] MacOSX - [X] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior _Expected:_ no action. _Actual:_ error: Error: java.lang.IllegalArgumentException: Class 'NonExistentClass' not found in database  ## Steps to reproduce the problem Try to DROP nonexistent class.  Command: DROP CLASS NonExistentClass IF EXISTS  See issue #3597.  "CREATE CLASS ExistentClass IF NOT EXISTS" works as expected - does nothing and generates no error.</body>
		<created>2016-12-01 13:11:08</created>
		<closed>2016-12-28 10:25:38</closed>
	</bug>
	<bug>
		<id>6956</id>
		<title>Property name starting with a number can be created but not deleted again</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [ ] Linux  ## Expected behavior and actual behavior Its possible to create a property with a name starting with a number but its not possible to delete it again using java api or studio  ## Steps to reproduce the problem  Create a property: database.getVertexType("Prod").createProperty("1234something", OType.STRING);  try to delete property: OrientVertexType ovtype = database.getVertexType("Prod"); ovtype.dropProperty("1234something");  Stacktrace: Exception in thread "main" com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: drop property Prod.1234something    ^ Encountered " &lt;DROP&gt; "drop "" at line 1, column 1. Was expecting one of:     &lt;SELECT&gt; ...     &lt;TRAVERSE&gt; ...     &lt;MATCH&gt; ...     &lt;INSERT&gt; ...     &lt;RETURN&gt; ...     &lt;PROFILE&gt; ...     &lt;FIND&gt; ...     &lt;REBUILD&gt; ...     &lt;OPTIMIZE&gt; ...     &lt;GRANT&gt; ...     &lt;REVOKE&gt; ...     &lt;BEGIN&gt; ...     &lt;COMMIT&gt; ...     &lt;ROLLBACK&gt; ...     &lt;IF&gt; ...     &lt;SLEEP&gt; ...     &lt;CONSOLE&gt; ...      at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:422) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:437) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:388) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:270) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:162) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2167) at com.orientechnologies.orient.client.remote.OStorageRemote$27.execute(OStorageRemote.java:1160) at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:196) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetry(OStorageRemote.java:193) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:204) at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1136) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.core.metadata.schema.OClassImpl.dropProperty(OClassImpl.java:878) at com.orientechnologies.orient.core.metadata.schema.OClassAbstractDelegate.dropProperty(OClassAbstractDelegate.java:190)  </body>
		<created>2016-12-01 09:47:48</created>
		<closed>2016-12-28 11:02:06</closed>
	</bug>
	<bug>
		<id>6954</id>
		<title>ONestedRollbackException Issue</title>
		<body> We are facing the following issue when I run SQL to create Edge "CREATE EDGE inquiry FROM #29:5093 TO #25:17741 SET when = date()". Please help to solve it.  https://gist.github.com/heleyboo/6e94d7f87526ed9a81562fab71c862f3  ## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[x] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  ## Steps to reproduce the problem </body>
		<created>2016-11-30 09:58:32</created>
		<closed>2017-01-19 11:34:22</closed>
	</bug>
	<bug>
		<id>6953</id>
		<title>Adding index on string field breaks CONTAINS operator</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .12[x] .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior Expected: adding an index on a field should not change the returned results.  Actual: adding an index on a string field makes the `CONTAINS` operator ignore fields that should match it.  ## Steps to reproduce the problem ``` CREATE CLASS Foo EXTENDS V CREATE PROPERTY Foo.name String  CREATE VERTEX Foo SET name = 'foo'  // Both of the following queries should (and do) return the above Foo vertex. SELECT * FROM Foo WHERE name IN ['foo', 'bar'] SELECT * FROM Foo WHERE ['foo', 'bar'] CONTAINS name  // Let's create the index. CREATE INDEX Foo.name UNIQUE_HASH_INDEX  // Now, only the first query returns the correct result. // The second query returns no results. SELECT * FROM Foo WHERE name IN ['foo', 'bar'] SELECT * FROM Foo WHERE ['foo', 'bar'] CONTAINS name ```  </body>
		<created>2016-11-28 22:36:14</created>
		<closed>2016-11-30 10:16:35</closed>
	</bug>
	<bug>
		<id>6948</id>
		<title>drop index, create it, says that index already exists</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.14-SNAPSHOT-20161118.121331-4  ## Operating System - [x] Linux  ## Expected behavior and actual behavior  1. started the non-distributed mode of the server, and login via "console.sh" 2. I drop an index 3. I create it again but with different columns 4. at the end, the logs say that index is properly created: ``` 2016-11-25 12:41:48:422 INFO  {db=cdrarch} --&gt; OK, indexed 38,150,465 items in 9,770,022 ms [OIndexRebuildOutputListener] ``` 5. in console, the command terminates with ``` orientdb {db=cdrarch}&gt; drop index idx_cdr_icx_20161113_0                                                                Removing index... Dropped index in 4.377000 sec(s). Index removed successfully orientdb {db=cdrarch}&gt; create index idx_cdr_icx_20161113_0 on cdr_icx_20161113(ENV,PRT_DATE,FILENAME,RECORD_NUMBER) UNIQUE Creating index... Error: com.orientechnologies.orient.core.index.OIndexException: Index with name idx_cdr_icx_20161113_0 already exists.         DB name="cdrarch"         DB name="cdrarch" ``` 6. if I ask status of the index in console, it say that it do not exist?! ``` orientdb {db=cdrarch}&gt; desc cdr_icx_20161113 ... INDEXES (1 altogether) +----+----------------------+----------+ |#   |NAME                  |PROPERTIES| +----+----------------------+----------+ |0   |idx_cdr_icx_20161113_1|[FILENAME]| +----+----------------------+----------+ ```</body>
		<created>2016-11-25 12:02:17</created>
		<closed>2017-01-30 21:30:02</closed>
	</bug>
	<bug>
		<id>6947</id>
		<title>Can't parse valid JSON in SQL requests</title>
		<body>## OrientDB Version, operating system, or hardware. - [x] orientdb-enterprise-2.2.12  ## Operating System - [x] Linux (Ubuntu 14.04.3 LTS)  Tested in studio and PhpOrient  ## Expected behavior and actual behavior I try migrate data from mysql to orientdb and take some bugs parsing JSON in SQL commands. I think that it's valid requests, but db can not parsing data.  ## Steps to reproduce the problem  ### the first bug ``` INSERT INTO `DealComplex` (deals) VALUES ( [{ "goods":[{     "GoodsDescription":" \" coma--&gt;,&lt;-- coma  \" ", "@class":"Goods","@type":"d"} ], "@class":"Deal","@type":"d"} ] ) ``` only paste comma inside `\" \"` db return error:  &gt; Map found but entries are not defined as &lt;key&gt;:&lt;value&gt; DB name="dt"  ### the second bug: again comma, but some other behavior ``` INSERT INTO `DealComplex` (contract) VALUES ({     "ContractSubject":" \" \/ \u0443, ", "@class":"Contract","@type":"d"} ) ``` add comma after this combination `\" \/` strings variations: `\" \u0443 \/ \u0443,` `\u0443 \" \u0443 \/ \u0443,`  DB return error:  &gt; com.orientechnologies.orient.core.exception.OCommandExecutionException: expression item '' cannot be resolved because current record is NULL DB name="dt"  ### the third bug (or not) MySQL store empty(not null) date in the follow format `0000-00-00` and when execute sql `INSERT INTO c_document (PI_RegID) VALUES ('0000-00-00')` I took error that it's wrong format:  &gt; Error on conversion of date '0000-00-00' using the format: yyyy-MM-dd DB name="dt"  I think that it's can be valid format. </body>
		<created>2016-11-25 05:29:01</created>
		<closed>2016-11-30 11:13:28</closed>
	</bug>
	<bug>
		<id>6946</id>
		<title>Delete vertex and update queries not working in  OSQLNonBlockingQuery</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [ ] Linux  ## Expected behavior and actual behavior When running code for delete vertex the data is deleted in the db correctly but the response is throwing an exception (see below) and also the 'void end()' method is called twice and the 'boolean result(Object iRecord)' method is not called.  The same is happening when doing an update query.  In end() In end() Exception in thread "Thread-3" com.orientechnologies.orient.enterprise.channel.binary.OResponseProcessingException: Exception during response processing at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:453) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:388) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:270) at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:162) at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2167) at com.orientechnologies.orient.client.remote.OStorageRemote$27.execute(OStorageRemote.java:1160) at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:196) at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetry(OStorageRemote.java:193) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:204) at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1136) at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78) at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.yodenote.common.server.db.OSQLNonBlockingQuery2$1.run(OSQLNonBlockingQuery.java:284) at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.ClassCastException: java.lang.Integer cannot be cast to java.util.List at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78) at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1446) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:577) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:322) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:198) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  ## Steps to reproduce the problem ``` OrientGraph database = new OrientGraph(DBUtil.CONNECTION_URL + "mxi2"); //    database.createVertexType("Prod").createProperty("something", OType.STRING); //    for (int i = 0; i &lt; 21; i++) { //      OrientVertex vertex = database.addVertex("class:Prod"); //      vertex.setProperty("something", "value"); //      vertex.save(); //    } //    database.commit();     try {       OSQLNonBlockingQuery&lt;Object&gt; test = new OSQLNonBlockingQuery&lt;Object&gt;("Delete vertex Prod limit 1", new OCommandResultListener() {         int resultCount = 0;          @Override         public boolean result(Object iRecord) {           resultCount++;            System.out.println("In result()");                      return resultCount &gt; 1 ? false : true;         }          @Override         public void end() {         System.out.println("In end()");         }          @Override         public Object getResult() {           return resultCount;         }       });       database.command(test).execute();  ```</body>
		<created>2016-11-24 19:16:19</created>
		<closed>2016-12-15 14:48:37</closed>
	</bug>
	<bug>
		<id>6945</id>
		<title>OStorageException "Cannot route COMMAND operation to the distributed node" with empty result sets</title>
		<body>## OrientDB Version, operating system, or hardware. - [X] v2.2.13  ## Operating System - [X] Linux  ## Expected behavior and actual behavior Same bug fixed in issue #6685 ... but it happen also with list() and set(), not only average.  ## Steps to reproduce the problem ``` orientdb {db=dlmcom}&gt; select count(login) from ppto_user where login = 'a'         +----+-----+ |#   |count| +----+-----+ |0   |0    | +----+-----+  1 item(s) found. Query executed in 0.001 sec(s).   orientdb {db=dlmcom}&gt; select set(login) from ppto_user where login = 'a'    Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot route COMMAND operation to the distributed node         DB name="dlmcom"         DB name="dlmcom"  Error: java.lang.IndexOutOfBoundsException: Index: 0, Size: 0   orientdb {db=dlmcom}&gt; select list(login) from ppto_user where login = 'a'  Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot route COMMAND operation to the distributed node         DB name="dlmcom"         DB name="dlmcom"  Error: java.lang.IndexOutOfBoundsException: Index: 0, Size: 0```</body>
		<created>2016-11-24 16:43:15</created>
		<closed>2016-11-25 11:43:55</closed>
	</bug>
	<bug>
		<id>6934</id>
		<title>Empty stopwords are not allowed</title>
		<body>A conf like that: ``` ...   "author_query": "org.apache.lucene.analysis.standrad.StandardAnalyzer",   "author_query_stopwords": [], ... ``` throw exceptions</body>
		<created>2016-11-21 14:45:58</created>
		<closed>2016-11-21 14:54:59</closed>
	</bug>
	<bug>
		<id>6931</id>
		<title>MATCH bug in location existence check</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .13[x] .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior Expected: If a traversal location named `baz` exists in the output, then checking `$matched.baz IS null` should be false in the MATCH query.  Actual: See below for an instance where data is returned for a location named `baz`, and yet the query evaluates `$matched.baz IS null` as `true`.  ## Steps to reproduce the problem ### Here's what the formed structure looks like: ``` Foo ==&gt; Bar ==&gt; Baz   \    \=&gt; Far ```  ### Setup: ``` CREATE CLASS Foo EXTENDS V CREATE CLASS Bar EXTENDS V CREATE CLASS Baz EXTENDS V CREATE CLASS Far EXTENDS V CREATE CLASS Foo_Bar EXTENDS E CREATE CLASS Bar_Baz EXTENDS E CREATE CLASS Foo_Far EXTENDS E  CREATE VERTEX Foo SET name = 'foo' CREATE VERTEX Bar SET name = 'bar' CREATE VERTEX Baz SET name = 'baz' CREATE VERTEX Far SET name = 'far'  CREATE EDGE Foo_Bar FROM (SELECT FROM Foo) TO (SELECT FROM Bar) CREATE EDGE Bar_Baz FROM (SELECT FROM Bar) TO (SELECT FROM Baz) CREATE EDGE Foo_Far FROM (SELECT FROM Foo) TO (SELECT FROM Far) ```  ### Problematic queries: - `baz` must always exist because it's not optional ``` MATCH {     class: Foo,     as: foo }.out('Foo_Bar') {     as: bar }, {     class: Bar,     as: bar }.out('Bar_Baz') {     as: baz }, {     class: Foo,     as: foo }.out('Foo_Far') {     where: ($matched.baz IS null),     as: far } RETURN $matches  // returns: // +----+-----+-----+-----+-----+ // |#   |foo  |bar  |far  |baz  | // +----+-----+-----+-----+-----+ // |0   |#11:0|#12:0|#14:0|#13:0| // +----+-----+-----+-----+-----+ //  // Note the existence of a result for "baz". ```  - `baz` might not exist because now it's optional ``` MATCH {     class: Foo,     as: foo }.out('Foo_Bar') {     as: bar }, {     class: Bar,     as: bar }.out('Bar_Baz') {     optional: true,     as: baz }, {     class: Foo,     as: foo }.out('Foo_Far') {     where: ($matched.baz IS null),     as: far } RETURN $matches  // returns: // +----+-----+-----+-----+-----+ // |#   |foo  |bar  |far  |baz  | // +----+-----+-----+-----+-----+ // |0   |#11:0|#12:0|#14:0|#13:0| // +----+-----+-----+-----+-----+ //  // Note the existence of a result for "baz". ```  This is extremely frustrating, I was hoping that your tests would have caught and prevented such a simple bug from making it into a release. This entire feature is broken at the moment.</body>
		<created>2016-11-18 18:55:05</created>
		<closed>2016-12-22 15:16:04</closed>
	</bug>
	<bug>
		<id>6930</id>
		<title>Verbose SQL CREATE EDGE(console.sh)</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13  ## Operating System - [ x] Linux  ## Expected behavior and  Created edge &lt;whatever&gt; ...  ##Actual behavior console.sh running osql-script which shows like in "debug mode". Created edge 'com.orientechnologies.orient.core.sql.query.OBasicResultSet@111d' in 0.003000 sec(s).  ## Steps to reproduce the problem run a script by console.sh that creates an edge like; create edge &lt;whatever&gt; from (select ..) to (select ..)</body>
		<created>2016-11-18 18:44:05</created>
		<closed>2016-11-21 14:39:33</closed>
	</bug>
	<bug>
		<id>6920</id>
		<title>percentile() returns same result for all percentages</title>
		<body>## OrientDB Version, operating system, or hardware.  - v2.2 SNAPSHOT[13 ]   ## Operating System - [x ] Linux  ## Expected behavior  sensible data! ## Actual behavior select percentile(samples,nn) from whatever ## Steps to reproduce the problem Insert 255, 168, 125, 11102, 59, 120, 500, 2, 98, 25 these values into some class as floats, and run select percentile(samples,90) from "whatever".   even try 50 or any value - percentile returns the same value, 11102.0!  By the way, median() does it correctly, i.e. returns 122.5 </body>
		<created>2016-11-16 10:11:33</created>
		<closed>2016-12-13 11:43:53</closed>
	</bug>
	<bug>
		<id>6917</id>
		<title>OStorageException: Error on creation of shared resource NullPointerException: Name is null</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[x] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [x] Other, name? - Docker  ## Expected behavior and actual behavior The database can't be opened. ## Steps to reproduce the problem I'm not sure how to reproduce the problem. I describe my guesswork. I've created a sequence that is used to generate uniq Ids for my entities. At some point orient started to log errors on sequence.next() (null.next() error). After these when I shutdown the orient. I can't connect to this database.   The error log says ``` 2016-11-16 07:39:50:870 SEVER Internal server error: com.orientechnologies.orient.core.exception.OStorageException: Error on creation of shared resource         DB name="test_rsm_service" --&gt; java.lang.NullPointerException: Name is null [ONetworkProtocolHttpDb] ``` The problem is that I can't even delete database got making import/export.  I used v.2.2.2. For the sequence error problem I've found a similar issue #6842 that is closed in 2.2.13 that is potential solve issue in future. But the database not opening now. [test_rsm_service.zip](https://github.com/orientechnologies/orientdb/files/594051/test_rsm_service.zip) </body>
		<created>2016-11-16 08:36:34</created>
		<closed>2017-08-21 14:31:52</closed>
	</bug>
	<bug>
		<id>6916</id>
		<title>Most basic distributed configuration not working.</title>
		<body>## OrientDB Version, operating system, or hardware. - v3.0.0 SNAPSHOT  ## Operating System - Windows - Mac OS/X Sierra  ## Expected behavior and actual behavior Have been trying for hours to get the most basic 2 node distributed database cluster working with TCP-IP not MULTICAST.  It continues to timeout waiting for the other node. This is when running (in a test environment) on the same development machine but with different ports. They seem to connect with each other,  This problem seems to have been around for a while and is dismissed regularly and marked as resolved. Whereas everyone starting out seems to be getting this issue. It would be nice if the OrientDB team took it seriously and put together a &lt;b&gt;proper&lt;/b&gt; tutorial from beginning to end with &lt;b&gt;proof&lt;/b&gt; that it works.   I have been in the industry 32 years so am no stranger to the difficulties of software design but when something as simple as this does not work it makes me want to choose another database which would be a shame as I like the features that OrientDB has &lt;b&gt;boasted&lt;/b&gt; about, simplicity being one of them.  &lt;b&gt;Second instance (node) log:&lt;/b&gt; ``` 2016-11-16 15:10:18:917 INFO  Loading configuration from input stream [OServerConfigurationLoaderXml] 2016-11-16 15:10:19:187 INFO  OrientDB Server v3.0.0-SNAPSHOT is starting up... [OServer] 2016-11-16 15:10:19:212 INFO  OrientDB auto-config DISKCACHE=3,572MB (heap=3,572MB direct=3,572MB os=16,064MB), assuming maximum direct memory size equals to maximum JVM heap size [orientechnologies] 2016-11-16 15:10:19:212 WARNI MaxDirectMemorySize JVM option is not set or has invalid value, that may cause out of memory errors. Please set the -XX:MaxDirectMemorySize=16064m option when you start the JVM. [Class] 2016-11-16 15:10:19:231 INFO  Databases directory: D:\Development\NexusSuite\Projects\MongooseGFX\MGFXOrientDBDatabaseDesigner\databases [OServer] 2016-11-16 15:10:19:262 SEVER ODefaultServerSecurity.loadConfig() Could not access the security JSON file: D:/Development/NexusSuite/Projects/MongooseGFX/MGFXOrientDBDatabaseDesigner//config/security.json [ODefaultServerSecurity] 2016-11-16 15:10:19:312 INFO  Listening binary connections on 0.0.0.0:8091 (protocol v.36, socket=ssl) [OServerNetworkListener] 2016-11-16 15:10:19:325 INFO  Listening http connections on 0.0.0.0:8092 (protocol v.10, socket=https) [OServerNetworkListener] 2016-11-16 15:10:19:332 WARNI Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] 2016-11-16 15:10:19:503 INFO  Installing dynamic plugin 'studio-2.2.zip'... [OServerPluginManager] 2016-11-16 15:10:19:627 INFO  Installed GREMLIN language v.2.6.0 - graph.pool.max=50 [OGraphServerHandler] 2016-11-16 15:10:19:701 INFO  Configuring Hazelcast from 'D:\Development\NexusSuite\Projects\MongooseGFX\MGFXOrientDBDatabaseDesigner\configuration\orientdb\hazelcast.xml'. [FileSystemXmlConfig] 2016-11-16 15:10:19:793 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2016-11-16 15:10:20:100 INFO  [LOCAL] [orientdb] [3.6.5] Interfaces is disabled, trying to pick one address from TCP-IP config addresses: [127.0.0.1] [DefaultAddressPicker] 2016-11-16 15:10:20:107 INFO  [LOCAL] [orientdb] [3.6.5] Picked Address[127.0.0.1]:8093, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=8093], bind any local is true [DefaultAddressPicker] 2016-11-16 15:10:20:120 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Hazelcast 3.6.5 (20160823 - e4af3d9) starting at Address[127.0.0.1]:8093 [system] 2016-11-16 15:10:20:121 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system] 2016-11-16 15:10:20:121 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Configured Hazelcast Serialization version : 1 [system] 2016-11-16 15:10:20:316 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Backpressure is disabled [OperationService] 2016-11-16 15:10:20:336 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Starting with 1 generic operation threads and 1 partition operation threads. [ClassicOperationExecutor] 2016-11-16 15:10:20:748 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Creating TcpIpJoiner [Node] 2016-11-16 15:10:20:749 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Address[127.0.0.1]:8093 is STARTING [LifecycleService] 2016-11-16 15:10:20:968 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads [NonBlockingIOThreadingModel] 2016-11-16 15:10:21:021 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Connecting to /127.0.0.1:8083, timeout: 0, bind-any: true [InitConnectionTask] 2016-11-16 15:10:21:034 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Established socket connection between /127.0.0.1:52495 and /127.0.0.1:8083 [TcpIpConnectionManager] 2016-11-16 15:10:28:034 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5]   Members [2] { Member [127.0.0.1]:8083 Member [127.0.0.1]:8093 this }  [ClusterService] 2016-11-16 15:10:30:050 INFO  [127.0.0.1]:8093 [orientdb] [3.6.5] Address[127.0.0.1]:8093 is STARTED [LifecycleService] 2016-11-16 15:10:30:050 INFO  Starting distributed server 'nexus-test-2' (hzID=6033608a-c37b-487b-92b7-65127c68ad26)... [OHazelcastPlugin] 2016-11-16 15:10:30:106 WARNI [nexus-test-2] Servers in cluster: [nexus-test-1, nexus-test-2] [OHazelcastPlugin] 2016-11-16 15:10:39:383 INFO  [nexus-test-2] Current node is a MASTER for database 'testdatabase' [OHazelcastPlugin] 2016-11-16 15:10:39:395 INFO  [nexus-test-2] New distributed configuration for database: testdatabase (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+------------+-------------+ |        |           |          |   MASTER   |   MASTER    | |        |           |          |   ONLINE   |NOT_AVAILABLE| +--------+-----------+----------+------------+-------------+ |CLUSTER |writeQuorum|readQuorum|nexus-test-1|nexus-test-2 | +--------+-----------+----------+------------+-------------+ |*       |     1     |    1     |     X      |      o      | |internal|     1     |    1     |            |             | +--------+-----------+----------+------------+-------------+   [OHazelcastPlugin] 2016-11-16 15:10:39:395 INFO  [nexus-test-2] Saving distributed configuration file for database 'testdatabase' to: D:\Development\NexusSuite\Projects\MongooseGFX\MGFXOrientDBDatabaseDesigner\databases\testdatabase\distributed-config.json [OHazelcastPlugin] 2016-11-16 15:10:39:401 INFO  [nexus-test-2] Distributed servers status:  +-------------+--------+----------------------------+-----+---------+------------------+------------------+----------------------+ |Name         |Status  |Databases                   |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------------+--------+----------------------------+-----+---------+------------------+------------------+----------------------+ |nexus-test-1 |ONLINE  |testdatabase=ONLINE (MASTER)|2    |15:08:59 |169.254.80.80:8081|169.254.80.80:8082|79.92MB/3.49GB (2.24%)| |nexus-test-2*|STARTING|                            |1    |15:10:19 |169.254.80.80:8091|169.254.80.80:8092|98.37MB/3.49GB (2.75%)| +-------------+--------+----------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-11-16 15:10:39:419 WARNI [nexus-test-2]-&gt;[[nexus-test-1]] Requesting deploy of database 'testdatabase' on local server... [OHazelcastPlugin] [nexus-test-2] Error on starting distributed plugin com.orientechnologies.orient.server.distributed.task.ODistributedOperationException: No response received from any of nodes [nexus-test-1] for request id=1.0 task=deploy_db after 1200046ms at com.orientechnologies.orient.server.distributed.ODistributedResponseManager.getFinalResponse(ODistributedResponseManager.java:350) at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.waitForResponse(ODistributedDatabaseImpl.java:802) at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.send2Nodes(ODistributedDatabaseImpl.java:434) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.sendRequest(ODistributedAbstractPlugin.java:623) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.requestDatabaseFullSync(ODistributedAbstractPlugin.java:1119) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.requestFullDatabase(ODistributedAbstractPlugin.java:961) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.installDatabase(ODistributedAbstractPlugin.java:928) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installNewDatabasesFromCluster(OHazelcastPlugin.java:1109) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:209) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1144) at com.orientechnologies.orient.server.OServer.activate(OServer.java:398) at nz.co.mongoosegfx.Main$1$1.execute(Main.java:198) at nz.co.mongoosegfx.abstracts.system.threading.MGFXRunnable.run(MGFXRunnable.java:60) at nz.co.mongoosegfx.impl.system.threading.MGFXExecutorThread.run(MGFXExecutorThread.java:250) [DATETIME] 2016-11-16 15:30:39.429 [THREAD] 0000000000000037 [LEVEL] WARNING [MESSAGE] Thread 'system-executor-1479273018284' was terminated: Reason = '{com.orientechnologies.orient.server.distributed.task.ODistributedOperationException}-{ No response received from any of nodes [nexus-test-1] for request id=1.0 task=deploy_db after 1200046ms } Stack trace: com.orientechnologies.orient.server.distributed.task.ODistributedOperationException: No response received from any of nodes [nexus-test-1] for request id=1.0 task=deploy_db after 1200046ms at com.orientechnologies.orient.server.distributed.ODistributedResponseManager.getFinalResponse(ODistributedResponseManager.java:350) at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.waitForResponse(ODistributedDatabaseImpl.java:802) at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.send2Nodes(ODistributedDatabaseImpl.java:434) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.sendRequest(ODistributedAbstractPlugin.java:623) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.requestDatabaseFullSync(ODistributedAbstractPlugin.java:1119) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.requestFullDatabase(ODistributedAbstractPlugin.java:961) at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.installDatabase(ODistributedAbstractPlugin.java:928) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installNewDatabasesFromCluster(OHazelcastPlugin.java:1109) at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:209) at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1144) at com.orientechnologies.orient.server.OServer.activate(OServer.java:398) at nz.co.mongoosegfx.Main$1$1.execute(Main.java:198) at nz.co.mongoosegfx.abstracts.system.threading.MGFXRunnable.run(MGFXRunnable.java:60) at nz.co.mongoosegfx.impl.system.threading.MGFXExecutorThread.run(MGFXExecutorThread.java:250)  ```  &lt;b&gt;First instance (node) log:&lt;/b&gt; ``` 2016-11-16 15:08:58:301 INFO  Loading configuration from input stream [OServerConfigurationLoaderXml] 2016-11-16 15:08:58:567 INFO  OrientDB Server v3.0.0-SNAPSHOT is starting up... [OServer] 2016-11-16 15:08:58:599 INFO  OrientDB auto-config DISKCACHE=3,572MB (heap=3,572MB direct=3,572MB os=16,064MB), assuming maximum direct memory size equals to maximum JVM heap size [orientechnologies] 2016-11-16 15:08:58:600 WARNI MaxDirectMemorySize JVM option is not set or has invalid value, that may cause out of memory errors. Please set the -XX:MaxDirectMemorySize=16064m option when you start the JVM. [Class] 2016-11-16 15:08:58:619 INFO  Databases directory: D:\Development\NexusSuite\Projects\MongooseGFX\MGFXOrientDBContainerServer\databases [OServer] 2016-11-16 15:08:58:653 SEVER ODefaultServerSecurity.loadConfig() Could not access the security JSON file: D:/Development/NexusSuite/Projects/MongooseGFX/MGFXOrientDBContainerServer//config/security.json [ODefaultServerSecurity] 2016-11-16 15:08:58:676 INFO  Listening binary connections on 0.0.0.0:8081 (protocol v.36, socket=ssl) [OServerNetworkListener] 2016-11-16 15:08:58:691 INFO  Listening http connections on 0.0.0.0:8082 (protocol v.10, socket=https) [OServerNetworkListener] 2016-11-16 15:08:58:699 WARNI Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] 2016-11-16 15:08:58:876 INFO  Installing dynamic plugin 'studio-2.2.zip'... [OServerPluginManager] 2016-11-16 15:08:58:983 INFO  Installed GREMLIN language v.2.6.0 - graph.pool.max=50 [OGraphServerHandler] 2016-11-16 15:08:59:074 INFO  Configuring Hazelcast from 'D:\Development\NexusSuite\Projects\MongooseGFX\MGFXOrientDBContainerServer\configuration\orientdb\hazelcast.xml'. [FileSystemXmlConfig] 2016-11-16 15:08:59:164 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2016-11-16 15:08:59:446 INFO  [LOCAL] [orientdb] [3.6.5] Interfaces is disabled, trying to pick one address from TCP-IP config addresses: [127.0.0.1] [DefaultAddressPicker] 2016-11-16 15:08:59:452 INFO  [LOCAL] [orientdb] [3.6.5] Picked Address[127.0.0.1]:8083, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=8083], bind any local is true [DefaultAddressPicker] 2016-11-16 15:08:59:463 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Hazelcast 3.6.5 (20160823 - e4af3d9) starting at Address[127.0.0.1]:8083 [system] 2016-11-16 15:08:59:463 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system] 2016-11-16 15:08:59:463 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Configured Hazelcast Serialization version : 1 [system] 2016-11-16 15:08:59:647 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Backpressure is disabled [OperationService] 2016-11-16 15:08:59:668 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Starting with 1 generic operation threads and 1 partition operation threads. [ClassicOperationExecutor] 2016-11-16 15:09:00:043 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Creating TcpIpJoiner [Node] 2016-11-16 15:09:00:043 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Address[127.0.0.1]:8083 is STARTING [LifecycleService] 2016-11-16 15:09:00:112 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads [NonBlockingIOThreadingModel] 2016-11-16 15:09:00:150 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Connecting to /127.0.0.1:8093, timeout: 0, bind-any: true [InitConnectionTask] 2016-11-16 15:09:01:150 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Could not connect to: /127.0.0.1:8093. Reason: SocketException[Connection refused: connect to address /127.0.0.1:8093] [InitConnectionTask] 2016-11-16 15:09:01:151 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Address[127.0.0.1]:8093 is added to the blacklist. [TcpIpJoiner] 2016-11-16 15:09:02:149 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5]    Members [1] { Member [127.0.0.1]:8083 this }  [TcpIpJoiner] 2016-11-16 15:09:02:175 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Address[127.0.0.1]:8083 is STARTED [LifecycleService] 2016-11-16 15:09:02:178 INFO  Starting distributed server 'nexus-test-1' (hzID=2cec5118-c10b-4b44-8a7a-5a9c35167c7c)... [OHazelcastPlugin] 2016-11-16 15:09:02:203 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Initializing cluster partition table arrangement... [InternalPartitionService] 2016-11-16 15:09:02:284 WARNI [nexus-test-1] Servers in cluster: [nexus-test-1] [OHazelcastPlugin] 2016-11-16 15:09:02:477 INFO  [nexus-test-1] Opening database 'testdatabase'... [OHazelcastPlugin] 2016-11-16 15:09:02:484 INFO  [nexus-test-1] loaded database configuration from disk: D:\Development\NexusSuite\Projects\MongooseGFX\MGFXOrientDBContainerServer\databases\testdatabase\distributed-config.json [OHazelcastPlugin] 2016-11-16 15:09:02:494 INFO  [nexus-test-1] New distributed configuration for database: testdatabase (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+-------------+-------------+ |        |           |          |   MASTER    |   MASTER    | |        |           |          |NOT_AVAILABLE|NOT_AVAILABLE| +--------+-----------+----------+-------------+-------------+ |CLUSTER |writeQuorum|readQuorum|nexus-test-1 |nexus-test-2 | +--------+-----------+----------+-------------+-------------+ |*       |     1     |    1     |      X      |      o      | |internal|     1     |    1     |             |             | +--------+-----------+----------+-------------+-------------+   [OHazelcastPlugin] 2016-11-16 15:09:02:496 INFO  [nexus-test-1] Distributed servers status:  +-------------+--------+---------+-----+---------+------------------+------------------+----------------------+ |Name         |Status  |Databases|Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------------+--------+---------+-----+---------+------------------+------------------+----------------------+ |nexus-test-1*|STARTING|         |1    |15:08:59 |169.254.80.80:8081|169.254.80.80:8082|94.19MB/3.49GB (2.64%)| +-------------+--------+---------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-11-16 15:09:02:496 INFO  [nexus-test-1] Current node started as MASTER for database 'testdatabase' [OHazelcastPlugin$4] 2016-11-16 15:09:02:510 INFO  [nexus-test-1] New distributed configuration for database: testdatabase (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+-------------+-------------+ |        |           |          |   MASTER    |   MASTER    | |        |           |          |SYNCHRONIZING|NOT_AVAILABLE| +--------+-----------+----------+-------------+-------------+ |CLUSTER |writeQuorum|readQuorum|nexus-test-1 |nexus-test-2 | +--------+-----------+----------+-------------+-------------+ |*       |     1     |    1     |      X      |      o      | |internal|     1     |    1     |             |             | +--------+-----------+----------+-------------+-------------+   [OHazelcastPlugin] 2016-11-16 15:09:03:303 INFO  [nexus-test-1] Publishing ONLINE status for database nexus-test-1.testdatabase... [ODistributedDatabaseImpl] 2016-11-16 15:09:03:305 WARNI [nexus-test-1] Updated node status to 'ONLINE' [OHazelcastPlugin] 2016-11-16 15:09:03:469 INFO  [nexus-test-1] Distributed servers status:  +-------------+------+----------------------------+-----+---------+------------------+------------------+----------------------+ |Name         |Status|Databases                   |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------------+------+----------------------------+-----+---------+------------------+------------------+----------------------+ |nexus-test-1*|ONLINE|testdatabase=ONLINE (MASTER)|1    |15:08:59 |169.254.80.80:8081|169.254.80.80:8082|42.72MB/3.49GB (1.20%)| +-------------+------+----------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-11-16 15:09:06:470 WARNI Authenticated clients can execute any kind of code into the server by using the following allowed languages: [sql] [OServerSideScriptInterpreter] 2016-11-16 15:09:06:471 WARNI onAfterActivate() Configuration document is empty [ODefaultServerSecurity] 2016-11-16 15:09:06:568 INFO  OrientDB Studio available at http://169.254.80.80:8082/studio/index.html [OServer] 2016-11-16 15:09:06:568 INFO  OrientDB Server is active v3.0.0-SNAPSHOT. [OServer]    2016-11-16 15:10:21:023 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Accepting socket connection from /127.0.0.1:52495 [SocketAcceptorThread] 2016-11-16 15:10:21:039 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Established socket connection between /127.0.0.1:8083 and /127.0.0.1:52495 [TcpIpConnectionManager] 2016-11-16 15:10:28:027 WARNI [nexus-test-1] Added new node id=Member [127.0.0.1]:8093 name=ext:6033608a-c37b-487b-92b7-65127c68ad26 [OHazelcastPlugin] 2016-11-16 15:10:28:027 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5]   Members [2] { Member [127.0.0.1]:8083 this Member [127.0.0.1]:8093 }  [ClusterService] 2016-11-16 15:10:28:279 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] Re-partitioning cluster data... Migration queue size: 135 [InternalPartitionService] 2016-11-16 15:10:29:549 INFO  [127.0.0.1]:8083 [orientdb] [3.6.5] All migration tasks have been completed, queues are empty. [InternalPartitionService] 2016-11-16 15:10:30:107 INFO  [nexus-test-1]&lt;-[ext:6033608a-c37b-487b-92b7-65127c68ad26] Received updated about registered nodes [OHazelcastPlugin] 2016-11-16 15:10:45:371 INFO  [nexus-test-1]&lt;-[nexus-test-2] Added node configuration id=Member [127.0.0.1]:8093 name=nexus-test-2, now 2 nodes are configured [OHazelcastPlugin] 2016-11-16 15:10:45:373 INFO  [nexus-test-1] Distributed servers status:  +-------------+--------+----------------------------+-----+---------+------------------+------------------+----------------------+ |Name         |Status  |Databases                   |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------------+--------+----------------------------+-----+---------+------------------+------------------+----------------------+ |nexus-test-1*|ONLINE  |testdatabase=ONLINE (MASTER)|3    |15:08:59 |169.254.80.80:8081|169.254.80.80:8082|81.63MB/3.49GB (2.29%)| |nexus-test-2 |STARTING|                            |1    |15:10:19 |169.254.80.80:8091|169.254.80.80:8092|98.37MB/3.49GB (2.75%)| +-------------+--------+----------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-11-16 15:10:45:374 INFO  [nexus-test-1]&lt;-[nexus-test-2] Received new status nexus-test-2.testdatabase=SYNCHRONIZING [OHazelcastPlugin] ```  ## Steps to reproduce the problem  &lt;b&gt;Instance ONE server configuration:&lt;/b&gt; ``` &lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt; &lt;orient-server&gt;     &lt;handlers&gt;         &lt;handler class="com.orientechnologies.orient.graph.handler.OGraphServerHandler"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="true"/&gt;                 &lt;parameter name="graph.pool.max" value="50"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- CLUSTER PLUGIN, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter name="nodeName" value="test-1" /&gt;                 &lt;parameter name="enabled" value="true" /&gt;                 &lt;parameter name="configuration.db.default" value="${ORIENTDB_HOME}/configuration/orientdb/default-distributed-db-config.json"/&gt;                 &lt;parameter name="configuration.hazelcast" value="${ORIENTDB_HOME}/configuration/orientdb/hazelcast.xml"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- JMX SERVER, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OJMXPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="false"/&gt;                 &lt;parameter name="profilerManaged" value="true"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- AUTOMATIC BACKUP, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OAutomaticBackup"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="false"/&gt;                 &lt;!-- LOCATION OF JSON CONFIGURATION FILE --&gt;                 &lt;parameter name="config" value="${ORIENTDB_HOME}/configuration/oriebtdb/automatic-backup.json"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- SERVER SIDE SCRIPT INTERPRETER. WARNING, THIS CAN BE A SECURITY HOLE BECAUSE MALICIOUS CODE COULD BE INJECTED.             ENABLE IT ONLY IF CLIENTS ARE TRUSTED, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler                 class="com.orientechnologies.orient.server.handler.OServerSideScriptInterpreter"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="true"/&gt;                 &lt;parameter name="allowedLanguages" value="SQL"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;      &lt;/handlers&gt;     &lt;network&gt;         &lt;sockets&gt;             &lt;socket implementation="com.orientechnologies.orient.server.network.OServerTLSSocketFactory" name="ssl"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.keyStore"/&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.trustStore"/&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;             &lt;socket implementation="com.orientechnologies.orient.server.network.OServerTLSSocketFactory" name="https"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.keyStore"/&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.trustStore"/&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;         &lt;/sockets&gt;         &lt;protocols&gt;             &lt;!-- Default registered protocol. It reads commands using the HTTP protocol                 and write data locally --&gt;             &lt;protocol name="binary" implementation="com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary"/&gt;             &lt;protocol name="http" implementation="com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpDb"/&gt;         &lt;/protocols&gt;         &lt;listeners&gt;             &lt;listener protocol="binary" ip-address="0.0.0.0" port-range="8081" socket="ssl"/&gt;             &lt;listener protocol="http" ip-address="0.0.0.0" port-range="8082" socket="https"&gt;                 &lt;parameters&gt;                                          &lt;!-- Connection's custom parameters. If not specified the global configuration will be taken --&gt;                     &lt;parameter name="network.http.charset" value="utf-8"/&gt;                     &lt;parameter value="true" name="network.http.jsonResponseError"/&gt;                                          &lt;!-- Define additional HTTP headers to always send as response --&gt;                     &lt;!-- Allow cross-site scripting --&gt;                     &lt;!-- parameter name="network.http.additionalResponseHeaders" value="Access-Control-Allow-Origin:                         *;Access-Control-Allow-Credentials: true" / --&gt;                 &lt;/parameters&gt;                 &lt;commands&gt;                     &lt;command                             pattern="GET|www GET|studio/ GET| GET|*.htm GET|*.html GET|*.xml GET|*.jpeg GET|*.jpg GET|*.png GET|*.gif GET|*.js GET|*.css GET|*.swf GET|*.ico GET|*.txt GET|*.otf GET|*.pjs GET|*.svg GET|*.json GET|*.woff GET|*.woff2 GET|*.ttf GET|*.svgz"                             implementation="com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetStaticContent"&gt;                         &lt;parameters&gt;                                                          &lt;!-- Don't cache html resources in development mode --&gt;                             &lt;entry name="http.cache:*.htm *.html" value="Cache-Control: no-cache, no-store, max-age=0, must-revalidate\r\nPragma: no-cache"/&gt;                                                          &lt;!-- Default caching --&gt;                             &lt;entry name="http.cache:default" value="Cache-Control: max-age=120"/&gt;                                                      &lt;/parameters&gt;                     &lt;/command&gt;                     &lt;command pattern="GET|gephi/*" implementation="com.orientechnologies.orient.graph.server.command.OServerCommandGetGephi"/&gt;                 &lt;/commands&gt;             &lt;/listener&gt;         &lt;/listeners&gt;                  &lt;!-- Clusters??? --&gt;         &lt;cluster&gt;         &lt;/cluster&gt;     &lt;/network&gt;     &lt;storages&gt;     &lt;/storages&gt;     &lt;users&gt;     &lt;user name="root" password="password" resources="*"&gt;&lt;/user&gt;     &lt;/users&gt;     &lt;properties&gt;         &lt;!-- DATABASE POOL: size min/max --&gt;         &lt;entry name="db.pool.min" value="1"/&gt;         &lt;entry name="db.pool.max" value="50"/&gt;          &lt;!-- PROFILER: configures the profiler as &lt;seconds-for-snapshot&gt;,&lt;archive-snapshot-size&gt;,&lt;summary-size&gt; --&gt;         &lt;entry name="profiler.enabled" value="false"/&gt;                  &lt;!-- &lt;entry name="profiler.config" value="30,10,10" /&gt; --&gt;     &lt;/properties&gt; &lt;/orient-server&gt;  ``` &lt;b&gt;Instance TWO server configuration:&lt;/b&gt; ``` &lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt; &lt;orient-server&gt;     &lt;handlers&gt;         &lt;handler class="com.orientechnologies.orient.graph.handler.OGraphServerHandler"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="true"/&gt;                 &lt;parameter name="graph.pool.max" value="50"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- CLUSTER PLUGIN, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter name="nodeName" value="test-2" /&gt;                 &lt;parameter name="enabled" value="true" /&gt;                 &lt;parameter name="configuration.db.default" value="${ORIENTDB_HOME}/configuration/orientdb/default-distributed-db-config.json"/&gt;                 &lt;parameter name="configuration.hazelcast" value="${ORIENTDB_HOME}/configuration/orientdb/hazelcast.xml"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- JMX SERVER, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OJMXPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="false"/&gt;                 &lt;parameter name="profilerManaged" value="true"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- AUTOMATIC BACKUP, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OAutomaticBackup"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="false"/&gt;                 &lt;!-- LOCATION OF JSON CONFIGURATION FILE --&gt;                 &lt;parameter name="config" value="${ORIENTDB_HOME}/configuration/oriebtdb/automatic-backup.json"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- SERVER SIDE SCRIPT INTERPRETER. WARNING, THIS CAN BE A SECURITY HOLE BECAUSE MALICIOUS CODE COULD BE INJECTED.             ENABLE IT ONLY IF CLIENTS ARE TRUSTED, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler                 class="com.orientechnologies.orient.server.handler.OServerSideScriptInterpreter"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="true"/&gt;                 &lt;parameter name="allowedLanguages" value="SQL"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;      &lt;/handlers&gt;     &lt;network&gt;         &lt;sockets&gt;             &lt;socket implementation="com.orientechnologies.orient.server.network.OServerTLSSocketFactory" name="ssl"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.keyStore"/&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.trustStore"/&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;             &lt;socket implementation="com.orientechnologies.orient.server.network.OServerTLSSocketFactory" name="https"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.keyStore"/&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;                     &lt;parameter value="./mystore.ks" name="network.ssl.trustStore"/&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;         &lt;/sockets&gt;         &lt;protocols&gt;             &lt;!-- Default registered protocol. It reads commands using the HTTP protocol                 and write data locally --&gt;             &lt;protocol name="binary" implementation="com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary"/&gt;             &lt;protocol name="http" implementation="com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpDb"/&gt;         &lt;/protocols&gt;         &lt;listeners&gt;             &lt;listener protocol="binary" ip-address="0.0.0.0" port-range="8091" socket="ssl"/&gt;             &lt;listener protocol="http" ip-address="0.0.0.0" port-range="8092" socket="https"&gt;                 &lt;parameters&gt;                                          &lt;!-- Connection's custom parameters. If not specified the global configuration will be taken --&gt;                     &lt;parameter name="network.http.charset" value="utf-8"/&gt;                     &lt;parameter value="true" name="network.http.jsonResponseError"/&gt;                                          &lt;!-- Define additional HTTP headers to always send as response --&gt;                     &lt;!-- Allow cross-site scripting --&gt;                     &lt;!-- parameter name="network.http.additionalResponseHeaders" value="Access-Control-Allow-Origin:                         *;Access-Control-Allow-Credentials: true" / --&gt;                 &lt;/parameters&gt;                 &lt;commands&gt;                     &lt;command                             pattern="GET|www GET|studio/ GET| GET|*.htm GET|*.html GET|*.xml GET|*.jpeg GET|*.jpg GET|*.png GET|*.gif GET|*.js GET|*.css GET|*.swf GET|*.ico GET|*.txt GET|*.otf GET|*.pjs GET|*.svg GET|*.json GET|*.woff GET|*.woff2 GET|*.ttf GET|*.svgz"                             implementation="com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetStaticContent"&gt;                         &lt;parameters&gt;                                                          &lt;!-- Don't cache html resources in development mode --&gt;                             &lt;entry name="http.cache:*.htm *.html" value="Cache-Control: no-cache, no-store, max-age=0, must-revalidate\r\nPragma: no-cache"/&gt;                                                          &lt;!-- Default caching --&gt;                             &lt;entry name="http.cache:default" value="Cache-Control: max-age=120"/&gt;                                                      &lt;/parameters&gt;                     &lt;/command&gt;                     &lt;command pattern="GET|gephi/*" implementation="com.orientechnologies.orient.graph.server.command.OServerCommandGetGephi"/&gt;                 &lt;/commands&gt;             &lt;/listener&gt;         &lt;/listeners&gt;                  &lt;!-- Clusters??? --&gt;         &lt;cluster&gt;         &lt;/cluster&gt;     &lt;/network&gt;     &lt;storages&gt;     &lt;/storages&gt;     &lt;users&gt;     &lt;user name="root" password="password" resources="*"&gt;&lt;/user&gt;     &lt;/users&gt;     &lt;properties&gt;         &lt;!-- DATABASE POOL: size min/max --&gt;         &lt;entry name="db.pool.min" value="1"/&gt;         &lt;entry name="db.pool.max" value="50"/&gt;          &lt;!-- PROFILER: configures the profiler as &lt;seconds-for-snapshot&gt;,&lt;archive-snapshot-size&gt;,&lt;summary-size&gt; --&gt;         &lt;entry name="profiler.enabled" value="false"/&gt;                  &lt;!-- &lt;entry name="profiler.config" value="30,10,10" /&gt; --&gt;     &lt;/properties&gt; &lt;/orient-server&gt;  ```  &lt;b&gt;Instance ONE Hazlecast configuration:&lt;/b&gt; ``` &lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;hazelcast xsi:schemaLocation="http://www.hazelcast.com/schema/config hazelcast-config-3.3.xsd" xmlns="http://www.hazelcast.com/schema/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; &lt;group&gt; &lt;name&gt;orientdb&lt;/name&gt; &lt;password&gt;orientdb&lt;/password&gt; &lt;/group&gt; &lt;properties&gt; &lt;property name="hazelcast.mancenter.enabled"&gt;false&lt;/property&gt; &lt;property name="hazelcast.memcache.enabled"&gt;false&lt;/property&gt; &lt;property name="hazelcast.rest.enabled"&gt;false&lt;/property&gt; &lt;property name="hazelcast.wait.seconds.before.join"&gt;5&lt;/property&gt; &lt;property name="hazelcast.operation.thread.count"&gt;1&lt;/property&gt; &lt;property name="hazelcast.operation.generic.thread.count"&gt;1&lt;/property&gt; &lt;property name="hazelcast.client.event.thread.count"&gt;1&lt;/property&gt; &lt;property name="hazelcast.event.thread.count"&gt;1&lt;/property&gt; &lt;/properties&gt; &lt;network&gt; &lt;port auto-increment="false" port-count="100"&gt;8083&lt;/port&gt; &lt;join&gt; &lt;multicast enabled="false"&gt; &lt;multicast-group&gt;235.1.1.1&lt;/multicast-group&gt; &lt;multicast-port&gt;2434&lt;/multicast-port&gt; &lt;/multicast&gt; &lt;tcp-ip enabled="true"&gt; &lt;member&gt;127.0.0.1:8093&lt;/member&gt; &lt;/tcp-ip&gt; &lt;/join&gt; &lt;/network&gt; &lt;executor-service&gt; &lt;pool-size&gt;16&lt;/pool-size&gt; &lt;/executor-service&gt; &lt;/hazelcast&gt; ```  &lt;b&gt;Instance TWO Hazelcast configuration:&lt;/b&gt; ``` &lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;hazelcast xsi:schemaLocation="http://www.hazelcast.com/schema/config hazelcast-config-3.3.xsd" xmlns="http://www.hazelcast.com/schema/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; &lt;group&gt; &lt;name&gt;orientdb&lt;/name&gt; &lt;password&gt;orientdb&lt;/password&gt; &lt;/group&gt; &lt;properties&gt; &lt;property name="hazelcast.mancenter.enabled"&gt;false&lt;/property&gt; &lt;property name="hazelcast.memcache.enabled"&gt;false&lt;/property&gt; &lt;property name="hazelcast.rest.enabled"&gt;false&lt;/property&gt; &lt;property name="hazelcast.wait.seconds.before.join"&gt;5&lt;/property&gt; &lt;property name="hazelcast.operation.thread.count"&gt;1&lt;/property&gt; &lt;property name="hazelcast.operation.generic.thread.count"&gt;1&lt;/property&gt; &lt;property name="hazelcast.client.event.thread.count"&gt;1&lt;/property&gt; &lt;property name="hazelcast.event.thread.count"&gt;1&lt;/property&gt; &lt;/properties&gt; &lt;network&gt; &lt;port auto-increment="false" port-count="100"&gt;8093&lt;/port&gt; &lt;join&gt; &lt;multicast enabled="false"&gt; &lt;multicast-group&gt;235.1.1.1&lt;/multicast-group&gt; &lt;multicast-port&gt;2434&lt;/multicast-port&gt; &lt;/multicast&gt; &lt;tcp-ip enabled="true"&gt; &lt;member&gt;127.0.0.1:8083&lt;/member&gt; &lt;/tcp-ip&gt; &lt;/join&gt; &lt;/network&gt; &lt;executor-service&gt; &lt;pool-size&gt;16&lt;/pool-size&gt; &lt;/executor-service&gt; &lt;/hazelcast&gt;  ```  &lt;b&gt;Default distributed DB config JSON:&lt;/b&gt; ``` {   "replication": true,   "hotAlignment": true,   "resyncEvery": 15,   "executionMode": "undefined",   "autoDeploy": true,   "readQuorum": 1,   "writeQuorum": "majority",   "readYourWrites": true,   "failureAvailableNodesLessQuorum": false,   "servers":    {     "*": "master"   },   "clusters":    {     "internal":      {     },     "*":      {       "servers": ["&lt;NEW_NODE&gt;"]     }   } } ``` </body>
		<created>2016-11-16 06:07:28</created>
		<closed>2017-06-06 03:38:51</closed>
	</bug>
	<bug>
		<id>6911</id>
		<title>select dijkstra() never returns</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13-SNAPSHOT   ## Operating System - [ x] Linux  ## Expected behavior comparing with another function ... orientdb {db=HumanPPI2}&gt; SELECT shortestPath(#40:55,#33:0)    +----+---------------------------+ |#   |shortestPath               | +----+---------------------------+ |0   |[#40:55,#34:133,#33:0]| +----+----------------------------+  1 item(s) found. Query executed in 0.078 sec(s).  ## Actual behavior orientdb {db=HumanPPI2}&gt; SELECT dijkstra(#40:55, #33:0, 'Scale') FROM V  never returns- now 30 minutes, and counting...  ## Steps to reproduce the problem download my database from google disk and check. please request share. </body>
		<created>2016-11-14 20:44:46</created>
		<closed>2016-12-13 15:35:31</closed>
	</bug>
	<bug>
		<id>6910</id>
		<title>An exception in distribte modeLocal node 'node07' is not the owner for cluster 'test_25' (it is 'node08')</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2 12  ## Operating System - [ ] Linux  ## Expected behavior and actual behavior I want to get help that how this exception occur &amp; some development document in java API with distribute mode orientDB.Thanks~ ## Steps to reproduce the problem First, I just setup a distribute orientdb, I think it's right. Then, I use orientdb create a database(just some class, vetex &amp; edge), I get database in each of orientdb in cluster. But finally I insert data to orientdb, I got exception with this, and I don't know why?  ``` 2016-11-14 19:24:37,543 [com.test.testDB.graph.OrientDBImportUtil:315]-[ERROR] pool-9-thread-25  com.orientechnologies.orient.server.distributed.ODistributedConfigurationChangedException: Local node 'node07' is not the owner for cluster 'vetex_25' (it is 'node08') DB name="test_db" DB name="test_db" at sun.reflect.GeneratedConstructorAccessor50.newInstance(Unknown Source) ~[na:na] at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:1.7.0_67] at java.lang.reflect.Constructor.newInstance(Constructor.java:526) ~[na:1.7.0_67] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:437) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:388) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:270) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:162) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2138) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote$6.execute(OStorageRemote.java:548) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote$6.execute(OStorageRemote.java:542) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote$1.execute(OStorageRemote.java:164) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote.asyncNetworkOperation(OStorageRemote.java:156) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.client.remote.OStorageRemote.createRecord(OStorageRemote.java:528) ~[orientdb-client-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2095) ~[orientdb-core-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:246) ~[orientdb-core-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:179) ~[orientdb-core-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2597) ~[orientdb-core-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:103) ~[orientdb-core-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1802) ~[orientdb-core-2.2.12.jar:2.2.12] at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1793) ~[orientdb-core-2.2.12.jar:2.2.12] at com.tinkerpop.blueprints.impls.orient.OrientElement.save(OrientElement.java:333) ~[orientdb-graphdb-2.2.12.jar:2.2.12] at com.tinkerpop.blueprints.impls.orient.OrientElement.save(OrientElement.java:315) ~[orientdb-graphdb-2.2.12.jar:2.2.12] at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.addVertex(OrientBaseGraph.java:579) ~[orientdb-graphdb-2.2.12.jar:2.2.12] at com.thunisoft.wmcloud.graph.GraphUtils.addAjVertex(GraphUtils.java:129) ~[wmcloud-graph-loader.jar:na] at com.thunisoft.wmcloud.graph.GraphUtils.createGraph(GraphUtils.java:329) ~[wmcloud-graph-loader.jar:na] at com.thunisoft.writDB.graph.OrientDBImportUtil$TaskRunner.run(OrientDBImportUtil.java:305) ~[classes/:na] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [na:1.7.0_67] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [na:1.7.0_67] at java.lang.Thread.run(Thread.java:745) [na:1.7.0_67] ```</body>
		<created>2016-11-14 12:01:00</created>
		<closed>2016-11-14 17:20:37</closed>
	</bug>
	<bug>
		<id>6908</id>
		<title>Replica holds clusters owners ?</title>
		<body>## OrientDB Version, operating system, or hardware. - OrientDB console v.2.2.12-SNAPSHOT (build 2.2.x@r2a76ee1efc4487d9dc5f43e1ddc2fba1c5a0167c; 2016-10-20 13:55:08+0000)  ## Operating System - Oracle Linux 6.5  ## Expected behavior and actual behavior # ** 3 nodes with "config/default-distributed-db-config.json" as below:** {   "autoDeploy": true,   "hotAlignment": false,   "readQuorum": 1,   "writeQuorum": 1,   "executionMode": "asynchronous",   "readYourWrites": false,   "servers" : {     "govnet01": "master",     "govnet02": "master",     "*"       : "replica"   },   "clusters": {     "internal": {   },     "index"   : {   },     "*": {       "servers": ["&lt;NEW_NODE&gt;"]     }   } }  # ** Expected that govnet01 &amp; govnet02 hold clusters owners, and govnet03 holds clusters copies.  Connecting OrientDB, find 3 nodes : govnet01 holds copies, govnet02 &amp; govnet03 hold owners.** orientdb&gt; connect remote:t1s1/test_g3 root password  Connecting to database [remote:t1s1/test_g3] with user 'root'...OK  CONFIGURED SERVERS +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+-----------------+---------+ |#   |Name    |Status|Connections|StartedOn          |Binary            |HTTP              |UsedMemory       |FreeMemory       |MaxMemory| +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+-----------------+---------+ |0   |govnet03|ONLINE|6          |2016-11-14 13:56:51|192.168.3.203:2424|192.168.3.203:2480|369.28MB (36.54%)|641.22MB (63.46%)|1010.50MB| |1   |govnet01|ONLINE|17         |2016-11-14 14:23:00|192.168.3.201:2424|192.168.3.201:2480|847.29MB (84.64%)|153.71MB (15.36%)|1001.00MB| |2   |govnet02|ONLINE|11         |2016-11-14 13:56:54|192.168.3.202:2424|192.168.3.202:2480|576.88MB (56.92%)|436.62MB (43.08%)|1013.50MB| +----+--------+------+-----------+-------------------+------------------+------------------+-----------------+-----------------+---------+  orientdb {db=test_g3}&gt; ha status -db -output=text  Executed '  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------------------+----+-----------+----------+--------+--------+--------+ |                    |    |           |          | MASTER | MASTER |REPLICA | |                    |    |           |          | ONLINE | ONLINE | ONLINE | +--------------------+----+-----------+----------+--------+--------+--------+ |CLUSTER             |  id|writeQuorum|readQuorum|govnet01|govnet02|govnet03| +--------------------+----+-----------+----------+--------+--------+--------+ |*                   |    |     1     |    1     |   X    |   o    |   o    | |_studio             |  58|     1     |    1     |   o    |   X    |   o    | |_studio_10          |  68|     1     |    1     |   o    |   o    |   X    | |_studio_11          |  69|     1     |    1     |   o    |   o    |   X    | |_studio_12          |  70|     1     |    1     |   o    |   o    |   X    | |_studio_13          |  71|     1     |    1     |   o    |   o    |   X    | |_studio_17          |  75|     1     |    1     |   o    |   X    |   o    | |_studio_18          |  76|     1     |    1     |   o    |   X    |   o    | |_studio_19          |  77|     1     |    1     |   o    |   X    |   o    | |_studio_20          |  78|     1     |    1     |   o    |   o    |   X    | |_studio_21          |  79|     1     |    1     |   o    |   o    |   X    | |_studio_22          |  80|     1     |    1     |   o    |   o    |   X    | |_studio_23          |  81|     1     |    1     |   o    |   o    |   X    | |_studio_3           |  61|     1     |    1     |   o    |   X    |   o    | |_studio_4           |  62|     1     |    1     |   o    |   X    |   o    | |_studio_5           |  63|     1     |    1     |   o    |   X    |   o    | |_studio_6           |  64|     1     |    1     |   o    |   X    |   o    | |e                   |  33|     1     |    1     |   o    |   o    |   X    | |e_0                 |  57|     1     |    1     |   o    |   X    |   o    | |e_1                 |  34|     1     |    1     |   o    |   X    |   o    | |e_10                |  43|     1     |    1     |   o    |   X    |   o    | |e_11                |  44|     1     |    1     |   o    |   X    |   o    | |e_12                |  45|     1     |    1     |   o    |   X    |   o    | |e_17                |  50|     1     |    1     |   o    |   o    |   X    | |e_18                |  51|     1     |    1     |   o    |   o    |   X    | |e_19                |  52|     1     |    1     |   o    |   o    |   X    | |e_20                |  53|     1     |    1     |   o    |   X    |   o    | |e_21                |  54|     1     |    1     |   o    |   X    |   o    | |e_22                |  55|     1     |    1     |   o    |   X    |   o    | |e_23                |  56|     1     |    1     |   o    |   X    |   o    | |e_24                | 316|     1     |    1     |   o    |   o    |   X    | |e_6                 |  39|     1     |    1     |   o    |   o    |   X    | |e_8                 |  41|     1     |    1     |   o    |   o    |   X    | |e_9                 |  42|     1     |    1     |   o    |   o    |   X    | |index               |   1|     1     |    1     |        |        |        | |internal            |   0|     1     |    1     |        |        |        | |ofunction_0         | 310|     1     |    1     |   o    |   o    |   X    | |ofunction_1         | 311|     1     |    1     |   o    |   X    |   o    | |orole_0             | 302|     1     |    1     |   o    |   o    |   X    | |orole_1             | 303|     1     |    1     |   o    |   X    |   o    | |oschedule_0         | 319|     1     |    1     |   o    |   o    |   X    | |oschedule_1         | 320|     1     |    1     |   o    |   X    |   o    | |osequence_0         | 317|     1     |    1     |   o    |   o    |   X    | |osequence_1         | 318|     1     |    1     |   o    |   X    |   o    | |ouser_0             | 325|     1     |    1     |   o    |   o    |   X    | |ouser_1             | 326|     1     |    1     |   o    |   X    |   o    | |tb_object1_0        | 304|     1     |    1     |   o    |   o    |   X    | |tb_object1_1        | 155|     1     |    1     |   o    |   o    |   X    | |tb_object1_15       | 169|     1     |    1     |   o    |   o    |   X    | |tb_object1_16       | 170|     1     |    1     |   o    |   o    |   X    | |tb_object1_2        | 156|     1     |    1     |   o    |   o    |   X    | |tb_object1_20       | 174|     1     |    1     |   o    |   X    |   o    | |tb_object1_21       | 175|     1     |    1     |   o    |   o    |   X    | |tb_object1_22       | 176|     1     |    1     |   o    |   X    |   o    | |tb_object1_23       | 177|     1     |    1     |   o    |   X    |   o    | |tb_object1_24       | 305|     1     |    1     |   o    |   X    |   o    | |tb_object1_3        | 157|     1     |    1     |   o    |   o    |   X    | |tb_object1_4        | 158|     1     |    1     |   o    |   o    |   X    | |tb_object1_5        | 159|     1     |    1     |   o    |   o    |   X    | |tb_object1_6        | 160|     1     |    1     |   o    |   X    |   o    | |tb_object1_7        | 161|     1     |    1     |   o    |   X    |   o    | |tb_object1_8        | 162|     1     |    1     |   o    |   X    |   o    | |tb_object1_9        | 163|     1     |    1     |   o    |   X    |   o    | |tb_object2          | 226|     1     |    1     |   o    |   X    |   o    | |tb_object2_0        | 323|     1     |    1     |   o    |   o    |   X    | |tb_object2_1        | 227|     1     |    1     |   o    |   o    |   X    | |tb_object2_10       | 236|     1     |    1     |   o    |   o    |   X    | |tb_object2_11       | 237|     1     |    1     |   o    |   o    |   X    | |tb_object2_12       | 238|     1     |    1     |   o    |   X    |   o    | |tb_object2_13       | 239|     1     |    1     |   o    |   X    |   o    | |tb_object2_2        | 228|     1     |    1     |   o    |   o    |   X    | |tb_object2_20       | 246|     1     |    1     |   o    |   X    |   o    | |tb_object2_24       | 324|     1     |    1     |   o    |   X    |   o    | |tb_object2_3        | 229|     1     |    1     |   o    |   o    |   X    | |tb_object2_4        | 230|     1     |    1     |   o    |   o    |   X    | |tb_object2_5        | 231|     1     |    1     |   o    |   X    |   o    | |tb_object2_6        | 232|     1     |    1     |   o    |   X    |   o    | |tb_object2_7        | 233|     1     |    1     |   o    |   o    |   X    | |tb_object2_8        | 234|     1     |    1     |   o    |   o    |   X    | |tb_object2_9        | 235|     1     |    1     |   o    |   X    |   o    | |tb_object_0         | 308|     1     |    1     |   o    |   o    |   X    | |tb_object_1         | 275|     1     |    1     |   o    |   o    |   X    | |tb_object_16        | 290|     1     |    1     |   o    |   X    |   o    | |tb_object_17        | 291|     1     |    1     |   o    |   X    |   o    | |tb_object_2         | 276|     1     |    1     |   o    |   o    |   X    | |tb_object_20        | 294|     1     |    1     |   o    |   X    |   o    | |tb_object_21        | 295|     1     |    1     |   o    |   o    |   X    | |tb_object_22        | 296|     1     |    1     |   o    |   o    |   X    | |tb_object_23        | 297|     1     |    1     |   o    |   X    |   o    | |tb_object_24        | 309|     1     |    1     |   o    |   X    |   o    | |tb_object_3         | 277|     1     |    1     |   o    |   o    |   X    | |tb_object_4         | 278|     1     |    1     |   o    |   X    |   o    | |tb_object_5         | 279|     1     |    1     |   o    |   X    |   o    | |tb_object_6         | 280|     1     |    1     |   o    |   X    |   o    | |tb_object_7         | 281|     1     |    1     |   o    |   o    |   X    | |tb_object_8         | 282|     1     |    1     |   o    |   o    |   X    | |tb_object_9         | 283|     1     |    1     |   o    |   o    |   X    | |tb_object_entity    |  82|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_0 | 312|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_12| 262|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_13| 263|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_14| 264|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_15| 265|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_16| 266|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_17| 267|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_18| 268|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_19| 269|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_20| 270|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_21| 271|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_22| 272|     1     |    1     |   o    |   o    |   X    | |tb_object_entity2_23| 273|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_24| 313|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_3 | 253|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_4 | 254|     1     |    1     |   o    |   X    |   o    | |tb_object_entity2_5 | 255|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_0  | 314|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_1  |  83|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_14 |  96|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_15 |  97|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_16 |  98|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_17 |  99|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_18 | 100|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_19 | 101|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_2  |  84|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_24 | 315|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_4  |  86|     1     |    1     |   o    |   o    |   X    | |tb_object_entity_5  |  87|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_6  |  88|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_7  |  89|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_8  |  90|     1     |    1     |   o    |   X    |   o    | |tb_object_entity_9  |  91|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_0  | 321|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_1  | 179|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_11 | 189|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_12 | 190|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_2  | 180|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_20 | 198|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_21 | 199|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_22 | 200|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_23 | 201|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_24 | 322|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_3  | 181|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_4  | 182|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_5  | 183|     1     |    1     |   o    |   X    |   o    | |tb_object_linka1_6  | 184|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_7  | 185|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_8  | 186|     1     |    1     |   o    |   o    |   X    | |tb_object_linka1_9  | 187|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_0  | 298|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_1  | 203|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_10 | 212|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_11 | 213|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_12 | 214|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_13 | 215|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_14 | 216|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_15 | 217|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_16 | 218|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_17 | 219|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_18 | 220|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_19 | 221|     1     |    1     |   o    |   o    |   X    | |tb_object_linka2_2  | 204|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_24 | 299|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_3  | 205|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_4  | 206|     1     |    1     |   o    |   X    |   o    | |tb_object_linka2_8  | 210|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_0   | 306|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_1   | 107|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_10  | 116|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_12  | 118|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_13  | 119|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_14  | 120|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_15  | 121|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_16  | 122|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_17  | 123|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_18  | 124|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_19  | 125|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_2   | 108|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_20  | 126|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_21  | 127|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_22  | 128|     1     |    1     |   o    |   o    |   X    | |tb_object_linka_23  | 129|     1     |    1     |   o    |   X    |   o    | |tb_object_linka_24  | 307|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_0   | 300|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_1   | 131|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_10  | 140|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_11  | 141|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_12  | 142|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_13  | 143|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_14  | 144|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_15  | 145|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_16  | 146|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_17  | 147|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_18  | 148|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_19  | 149|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_2   | 132|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_22  | 152|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_23  | 153|     1     |    1     |   o    |   o    |   X    | |tb_object_linkb_24  | 301|     1     |    1     |   o    |   X    |   o    | |tb_object_linkb_3   | 133|     1     |    1     |   o    |   o    |   X    | |tb_object_links     | 329|     1     |    1     |   o    |   X    |   o    | |tb_object_links_10  | 339|     1     |    1     |   o    |   o    |   X    | |tb_object_links_11  | 340|     1     |    1     |   o    |   o    |   X    | |tb_object_links_12  | 341|     1     |    1     |   o    |   X    |   o    | |tb_object_links_13  | 342|     1     |    1     |   o    |   o    |   X    | |tb_object_links_16  | 345|     1     |    1     |   o    |   o    |   X    | |tb_object_links_17  | 346|     1     |    1     |   o    |   o    |   X    | |tb_object_links_20  | 349|     1     |    1     |   o    |   X    |   o    | |tb_object_links_21  | 350|     1     |    1     |   o    |   o    |   X    | |tb_object_links_22  | 351|     1     |    1     |   o    |   o    |   X    | |tb_object_links_23  | 352|     1     |    1     |   o    |   o    |   X    | |tb_object_links_5   | 334|     1     |    1     |   o    |   X    |   o    | |tb_object_links_6   | 335|     1     |    1     |   o    |   X    |   o    | |tb_object_links_7   | 336|     1     |    1     |   o    |   X    |   o    | |tb_object_links_8   | 337|     1     |    1     |   o    |   X    |   o    | |tb_object_links_9   | 338|     1     |    1     |   o    |   X    |   o    | |v                   |   9|     1     |    1     |   o    |   o    |   X    | |v_0                 | 327|     1     |    1     |   o    |   o    |   X    | |v_10                |  19|     1     |    1     |   o    |   X    |   o    | |v_11                |  20|     1     |    1     |   o    |   X    |   o    | |v_12                |  21|     1     |    1     |   o    |   X    |   o    | |v_13                |  22|     1     |    1     |   o    |   X    |   o    | |v_14                |  23|     1     |    1     |   o    |   X    |   o    | |v_15                |  24|     1     |    1     |   o    |   X    |   o    | |v_16                |  25|     1     |    1     |   o    |   X    |   o    | |v_17                |  26|     1     |    1     |   o    |   o    |   X    | |v_24                | 328|     1     |    1     |   o    |   X    |   o    | |v_3                 |  12|     1     |    1     |   o    |   o    |   X    | |v_5                 |  14|     1     |    1     |   o    |   o    |   X    | |v_6                 |  15|     1     |    1     |   o    |   o    |   X    | |v_7                 |  16|     1     |    1     |   o    |   o    |   X    | |v_8                 |  17|     1     |    1     |   o    |   o    |   X    | |v_9                 |  18|     1     |    1     |   o    |   o    |   X    | +--------------------+----+-----------+----------+--------+--------+--------+ ' in 0.017000 sec(s).  ## Steps to reproduce the problem </body>
		<created>2016-11-14 09:11:23</created>
		<closed>2016-11-14 18:12:16</closed>
	</bug>
	<bug>
		<id>6907</id>
		<title>Match limit apparently not working.  Match() exceeding depth 2 never returns? </title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ 12] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   16GB RAM, Intel i7, Kubuntu 14.04. server.sh:   OrientDB auto-config DISKCACHE=8,315MB (heap=5,461MB direct=524,288MB os=15,824MB) [orientechnologies]  ## Expected behavior match {as:P, class:HumanProtein} -InteractWith- {as:I, while:($depth&lt;2)} return $elements limit 50 returns 50 elements.  ##Actual behavior match {as:P, class:HumanProtein} -InteractWith- {as:I, while:($depth&lt;=2)} return $elements limit 50 This match (&lt;=2) runs forever.  Studio/console.sh resulting log-message: _(and limit of 50 seems to have been forgotten!)_  2016-11-12 14:48:12:662 INFO  {db=HumanPPI2} [TIP] Query 'SELECT FROM HumanProtein' returned a result set with more than 10000 records. Check if you really need all these records, or reduce the resultset by using a LIMIT to improve both performance and used RAM [OProfilerStub]  SELECT/TRAVERSE makes sense, but MATCH behaves strange. See below.  ## Steps to reproduce the problem The export database in question is available for download. 18000+ human proteins and 7.805 million edges with property. Data are very real indeed. Will share export file(approx 329M) if requested.  Also try with varying parameters: match {as:P, class:HumanProtein} -InteractWith- {as:I, while:($depth&lt;2)} return P,I,P.ProteinName as ProteinName,I.ProteinName as InteractingWith,I.GOtermName as GOtermName limit 50  SELECT @rid,$depth,ProteinName,GOtermName FROM (TRAVERSE out("InteractWith") FROM #37:307 WHILE $depth &lt;= 4) limit 50 returns nice sensible data.  Running MATCH while $depth exceeding 2 seems to get stuck. </body>
		<created>2016-11-12 15:13:01</created>
		<closed>2016-11-14 17:00:17</closed>
	</bug>
	<bug>
		<id>6906</id>
		<title>Commit automatically open transaction when changing AutoStartTx mode in TransactionalGraph</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12  ## Expected behavior and actual behavior  In `com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.setAutoStartTx(boolean)`, when invoked passing false as parameter (that is disabling AutoStart), this warning is printed if a transaction is already open.  &gt; "Auto transaction starting is turned off for the graph, but already started transaction is left open. Commit it manually or consider disabling auto transactions while creating the graph or its factory."  I would expect the open transaction to be committed automatically, exactly the same as the java standard [jdbc connection](https://docs.oracle.com/javase/7/docs/api/java/sql/Connection.html#setAutoCommit(boolean)) does:  &gt; NOTE: If this method is called during a transaction and the auto-commit mode is changed, the transaction is committed.  Furthermore, the mentioned warning is impossible to be avoided. When AutoStart is enabled, a manual commit is always followed by opening implicitly a new transaction.  `com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.ensureTransaction()`</body>
		<created>2016-11-11 13:57:40</created>
		<closed>2016-11-16 13:24:44</closed>
	</bug>
	<bug>
		<id>6901</id>
		<title>problems with creating  EMBEDDEDLIST with next types: date, datetime, decimal</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.11   ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?   Hi. I have problems when I create EMBEDDEDLISTs with next types: date, datetime, decimal   ## Steps to reproduce the problem orientdb {db=test}&gt; **create class eml** Class created successfully. Total classes in database now: 12.  orientdb {db=test}&gt; **create property eml.eml embeddedlist date** Property created successfully with id=1  orientdb {db=test}&gt; **create property eml.emldt embeddedlist datetime** Property created successfully with id=2.  orientdb {db=test}&gt; **create property eml.f embeddedlist float** Property created successfully with id=3.  orientdb {db=test}&gt; **create property eml.de embeddedlist Decimal** Property created successfully with id=4.  orientdb {db=test}&gt; **insert into eml content {"f":[5.1,3.1]}** Inserted record 'eml#21:0{f:[2]} v1' in 0,017000 sec(s).  orientdb {db=test}&gt; **select from eml** +----+-----+------+---------+ |#   |@RID |@CLASS|f        | +----+-----+------+---------+ |0   |#21:0|eml   |[5.1,3.1]| +----+-----+------+---------+ 1 item(s) found. Query executed in 0.003 sec(s).  orientdb {db=test}&gt; **insert into eml content {"eml":["2016-10-09","2016-10-11"]}** Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #23:-1        DB name="test" Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #23         DB name="test" Error: java.lang.ClassCastException: java.lang.String cannot be cast to java.util.Date  orientdb {db=test}&gt; **insert into eml content {"emldt":["2016-10-09 15:15:00","2016-10-11 10:10:00"]}** Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #24:-1        DB name="test" Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #24         DB name="test" Error: java.lang.ClassCastException: java.lang.String cannot be cast to java.util.Date  orientdb {db=test}&gt; **insert into eml content {"de":[5.1,3.1]}** Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #21:-1        DB name="test" Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #21         DB name="test" Error: java.lang.ClassCastException: java.lang.Double cannot be cast to java.math.BigDecimal   ## But if I create property embedded with link on this class, I can insert new record  orientdb {db=test}&gt; **create property eml.emClass embedded eml** Property created successfully with id=6.  orientdb {db=test}&gt; **insert into eml content {"emClass":{"@type":"d","@class":"eml","de":[5.1,3.1],"emldt":["2016-10-09 15:15:00","2016-10-11 10:10:00" ], "eml":["2016-10-09","2016-10-11"] }}** Inserted record 'eml#21:1{emClass:eml{de:[2],emldt:[2],eml:[2]}} v1' in 0,021000 sec(s).  orientdb {db=test}&gt; **select from eml** +----+-----+------+---------+-----------------------------+ |#   |@RID |@CLASS|f        |emClass                      | +----+-----+------+---------+-----------------------------+ |0   |#21:0|eml   |[5.1,3.1]|                             | |1   |#21:1|eml   |         |eml{de:[2],emldt:[2],eml:[2]}| +----+-----+------+---------+-----------------------------+ 2 item(s) found. Query executed in 0.003 sec(s). </body>
		<created>2016-11-10 12:27:15</created>
		<closed>2016-11-14 14:30:34</closed>
	</bug>
	<bug>
		<id>6900</id>
		<title>Bug in Graph visualization</title>
		<body>## OrientDB Version, operating system, or hardware. - v.2.2.12   ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior If I create a two edge and both have the same source vertex and the same destionation vertex, I expect to see in the Graph editor two edge instead of one.  ![image](https://cloud.githubusercontent.com/assets/13778147/20175532/87289b96-a743-11e6-9bf3-8d703c004d1e.png)  ![image](https://cloud.githubusercontent.com/assets/13778147/20175563/b7761b34-a743-11e6-8f54-9089373ea1bb.png)   ## Steps to reproduce the problem Create two edges between two vertexes, both edges must have the same source vertex and the same destination vertex.  Thx</body>
		<created>2016-11-10 11:47:43</created>
		<closed>2016-11-18 11:16:27</closed>
	</bug>
	<bug>
		<id>6898</id>
		<title>Embedded attribute's numbers reset to 0, while storing record through binary protocol</title>
		<body>## OrientDB Version ### v2.2.12  ## Operating System ### Linux  ---  Hi guys,  There's been a strange issue, while using **binary protocol** through PhpOrient library (see link below). Basically, after record's been saved it's embedded attribute's internal numeric values (in my case `double`) are reset to 0. @Ostico, the owner of the PhpOrient, is saying that issue happens to him from both the library and console/Studio (he was using OrientDB v2.2.5), while to me it happens only through the library.   This issue on PhpOrient describes the problem in full: https://github.com/Ostico/PhpOrient/issues/84  Could you please help resolve this? The problem does not allow us to move on from 2.1 to 2.2</body>
		<created>2016-11-10 05:12:35</created>
		<closed>2016-11-11 13:43:50</closed>
	</bug>
	<bug>
		<id>6897</id>
		<title>Cannot change cluster selection strategy for class</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12-SNAPSHOT  ## Operating System - [x ] MacOSX  ## Expected behavior and actual behavior  Expected: according to documentation, the _cluster selection strategy_ for a class in distributed mode should be set to `local`.   Actual: _cluster selection strategy_ is set to _round-robin_, and cannot be changed. This leads to error when doing insert, as every _X:th_ insert will fail since it is targeted at a cluster that the current node does not own.  ## Steps to reproduce the problem  - Download v2.2.12, unzip - Run _bin/dserver.sh_ - Login with console application:  _connect remote:localhost/GratefulDeadConcerts root password_ - Try changing cluster selection strategy for class _sung\_by_  ``` orientdb {db=GratefulDeadConcerts}&gt; info class sung_by  CLASS 'sung_by'  Records..............: 501 Super classes........: [E] Default cluster......: sung_by (id=41) Supported clusters...: sung_by(41), sung_by_1(42), sung_by_2(43), sung_by_3(44), sung_by_4(45), sung_by_5(46), sung_by_6(47), sung_by_7(48) Cluster selection....: round-robin Oversize.............: 0.0 orientdb {db=GratefulDeadConcerts}&gt; alter class sung_by clusterselection local  Class updated successfully.  orientdb {db=GratefulDeadConcerts}&gt; info class sung_by  CLASS 'sung_by'  Records..............: 501 Super classes........: [E] Default cluster......: sung_by (id=41) Supported clusters...: sung_by(41), sung_by_1(42), sung_by_2(43), sung_by_3(44), sung_by_4(45), sung_by_5(46), sung_by_6(47), sung_by_7(48) Cluster selection....: round-robin Oversize.............: 0.0 ```   </body>
		<created>2016-11-09 14:22:54</created>
		<closed>2016-11-09 17:24:58</closed>
	</bug>
	<bug>
		<id>6896</id>
		<title>"select from ?" no longer works with OSQLAsynchQuery when upgrading to 2.2.12</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12  ## Operating System - [x] Linux  ## Expected behavior and actual behavior After upgrading to 2.2.12 from 2.1.17 Async query with positional parameter using java api does not work with a query like:   String query = "select @rid,* from ?";  ## Steps to reproduce the problem  String query = "select @rid,* from ?"; graph.command(new OSQLAsynchQuery&lt;Vertex&gt;(query, new OCommandResultListener() {                                       @Override public boolean result(Object iRecord) {                                         }  @Override public void end() {  }  @Override public Object getResult() { // TODO Auto-generated method stub return null; } The new method Object getResult() in the interface OCommandResultListener breaks the existing code. I am not sure what it should be used for?  After fixing the interface most of my queries work but "select from ?" doesn't work. Is it no longer allowed to do this kind of query or is it a regression bug? here is the stack trace:  com.orientechnologies.orient.core.exception.OStorageException: Error on executing command: sql.select @rid,* from ? DB name="mxi2" at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:271) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetry(OStorageRemote.java:193) at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:204) at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1136) at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78) at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.tinkerpop.blueprints.impls.orient.OrientGraphCommand.execute(OrientGraphCommand.java:49)     </body>
		<created>2016-11-09 11:16:23</created>
		<closed>2016-11-30 14:19:39</closed>
	</bug>
	<bug>
		<id>6890</id>
		<title>NullPointerException on MATCH with no in/out/both() and multiple traversals</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .13 SNAPSHOT (2.2.x branch) [x] .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior  Expected: for unrelated classes `A` and `B`, the following query should return the cross product of elements of each type, `A x B`:  ``` MATCH {     class: A,     as: obj_a }, {      class: B,     as: obj_b } RETURN $matches ```  Actual: the query causes a `NullPointerException` in the server.  ## Steps to reproduce the problem  See above query. This works on every schema I've tried, so I doubt the exact schema matters. </body>
		<created>2016-11-08 00:29:25</created>
		<closed>2016-11-08 09:13:48</closed>
	</bug>
	<bug>
		<id>6885</id>
		<title>Incomplete saving of an edge with a remote connection</title>
		<body></body>
		<created>2016-11-07 10:34:24</created>
		<closed>2016-11-07 11:02:36</closed>
	</bug>
	<bug>
		<id>6884</id>
		<title>cannot open database anymore after 2.2.13 snapshots</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13-20161101.003253-11  ## Operating System - [x] Linux  ## Expected behavior and actual behavior After running with 2.2.13, shutting the database server left it in a 'un-openable' state :   launching the server again (any snapshot version 2.2.13-*) and trying to open the dbase from console session, fails with ``` orientdb&gt; use remote:localhost/cdrarch admin $ourPwd Connecting to database [remote:localhost/cdrarch] with user 'admin'... Error: com.orientechnologies.orient.core.exception.OStorageException: Can not close file with id 0 because it is still in use         DB name="cdrarch"         DB name="cdrarch" ```  Have rebooted the operating system, still same problem.  -&gt; server is down !</body>
		<created>2016-11-07 08:59:47</created>
		<closed>2016-11-15 11:51:22</closed>
	</bug>
	<bug>
		<id>6878</id>
		<title>astar function</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ 12] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior SELECT astar(#38:2159,#36:185, 'Score') FROM V  Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: No function with name 'astar', available names are : [date,encod...  ## Steps to reproduce the problem SELECT astar(#source,#dest 'xxx') FROM V</body>
		<created>2016-11-03 22:47:04</created>
		<closed>2016-12-28 05:38:22</closed>
	</bug>
	<bug>
		<id>6877</id>
		<title>Can't rename a property with a period</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12  ## Operating System - [x] Linux - [x] MacOSX  ## Expected behavior and actual behavior I'm trying to rename an existing class property, but it fails. See the terminal commands below: ``` orientdb {db=Customers}&gt; info property SellCampaign.leadCategory                 PROPERTY 'SellCampaign.leadCategory'  Type.................: LINK Mandatory............: true Not null.............: true Read only............: false Default value........: null Minimum value........: null Maximum value........: null REGEXP...............: null Collate..............: {ODefaultCollate : name = default} Linked class.........: SettingsLeadCategory Linked type..........: null  orientdb {db=Customers}&gt; ALTER PROPERTY SellCampaign.leadCategory NAME category Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Property 'SellCampaign.leadCategory' not exists DB name="Customers" DB name="Customers" ```  It complaints that the property does not exist, but it does. The property is the embedded link to another class, but should it be a problem? </body>
		<created>2016-11-03 20:28:54</created>
		<closed>2016-11-11 15:01:17</closed>
	</bug>
	<bug>
		<id>6872</id>
		<title>ETL giving up after one error</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ 12] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   **Error in Pipeline execution: com.orientechnologies.orient.core.exception.OCommandExecutionException: No edge has been created because no target vertices** Why give up(see below log)? Can't this process just report the problem and continue? With millions of edges in question this is behavior is inefficient and wasting lots of time. In the other ETL transformers you can specify "unresolvedLinkAction". Why not add this(or similar features) to the Command Transformer also?   ## Expected behavior and actual behavior  From a three column csv-file(arg1,arg2,arg3) arguments are taken to create edges with one property.  The essence of the actual ETL json config is this:  "command" :    create edge from (select from ClassX where $input.arg1..) to (select from ClassX where $input.arg2..) set something=$input.arg3  Here is what happens if one target vertice is not found: ------------ excerpt from logging: + extracted 7,996 rows (5 rows/sec) - 7,996 rows -&gt; loaded 7,493 vertices (5 vertices/sec) Total time: 1662154ms [0 warnings, 0 errors] + extracted 8,000 rows (4 rows/sec) - 8,000 rows -&gt; loaded 7,497 vertices (4 vertices/sec) Total time: 1663154ms [0 warnings, 0 errors] + extracted 8,004 rows (4 rows/sec) - 8,004 rows -&gt; loaded 7,501 vertices (4 vertices/sec) Total time: 1664154ms [0 warnings, 0 errors] + extracted 8,008 rows (4 rows/sec) - 8,008 rows -&gt; loaded 7,505 vertices (4 vertices/sec) Total time: 1665154ms [0 warnings, 0 errors] Error in Pipeline execution: com.orientechnologies.orient.core.exception.OCommandExecutionException: No edge has been created because no target vertices         DB name="XXXX"         DB name="XXXX" + extracted 8,010 rows (1 rows/sec) - 8,010 rows -&gt; loaded 7,507 vertices (1 vertices/sec) Total time: 1666155ms [0 warnings, 1 errors] + extracted 8,010 rows (0 rows/sec) - 8,010 rows -&gt; loaded 7,507 vertices (0 vertices/sec) Total time: 1667155ms [0 warnings, 1 errors] + extracted 8,010 rows (0 rows/sec) - 8,010 rows -&gt; loaded 7,507 vertices (0 vertices/sec) Total time: 1668155ms [0 warnings, 1 errors] + extracted 8,010 rows (0 rows/sec) - 8,010 rows -&gt; loaded 7,507 vertices (0 vertices/sec) Total time: 1669155ms [0 warnings, 1 errors] + extracted 8,010 rows (0 rows/sec) - 8,010 rows -&gt; loaded 7,507 vertices (0 vertices/sec) Total time: 1670156ms [0 warnings, 1 errors]  ## Steps to reproduce the problem You need a class containing some 1000' records and a list of the vertices to be linked (see above).  </body>
		<created>2016-11-02 10:44:45</created>
		<closed>2016-12-29 16:59:38</closed>
	</bug>
	<bug>
		<id>6870</id>
		<title>com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error during creation of mapping between logical adn physical record position</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12  ## Operating System - Linux  ## The Problem The following partial log entries had started to show and I'm not sure what could be the cause for it. The change implemented just before this issues started to show was to introduce Trove libraries in our app, but I don't see how that could be related as we are not persisting Trove collections in DB. This does show only on Production environment, not in DEV. Any hint please?   nbr.1 type of entry in application log: ``` 2016-11-01 17:50:29.605 [ActiveMQ Session Task-3] ERROR com.develance.vlastni.api.jms.SendMailListenerHelperImpl 48 setMailDeliveryStatus - com.orientechnologies.orient.core.exception.OClusterPos$         DB name="vlasni4"         Component Name="receivesemail"         DB name="vlasni4"         Component Name="receivesemail" com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error during creation of mapping between logical adn physical record position         DB name="vlasni4"         Component Name="receivesemail"         DB name="vlasni4"         Component Name="receivesemail"         at sun.reflect.GeneratedConstructorAccessor71.newInstance(Unknown Source) ~[?:?]         at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:1.8.0_111]         at java.lang.reflect.Constructor.newInstance(Constructor.java:423) ~[?:1.8.0_111]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:437) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:388) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:270) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:162) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2138) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote$28.execute(OStorageRemote.java:1321) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote$28.execute(OStorageRemote.java:1294) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:196) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetry(OStorageRemote.java:193) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:204) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.commit(OStorageRemote.java:1294) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:560) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.commit(OrientTransactionalGraph.java:175) ~[orientdb-graphdb-2.2.12.jar:2.2.12]         at com.develance.vlastni.api.jms.SendMailListenerHelperImpl.createMailEntry(SendMailListenerHelperImpl.java:90) ~[SendMailListenerHelperImpl.class:?]         at com.develance.vlastni.api.jms.SendMailListenerHelperImpl.setMailDeliveryStatus(SendMailListenerHelperImpl.java:42) [SendMailListenerHelperImpl.class:?]         at com.develance.vlastni.api.jms.SendMailListener.onMessage(SendMailListener.java:33) [SendMailListener.class:?]         at org.apache.activemq.ActiveMQMessageConsumer.dispatch(ActiveMQMessageConsumer.java:1390) [activemq-all-5.10.0.jar:5.10.0]         at org.apache.activemq.ActiveMQSessionExecutor.dispatch(ActiveMQSessionExecutor.java:131) [activemq-all-5.10.0.jar:5.10.0]         at org.apache.activemq.ActiveMQSessionExecutor.iterate(ActiveMQSessionExecutor.java:202) [activemq-all-5.10.0.jar:5.10.0]         at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133) [activemq-all-5.10.0.jar:5.10.0]         at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48) [activemq-all-5.10.0.jar:5.10.0]         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]         at java.lang.Thread.run(Thread.java:745) [?:1.8.0_111] Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component         DB name="vlasni4"         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:450) ~[orientdb-core-2.2.12.ja$         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:405) ~[orientdb-core-2.2.12.ja$         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.allocate(OClusterPositionMap.java:270) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.allocatePosition(OPaginatedCluster.java:424) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1395) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:566) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1309) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:580) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ~[orientdb-core-2.2.12.jar:2.2.12]  ``` nbr.2 type of entry in application log: ``` 2016-11-01 17:50:30.332 [http-nio-9090-exec-58] ERROR com.develance.vlastni.api.resource.OfferResource 895 getOfferChanges - com.orientechnologies.orient.core.exception.OStorageException: Cannot $         DB name="vlasni4"         DB name="vlasni4" com.orientechnologies.orient.core.exception.OStorageException: Cannot put key value entry in index         DB name="vlasni4"         DB name="vlasni4"         at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_111]         at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ~[?:1.8.0_111]         at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:1.8.0_111]         at java.lang.reflect.Constructor.newInstance(Constructor.java:423) ~[?:1.8.0_111]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:437) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:388) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:270) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:162) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2138) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote$28.execute(OStorageRemote.java:1321) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote$28.execute(OStorageRemote.java:1294) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:196) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetry(OStorageRemote.java:193) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:204) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.client.remote.OStorageRemote.commit(OStorageRemote.java:1294) ~[orientdb-client-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:560) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.commit(OrientTransactionalGraph.java:175) ~[orientdb-graphdb-2.2.12.jar:2.2.12]         at com.develance.vlastni.api.resource.helper.InstallationResourceHelperImpl.notifyActivity(InstallationResourceHelperImpl.java:183) ~[InstallationResourceHelperImpl.class:?]         at com.develance.vlastni.api.resource.OfferResource.getOfferChanges(OfferResource.java:885) [OfferResource.class:?]         at com.develance.vlastni.api.resource.OfferResource$$FastClassBySpringCGLIB$$46be27b5.invoke(&lt;generated&gt;) [spring-core-3.2.13.RELEASE.jar:?]         at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) [spring-core-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:700) [spring-aop-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150) [spring-aop-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.cache.interceptor.CacheInterceptor$1.invoke(CacheInterceptor.java:58) [spring-context-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.cache.interceptor.CacheAspectSupport.execute(CacheAspectSupport.java:211) [spring-context-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.cache.interceptor.CacheInterceptor.invoke(CacheInterceptor.java:66) [spring-context-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) [spring-aop-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:633) [spring-aop-3.2.13.RELEASE.jar:3.2.13.RELEASE]         at com.develance.vlastni.api.resource.OfferResource$$EnhancerBySpringCGLIB$$8f0df402.getOfferChanges(&lt;generated&gt;) [spring-core-3.2.13.RELEASE.jar:?]         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_111]         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_111]         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_111]         at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_111]         at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory$1.invoke(ResourceMethodInvocationHandlerFactory.java:81) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:151) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:171) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$TypeOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:195) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:104) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:387) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:331) [jersey-server.jar:?]         at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:103) [jersey-server.jar:?]         at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:271) [jersey-server.jar:?]         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:271) [jersey-common.jar:?]         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:267) [jersey-common.jar:?]         at org.glassfish.jersey.internal.Errors.process(Errors.java:315) [jersey-common.jar:?]         at org.glassfish.jersey.internal.Errors.process(Errors.java:297) [jersey-common.jar:?]         at org.glassfish.jersey.internal.Errors.process(Errors.java:267) [jersey-common.jar:?]         at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:297) [jersey-common.jar:?]         at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:254) [jersey-server.jar:?]         at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:1030) [jersey-server.jar:?]         at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:373) [jersey-container-servlet-core.jar:?]         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:381) [jersey-container-servlet-core.jar:?]         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:344) [jersey-container-servlet-core.jar:?]         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:221) [jersey-container-servlet-core.jar:?]         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:291) [catalina.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.20]         at com.develance.vlastni.api.db.DBControlFilter.doFilter(DBControlFilter.java:26) [com.develance.vlastni.common-0.0.2-SNAPSHOT.jar:?]         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239) [catalina.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.20]         at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-websocket.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239) [catalina.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.20]         at org.apache.catalina.filters.CorsFilter.handleNonCORS(CorsFilter.java:438) [catalina.jar:8.0.20]         at org.apache.catalina.filters.CorsFilter.doFilter(CorsFilter.java:179) [catalina.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239) [catalina.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.20]         at com.develance.vlastni.api.auth.AuthFilter.doFilter(AuthFilter.java:57) [AuthFilter.class:?]         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239) [catalina.jar:8.0.20]         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.20]         at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219) [catalina.jar:8.0.20]         at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106) [catalina.jar:8.0.20]         at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:501) [catalina.jar:8.0.20]         at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142) [catalina.jar:8.0.20]         at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [catalina.jar:8.0.20]         at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:610) [catalina.jar:8.0.20]         at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88) [catalina.jar:8.0.20]         at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:516) [catalina.jar:8.0.20]         at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1086) [tomcat-coyote.jar:8.0.20]         at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:659) [tomcat-coyote.jar:8.0.20]         at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223) [tomcat-coyote.jar:8.0.20]         at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1558) [tomcat-coyote.jar:8.0.20]         at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1515) [tomcat-coyote.jar:8.0.20]         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]         at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-util.jar:8.0.20]         at java.lang.Thread.run(Thread.java:745) [?:1.8.0_111] Caused by: com.orientechnologies.orient.core.exception.OStorageException: Error during index removal         DB name="vlasni4"         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.remove(OLocalHashTable.java:549) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.remove(OHashTableIndexEngine.java:130) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateIndexEntry(OAbstractPaginatedStorage.java:2017) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateIndexEntry(OAbstractPaginatedStorage.java:1936) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexMultiValues.remove(OIndexMultiValues.java:194) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexAbstract.removeFromSnapshot(OIndexAbstract.java:910) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:741) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:709) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:1458) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1422) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:566) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1309) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:580) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ~[orientdb-core-2.2.12.jar:2.2.12] Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused$ com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record update         DB name="vlasni4"         Component Name="installation"         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.updateRecord(OPaginatedCluster.java:1110)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateRecord(OAbstractPaginatedStorage.java:3167)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:3710)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1418)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:566)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1309)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:580)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component         DB name="vlasni4"         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:450)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:405)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.updateRecord(OPaginatedCluster.java:1107)         ... 12 more          DB name="vlasni4"         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:450) ~[orientdb-core-2.2.12.ja$         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:405) ~[orientdb-core-2.2.12.ja$         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.remove(OLocalHashTable.java:510) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.remove(OHashTableIndexEngine.java:130) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateIndexEntry(OAbstractPaginatedStorage.java:2017) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateIndexEntry(OAbstractPaginatedStorage.java:1936) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexMultiValues.remove(OIndexMultiValues.java:194) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexAbstract.removeFromSnapshot(OIndexAbstract.java:910) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:741) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:709) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:1458) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1422) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:566) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697) ~[orientdb-core-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1309) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:580) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197) ~[orientdb-server-2.2.12.jar:2.2.12]         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ~[orientdb-core-2.2.12.jar:2.2.12]  ```  Below is the only entry logged in `orientdb.err`: ``` com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record update         DB name="vlasni4"         Component Name="installation"         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.updateRecord(OPaginatedCluster.java:1110)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateRecord(OAbstractPaginatedStorage.java:3167)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:3710)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1418)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:566)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2728)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1309)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:580)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component         DB name="vlasni4"         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:450)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:405)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.updateRecord(OPaginatedCluster.java:1107)         ... 12 more ```</body>
		<created>2016-11-01 21:06:55</created>
		<closed>2016-11-18 11:12:39</closed>
	</bug>
	<bug>
		<id>6866</id>
		<title>Can't enter complex sub-query during in(),out(),...</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[X] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior I have heard you should be able to add conditions when calling `out()`, for example: `select out('friendswith')[condition].out('friendswith')[condition] from E` This should only select vertices that are connected with 'friends with' where a condition is applied. I can make this work for simple conditions like `type="best"` but I can't do, for example, `type IN ["best","second best"]`.  Also, I can't find the documentation on this conditioning anywhere. </body>
		<created>2016-10-31 21:39:02</created>
		<closed>2016-12-28 11:07:24</closed>
	</bug>
	<bug>
		<id>6865</id>
		<title>Drop database with Lucene index complains</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[12] - .rc1[ ] .beta2[ ] .beta1[ ]  ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   ## Expected behavior and actual behavior One would expect database to be dropped with no complaints.  2016-10-31 13:59:33:534 SEVER {db=pAB} Cannot delete storage directory with path /srv/OrientDB2.2.x/pAB because directory is not empty. Files: [/srv/OrientDB2.2.x/pAB/luceneIndexes] [OLocalPaginatedStorage]  ## Steps to reproduce the problem Install Lucene Spatial, wget  http://central.maven.org/maven2/com/orientechnologies... Add records in class containing property with EMBEDDED OPoint. Drop database from Studio.  An empty directory is left: /srv/OrientDB2.2.x/pAB/luceneIndexes/</body>
		<created>2016-10-31 13:08:13</created>
		<closed>2016-10-31 14:44:00</closed>
	</bug>
	<bug>
		<id>6859</id>
		<title>Orientdb getVertices() returning Vertex for any label present in database after vertex indexed  with unique name(String) property</title>
		<body>## OrientDB Version, operating system, or hardware. ##  - v2.2 SNAPSHOT[ ] - .10 ## Operating System - Linux ## Expected behavior and actual behavior  Orientdb getVertices(lable, [] iKey, [] iValue)) returing Vertex for any label present in database after I index my vertex by unique name(String) property ## Steps to reproduce the problem  ``` `public class App  {     public static void main( String[] args )     {         String DB_NAME = "WonderLand";         OrientGraph graph = Service.getOrCreateGraphInstance(DB_NAME);           OrientVertexType ovt = graph.createVertexType("Person");         OrientVertexType ovt1 = graph.createVertexType("Relation");          graph.createKeyIndex("uid", Vertex.class, new Parameter("type", "UNIQUE"));       OrientVertex v = graph.addVertex("class:Person");          v.setProperties("uid", "ram");         v.setProperties("event", "Login");            Iterable&lt;Vertex&gt; it = graph.getVertices("Person", new String[]{"uid"}, new String[]{"ram"});         System.out.println("vertex Person-&gt;&gt; " + it.iterator().next());          Iterable&lt;Vertex&gt; it2 = graph.getVertices("Relation", new String[]{"uid"}, new String[]{"ram"});         System.out.println("vertex Relation-&gt;&gt; " + it2.iterator().next());         } } ` ``` ## Result with Indexing : - vertex Person-&gt;&gt; v(Person)[#-1:-2] - vertex Relation-&gt;&gt; v(Person)[#-1:-2] ## Result without Indexing : - vertex Person-&gt;&gt; v(Person)[#-1:-2]  kindly have a look at this [http://stackoverflow.com/questions/39999533/orientdb-getvertices-returing-vertex-for-any-label-present-in-database](stack overflow link) for more detail. </body>
		<created>2016-10-28 22:36:31</created>
		<closed>2016-11-30 15:14:03</closed>
	</bug>
	<bug>
		<id>6857</id>
		<title>createDefaultUsers=False breaks creating databases from Studio</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .12[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  `security.json` specifies:  ``` "server": {     "createDefaultUsers": false } ```  Expected behavior: using Studio to create a new database should succeed and log me into the new database. Actual behavior: Studio creates the new database, then gets disconnected with an authentication error. Using the developer tools in my browser, I can see that Studio attempted to use `admin/admin` as the credentials to log me into the new database, which failed since `security.json` prohibits default users.  This is the same problem as #6564 except in Studio rather than the console. ## Steps to reproduce the problem  Edit the default `security.json` to set `createDefaultUsers` to `true` and restart the server. Try to create a new database from Studio, and observe it not working as described above. </body>
		<created>2016-10-28 18:41:17</created>
		<closed>2016-11-29 16:49:22</closed>
	</bug>
	<bug>
		<id>6854</id>
		<title>DROP, SELECT or DESC of a class returns Java error</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13-20161027.133116-9 ## Operating System - [x] Linux  Had a class "files_loaded" before, did a rename of it (ALTER CLASS files_loaded name files_loaded1) a few days ago; meanwhile upgraded ODB to the listed v2.2.13 snapshot release; now want to cleanup this old class, but get errors:  ``` &gt; desc files_loaded1 CLASS 'files_loaded1' Error: com.orientechnologies.orient.enterprise.channel.binary.OResponseProcessingException: Exception during response processing Error: java.lang.NullPointerException  &gt; select * from files_loaded1 Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select * from files_loaded1         DB name="cdrarch"         DB name="cdrarch" Error: java.lang.NullPointerException  &gt; drop class files_loaded1 Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.drop class files_loaded1         DB name="cdrarch"         DB name="cdrarch" Error: java.lang.NullPointerException ```  No errors appear in the logfile. =&gt; what's going on ? How to get more details about the status of this class ? I can now drop it, but imagine this is about a class that I would still need, then how can this situation be corrected ? There is nothing in the docs about such a situation... </body>
		<created>2016-10-28 09:20:03</created>
		<closed>2016-11-29 18:00:19</closed>
	</bug>
	<bug>
		<id>6853</id>
		<title>Failure to open database after recovery: "Can not close file with id 0 because it is still in use"</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2.4 ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Java  java version "1.7.0_79" OpenJDK Runtime Environment (IcedTea 2.5.6) (7u79-2.5.6-0ubuntu1.14.04.1) OpenJDK 64-Bit Server VM (build 24.79-b02, mixed mode) ## Expected behavior and actual behavior  Expected: After recovering a database from a forced shutdown, the server successfully connects to it.  Actual: It fails to open the database and gives this error: `Internal server error: com.orientechnologies.orient.core.exception.OStorageException: Can not close file with id 0 because it is still in use` ## Steps to reproduce the problem  After attempting to shut down the database for an extended period of time, I had to run a "kill -9". One of the databases that wasn't even in use at the time got corrupted, and I cannot open it when connecting remotely or locally.  This is from orientdb.err:  &gt; 2016-10-27 14:38:15:202 WARNI {db=dbname} Storage 'dbname' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:15:202 INFO  {db=dbname} Looking for last checkpoint... [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:15:203 INFO  {db=dbname} Checkpoints are absent, the restore will start from the beginning. [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:15:203 INFO  {db=dbname} Data restore procedure is started. [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:15:280 WARNI {db=dbname} Non tx operation was used during data modification we will need index rebuild. [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:15:283 SEVER {db=dbname} Data restore was paused because of exception. The rest of changes will be rolled back and WAL files will be backed up. Please report issue about this exception to bug tracker and provide WAL files which are backed up in 'wal_backup' directory. [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:27:199 INFO  {db=dbname} Storage data recover was completed [OLocalPaginatedStorage] &gt; 2016-10-27 14:38:27:205 SEVER {db=dbname} Internal server error: &gt; com.orientechnologies.orient.core.exception.OStorageException: Can not close file with id 0 because it is still in use &gt;   DB name="dbname" [ONetworkProtocolHttpDb] </body>
		<created>2016-10-27 15:13:53</created>
		<closed>2017-01-10 08:01:23</closed>
	</bug>
	<bug>
		<id>6852</id>
		<title>ORecordNotFoundException with -2 cluster under stress conditions</title>
		<body>## OrientDB Version, operating system, or hardware.  OrientDB 2.2.12, MacOS Sierra, Java API ## Expected behavior and actual behavior  Hi,  I work with a query generator that produces type-clustered Breadth First Search queries, such as :  `SELECT $_root.nextVertices AS _root, $_layerA AS _layerA LET $_root = map('nextVertices', (SELECT FROM RootType)), $_layerA = (SELECT @rid AS parentId, out('rootToA') AS nextVertices FROM $_root.nextVertices) FETCHPLAN _root:1 _layerA:2` (in this example, $_root will contains the set of root nodes and $_layerA will contains the nodes of type TypeA that are direct descendant of the root nodes).  Such requests creates a lot of "fake" nodes (#-2:*) and, under stress conditions (large dataset or loop), an ORecordNotFoundException is thrown (see stack trace below).  The problem never happens when I run my queries in Studio.  ``` Exception in thread "main" com.orientechnologies.orient.core.exception.ORecordNotFoundException: The record with id '#-2:3561' was not found     DB name="testDatabase"     DB name="testDatabase"     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)     at java.lang.reflect.Constructor.newInstance(Constructor.java:422)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:428)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:379)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:261)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:153)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2132)     at com.orientechnologies.orient.client.remote.OStorageRemote$9.execute(OStorageRemote.java:663)     at com.orientechnologies.orient.client.remote.OStorageRemote$9.execute(OStorageRemote.java:645)     at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:196)     at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:228)     at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:193)     at com.orientechnologies.orient.client.remote.OStorageRemote.readRecord(OStorageRemote.java:645)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3238)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1888)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:115)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1628)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:103)     at com.orientechnologies.orient.core.id.ORecordId.getRecord(ORecordId.java:330)     at com.tinkerpop.blueprints.impls.orient.OrientElementIterator.next(OrientElementIterator.java:62)     at com.tinkerpop.blueprints.impls.orient.OrientElementIterator.next(OrientElementIterator.java:35)     at Test7.main(Test7.java:41) Caused by: java.lang.IllegalArgumentException: Cluster segment #-2 does not exist in database 'testDatabase'     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkClusterSegmentIndexRange(OAbstractPaginatedStorage.java:3739)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getClusterById(OAbstractPaginatedStorage.java:2424)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1081)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3238)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1888)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:97)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1651)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:103)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.readRecord(ONetworkProtocolBinary.java:1791)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:533)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  Given that the proplem occurs only when I stress the database, it may be a race condition somewhere in the Java API. ## Steps to reproduce the problem  Here is a snippet for reproducing the problem. You can vary the number of nodes with the nbRoots variable. With my computer, the problem occurs around nbRoots &gt;= 4000. However, if I increase the number of branches (more layers), the exception can be thrown with less than 100 root nodes.  ``` java OrientGraph graph = ... graph.begin();  graph.command(new OCommandSQL("DELETE VERTEX V")).execute(); graph.commit();  int nbRoots = 4000; for (int i = 0; i &lt; nbRoots; i++) {     OrientVertex root = graph.addVertex("class:RootType");     OrientVertex child = graph.addVertex("class:TypeA");     root.addEdge("rootToA", child); } graph.commit();  String query = "SELECT $_root.nextVertices AS _root, $_layerA AS _layerA LET $_root = map('nextVertices', (SELECT FROM RootType)), $_layerA = (SELECT @rid AS parentId, out('rootToA') AS nextVertices FROM $_root.nextVertices) FETCHPLAN _root:1 _layerA:2"; Iterable&lt;OrientVertex&gt; results = graph.command(new OCommandSQL(query)).execute(); OrientVertex first = results.iterator().next();  Iterable&lt;OrientVertex&gt; vertices = first.getProperty("_layerA"); for (OrientVertex vertex : vertices) {     vertex.getProperties(); } ``` </body>
		<created>2016-10-27 09:10:30</created>
		<closed>2016-11-17 13:46:50</closed>
	</bug>
	<bug>
		<id>6850</id>
		<title>Operator INSTANCEOF doesn't work in MATCH where clause after traverse</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .8[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Expected: in MATCH where clauses in the second traversal step and beyond, `A instanceof B` returns true if the class A is an instance of B.  Actual: `A instanceof B` always evaluates to false, even when `A = B` would evaluate to true. ## Steps to reproduce the problem  Setup:  ``` CREATE CLASS V1 EXTENDS V CREATE PROPERTY V1.name String  CREATE CLASS V2 EXTENDS V CREATE PROPERTY V2.callsign String  CREATE VERTEX V1 SET name = 'foo' CREATE VERTEX V2 SET callsign = 'bar'  CREATE EDGE E FROM (SELECT FROM V1 WHERE name = 'foo') TO (SELECT FROM V2 WHERE callsign = 'bar')  // the following returns the two added vertices, as expected MATCH {     class: V1,     as: origin }.out('E') {     where: (@class = 'V2')     as: endpoint } RETURN $matches ```  However, none of the following queries return anything:  ``` MATCH {     class: V1,     as: origin }.out('E') {     where: (@class instanceof 'V2'),     as: endpoint } RETURN $matches  MATCH {     class: V1,     as: origin }.out('E') {     where: (@class instanceof 'V'),     as: endpoint } RETURN $matches  MATCH {     class: V1,     as: origin }.out('E') {     where: ($currentMatch instanceof 'V2'),     as: endpoint } RETURN $matches  MATCH {     class: V1,     as: origin }.out('E') {     where: ($currentMatch instanceof 'V'),     as: endpoint } RETURN $matches ```  In the initial step of MATCH, the operator partially works:  ``` // this returns the two vertices, as expected MATCH {     class: V1,     where: (@class instanceof 'V'),     as: origin }.out('E') {     as: endpoint } RETURN $matches  // however, this query still returns no results MATCH {     class: V1,     where: ($currentMatch instanceof 'V'),     as: origin }.out('E') {     as: endpoint } RETURN $matches  // this query also returns no results MATCH {     class: V1,     where: ($currentMatch.@class instanceof 'V'),     as: origin }.out('E') {     as: endpoint } RETURN $matches ```  Possibly related to #6830. </body>
		<created>2016-10-26 14:27:00</created>
		<closed>2016-10-27 08:54:35</closed>
	</bug>
	<bug>
		<id>6849</id>
		<title>Unable to create abstract Vertex Type on OrientDB 2.2.12 on partitioned graph</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12 ## Operating System - [ x] Linux ## Expected behavior and actual behavior  Trying to create an abstarct Vertex type on OrientDB 2.2.12 I Obtain the following exception. The code worked on OrientDB 2.2.0.  ``` Exception in thread "main" com.orientechnologies.orient.core.exception.OSecurityException: Class 'MyVertexType' cannot be truncated because has record level security enabled (extends 'ORestricted')     DB name="mydb"     DB name="mydb"     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)     at java.lang.reflect.Constructor.newInstance(Constructor.java:526)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:437)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:388)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:270)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:162)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2138)     at com.orientechnologies.orient.client.remote.OStorageRemote$27.execute(OStorageRemote.java:1160)     at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:196)     at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:235)     at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperationRetry(OStorageRemote.java:193)     at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:204)     at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1136)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.setAbstract(OClassImpl.java:1369)     at com.orientechnologies.orient.core.metadata.schema.OClassAbstractDelegate.setAbstract(OClassAbstractDelegate.java:63)     at com.acme.Test.main(Test.java:68) ```  By debugging I found that the cause is:  ``` Caused by: com.orientechnologies.orient.core.exception.ODatabaseException:  Impossible to remove the last cluster of class 'Entity' drop the class instead     DB name="mydb"     DB name="mydb" ``` ## Steps to reproduce the problem  You can find the a complete project to reproduce this behaviour at https://github.com/lucafrosini/test-orientdb-2-2-12  hope this helps. If I can help to solve the problem do not hesitate to contact me. </body>
		<created>2016-10-26 12:38:15</created>
		<closed>2016-10-31 19:48:15</closed>
	</bug>
	<bug>
		<id>6848</id>
		<title>query via Lucene returns incorrect results</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12 SNAPSHOT[x] - 20161019 ## Operating System - [x] Linux  Records (documents) get INSERTed into a class; on a property FILENAME there is a FULLTEXT LUCENE index created.  When I search in this class for records that have a certain FILENAME, via the LUCENE operator (forcing it to use the Lucene index), the result is incorrect compared to the use of operator "=":  ``` SELECT count(*) FROM cdr_icx_20161023 WHERE ENV='uat' AND FILENAME = 'ICX001ICX20161025100000.109444' --&gt; returns 8 SELECT count(*) FROM cdr_icx_20161023 WHERE ENV='uat' AND FILENAME LUCENE 'ICX001ICX20161025100000.109444' --&gt; return 1 ```  =&gt; Lucene index is incorrect. </body>
		<created>2016-10-26 10:58:54</created>
		<closed>2016-10-27 16:11:55</closed>
	</bug>
	<bug>
		<id>6846</id>
		<title>Escaped char doesn't work for create edge</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2 SNAPSHOT[x] ## Operating System - [x] Linux ## Expected behavior  The escaped '\"' works for a normal query but for a create edge query it doesn't work ## Steps to reproduce the problem  The query that works :  `'SELECT FROM Expression WHERE libelle = "\"Plaine \"\"le Devez\"\"\""'`  The query that doesn't work : `CREATE EDGE Identifie FROM (SELECT FROM Expression WHERE libelle = "\"Plaine \"\"le Devez\"\"\"") to (SELECT FROM Etab WHERE id = "54886802")`  Thanks in advance </body>
		<created>2016-10-26 08:22:00</created>
		<closed>2016-10-29 15:27:43</closed>
	</bug>
	<bug>
		<id>6845</id>
		<title>Incorrect results returned from MATCH with `class` filter</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .8[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   On our production database, I am seeing incorrect results returned from a specific MATCH query involving a filtering step using the `class:` keyword after an edge traversal. Unfortunately, I was not able to construct a reproducible testcase that does not involve our proprietary data, and I am not able to share the data or the exact schema we are using.  Here is a schema and small dataset that capture some of the relevant relationships in our production setup:  ``` CREATE CLASS Base EXTENDS V CREATE PROPERTY Base.name String  CREATE CLASS AbstractFoo EXTENDS Base ABSTRACT CREATE CLASS Foo EXTENDS AbstractFoo  CREATE CLASS AbstractMixin EXTENDS V ABSTRACT CREATE CLASS GeneralBar EXTENDS Base CREATE CLASS SpecificBar EXTENDS GeneralBar, AbstractMixin  CREATE CLASS Unrelated EXTENDS Base  CREATE CLASS AbstractFoo_Base EXTENDS E CREATE PROPERTY AbstractFoo_Base.out LINK AbstractFoo CREATE PROPERTY AbstractFoo_Base.in LINK Base  CREATE CLASS Unrelated_SpecificBar EXTENDS E CREATE PROPERTY Unrelated_SpecificBar.out LINK Unrelated  CREATE PROPERTY Unrelated_SpecificBar.in LINK SpecificBar  CREATE VERTEX Foo SET name = 'foo' CREATE VERTEX SpecificBar SET name = 'bar' CREATE VERTEX Unrelated SET name = 'unrelated' CREATE EDGE AbstractFoo_Base FROM (SELECT FROM Foo) TO (SELECT FROM SpecificBar) CREATE EDGE Unrelated_SpecificBar FROM (SELECT FROM Unrelated) TO (SELECT FROM SpecificBar) ``` ## Expected behavior and actual behavior  Expected: queries that look like the following:  ``` // query 1 MATCH {     class: SpecificBar,     as: origin,     where: (name = 'bar') }.in('AbstractFoo_Base') {     class: Foo,     as: endpoint } RETURN origin, endpoint ```  have the property that `origin instanceof SpecificBar` and `endpoint instanceof Foo` are both true, as the `class:` query keywords in the two match steps indicate.  Actual: we found a query on our production system for which one of the returned values was not an instance of the class with which it was supposed to be filtered in its match step. The query was similar to this:  ``` // query 2 MATCH {     class: SpecificBar,     as: origin,     where: (name = 'bar') }.in('AbstractFoo_Base') {     class: Unrelated,     as: endpoint } RETURN origin, endpoint ```  Note that executing the above query on OrientDB 2.2.8, with the above schema and data, correctly returns no results. This is because the vertices of type `Unrelated` cannot and are not connected by an edge of type `AbstractFoo_Base`.  However, the analogous query to query 2 on our production OrientDB 2.2.8 returned one row -- the same row as query 1, for which `endpoint instanceof Unrelated` is not true as `endpoint` is of type `Foo`. ## Steps to reproduce the problem  As I mentioned, I was not able to reproduce the problem outside of our production system. However, I narrowed down the set of conditions that must be true for the bug to appear, and was hoping that someone with deeper knowledge of the MATCH execution system could use that to find the problem. Here is what I found: - Replacing `class: Unrelated` with `class: E` has the same incorrect result. - Replacing `class: Unrelated` with a class that does not exist generates an error (correctly). - Replacing `class: Unrelated` with a class that has no entries that are connected via edges of any type to `SpecificBar`, correctly returns no results. - Replacing `class: Unrelated` with a class `X` such that the schema specifies an edge that connects `X` to `SpecificBar`, but there are no entries of type `X` or its subtypes, correctly returns no results. - Replacing `class: Unrelated` with any class `Y` that has entries connected by edges to a `SpecificBar` that is not the one selected by the first step in the `MATCH`, correctly returns no results. - Replacing `class: Unrelated` with any class `Z` that has entries connected by edges to the exact `SpecificBar` that is selected by the first step in the `MATCH`, **generates the incorrect entry**, even though `Z` is not a superclass of `SpecificBar`.  One additional thing that may be complicating things -- we have kept the same database (upgraded from version to version) from approximately OrientDB 2.1.5, so the issue may also depend on that upgrade process. I was not able to export/import the data into a completely-new OrientDB database due to #6758 / #6759.  This is also a serious problem that is currently impeding my GraphQL-to-MATCH compilation work, as the compilation generates correct outputs that nevertheless produce incorrect results.  Thanks in advance for looking into it, and please let me know if I can help your investigation and debugging. </body>
		<created>2016-10-25 22:14:50</created>
		<closed>2016-10-27 09:23:26</closed>
	</bug>
	<bug>
		<id>6842</id>
		<title>using sequence gives "Error in transactional processing"</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12 ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  The following SQL statement has been working for some 1000's of times, but suddenly it aborts with the below error:  ``` INSERT INTO files_loaded SET FILENAME='ICX001ICX20161019155500.095588', FILE_ID=sequence('seq_files_loaded').next(), WHEN_LOADED='2016-10-25 14:14:00.000', ENV= 'prod' ```  The error:   ``` com.orientechnologies.orient.core.exception.OSequenceException: Error in transactional processing of seq_files_loaded.next() ```  The class "files_loaded" contains these 4 properties FILENAME, FILE_ID, WHEN_LOADED and ENV; there is a unique index on FILENAME, but no record exists yet with this same FILENAME. </body>
		<created>2016-10-25 12:27:21</created>
		<closed>2016-10-27 14:39:37</closed>
	</bug>
	<bug>
		<id>6841</id>
		<title>REST API - You have reached maximum pool size for given partition</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12 ## Operating System - [x] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I used Apache JMeter to call OrientDB REST API to test workload of server.  I have tested with 50 concurrent user and see that ~ 30%-45% request was failed with response message as below  ``` {   "errors": [     {       "code": 400,       "reason": "Bad request",       "content": "Error on parsing parameters from request body\u000d\u000a\u0009DB name=\"data_dev\"\u000aYou have reached maximum pool size for given partition"     }   ] } ```  I have checked and found that Server doesn't have this error. I mean the log file doesn't have it.  I have tried to change  ``` script.pool.maxSize to 2000 db.pool.max to 200 client.channel.maxPool to 2000 ```  But this issue still occurred.  Below is the server configuration dump. Please help recheck.  ``` LOCAL SERVER CONFIGURATION +----+----------------------------------------------+---------------------------------------------------------------------------------------------+ |#   |NAME                                          |VALUE                                                                                        | +----+----------------------------------------------+---------------------------------------------------------------------------------------------+ |0   |environment.dumpCfgAtStartup                  |false                                                                                        | |1   |environment.concurrent                        |true                                                                                         | |2   |environment.lockManager.concurrency.level     |32                                                                                           | |3   |environment.allowJVMShutdown                  |true                                                                                         | |4   |script.pool.maxSize                           |2000                                                                                         | |5   |memory.useUnsafe                              |true                                                                                         | |6   |memory.chunk.size                             |2147483647                                                                                   | |7   |memory.directMemory.safeMode                  |true                                                                                         | |8   |memory.directMemory.trackMode                 |false                                                                                        | |9   |memory.directMemory.onlyAlignedMemoryAccess   |true                                                                                         | |10  |jvm.gc.delayForOptimize                       |600                                                                                          | |11  |storage.openFiles.limit                       |512                                                                                          | |12  |storage.componentsLock.cache                  |10000                                                                                        | |13  |storage.diskCache.pinnedPages                 |20                                                                                           | |14  |storage.diskCache.bufferSize                  |4096                                                                                         | |15  |storage.diskCache.writeCachePart              |15                                                                                           | |16  |storage.diskCache.writeCachePageTTL           |86400                                                                                        | |17  |storage.diskCache.writeCachePageFlushInterval |25                                                                                           | |18  |storage.diskCache.writeCacheFlushInactivity...|60000                                                                                        | |19  |storage.diskCache.writeCacheFlushLockTimeout  |-1                                                                                           | |20  |storage.diskCache.diskFreeSpaceCheckInterval  |5                                                                                            | |21  |storage.diskCache.diskFreeSpaceCheckInterva...|2048                                                                                         | |22  |storage.diskCache.keepState                   |true                                                                                         | |23  |storage.configuration.syncOnUpdate            |true                                                                                         | |24  |storage.compressionMethod                     |nothing                                                                                      | |25  |storage.encryptionMethod                      |nothing                                                                                      | |26  |storage.encryptionKey                         |                                                                                             | |27  |storage.makeFullCheckpointAfterCreate         |false                                                                                        | |28  |storage.makeFullCheckpointAfterOpen           |true                                                                                         | |29  |storage.makeFullCheckpointAfterClusterCreate  |true                                                                                         | |30  |storage.trackChangedRecordsInWAL              |false                                                                                        | |31  |storage.useWAL                                |true                                                                                         | |32  |storage.wal.syncOnPageFlush                   |true                                                                                         | |33  |storage.wal.cacheSize                         |3000                                                                                         | |34  |storage.wal.fileAutoCloseInterval             |10                                                                                           | |35  |storage.wal.maxSegmentSize                    |128                                                                                          | |36  |storage.wal.maxSize                           |4096                                                                                         | |37  |storage.wal.commitTimeout                     |1000                                                                                         | |38  |storage.wal.shutdownTimeout                   |10000                                                                                        | |39  |storage.wal.fuzzyCheckpointInterval           |300                                                                                          | |40  |storage.wal.reportAfterOperationsDuringRestore|10000                                                                                        | |41  |storage.wal.restore.batchSize                 |1000                                                                                         | |42  |storage.wal.readCacheSize                     |1000                                                                                         | |43  |storage.wal.fuzzyCheckpointShutdownWait       |600                                                                                          | |44  |storage.wal.fullCheckpointShutdownTimeout     |600                                                                                          | |45  |storage.wal.path                              |                                                                                             | |46  |storage.diskCache.pageSize                    |64                                                                                           | |47  |storage.diskCache.diskFreeSpaceLimit          |256                                                                                          | |48  |storage.lowestFreeListBound                   |16                                                                                           | |49  |storage.lockTimeout                           |0                                                                                            | |50  |storage.record.lockTimeout                    |2000                                                                                         | |51  |storage.useTombstones                         |false                                                                                        | |52  |record.downsizing.enabled                     |true                                                                                         | |53  |object.saveOnlyDirty                          |false                                                                                        | |54  |db.pool.min                                   |1                                                                                            | |55  |db.pool.max                                   |200                                                                                          | |56  |db.pool.idleTimeout                           |0                                                                                            | |57  |db.pool.idleCheckDelay                        |0                                                                                            | |58  |db.mvcc.throwfast                             |false                                                                                        | |59  |db.validation                                 |true                                                                                         | |60  |nonTX.recordUpdate.synch                      |false                                                                                        | |61  |nonTX.clusters.sync.immediately               |manindex                                                                                     | |62  |tx.trackAtomicOperations                      |false                                                                                        | |63  |index.embeddedToSbtreeBonsaiThreshold         |40                                                                                           | |64  |index.sbtreeBonsaiToEmbeddedThreshold         |-1                                                                                           | |65  |hashTable.slitBucketsBuffer.length            |1500                                                                                         | |66  |index.auto.synchronousAutoRebuild             |true                                                                                         | |67  |index.auto.lazyUpdates                        |10000                                                                                        | |68  |index.flushAfterCreate                        |true                                                                                         | |69  |index.manual.lazyUpdates                      |1                                                                                            | |70  |index.durableInNonTxMode                      |true                                                                                         | |71  |index.ignoreNullValuesDefault                 |false                                                                                        | |72  |index.txMode                                  |FULL                                                                                         | |73  |index.cursor.prefetchSize                     |500000                                                                                       | |74  |sbtree.maxDepth                               |64                                                                                           | |75  |sbtree.maxKeySize                             |10240                                                                                        | |76  |sbtree.maxEmbeddedValueSize                   |40960                                                                                        | |77  |sbtreebonsai.bucketSize                       |2                                                                                            | |78  |sbtreebonsai.linkBagCache.size                |100000                                                                                       | |79  |sbtreebonsai.linkBagCache.evictionSize        |1000                                                                                         | |80  |sbtreebonsai.freeSpaceReuseTrigger            |0.5                                                                                          | |81  |ridBag.embeddedDefaultSize                    |4                                                                                            | |82  |ridBag.embeddedToSbtreeBonsaiThreshold        |2147483647                                                                                   | |83  |ridBag.sbtreeBonsaiToEmbeddedToThreshold      |-1                                                                                           | |84  |collections.preferSBTreeSet                   |false                                                                                        | |85  |file.trackFileClose                           |false                                                                                        | |86  |file.lock                                     |true                                                                                         | |87  |file.deleteDelay                              |10                                                                                           | |88  |file.deleteRetry                              |50                                                                                           | |89  |security.userPasswordSaltIterations           |65536                                                                                        | |90  |security.userPasswordSaltCacheSize            |500                                                                                          | |91  |security.userPasswordDefaultAlgorithm         |PBKDF2WithHmacSHA256                                                                         | |92  |network.maxConcurrentSessions                 |1000                                                                                         | |93  |network.socketBufferSize                      |32768                                                                                        | |94  |network.lockTimeout                           |15000                                                                                        | |95  |network.socketTimeout                         |15000                                                                                        | |96  |network.requestTimeout                        |3600000                                                                                      | |97  |network.retry                                 |5                                                                                            | |98  |network.retryDelay                            |500                                                                                          | |99  |network.binary.loadBalancing.enabled          |false                                                                                        | |100 |network.binary.loadBalancing.timeout          |2000                                                                                         | |101 |network.binary.maxLength                      |16384                                                                                        | |102 |network.binary.readResponse.maxTimes          |20                                                                                           | |103 |network.binary.debug                          |false                                                                                        | |104 |network.http.installDefaultCommands           |true                                                                                         | |105 |network.http.serverInfo                       |OrientDB Server v.2.2.8-SNAPSHOT (build 2.2.x@r39259e190e16045fe1425b1c0485f8562fca055b; 2...| |106 |network.http.maxLength                        |1000000                                                                                      | |107 |network.http.streaming                        |true                                                                                         | |108 |network.http.charset                          |utf-8                                                                                        | |109 |network.http.jsonResponseError                |true                                                                                         | |110 |network.http.jsonp                            |false                                                                                        | |111 |network.http.sessionExpireTimeout             |300                                                                                          | |112 |network.http.useToken                         |false                                                                                        | |113 |network.token.secretyKey                      |                                                                                             | |114 |network.token.encriptionAlgorithm             |HmacSHA256                                                                                   | |115 |network.token.expireTimeout                   |60                                                                                           | |116 |profiler.enabled                              |false                                                                                        | |117 |profiler.config                               |                                                                                             | |118 |profiler.autoDump.interval                    |0                                                                                            | |119 |profiler.maxValues                            |200                                                                                          | |120 |sequence.maxRetry                             |100                                                                                          | |121 |sequence.retryDelay                           |200                                                                                          | |122 |storageProfiler.intervalBetweenSnapshots      |100                                                                                          | |123 |storageProfiler.cleanUpInterval               |5000                                                                                         | |124 |log.console.level                             |info                                                                                         | |125 |log.file.level                                |info                                                                                         | |126 |class.minimumClusters                         |0                                                                                            | |127 |log.console.ansi                              |auto                                                                                         | |128 |cache.local.impl                              |com.orientechnologies.orient.core.cache.ORecordCacheWeakRefs                                 | |129 |command.timeout                               |0                                                                                            | |130 |command.cache.enabled                         |false                                                                                        | |131 |command.cache.evictStrategy                   |PER_CLUSTER                                                                                  | |132 |command.cache.minExecutionTime                |10                                                                                           | |133 |command.cache.maxResultsetSize                |500                                                                                          | |134 |query.parallelAuto                            |false                                                                                        | |135 |query.parallelMinimumRecords                  |300000                                                                                       | |136 |query.parallelResultQueueSize                 |20000                                                                                        | |137 |query.scanPrefetchPages                       |20                                                                                           | |138 |query.scanBatchSize                           |1000                                                                                         | |139 |query.scanThresholdTip                        |50000                                                                                        | |140 |query.limitThresholdTip                       |10000                                                                                        | |141 |query.live.support                            |true                                                                                         | |142 |statement.cacheSize                           |100                                                                                          | |143 |sql.graphConsistencyMode                      |tx                                                                                           | |144 |client.channel.maxPool                        |2000                                                                                         | |145 |client.connectionPool.waitTimeout             |5000                                                                                         | |146 |client.channel.dbReleaseWaitTimeout           |10000                                                                                        | |147 |client.ssl.enabled                            |false                                                                                        | |148 |client.ssl.keyStore                           |                                                                                             | |149 |client.ssl.keyStorePass                       |                                                                                             | |150 |client.ssl.trustStore                         |                                                                                             | |151 |client.ssl.trustStorePass                     |                                                                                             | |152 |server.openAllDatabasesAtStartup              |false                                                                                        | |153 |server.channel.cleanDelay                     |5000                                                                                         | |154 |server.cache.staticFile                       |false                                                                                        | |155 |server.log.dumpClientExceptionLevel           |FINE                                                                                         | |156 |server.log.dumpClientExceptionFullStackTrace  |false                                                                                        | |157 |distributed.crudTaskTimeout                   |3000                                                                                         | |158 |distributed.commandTaskTimeout                |120000                                                                                       | |159 |distributed.commandQuickTaskTimeout           |5000                                                                                         | |160 |distributed.commandLongTaskTimeout            |86400000                                                                                     | |161 |distributed.deployDbTaskTimeout               |1200000                                                                                      | |162 |distributed.deployChunkTaskTimeout            |15000                                                                                        | |163 |distributed.deployDbTaskCompression           |7                                                                                            | |164 |distributed.asynchQueueSize                   |0                                                                                            | |165 |distributed.asynchResponsesTimeout            |15000                                                                                        | |166 |distributed.purgeResponsesTimerDelay          |15000                                                                                        | |167 |distributed.conflictResolverRepairerChain     |majority,content,version                                                                     | |168 |distributed.conflictResolverRepairerCheckEvery|5000                                                                                         | |169 |distributed.conflictResolverRepairerBatch     |100                                                                                          | |170 |distributed.txAliveTimeout                    |30000                                                                                        | |171 |distributed.requestChannels                   |1                                                                                            | |172 |distributed.responseChannels                  |1                                                                                            | |173 |distributed.heartbeatTimeout                  |10000                                                                                        | |174 |distributed.checkHealthCanOfflineServer       |false                                                                                        | |175 |distributed.checkHealthEvery                  |10000                                                                                        | |176 |distributed.autoRemoveOfflineServers          |-1                                                                                           | |177 |distributed.publishNodeStatusEvery            |5000                                                                                         | |178 |distributed.localQueueSize                    |10000                                                                                        | |179 |distributed.dbWorkerThreads                   |8                                                                                            | |180 |distributed.queueMaxSize                      |10000                                                                                        | |181 |distributed.backupDirectory                   |../backup/databases                                                                          | |182 |distributed.concurrentTxMaxAutoRetry          |10                                                                                           | |183 |distributed.atomicLockTimeout                 |300                                                                                          | |184 |distributed.concurrentTxAutoRetryDelay        |100                                                                                          | |185 |db.document.serializer                        |ORecordSerializerBinary                                                                      | |186 |client.krb5.config                            |                                                                                             | |187 |client.krb5.ccname                            |                                                                                             | |188 |client.krb5.ktname                            |                                                                                             | |189 |client.credentialinterceptor                  |                                                                                             | |190 |security.createDefaultUsers                   |true                                                                                         | |191 |server.security.file                          |                                                                                             | |192 |jna.disable.system.library                    |true                                                                                         | |193 |distributed.queueTimeout                      |500000                                                                                       | |194 |db.makeFullCheckpointOnIndexChange            |true                                                                                         | |195 |db.makeFullCheckpointOnSchemaChange           |true                                                                                         | |196 |client.session.tokenBased                     |true                                                                                         | |197 |oauth2.secretkey                              |                                                                                             | |198 |storage.cluster.usecrc32                      |false                                                                                        | |199 |lazyset.workOnStream                          |true                                                                                         | |200 |db.mvcc                                       |true                                                                                         | |201 |db.use.distributedVersion                     |false                                                                                        | |202 |mvrbtree.timeout                              |0                                                                                            | |203 |mvrbtree.nodePageSize                         |256                                                                                          | |204 |mvrbtree.loadFactor                           |0.7                                                                                          | |205 |mvrbtree.optimizeThreshold                    |100000                                                                                       | |206 |mvrbtree.entryPoints                          |64                                                                                           | |207 |mvrbtree.optimizeEntryPointsFactor            |1.0                                                                                          | |208 |mvrbtree.entryKeysInMemory                    |false                                                                                        | |209 |mvrbtree.entryValuesInMemory                  |false                                                                                        | |210 |mvrbtree.ridBinaryThreshold                   |-1                                                                                           | |211 |mvrbtree.ridNodePageSize                      |64                                                                                           | |212 |mvrbtree.ridNodeSaveMemory                    |false                                                                                        | |213 |tx.commit.synch                               |false                                                                                        | |214 |tx.autoRetry                                  |1                                                                                            | |215 |tx.log.fileType                               |classic                                                                                      | |216 |tx.log.synch                                  |false                                                                                        | |217 |tx.useLog                                     |true                                                                                         | |218 |index.auto.rebuildAfterNotSoftClose           |true                                                                                         | |219 |client.channel.minPool                        |1                                                                                            | |220 |storage.keepOpen                              |true                                                                                         | |221 |cache.local.enabled                           |true                                                                                         | +----+----------------------------------------------+---------------------------------------------------------------------------------------------+  ```  Thanks, Tan </body>
		<created>2016-10-25 05:01:08</created>
		<closed>2016-11-21 15:25:48</closed>
	</bug>
	<bug>
		<id>6840</id>
		<title>Studio database name capital letters only</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ 12] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  In the upper right corner of the Studio screen the database name only shows in CAPITALS. If the database name is, e.g. Base9 it will appear as BASE9. It may lead to confusion. ## Steps to reproduce the problem  Build a database named bASE4 and see how it looks when you get (auto) logged in as admin.  </body>
		<created>2016-10-24 20:15:49</created>
		<closed>2016-11-18 11:33:48</closed>
	</bug>
	<bug>
		<id>6839</id>
		<title>Loading CSV data by ETL override Float values</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ 11] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [ x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior   If first row (below column headers) is 0, i.e. _not_ 0.0, then the next row values gets set to integer also. Used sed to circumvent during load prep, but how can this be handled otherwise? ## Steps to reproduce the problem  Load CSV file with 0 in first line (below title-row) and on next line, i.e. below the column with 0, a float value, e.g. 2.82942 will become 2 </body>
		<created>2016-10-24 20:11:08</created>
		<closed>2017-04-10 19:40:42</closed>
	</bug>
	<bug>
		<id>6836</id>
		<title>unexpected error when accessing a declared ODocument's field in a live query callback</title>
		<body>## OrientDB Version, operating system, or hardware. -  [x] v2.2.11 ## Operating System - [X] Linux ### Expected behavior  `Got live update 42` ### Actual behavior  ``` WARNI Error deserializing record with id #17:0 send this data for debugging: ABJMaXZlVGFibGUvAAAAEQAENDI=  [ORecordSerializerBinary]com.orientechnologies.orient.core.exception.ODatabaseException: The database instance is not set in the current thread. Be sure to set it with: ODatabaseRecordThreadLocal.INSTANCE.set(db);     at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.get(ODatabaseRecordThreadLocal.java:51)     at com.orientechnologies.orient.core.record.ORecordAbstract.getDatabase(ORecordAbstract.java:241)     at com.orientechnologies.orient.core.record.impl.ODocument.getGlobalPropertyById(ODocument.java:2197)     at com.orientechnologies.orient.core.record.impl.ODocumentInternal.getGlobalPropertyById(ODocumentInternal.java:64)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.getGlobalProperty(ORecordSerializerBinaryV0.java:509)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserializePartial(ORecordSerializerBinaryV0.java:121)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.fromStream(ORecordSerializerBinary.java:78)     at com.orientechnologies.orient.core.record.impl.ODocument.deserializeFields(ODocument.java:1851)     at com.orientechnologies.orient.core.record.impl.ODocument.checkForFields(ODocument.java:2559)     at com.orientechnologies.orient.core.record.impl.ODocument.rawField(ODocument.java:773)     at com.orientechnologies.orient.core.record.impl.ODocument.field(ODocument.java:823)     at com.Application$1.onLiveResult(Application.java:24)     at com.orientechnologies.orient.core.sql.query.OLocalLiveResultListener.onLiveResult(OLocalLiveResultListener.java:35)     at com.orientechnologies.orient.client.remote.OStorageRemoteAsynchEventListener.onRequest(OStorageRemoteAsynchEventListener.java:87)     at com.orientechnologies.orient.client.remote.ORemoteConnectionPushListener.onRequest(ORemoteConnectionPushListener.java:55)     at com.orientechnologies.orient.client.binary.OAsynchChannelServiceThread.execute(OAsynchChannelServiceThread.java:62)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ``` ## Steps to reproduce the problem  Create a class and set a property (named "entry" in this example) to it. Set up live query listener for the table and try to access document.field("entry") in its onLiveResult() method. Insert a record to the table. It is done in the attached program, so just run its com.Main. [orient_6836.zip](https://github.com/orientechnologies/orientdb/files/542009/orient_6836.zip) </body>
		<created>2016-10-20 14:52:34</created>
		<closed>2016-11-17 13:47:39</closed>
	</bug>
	<bug>
		<id>6834</id>
		<title>Query parsing issue when "in" clause occurs after "or" condition</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[X] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  //Expected: No rows returned, actual rows are returned select \* from V where ( ( (1=1) or (1 in (select 1 from V)) ) and 1=2 ) ## Steps to reproduce the problem  The following query run from the OrientDB UI is returning rows, even though and 1=2" should always be false: select \* from V where ( ( (1=1) or (1 in (select 1 from V)) ) and 1=2 )  But if I simply change the order of the "or" condition, then the query correctly honors the "and" condition and returns no rows: select \* from V where ( ( (1 in (select 1 from V)) or (1=1) ) and 1=2 )  It looks like a OrientDB query parsing bug where if you have an in after an or condition, then the rest of the query is ignored.  Note that you can reproduce the problem by using any class, not just V. </body>
		<created>2016-10-20 13:46:58</created>
		<closed>2017-07-21 10:09:24</closed>
	</bug>
	<bug>
		<id>6832</id>
		<title>single node: Quorum (1) cannot be reached because it is major than available nodes (0)</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13-20161027.133116-9 ## Operating System - [x] Linux ## Expected behavior and actual behavior - started this single server in distributed mode (with "dserver.sh"), this is the only server active in its group - distributed-config.json :   ``` {"@type":"d","@version":0,"autoDeploy":true,"readQuorum":1,"writeQuorum":1, "executionMode":"undefined","readYourWrites":true,"servers":{"@type":"d","@version":0,"*":"master"}, "clusters": {"@type":"d","@version":0, "internal":{"@type":"d","@version":0}, "cl_*_p0":{"@type":"d","@version":0,"servers":["orient1","orient2","orient4"]}, "cl_*_p1":{"@type":"d","@version":0,"servers":["orient1","orient2","orient4","orient5"]}, "cl_*_p2":{"@type":"d","@version":0,"servers":["orient1","orient4","orient5","orient3"]}, "cl_*_p3":{"@type":"d","@version":0,"servers":["orient1","orient5","orient3","orient6"]}, "cl_*_p4":{"@type":"d","@version":0,"servers":["orient3","orient6","orient1"]}, "cl_*_p5":{"@type":"d","@version":0,"servers":["orient6","orient1","orient2"]}, "*":{"@type":"d","@version":0,"servers":["orient1"]} },"version":1} ``` - from console, I get following status:   ``` orientdb {db=cdrarch}&gt; HA STATUS -db -output=text Executed ' CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+----+-----------+----------+-------+-------------+-------------+-------------+-------------+-------------+ |        |    |           |          |MASTER |   MASTER    |   MASTER    |   MASTER    |   MASTER    |   MASTER    | |        |    |           |          |ONLINE |NOT_AVAILABLE|NOT_AVAILABLE|NOT_AVAILABLE|NOT_AVAILABLE|NOT_AVAILABLE| +--------+----+-----------+----------+-------+-------------+-------------+-------------+-------------+-------------+ |CLUSTER |  id|writeQuorum|readQuorum|orient1|   orient2   |   orient4   |   orient5   |   orient3   |   orient6   | +--------+----+-----------+----------+-------+-------------+-------------+-------------+-------------+-------------+ |*       |    |     1     |    1     |   X   |             |             |             |             |             | |cl_*_p0 |    |     1     |    1     |   X   |      o      |      o      |             |             |             | |cl_*_p1 |    |     1     |    1     |   X   |      o      |      o      |      o      |             |             | |cl_*_p2 |    |     1     |    1     |   X   |             |      o      |      o      |      o      |             | |cl_*_p3 |    |     1     |    1     |   X   |             |             |      o      |      o      |      o      | |cl_*_p4 |    |     1     |    1     |   o   |             |             |             |      X      |      o      | |cl_*_p5 |    |     1     |    1     |   o   |      o      |             |             |             |      X      | |internal|   0|     1     |    1     |       |             |             |             |             |             | +--------+----+-----------+----------+-------+-------------+-------------+-------------+-------------+-------------+ ``` - I created following clusters:   ``` cl_cdr_af_20160626_p0, cl_cdr_af_20160626_p1, cl_cdr_af_20160626_p2, cl_cdr_af_20160626_p3, cl_cdr_af_20160626_p4, cl_cdr_af_20160626_p5 ```  (these have got the following cluster-IDs : 586..591) - I created a class "cdr_af_20160626" with these clusters:  ``` CREATE CLASS cdr_af_20160626 cluster 586,587,588,589,590,591 ``` - when I request a description of this class, I get a normal answer:  ``` DESC cdr_af_20160626 ... (clusters are listed as expected) ``` - in another "console.sh" session to this same database, I do the same:  ``` desc cdr_af_20160626 ! Class 'cdr_af_20160626' does not exist in the database 'cdrarch' ```  (hmm, strange ...) - from the first console, I start defining a bunch of properties for this class:  ``` ALTER CLASS cdr_af_20160626 STRICTMODE false ...Error: com.orientechnologies.orient.server.distributed.ODistributedException: Quorum (1) cannot be reached because it is major than available nodes (0)' ``` </body>
		<created>2016-10-19 18:16:26</created>
		<closed>2017-02-18 14:11:11</closed>
	</bug>
	<bug>
		<id>6830</id>
		<title>Operator IN doesn't work in MATCH where clause after traverse</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .8[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Expected: for an EmbeddedSet `names`, the `IN` operator checks if an element is contained regardless of the location of the WHERE clause.  Actual: for MATCH statements, the `IN` operator doesn't work and returns no results if used in a WHERE clause after a traversal step. See below for repro -- all MATCH queries were expected to return `#13:0`, but the one with `IN` in the traversal step's WHERE clause returned no results. ## Steps to reproduce the problem  ``` CREATE CLASS V1 EXTENDS V CREATE PROPERTY V1.names EmbeddedSet String CREATE VERTEX V1 SET names=['foo', 'bar']    // returns #12:0  CREATE CLASS V2 EXTENDS V CREATE PROPERTY V2.names EmbeddedSet String CREATE VERTEX V2 SET names=['baz', 'quux']   // returns #13:0  CREATE EDGE E FROM #12:0 TO #13:0  # Returns one result, v2 = #13:0 MATCH {   class: V1 }.out('E') {   as: v2 } RETURN $matches  # Returns one result, v2 = #13:0 MATCH {   class: V2,   where: ('baz' IN names),   as: v2 } RETURN $matches  # Returns no results! MATCH {   class: V1 }.out('E') {   where: ('baz' IN names),   as: v2 } RETURN $matches  # Returns one result, v2 = #13:0 MATCH {   class: V1 }.out('E') {   where: (names CONTAINS 'baz'),   as: v2 } RETURN $matches ``` </body>
		<created>2016-10-19 13:44:13</created>
		<closed>2016-10-24 13:39:26</closed>
	</bug>
	<bug>
		<id>6828</id>
		<title>indexing optional propertys</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.11 ## Operating System - Linux ## Expected behavior and actual behavior  I have a class with multiple properties. One of the properties is optional. The others are not. I want to create a composite index on both of them  ``` create class example extends v create property example.name string create property example.version integer create property example.date date alter property example.name  mandatory True create index partial_unique on example (name, version, date) unique ```  however, now if I try to insert a record where version is null I get a null pointer exception. I would have expected it to allow me to insert things with nulls on optional, nullable properties still  the desired behaviour I am looking for is  ``` create class example extends v create property example.name string create property example.version integer create property example.date date alter property example.name  mandatory True create index partial_unique on example (name, version, date) unique create vertex example content {'name': 'ex1'} create vertex example content {'name': 'ex1', 'version': 1} ```  would be ok and then I would get a unique constraint error on the following  ``` create vertex example content {'name': 'ex1'} ``` ## Steps to reproduce the problem  ``` create class example extends v create property example.name string create property example.version integer create property example.date date alter property example.name  mandatory True create index partial_unique on example (name, version, date) unique create vertex example content {'name': 'ex1'} ``` </body>
		<created>2016-10-18 23:18:45</created>
		<closed>2016-10-24 14:48:32</closed>
	</bug>
	<bug>
		<id>6822</id>
		<title>Graph Editor update problem</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[11 ] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [ x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  ```     DB name="XXX" [ONetworkProtocolHttpDb] ```  2016-10-17 20:54:33:694 SEVER Internal server error: com.orientechnologies.orient.server.network.protocol.http.OHttpRequestException: Syntax error: document/&lt;database&gt;/&lt;record-id&gt;[/fetchPlan] [ONetworkProtocolHttpDb] ## Steps to reproduce the problem  Click on a vertex and then click Pensil-symbol and change a property and save. Click again to see the result. You will see no change in the left panel as you receive the above internal error from the server, and "Error on parsing query Query: undefined-----^ DB name..." as a red error message at the bottom of the Graph Editor screen.  </body>
		<created>2016-10-17 19:09:12</created>
		<closed>2016-10-24 14:17:53</closed>
	</bug>
	<bug>
		<id>6821</id>
		<title>With ALTER CLASS, certain property values are case-sensitive</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.11 ## Operating System - [ ] Linux - [ ] MacOSX - [X] Windows - [x] Other Unix - [x] Other, name?  ## Expected behavior and actual behavior  With the command "ALTER CLASS &lt;ClassName&gt; STRICTMODE &lt;value&gt;", the value (true/false) must lower case.  However most other ALTER CLASS/PROPERTY commands that accept a Boolean are okay with either upper- or lowercase.  STRICTMODE should not be the only property that requires a case-sensitive value.  The documentation shows examples of both upper- and lower-case being used in various places (TRUE/true/FALSE/false). ## Steps to reproduce the problem  Setup:  ``` CREATE CLASS Account EXTENDS V; CREATE PROPERTY Account.Name STRING; ALTER  PROPERTY Account.Name MANDATORY TRUE; ```  Then, run this: `ALTER CLASS Account STRICTMODE TRUE;` You'll get this output:  ``` Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error parsing query: alter CLASS Account STRICTMODE FALSE     ^ Encountered " &lt;ALTER&gt; "alter "" at line 1, column 1. Was expecting one of: ... ```  It turns out that the problem is resolved by changing "TRUE" to "true". </body>
		<created>2016-10-17 18:01:16</created>
		<closed>2016-10-28 09:06:48</closed>
	</bug>
	<bug>
		<id>6818</id>
		<title>Method "executeQuery" from Statement not works.</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ]   v2.2.11 ## Operating System - [ ] Linux - [ ] MacOSX - [x ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Code "ResultSet rs = stmt.executeQuery( query.toString() );" returns ResultSet with data. But the code throws exception and  log message; WARNING: Error deserializing record to get field-names, send this data for debugging: ABRIeXBvdGhlc2lzOQAAABw3AAAAHTUAAAAlAAIOTlAgIT0gUBQxMjM0NTY3ODkw  Request for executing: select from Hypothesis WHERE id='1234567890' ## Steps to reproduce the problem  Store entity and try select the entity by JDBC </body>
		<created>2016-10-17 11:26:07</created>
		<closed>2016-10-18 14:43:28</closed>
	</bug>
	<bug>
		<id>6815</id>
		<title>Cannot drop database in distributed mode</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.11 ## Operating System - [x] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Steps to reproduce the problem - Run OrientDB with distributed mode (only 1 node) - Use console tool to create a new database  `create database remote:localhost/test root 123@123 plocal graph;` - Use console tool to drop database  `drop database remote:localhost/test root 123@123;`  Exception occurred:    &gt; Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot delete the remote storage: test &gt; Error: com.orientechnologies.orient.server.distributed.ODistributedException: No nodes configured for partition 'test.null' request: id=0.0 task=drop_database </body>
		<created>2016-10-15 06:59:35</created>
		<closed>2016-10-18 04:57:32</closed>
	</bug>
	<bug>
		<id>6810</id>
		<title>Distributed setup : Java::ComOrientechnologiesOrientCoreException::OSecurityAccessException</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.12-SNAPSHOT ## Operating System - Linux ## Expected behavior and actual behavior  ``` Java::ComOrientechnologiesOrientCoreException::OSecurityAccessException :  User 'guest' does not have permission to execute the operation 'Update' against the resource: ResourceGeneric [name=CLASS, legacyName=database.class].DevaprintProject  DB name="devaprint-production" "com.orientechnologies.orient.core.metadata.security.OImmutableUser.allow(com/orientechnologies/orient/core/metadata/security/OImmutableUser.java:53)" "com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.checkSecurity(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:891)" "com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:2593)" "com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:2489)" "com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:103)" "com.orientechnologies.orient.server.distributed.impl.task.OUpdateRecordTask.executeRecordTask(com/orientechnologies/orient/server/distributed/impl/task/OUpdateRecordTask.java:132)" "com.orientechnologies.orient.server.distributed.task.OAbstractRecordReplicatedTask.execute(com/orientechnologies/orient/server/distributed/task/OAbstractRecordReplicatedTask.java:106)" "com.orientechnologies.orient.server.distributed.impl.task.OTxTask.execute(com/orientechnologies/orient/server/distributed/impl/task/OTxTask.java:120)" "com.orientechnologies.orient.server.distributed.impl.OSynchronizedTaskWrapper.execute(com/orientechnologies/orient/server/distributed/impl/OSynchronizedTaskWrapper.java:70)" "com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(com/orientechnologies/orient/server/distributed/impl/ODistributedAbstractPlugin.java:642)" "com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(com/orientechnologies/orient/core/db/OScenarioThreadLocal.java:70)" "com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(com/orientechnologies/orient/server/distributed/impl/ODistributedAbstractPlugin.java:638)" "com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(com/orientechnologies/orient/server/distributed/impl/ODistributedWorker.java:285)" "com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(com/orientechnologies/orient/server/distributed/impl/ODistributedWorker.java:96)" ``` ## Steps to reproduce the problem  Execute a distributed operation (worked with 2.11) </body>
		<created>2016-10-14 09:11:21</created>
		<closed>2016-11-07 16:53:42</closed>
	</bug>
	<bug>
		<id>6808</id>
		<title>always problems with closing Lucene index during server shutdown</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.x (up till and including 2.2.12-20161019.051435-38) ## Operating System - [x] Linux ## Expected behavior and actual behavior  During shutdown, I always notice that the logs have an error message about the closing of Lucene index :   ``` Error on closing Lucene index java.nio.channels.ClosedByInterruptException         at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:202)         at sun.nio.ch.FileChannelImpl.size(FileChannelImpl.java:315)         at org.apache.lucene.store.NativeFSLockFactory$NativeFSLock.ensureValid(NativeFSLockFactory.java:170)         at org.apache.lucene.store.LockValidatingDirectoryWrapper.createOutput(LockValidatingDirectoryWrapper.java:43)         at org.apache.lucene.index.SegmentInfos.write(SegmentInfos.java:516)         at org.apache.lucene.index.SegmentInfos.prepareCommit(SegmentInfos.java:809)         at org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4439)         at org.apache.lucene.index.IndexWriter.prepareCommitInternal(IndexWriter.java:2874)         at org.apache.lucene.index.IndexWriter.commitInternal(IndexWriter.java:2977)         at org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:2944)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.closeIndex(OLuceneIndexEngineAbstract.java:306)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.close(OLuceneIndexEngineAbstract.java:341)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.onShutdown(OLuceneIndexEngineAbstract.java:483)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:1005)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:331)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:493)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary$3.run(ONetworkProtocolBinary.java:2138) ``` </body>
		<created>2016-10-13 10:50:51</created>
		<closed>2016-11-18 11:22:39</closed>
	</bug>
	<bug>
		<id>6807</id>
		<title>Corrupt database, removeVertex gives NPE</title>
		<body>using 2.0.15 on Windows tested with 2.2.11 and had the same issue  We where deleting some vertexes in our database from our application when we got a NPE. After some testing we established that the NPE is from the OrientDB server; not our code.  ``` 2016-10-13 10:01:00,817 [qtp1656404914-1031] ERROR com.company.datastore.impl.blueprints.orientdb.administration.AdministrationProvider:1356 - Data Store exception in deleteUserCategory java.lang.NullPointerException     at com.tinkerpop.blueprints.impls.orient.OrientVertex.removeEdges(OrientVertex.java:322)     at com.tinkerpop.blueprints.impls.orient.OrientVertex.removeInverseEdge(OrientVertex.java:446)     at com.tinkerpop.blueprints.impls.orient.OrientVertex.removeEdges(OrientVertex.java:255)     at com.tinkerpop.blueprints.impls.orient.OrientVertex.remove(OrientVertex.java:659)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.removeVertex(OrientBaseGraph.java:758)     at com.company.datastore.impl.blueprints.orientdb.administration.AdministrationProvider.__M_deleteUserCategory(AdministrationProvider.java:1349)     at com.company.datastore.impl.blueprints.orientdb.administration.AdministrationProvider.deleteUserCategory(AdministrationProvider.java) ```  I opened the database in Studio to check how much had actually been deleted. g.v('#50:11').out()  Only 2 records was still hanging on #50:11 and only one of them should be deleted, so I ran delete vertex #53:63  and got an NPE error in Studio.  The OrientDB log reported: 2016-10-13 10:09:33:168 INFO  OrientDB Server v2.0.15 is active. [OServer] 2016-10-13 10:10:25:726 SEVERE Internal server error: java.lang.NullPointerException [ONetworkProtocolHttpDb  The following steps has been tried to fix the problem. 1. export the database and import it into a fresh database -&gt; same problem 2. tested in studio in latest version (2.2.11) -&gt; same problem </body>
		<created>2016-10-13 08:51:18</created>
		<closed>2016-10-18 09:05:26</closed>
	</bug>
	<bug>
		<id>6805</id>
		<title>" Restore is not possible because write ahead log is empty." for replica server</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [x] Linux ## Cluster   bbs1: master  bbs2: replica ## Expected behavior and actual behavior  replica server can't be restored. ## Steps to reproduce the problem  The replica server stopped to work at 1am with some heap size exceptions.  from replica:  ``` log 2016-10-13 00:21:39:278 WARNI [bbs2] Timeout (91218ms) on waiting for synchronous responses from nodes=[bbs1] responsesSoFar=[] request=(id=1.27501 task=heartbeat timestamp: 1476288682229) [ODistributedDatabaseImpl]Error on client connection java.lang.OutOfMemoryError: Java heap space         at java.io.BufferedInputStream.&lt;init&gt;(BufferedInputStream.java:203)         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryServer.&lt;init&gt;(OChannelBinaryServer.java:38)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.config(ONetworkProtocolBinary.java:145)         at com.orientechnologies.orient.server.network.OServerNetworkListener.run(OServerNetworkListener.java:216) Exception in thread "hz._hzInstance_1_orientdb.SlowOperationDetectorThread" java.lang.OutOfMemoryError: Java heap space  2016-10-13 00:49:16:912 WARNI [bbs2]-&gt;[bbs1] Server 'bbs1' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 00:53:53:021 WARNI [192.168.3.10]:2434 [orientdb] [3.6.3] This node does not have a connection to Member [192.168.1.127]:2434 [ClusterHeartbeatManager]Error during WAL background flush java.lang.OutOfMemoryError: Java heap space         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegment.commitLog(OLogSegment.java:170)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegment.access$100(OLogSegment.java:33)         at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OLogSegment$FlushTask.run(OLogSegment.java:138)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745)  ```  from master:  ``` log 2016-10-13 00:09:03:632 WARNI Cannot serialize record: #-2:338{uid:8214636,rcount:25} v0 [ONetworkProtocolBinary] 2016-10-13 00:09:03:632 WARNI Cannot serialize record: #-2:863{uid:7993040,rcount:25} v0 [ONetworkProtocolBinary] 2016-10-13 00:09:03:632 WARNI Cannot serialize record: #-2:16953{uid:7894288,rcount:25} v0 [ONetworkProtocolBinary]Error on unmarshalling record #-2:935 (java.net.SocketException: Broken pipe) java.net.SocketException: Broken pipe         at java.net.SocketOutputStream.socketWrite0(Native Method)         at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)         at java.net.SocketOutputStream.write(SocketOutputStream.java:153)         at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)         at java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)         at java.io.DataOutputStream.write(DataOutputStream.java:107)         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.writeBytes(OChannelBinary.java:276)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.writeRecord(ONetworkProtocolBinary.java:2845)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.writeIdentifiable(ONetworkProtocolBinary.java:2629)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.serializeValue(ONetworkProtocolBinary.java:1597)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1542)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:579)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:320)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:196)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  2016-10-13 00:09:05:701 WARNI Cannot serialize record: #-2:935{uid:22241241,rcount:40} v0 [ONetworkProtocolBinary] 2016-10-13 00:09:05:701 WARNI Cannot serialize record: #-2:240{uid:21491041,rcount:40} v0 [ONetworkProtocolBinary] 2016-10-13 00:09:05:701 WARNI Cannot serialize record: #-2:905{uid:19333566,rcount:40} v0 [ONetworkProtocolBinary] 2016-10-13 00:10:46:771 WARNI [bbs1] Timeout (10039ms) on waiting for synchronous responses from nodes=[bbs2] responsesSoFar=[] request=(id=0.79344 task=heartbeat timestamp: 1476288636731) [ODistributedDatabaseImpl] 2016-10-13 00:10:46:772 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 00:10:56:772 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=mysns, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 00:11:08:903 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 00:11:18:903 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=mysns, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 00:11:36:901 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 00:11:46:901 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=mysns, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker]  ```  Then when I restart the master and then restart the replica, I got this from replica:  ``` log 2016-10-13 11:16:10:268 WARNI [bbs2]-&gt;[[bbs1]] Requesting deploy of database 'mysns' on local server... [OHazelcastPlugin] 2016-10-13 11:16:13:431 WARNI [bbs2] Moving existent database 'mysns' in '/usr/local/orientdb-community-2.2.8/databases/mysns' to '/usr/local/orientdb-community-2.2.8/databases//../backup/databases/mysns' and get a fresh copy from a remote node... [OHazelcastPlugin] 2016-10-13 11:17:29:448 WARNI {db=mysns} Storage 'mysns' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-10-13 11:17:29:449 SEVER {db=mysns} Restore is not possible because write ahead log is empty. [OLocalPaginatedStorage] 2016-10-13 11:17:31:482 WARNI {db=mysns} Database is open by another process [OPaginatedStorageDirtyFlag] 2016-10-13 11:17:31:638 WARNI {db=mysns} MBean with name com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations:id=1278582676,name="mysns",type=OAtomicOperationsMangerMXBean has already registered. Probably your system was not shutdown correctly or you have several running applications which use OrientDB engine inside [OAtomicOperationsManager] 2016-10-13 11:17:31:639 WARNI {db=mysns} Storage 'mysns' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-10-13 11:17:31:639 SEVER {db=mysns} Restore is not possible because write ahead log is empty. [OLocalPaginatedStorage] 2016-10-13 11:17:33:994 WARNI {db=mysns} Database is open by another process [OPaginatedStorageDirtyFlag] 2016-10-13 11:17:34:015 WARNI {db=mysns} MBean with name com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations:id=1278582676,name="mysns",type=OAtomicOperationsMangerMXBean has already registered. Probably your system was not shutdown correctly or you have several running applications which use OrientDB engine inside [OAtomicOperationsManager] 2016-10-13 11:17:34:015 WARNI {db=mysns} Storage 'mysns' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-10-13 11:17:34:016 SEVER {db=mysns} Restore is not possible because write ahead log is empty. [OLocalPaginatedStorage] 2016-10-13 11:17:38:982 WARNI {db=mysns} Database is open by another process [OPaginatedStorageDirtyFlag] 2016-10-13 11:17:39:161 WARNI {db=mysns} MBean with name com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations:id=1278582676,name="mysns",type=OAtomicOperationsMangerMXBean has already registered. Probably your system was not shutdown correctly or you have several running applications which use OrientDB engine inside [OAtomicOperationsManager] 2016-10-13 11:17:39:162 WARNI {db=mysns} Storage 'mysns' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-10-13 11:17:39:162 SEVER {db=mysns} Restore is not possible because write ahead log is empty. [OLocalPaginatedStorage] 2016-10-13 11:17:40:228 WARNI {db=mysns} Database is open by another process [OPaginatedStorageDirtyFlag] 2016-10-13 11:17:40:256 WARNI {db=mysns} MBean with name com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations:id=1278582676,name="mysns",type=OAtomicOperationsMangerMXBean has already registered. Probably your system was not shutdown correctly or you have several running applications which use OrientDB engine inside [OAtomicOperationsManager]  ```  from master:  ``` log 2016-10-13 11:17:23:082 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #47 offset=192933888 size=8384701... [OCopyDatabaseChunkTask] 2016-10-13 11:17:24:057 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 11:17:24:691 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #48 offset=201318589 size=3907... [OCopyDatabaseChunkTask] 2016-10-13 11:17:24:698 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #49 offset=201322496 size=8384605... [OCopyDatabaseChunkTask] 2016-10-13 11:17:28:341 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #50 offset=209707101 size=4003... [OCopyDatabaseChunkTask] 2016-10-13 11:17:28:500 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #51 offset=209711104 size=8384235... [OCopyDatabaseChunkTask] 2016-10-13 11:17:31:162 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #52 offset=218095339 size=277... [OCopyDatabaseChunkTask] 2016-10-13 11:17:31:169 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #53 offset=218095616 size=8387903... [OCopyDatabaseChunkTask] 2016-10-13 11:17:33:504 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #54 offset=226483519 size=705... [OCopyDatabaseChunkTask] 2016-10-13 11:17:33:511 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #55 offset=226484224 size=8387453... [OCopyDatabaseChunkTask] 2016-10-13 11:17:34:062 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 11:17:36:483 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #56 offset=234871677 size=1155... [OCopyDatabaseChunkTask] 2016-10-13 11:17:36:490 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #57 offset=234872832 size=8387282... [OCopyDatabaseChunkTask] 2016-10-13 11:17:39:680 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #58 offset=243260114 size=1326... [OCopyDatabaseChunkTask] 2016-10-13 11:17:39:688 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #59 offset=243261440 size=8386832... [OCopyDatabaseChunkTask] 2016-10-13 11:17:42:678 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #60 offset=251648272 size=1776... [OCopyDatabaseChunkTask] 2016-10-13 11:17:42:686 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #61 offset=251650048 size=8386506... [OCopyDatabaseChunkTask] 2016-10-13 11:17:44:065 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 11:17:45:494 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #62 offset=260036554 size=2102... [OCopyDatabaseChunkTask] 2016-10-13 11:17:45:501 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #63 offset=260038656 size=8386345... [OCopyDatabaseChunkTask] 2016-10-13 11:17:48:672 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #64 offset=268425001 size=2263... [OCopyDatabaseChunkTask] 2016-10-13 11:17:48:679 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #65 offset=268427264 size=8385931... [OCopyDatabaseChunkTask] 2016-10-13 11:17:48:765 INFO  [bbs1]-&gt;[bbs2] Backup of database 'mysns' completed. lastOperationId=1.3... [OSyncDatabaseTask$1] 2016-10-13 11:17:48:777 INFO  [bbs1]-&gt;[bbs2] - transferring chunk #66 offset=276813195 size=454562... [OCopyDatabaseChunkTask] 2016-10-13 11:17:48:778 INFO  [bbs1] Received updated status bbs1.mysns=ONLINE [OHazelcastPlugin] 2016-10-13 11:18:14:133 WARNI [bbs1] Timeout (30063ms) on waiting for synchronous responses from nodes=[bbs2] responsesSoFar=[] request=(id=0.72 task=heartbeat timestamp: 1476328664070) [ODistributedDatabaseImpl] 2016-10-13 11:18:14:133 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker] 2016-10-13 11:18:14:136 INFO  [bbs1] Distributed servers status:  +-----+--------+------------------------------------+-----+---------+----------------+----------------+-----------------------+ |Name |Status  |Databases                           |Conns|StartedOn|Binary          |HTTP            |UsedMemory             | +-----+--------+------------------------------------+-----+---------+----------------+----------------+-----------------------+ |bbs1*|ONLINE  |GratefulDeadConcerts=ONLINE (MASTER)|104  |11:15:41 |192.168.1.127:2424|192.168.1.127:2480|2.38GB/5.71GB (41.76%) | |     |        |mysns=ONLINE (MASTER)             |     |         |                |                |                       | |bbs2 |STARTING|                                    |0    |11:15:58 |192.168.3.10:2424 |192.168.3.10:2480 |405.33MB/5.44GB (7.28%)| +-----+--------+------------------------------------+-----+---------+----------------+----------------+-----------------------+  [OHazelcastPlugin] 2016-10-13 11:20:34:845 WARNI [bbs1]-&gt;[bbs2] Server 'bbs2' did not respond to the heartbeat message (db=GratefulDeadConcerts, timeout=10000ms), but cannot be set OFFLINE by configuration [OClusterHealthChecker]Error on unmarshalling record #-2:968 (java.net.SocketException: Broken pipe) java.net.SocketException: Broken pipe         at java.net.SocketOutputStream.socketWrite0(Native Method)         at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)         at java.net.SocketOutputStream.write(SocketOutputStream.java:153)         at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)         at java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)         at java.io.DataOutputStream.write(DataOutputStream.java:107)         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.writeBytes(OChannelBinary.java:276)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.writeRecord(ONetworkProtocolBinary.java:2845)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.writeIdentifiable(ONetworkProtocolBinary.java:2629)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.serializeValue(ONetworkProtocolBinary.java:1597)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1542)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:579)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:320)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:196)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  2016-10-13 11:21:07:318 WARNI Cannot serialize record: #-2:968{uid:17133217,rcount:41} v0 [ONetworkProtocolBinary] 2016-10-13 11:21:07:319 WARNI Cannot serialize record: #-2:4376{uid:12905248,rcount:41} v0 [ONetworkProtocolBinary] 2016-10-13 11:22:01:089 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Connection [Address[192.168.3.10]:2434] lost. Reason: java.io.EOFException[Remote socket closed!] [TcpIpConnection] 2016-10-13 11:22:01:090 WARNI [192.168.1.127]:2434 [orientdb] [3.6.3] hz._hzInstance_1_orientdb.IO.thread-in-0 Closing socket to endpoint Address[192.168.3.10]:2434, Cause:java.io.EOFException: Remote socket closed! [NonBlockingSocketReader] 2016-10-13 11:22:01:531 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Connecting to /192.168.3.10:2434, timeout: 0, bind-any: false [InitConnectionTask] 2016-10-13 11:22:01:532 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Could not connect to: /192.168.3.10:2434. Reason: SocketException[Connection refused to address /192.168.3.10:2434] [InitConnectionTask] 2016-10-13 11:22:06:458 WARNI [bbs1]-&gt;[bbs2] Error on sending message to distributed node (java.net.SocketException: Connection reset) retrying (1/3) [ORemoteServerChannel] 2016-10-13 11:22:06:459 WARNI [bbs1]-&gt;[bbs2] Error on reconnecting to distributed node (java.net.ConnectException: Connection refused) [ORemoteServerChannel] 2016-10-13 11:22:06:459 WARNI [bbs1]-&gt;[bbs2] Error on sending message to distributed node (java.net.SocketException: Socket closed) retrying (2/3) [ORemoteServerChannel] 2016-10-13 11:22:06:531 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Connecting to /192.168.3.10:2434, timeout: 0, bind-any: false [InitConnectionTask] 2016-10-13 11:22:06:531 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Could not connect to: /192.168.3.10:2434. Reason: SocketException[Connection refused to address /192.168.3.10:2434] [InitConnectionTask] 2016-10-13 11:22:06:860 WARNI [bbs1]-&gt;[bbs2] Error on reconnecting to distributed node (java.net.ConnectException: Connection refused) [ORemoteServerChannel] 2016-10-13 11:22:06:860 WARNI [bbs1]-&gt;[bbs2] Error on sending message to distributed node (java.net.SocketException: Socket closed) retrying (3/3) [ORemoteServerChannel] 2016-10-13 11:22:07:461 WARNI [bbs1]-&gt;[bbs2] Error on reconnecting to distributed node (java.net.ConnectException: Connection refused) [ORemoteServerChannel] 2016-10-13 11:22:07:463 WARNI [bbs1]-&gt;[bbs2] Error on sending message to distributed node (java.net.SocketException: Socket closed) retrying (1/3) [ORemoteServerChannel] 2016-10-13 11:22:07:463 SEVER [bbs1]-&gt;[bbs2] Error on sending distributed request id=0.210 task=tx user=#5:0 (Connection refused). Active nodes: [bbs1, bbs2] [ODistributedDatabaseImpl] 2016-10-13 11:22:07:463 WARNI [bbs1]-&gt;[bbs2] Error on reconnecting to distributed node (java.net.ConnectException: Connection refused) [ORemoteServerChannel] 2016-10-13 11:22:07:463 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Connecting to /192.168.3.10:2434, timeout: 0, bind-any: false [InitConnectionTask] 2016-10-13 11:22:07:463 WARNI [bbs1]-&gt;[bbs2] Error on sending message to distributed node (java.net.SocketException: Socket closed) retrying (2/3) [ORemoteServerChannel] 2016-10-13 11:22:07:464 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Could not connect to: /192.168.3.10:2434. Reason: SocketException[Connection refused to address /192.168.3.10:2434] [InitConnectionTask] 2016-10-13 11:22:07:464 WARNI [192.168.1.127]:2434 [orientdb] [3.6.3] Removing connection to endpoint Address[192.168.3.10]:2434 Cause =&gt; java.net.SocketException {Connection refused to address /192.168.3.10:2434}, Error-Count: 5 [TcpIpConnectionMonitor] 2016-10-13 11:22:07:465 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Removing Member [192.168.3.10]:2434 [ClusterService] 2016-10-13 11:22:07:465 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Connecting to /192.168.3.10:2434, timeout: 0, bind-any: false [InitConnectionTask] 2016-10-13 11:22:07:465 INFO  [192.168.1.127]:2434 [orientdb] [3.6.3] Removing Member [192.168.3.10]:2434 [InternalPartitionService] ``` </body>
		<created>2016-10-13 03:56:20</created>
		<closed>2016-11-03 10:48:49</closed>
	</bug>
	<bug>
		<id>6802</id>
		<title>java.lang.NullPointerException: null OSBTree.findBucket</title>
		<body>## OrientDB Version, operating system, or hardware.  Orient DB 2.2.11 ## Operating System  .19.0-66-generic #74~14.04.1-Ubuntu SMP Tue Jul 19 19:56:11 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux ## Expected behavior and actual behavior  A Null pointer exception is generated..  ``` java.lang.NullPointerException: null         at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.findBucket(OSBTree.java:1701)         at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.get(OSBTree.java:199)         at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.get(OSBTreeIndexEngine.java:128)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:1921)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:1910)         at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:56)         at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:40)         at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.get(OIndexAbstractDelegate.java:58)         at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:262)         at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:40)         at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertices(OrientBaseGraph.java:845)         at com.stimulus.archiva.hp.f(MailArchiva:367)         at com.stimulus.archiva.hp.d(MailArchiva:352)         at com.stimulus.archiva.hp.a(MailArchiva:172)         at com.stimulus.archiva.database.DatabaseService.a(MailArchiva:446)         at com.stimulus.archiva.database.DatabaseService.a(MailArchiva:386)         at com.stimulus.archiva.database.DatabaseService.a(MailArchiva:365)         at com.stimulus.archiva.pr.b(MailArchiva:652)         at com.stimulus.archiva.pr.a(MailArchiva:625)         at com.stimulus.archiva.gn$f.a(MailArchiva:670)         at com.stimulus.archiva.gn$f.a(MailArchiva:626)         at com.stimulus.archiva.gn$b.b(MailArchiva:699)         at com.stimulus.archiva.gn$b.onSuccess(MailArchiva:685)         at com.google.api.client.googleapis.batch.BatchUnparsedResponse.parseAndCallback(BatchUnparsedResponse.java:197)         at com.google.api.client.googleapis.batch.BatchUnparsedResponse.parseNextResponse(BatchUnparsedResponse.java:155)         at com.google.api.client.googleapis.batch.BatchRequest.execute(BatchRequest.java:253)    .... ```  We are not expecting any null pointer exceptions. ## Steps to reproduce the problem </body>
		<created>2016-10-12 08:09:44</created>
		<closed>2016-10-28 09:20:29</closed>
	</bug>
	<bug>
		<id>6800</id>
		<title>NullPointerException in serializer</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.9 ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior ## Steps to reproduce the problem  2016-10-11 05:21:46.166 [kafka-consumer-modules-events-E615E245-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializin g record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAWAcAtuMDYG1vZHVsZXMtZXZlbnRzOkZMRUVUQURBUFRFUkhPUklaT05TVUJTQ1JJUFRJT046 MAJk  2016-10-11 05:21:46.194 [kafka-consumer-modules-events-E620B7C4-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught  during run java.lang.NullPointerException: null         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.getFieldNames(ORecordSerializerBinaryV0.java:319)         at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.getFieldNames(ORecordSerializerBinary.java:112)         at com.orientechnologies.orient.core.record.impl.ODocument.fieldNames(ODocument.java:735)  2016-10-11 05:26:00.011 [kafka-consumer-modules-events-E615E245-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAWAcAtuMDYG1vZHVsZXMtZXZlbnRzOkZMRUVUQURBUFRFUkhPUklaT05TVUJTQ1JJUFRJT046MAJk  2016-10-11 05:26:00.011 [kafka-consumer-modules-events-E616F3BA-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAYQcAtuMDcm1vZHVsZXMtZXZlbnRzOkFJUkxJTkVJTlRFR1JJVFlDSEVDS0hPUklaT05TVUJTQ1JJUFRJT046MAJk  2016-10-11 05:26:00.011 [kafka-consumer-modules-events-E615E245-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.022 [kafka-consumer-modules-events-E616F3BA-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.012 [kafka-consumer-modules-events-E618052D-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAXQcAtuMDam1vZHVsZXMtZXZlbnRzOlNFQ1VSSVRZUkVBRE1PREVMSE9SSVpPTlNVQlNDUklQVElPTjowAmQ=  2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E618052D-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.012 [kafka-consumer-modules-events-E616A599-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAWgcAtuMDZG1vZHVsZXMtZXZlbnRzOkZMRUVUUkVBRE1PREVMSE9SSVpPTlNVQlNDUklQVElPTjowAmQ=  2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E616A599-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.012 [kafka-consumer-modules-events-E61F582E-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAXgcAtuMDbG1vZHVsZXMtZXZlbnRzOlNFQ1VSSVRZV1JJVEVNT0RFTEhPUklaT05TVUJTQ1JJUFRJT046MAJk  2016-10-11 05:26:00.012 [kafka-consumer-modules-events-E62090B3-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAWwcAtuMDZm1vZHVsZXMtZXZlbnRzOkZMRUVUV1JJVEVNT0RFTEhPUklaT05TVUJTQ1JJUFRJT046MAJk  2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E61F582E-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E62090B3-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E616F3BA-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAYQcAtuMDcm1vZHVsZXMtZXZlbnRzOkFJUkxJTkVJTlRFR1JJVFlDSEVDS0hPUklaT05TVUJTQ1JJUFRJT046MAJk  2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E616F3BA-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.012 [kafka-consumer-modules-events-E61FF46F-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAWgcAtuMDZG1vZHVsZXMtZXZlbnRzOkFJUkxJTkVBREFQVEVSSE9SSVpPTlNVQlNDUklQVElPTjowAmQ=  2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E61FF46F-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E615E245-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAWAcAtuMDYG1vZHVsZXMtZXZlbnRzOkZMRUVUQURBUFRFUkhPUklaT05TVUJTQ1JJUFRJT046MAJk  2016-10-11 05:26:00.023 [kafka-consumer-modules-events-E615E245-8C68-11E6-AFC0-0050568B6471-admin-service-0] ERROR c.l.p.u.e.ExceptionLoggingExecutorService - Exception caught during run java.lang.NullPointerException: null 2016-10-11 05:26:00.012 [kafka-consumer-modules-events-E6167E88-8C68-11E6-AFC0-0050568B6471-admin-service-0] WARN  c.o.o.c.s.s.r.b.ORecordSerializerBinary - Error deserializing record to get field-names, send this data for debugging: ABhPcmllbnRPZmZzZXRDAAAAJD8AAAAnCkB0eXBlAAAAbwcAtuMDjAFtb2R1bGVzLWV2ZW50czpGTEVFVEFEQVBURVJTVUJGTEVFVEdST1VQSU5URUdSSVRZSE9SSVpPTlNVQlNDUklQVElPTjowAmQ=  </body>
		<created>2016-10-11 16:07:50</created>
		<closed>2016-10-12 13:11:02</closed>
	</bug>
	<bug>
		<id>6798</id>
		<title>Hook callbacks are called random number of times</title>
		<body>## OrientDB Version, operating system, or hardware. -  [x] v2.2.11 ## Operating System - [X] Linux ## Expected behavior and actual behavior  The callbacks like `onRecordAfterCreate()` should be called only once for every insert. ## Steps to reproduce the problem  ``` public class MyHook extends ODocumentHookAbstract {   @Override   public DISTRIBUTED_EXECUTION_MODE getDistributedExecutionMode() {     return DISTRIBUTED_EXECUTION_MODE.TARGET_NODE;   }   @Override   public void onRecordAfterCreate(ODocument iDocument) {     System.out.println("Created " + iDocument.toJSON());   } } ```  ```   for (int i = 0; i &lt; 10; i++) {     try (ODatabaseDocumentTx db = dbPool.acquire()) {       db.save(new ODocument("SomeTable").field("entry", i));     }   } ```  Result:  ``` Created {"@type":"d","@rid":"#17:0","@version":1,"@class":"SomeTable","entry":0} Created {"@type":"d","@rid":"#18:0","@version":1,"@class":"SomeTable","entry":1} Created {"@type":"d","@rid":"#19:0","@version":1,"@class":"SomeTable","entry":2} Created {"@type":"d","@rid":"#19:0","@version":1,"@class":"SomeTable","entry":2} Created {"@type":"d","@rid":"#20:0","@version":1,"@class":"SomeTable","entry":3} Created {"@type":"d","@rid":"#20:0","@version":1,"@class":"SomeTable","entry":3} Created {"@type":"d","@rid":"#17:1","@version":1,"@class":"SomeTable","entry":4} Created {"@type":"d","@rid":"#17:1","@version":1,"@class":"SomeTable","entry":4} Created {"@type":"d","@rid":"#17:1","@version":1,"@class":"SomeTable","entry":4} Created {"@type":"d","@rid":"#18:1","@version":1,"@class":"SomeTable","entry":5} Created {"@type":"d","@rid":"#18:1","@version":1,"@class":"SomeTable","entry":5} Created {"@type":"d","@rid":"#18:1","@version":1,"@class":"SomeTable","entry":5} Created {"@type":"d","@rid":"#19:1","@version":1,"@class":"SomeTable","entry":6} Created {"@type":"d","@rid":"#19:1","@version":1,"@class":"SomeTable","entry":6} Created {"@type":"d","@rid":"#19:1","@version":1,"@class":"SomeTable","entry":6} Created {"@type":"d","@rid":"#19:1","@version":1,"@class":"SomeTable","entry":6} Created {"@type":"d","@rid":"#20:1","@version":1,"@class":"SomeTable","entry":7} Created {"@type":"d","@rid":"#20:1","@version":1,"@class":"SomeTable","entry":7} Created {"@type":"d","@rid":"#20:1","@version":1,"@class":"SomeTable","entry":7} Created {"@type":"d","@rid":"#20:1","@version":1,"@class":"SomeTable","entry":7} Created {"@type":"d","@rid":"#17:2","@version":1,"@class":"SomeTable","entry":8} Created {"@type":"d","@rid":"#17:2","@version":1,"@class":"SomeTable","entry":8} Created {"@type":"d","@rid":"#17:2","@version":1,"@class":"SomeTable","entry":8} Created {"@type":"d","@rid":"#17:2","@version":1,"@class":"SomeTable","entry":8} Created {"@type":"d","@rid":"#17:2","@version":1,"@class":"SomeTable","entry":8} Created {"@type":"d","@rid":"#18:2","@version":1,"@class":"SomeTable","entry":9} Created {"@type":"d","@rid":"#18:2","@version":1,"@class":"SomeTable","entry":9} Created {"@type":"d","@rid":"#18:2","@version":1,"@class":"SomeTable","entry":9} Created {"@type":"d","@rid":"#18:2","@version":1,"@class":"SomeTable","entry":9} Created {"@type":"d","@rid":"#18:2","@version":1,"@class":"SomeTable","entry":9} ``` </body>
		<created>2016-10-11 06:36:28</created>
		<closed>2016-10-26 10:40:29</closed>
	</bug>
	<bug>
		<id>6797</id>
		<title>Perpetual wait on a reentrant lock while loading from cache</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.9 - v2.2.11 ## Operating System - [X] Windows Server 2012 R2 (64 bit) ## Hardware  16GB, 4 CPU core. Running in a VMWare virtualized environment. ## Java  Java 8 with heap size set to 6GB.  ## Expected behavior and actual behavior  In our server, Orient DB v2.2.9 - v2.2.11 stops functioning when the database gets to a certain size. There are long pauses in Orient DB calls to perform simple operations like retrieve a value from a vertex. After restarting the database, it works for a short while and then get back into a mode whereby the database freezes again.  The value **-XX:MaxDirectMemorySize=512g**  is set when this error occurs.   Expected behaviour: We expect that Orient will continue to do useful work. ## Steps to reproduce the problem  This issue is occurring in two production systems and is reproducible by restarting the server using a specific Orient DB database (already provided to Andrey). To the untrained eye, it looks like some kind of caching logic issue. To guard against OME problems we experienced when we moved to v2.2, we limit the size of the cache as follows on startup:  ``` long maxDirectMemoryBytes = sun.misc.VM.maxDirectMemory(); long directHintMB = maxDirectMemoryBytes / 1024 / 1024; long maxMemoryBytes = Runtime.getRuntime().maxMemory(); long maxMemoryHintMB = maxMemoryBytes / 1024 / 1024; long bufferSizeMB = Math.min(directHintMB, maxMemoryHintMB); System.setProperty("storage.diskCache.bufferSize", String.valueOf(bufferSizeMB)); ```  The cache size ends up being several GB in size, so it shouldn't be an issue that the server would stop working. If we didn't specify the storage.diskCache.bufferSize value, the server would simply OME after some time. Setting **storage.diskCache.bufferSize** to **2GB** doesn't help either.  ![chart](https://cloud.githubusercontent.com/assets/6212848/19260924/f819afac-8f8d-11e6-995a-f19c933137c4.png)  If we start from an empty database, Orient DB seems to work fine. When the database grows in size, it gets to a point where the behaviour is observed.   Access to the Yourkit snapshot and Orient DB database has been provided offline to Andrey.  </body>
		<created>2016-10-11 06:32:22</created>
		<closed>2016-11-30 06:06:28</closed>
	</bug>
	<bug>
		<id>6793</id>
		<title>Range filtering (in, out) throws NegativeArrayException when the provided range is out of bounds</title>
		<body>## OrientDB Version, operating system, or hardware.  2.2.11 MacOS X ## Expected behavior and actual behavior  `SELECT out('edge')[10-20] FROM V` throws a `NegativeArrayException` if a vertex has less than 10 edges of type "edge". The problem is easy to reproduce: it occurs in studio, console and client APIs.  The problem occurs only with ranges, `SELECT out('edge')[10] FROM V` doesn't fail. However, it returns an empty tuple while I would have expected no results at all:  ``` &gt; SELECT out('anEdge')[0] FROM RootType  +----+ |#   | +----+ |0   | +----+  1 item(s) found. Query executed in 0.003 sec(s). ```  Some test code:  ``` java OrientVertex vertex1 = graph.addVertex("class:V"); OrientVertex vertex2 = graph.addVertex("class:V"); vertex1.addEdge("edge", vertex2); graph.commit();  String query = "SELECT out('edge')[10] FROM V"; Iterable&lt;OrientVertex&gt; results = graph.command(new OCommandSQL(query)).execute(); // ok, but results contains one element  query = "SELECT out('nonExistingEdge')[0] FROM V"; results = graph.command(new OCommandSQL(query)).execute(); // ok, but results contains one element  query = "SELECT out('nonExistingEdge')[0-10] FROM V"; results = graph.command(new OCommandSQL(query)).execute(); // ok, but results contains one element  query = "SELECT out('nonExistingEdge')[10-20] FROM V"; results = graph.command(new OCommandSQL(query)).execute(); /* Exception in thread "main" com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.SELECT out('nonExistingEdge')[10-20] FROM V ... Caused by: java.lang.NegativeArraySizeException at com.orientechnologies.orient.core.record.impl.ODocumentHelper.getFieldValue(ODocumentHelper.java:452) at com.orientechnologies.orient.core.sql.functions.coll.OSQLMethodMultiValue.execute(OSQLMethodMultiValue.java:54) at com.orientechnologies.orient.core.sql.method.OSQLMethodRuntime.execute(OSQLMethodRuntime.java:139) at com.orientechnologies.orient.core.sql.filter.OSQLFilterItemAbstract.transformValue(OSQLFilterItemAbstract.java:140) at com.orientechnologies.orient.core.sql.functions.OSQLFunctionRuntime.execute(OSQLFunctionRuntime.java:134) at com.orientechnologies.orient.core.sql.ORuntimeResult.applyRecord(ORuntimeResult.java:141) at com.orientechnologies.orient.core.sql.ORuntimeResult.getProjectionResult(ORuntimeResult.java:255) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:707) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:673) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:630) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1619) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1566) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:525) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:488) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:74) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2672) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2618) at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1438) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:576) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:321) at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:197) at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)*/ ``` </body>
		<created>2016-10-07 05:53:11</created>
		<closed>2016-10-10 07:48:54</closed>
	</bug>
	<bug>
		<id>6791</id>
		<title>Write with reader instead of root produces unexpected behavior</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.4 ## Operating System - Linux ## Expected behavior and actual behavior  Writing to OrientDB with reader produces an error but still writes the data. Expected to not write any date using reader role. ## Steps to reproduce the problem  Write to OrientDB with reader role. </body>
		<created>2016-10-06 20:05:22</created>
		<closed>2016-11-14 19:31:37</closed>
	</bug>
	<bug>
		<id>6789</id>
		<title>Move vertex suddenly drops edges</title>
		<body>2.2.7, Linux ubuntu ## Expected behavior and actual behavior  When moving vertex from one class to another I would expect that those edges will not be removed. This is mine code snippet: `OrientVertex beforeVertex;` `OrientVertex afterVertex;` `int bofore = beforeVertex.countEdges(Direction.IN, UserVoteOnPickle.LABEL);` `activeGraph.command(new OCommandSQL("move vertex #11:545 to class:ExpiredPickle set expiredAt = ?")).execute(new Date());` `int after = afterVertex.countEdges(Direction.IN, UserVoteOnPickle.LABEL);`  `create class User extends V;` `create class Pickle extends V;` `create class ActivePickle extends Pickle;` `create class ExpiredPickle extends Pickle;` `create property ExpiredPickle.expiredAt datetime;` `create class UserVoteOnPickle extends E;` `create property UserVoteOnPickle.out LINK User;` `create property UserVoteOnPickle.in LINK Pickle;` `ALTER PROPERTY UserVoteOnPickle.out MANDATORY TRUE;` `ALTER PROPERTY UserVoteOnPickle.in MANDATORY TRUE;` `CREATE INDEX UniqueUserVoteOnPickle ON UserVoteOnPickle(out,in) UNIQUE;`  UserVoteOnPickle's are the edges which disappear.  Those are the logs I am getting after executing this code: `2016-10-06 08:03:17,030 INFO [request=] [uid=] [user=] [service=] - Votes count before: 41` `2016-10-06 08:03:17,039 INFO [request=] [uid=] [user=] [service=] - Votes count after: 0`  `2016-10-06 09:33:58,133 INFO [request=] [uid=] [user=] [service=] - Votes count before: 71` `2016-10-06 09:33:58,159 INFO [request=] [uid=] [user=] [service=] - Votes count after: 0`  `2016-10-06 09:53:39,419 INFO [request=] [uid=] [user=] [service=] - Votes count before: 2` `2016-10-06 09:53:39,424 INFO [request=] [uid=] [user=] [service=] - Votes count after: 2`  `2016-10-06 13:21:27,101 INFO [request=] [uid=] [user=] [service=] - Votes count before: 79` `2016-10-06 13:21:27,118 INFO [request=] [uid=] [user=] [service=] - Votes count after: 0` ## Steps to reproduce the problem  I do not know exact steps to reproduce but it seems that it does not work only with large ammount of edges. As you see in mine logs vertex with two edges was able to keep them persited .. but those with more are lost.  Error did not occur with version 2.1, it started to occur after update to 2.2 </body>
		<created>2016-10-06 17:12:33</created>
		<closed>2016-10-10 11:08:08</closed>
	</bug>
	<bug>
		<id>6786</id>
		<title>Quotes and parentheses in SQL query</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.5 ## Operating System - Linux ## Expected behavior and actual behavior  I have next data:  ``` { "result": [    {        "@type": "d",        "@rid": "#25:0",        "@version": 1,        "@class": "name",        "surname": "foo surname",        "name": "foo name"    },    {        "@type": "d",        "@rid": "#26:0",        "@version": 1,        "@class": "name",        "surname": "bar surname",        "name": "bar name"    },    {        "@type": "d",        "@rid": "#27:0",        "@version": 1,        "@class": "name",        "surname": "O'brien",        "name": "baz"    } ], "notification": "Query executed in 0.015 sec. Returned 3 record(s)" } ```  for query  ``` SELECT * FROM name; ```  And I have next query:  ``` select * from name WHERE (NOT (surname='O\'brien')) ```  And result:  ``` java.lang.NullPointerException ```  Expected result:  ``` { "result": [    {        "@type": "d",        "@rid": "#25:0",        "@version": 1,        "@class": "name",        "surname": "foo surname",        "name": "foo name"    },    {        "@type": "d",        "@rid": "#26:0",        "@version": 1,        "@class": "name",        "surname": "bar surname",        "name": "bar name"    } ] } ```  More examples in http://stackoverflow.com/questions/39892358/orientdb-quote-in-sql-query  Question - is it a bug, or I do something wrong?  Thanks. </body>
		<created>2016-10-06 10:05:06</created>
		<closed>2016-10-31 11:55:49</closed>
	</bug>
	<bug>
		<id>6783</id>
		<title>Object API: Updating child via parent</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.X ## Operating System - MacOSX - Windows ## Expected behavior and actual behavior  I think the behavior I'm going to describe is closely related to this issue: https://github.com/orientechnologies/orientdb/issues/6729.  I have a very simple domain model consisting of 2 entities related via a one-to-one relationship. Entity A has a reference to entity B. The fields in both entities are @Basic, all but the reference in A to B.  I have a repository service which uses OrientDB Object API to perform CRUD and list operations on the previous domain model. The repository instantiates and access a Plocal database.  This code uses OrientDB 2.1.x and is in production. Everything works fine. We have a bunch of integration tests (junit) for all the operations in the repository.  Now we are trying to upgrade to OrientDB 2.2.X.  First, we upgraded to OrientDB 2.2.10 and all the integration tests passed, but when deploy the application to tomcat we experience a problem: - Create an instance of A and its related B and do save A. Fine. Both A and B are stored. - Update a field in B and do a save in A. An OConcurrentModificationException is thrown.  `Error updating job. JobID: 0e426fe2-0a8c-41e8-8455-b3c8abec5443. Cannot UPDATE the record #43:5 because the version is not the latest. Probably you are updating an old record or it has been modified by another user (db=v3 your=v2)`  What is odd is that the record is saved, so I assume OrientDB is trying to save it twice, the first time works and the second fails because obviously it has been already been saved and thus the version has been increased.  What is even odder, when we try to to the same operation in the same record it fails again, but if we keep trying it eventually stops failing, and from that moment on it works well.  I have been trying but have not been able to reproduce this behavior on an integration test, it only happens when we deploy the application in Tomcat.  **Yesterday I upgraded to OrientDB 2.2.11** and now the exception is thrown **much less often**, but still happens sometimes. That's why I assume is something related to what was reported and fixed in https://github.com/orientechnologies/orientdb/issues/6729. </body>
		<created>2016-10-05 09:37:48</created>
		<closed>2017-06-05 15:49:21</closed>
	</bug>
	<bug>
		<id>6782</id>
		<title>Saving JSON data with embedded objects fails</title>
		<body>## OrientDB Version, operating system, or hardware. v2.2.10 ## Operating System - [X] Linux - [X] MacOSX ## Expected behavior and actual behavior  Expected to save serialized JSON classes with embedded classes when they one-to-one have the same structure as classes in orientdb, but it doesn't work. Per Luigi's request, I'm pasting the issue here from the google groups. Just for the reference, my original question can be found here: https://groups.google.com/forum/#!topic/orient-database/hFhYyE5da-A  I'm working on the application, which will need to store different objects of complex structure (objects inside of objects). For example, Person object may have Address object, Contacts, and may need to link to some other objects, etc. Sometimes these objects may go few levels deep. I created the class with an embedded class and it all works good when I run query in the console. I have to use these extra fields ("@type":"d", "@class":"Address") in the embedded object in order for the query to understand the embedded object.  Here is example of a working query:  ``` insert into Account (company, website, address) values ('Seller 0', 'http://www.seller0.com', {"@type":"d", "@class":"Address", "street":"1234 Sunset Dr.", "city":"Santa Monica", "state":"CA", "zip":"90046"}) ```  The problem I"m running into, is that I will need to do this functionality dynamically in Java and I have modeled my java classes to be exact as the classes in the database, which makes sense to me and would save a lot of time. However, when I serialize my Java object into JSON and create ODocument object from this JSON, on save() the database is not taking it. Here is example of one simple serialized java object:  ``` json =  {     "account": "#25:0",     "meta": {         "created": "2016-10-03T21:10:21.77-07:00",         "ip": "0:0:0:0:0:0:0:1",         "contentType": "application/x-www-form-urlencoded",         "userAgent": "PostmanRuntime/2.5.2"     },     "data": "firstName=Jessica&amp;lastName=Smith" } ```  When I use this logic it fails:  ``` **ODocument d = new ODocument("RawLead").fromJSON(json); d.save();**             ```  I get Java error: `**Error: Error during saving of record with rid #-1:-1**`  For the above JSON I have the following "RawLead" class with embedded "LeadMetadata" class:  ``` CLASS 'RawLead' PROPERTIES +----+-------+--------+-----------------+---------+--------+--------+----+----+-------+-------+  |#   |NAME   |TYPE    |LINKED-TYPE/CLASS|MANDATORY|READONLY|NOT-NULL|MIN |MAX |COLLATE|DEFAULT| +----+-------+--------+-----------------+---------+--------+--------+----+----+-------+-------+ |0   |data   |STRING  |                 |true     |false   |true    |    |    |default|       | |1   |meta   |EMBEDDED|LeadMetadata     |true     |false   |true    |    |    |default|       | |2   |account|LINK    |Account          |true     |false   |true    |    |    |default|       | +----+-------+--------+-----------------+---------+--------+--------+----+----+-------+-------+  CLASS 'LeadMetadata' PROPERTIES  +----+-----------+--------+-----------------+---------+--------+--------+----+----+-------+---------+ |#   |NAME       |TYPE    |LINKED-TYPE/CLASS|MANDATORY|READONLY|NOT-NULL|MIN |MAX |COLLATE|DEFAULT  | +----+-----------+--------+-----------------+---------+--------+--------+----+----+-------+---------+ |0   |created    |DATETIME|                 |false    |true    |false   |    |    |default|sysdate()| |1   |ip         |STRING  |                 |true     |false   |true    |7   |40  |default|         | |2   |userAgent  |STRING  |                 |true     |false   |true    |1   |100 |default|         | |3   |contentType|STRING  |                 |true     |false   |true    |4   |50  |default|         | +----+-----------+--------+-----------------+---------+--------+--------+----+----+-------+---------+ ```  I assume it's because I don't have the magic fields ("@type":"d", "@class":"Meta") in my JSON. If this is correct, I need an advise on how to go around it or maybe there is a different and more straight forward way of doing it? I was hopping that I can simply serialize my exact Java objects into JSON format then create ODocument and simply save it in the database. That would be so awesome.  Let me know if you need any additional info or if you want me to try anything. Thanks. </body>
		<created>2016-10-04 17:04:06</created>
		<closed>2016-10-28 16:30:31</closed>
	</bug>
	<bug>
		<id>6780</id>
		<title>Issues with OrientVertex#addEdge after OrientEdge#remove</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.9 ## Operating System - [x] Windows ## Expected behavior and actual behavior ## Steps to reproduce the problem  I'm trying to update the connection of vertices by removing the edge and then adding a new edge via java graph api. Multiple issues arise which are described in the following test.   [3] and [4] are working without errrors or warnings but shouldn't this be achived with the `reload()` call?   [5] is weird because the document state is valid (i.e. only one edge) after commit but is not persited to the db.  ``` @Test    public void testDeleteAndAddNewEdge()    {       OrientGraph graph = factory.getTx();        OrientVertex v1 = graph.addTemporaryVertex( "Test1V" );       v1.getRecord().field( "name", "v1" );       v1.save();        OrientVertex v2 = graph.addTemporaryVertex( "Test2V" );       v2.getRecord().field( "name", "v2" );       v2.save();        graph.commit();        System.out.println( v1.getRecord().toJSON() );       System.out.println( v2.getRecord().toJSON() );        Assert.assertTrue( v1.getIdentity().isPersistent() );       Assert.assertTrue( v2.getIdentity().isPersistent() );        for( int i = 0; i &lt; 5; i++ )       {          System.out.println( i );           // Remove all edges          List&lt;Edge&gt; edges = new ArrayList&lt;&gt;();          v1.getEdges( Direction.OUT, "TestE" ).forEach( edges::add );          edges.forEach( Edge::remove );            // -------------------------          // [1] WITHOUT RELOAD          // ==&gt; java.lang.NullPointerException on commit          // at com.tinkerpop.blueprints.impls.orient.OrientElement.checkClass(OrientElement.java:606)          // at com.tinkerpop.blueprints.impls.orient.OrientEdge.remove(OrientEdge.java:384)          // at java.util.ArrayList.forEach(Unknown Source)            // -------------------------          // [2] WITH RELOAD          // ==&gt; WARNING: Found record in transaction with the same RID #152:4 but different instance. Probably the record has been loaded from another transaction and reused on the current one: reload it from current transaction before to update or delete it           // v1.reload();          // v2.reload();            // -------------------------          // [3] WITH NEW INSTANCE          // ==&gt; No warnings! But not always feasible because more tracking and vertex management required           // v1 = new OrientVertex( null, v1.getIdentity() );          // v2 = new OrientVertex( null, v2.getIdentity() );            // -------------------------          // [4] WITH rawElement REFLECTION TO 'RELOAD'          // ==&gt; No warnings! Same as above           // try          // {          //    Field field = OrientElement.class.getDeclaredField( "rawElement" );          //    field.setAccessible( true );          //    field.set( v1, v1.getIdentity() );          //    field.set( v2, v2.getIdentity() );          // }          // catch( Exception e )          // {          //    throw new IllegalStateException( e );          // }           // Add new edge          v1.addEdge( "TestE", v2 );           graph.commit();           // -------------------------          // [5] WITH RELOAD AFTER COMMIT          // ==&gt; WARNING: Record (#138:84) is null          // Edges are deleted but but the links in both vertices are not updated          // "out_TestE":["#140:82","#137:89","#138:84","#139:89","#140:83"]          // "in_TestE":["#140:82","#137:89","#138:84","#139:89","#140:83"]           // v1.reload();          // v2.reload();             System.out.println( v1.getRecord().toJSON() );          System.out.println( v2.getRecord().toJSON() );           Assert.assertEquals( v2.getId(), v1.getVertices( Direction.OUT, "TestE" ).iterator().next().getId() );          Assert.assertEquals( v1.getId(), v2.getVertices( Direction.IN, "TestE" ).iterator().next().getId() );       }    } ``` </body>
		<created>2016-10-04 14:51:39</created>
		<closed>2016-12-14 18:08:44</closed>
	</bug>
	<bug>
		<id>6774</id>
		<title>NullPointerException during incremental restore</title>
		<body>## OrientDB Version, operating system, or hardware.  OrientDB Enterprise Edition v2.2.4 ## Operating System  Linux ## Expected behavior and actual behavior  Incremental restore using the Java API throws a null pointer exception. A corrupted database is created from this restore. It cannot be deleted nor logged into via the web studio. ## Steps to reproduce the problem  If I execute a single incremental backup and restore (single ibu file in the backup directory), everything works fine. However, if I execute another incremental backup after creating one new vertex (meaning two ibu files now), and then try to restore, I get the exception below during the restore. Note that I tried but was unable to reproduce this on an example database. I cannot share my database publicly nor privately because it contains proprietary data. Please let me know if there is any more information I can provide to help with debugging.  Command executed (Java API):  ``` new OServerAdmin(dbHost)   .connect(username, password)   .createDatabase(dbName, "graph", "plocal", backupPath); ```  Server Log:  ``` 2016-10-03 19:33:26:319 WARNI {db=&lt;restore_db_name&gt;} Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=#, position=#}} com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointStartRecord{lsn=null, previousCheckpoint=OLogSequenceNumber{segment=#, position=#}} will be skipped during data restore [OEnterpriseLocalPaginatedStorage] 2016-10-03 19:33:26:320 WARNI {db=&lt;restore_db_name&gt;} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segment=#, position=#}} will be skipped during data restore [OEnterpriseLocalPaginatedStorage] ```  Exception:  ``` Caused by: com.orientechnologies.orient.enterprise.channel.binary.OResponseProcessingException: Exception during response processing     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:443)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:378)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:260)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:152)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2087)     at com.orientechnologies.orient.client.remote.OStorageRemote.getResponse(OStorageRemote.java:2095)     at com.orientechnologies.orient.client.remote.OServerAdmin$5.execute(OServerAdmin.java:265)     at com.orientechnologies.orient.client.remote.OServerAdmin$5.execute(OServerAdmin.java:243)     at com.orientechnologies.orient.client.remote.OServerAdmin.networkAdminOperation(OServerAdmin.java:695)     ... 8 more Caused by: java.lang.NullPointerException     at com.orientechnologies.lucene.engine.OLuceneIndexEngineDelegate.close(OLuceneIndexEngineDelegate.java:117)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.closeIndexes(OAbstractPaginatedStorage.java:3554)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OEnterpriseLocalPaginatedStorage.restoreFromIncrementalBackup(OEnterpriseLocalPaginatedStorage.java:419)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OEnterpriseLocalPaginatedStorage.restoreFromIncrementalBackup(OEnterpriseLocalPaginatedStorage.java:398)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OEnterpriseLocalPaginatedStorage.restoreFromIncrementalBackup(OEnterpriseLocalPaginatedStorage.java:364)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.create(ODatabaseDocumentTx.java:374)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createDatabase(ONetworkProtocolBinary.java:2585)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createDatabase(ONetworkProtocolBinary.java:1160)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:362)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:199)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ``` </body>
		<created>2016-10-03 19:48:05</created>
		<closed>2016-10-18 13:18:26</closed>
	</bug>
	<bug>
		<id>6773</id>
		<title>repair database --fix-graph throws NPE</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.10 - v2.2.11 ## Operating System  Linux ## Expected behavior and actual behavior  Expected to get an output similar to what's described in http://orientdb.com/docs/last/Console-Command-Repair-Database.html  I am getting just "null pointer exception" with no further details.   From orientdb.err (partial):  ``` 2016-10-03 14:41:40:000 INFO  Loading configuration from: /home/develance/orientdb/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml] 2016-10-03 14:41:40:315 INFO  OrientDB Server v2.2.11 (build 2.2.x@r8b3a478e3ca7321a48e7cf0f5991569bbe06ed89; 2016-10-03 09:39:41+0000) is starting up... [OServer] 2016-10-03 14:41:40:322 INFO  Databases directory: /home/develance/orientdb/data [OServer] 2016-10-03 14:41:40:783 INFO  Listening binary connections on 0.0.0.0:2424 (protocol v.36, socket=default) [OServerNetworkListener] 2016-10-03 14:41:40:786 INFO  Listening http connections on 0.0.0.0:2480 (protocol v.10, socket=default) [OServerNetworkListener] 2016-10-03 14:41:40:798 INFO  Installing dynamic plugin 'studio-2.2.zip'... [OServerPluginManager] 2016-10-03 14:41:40:808 INFO  ODefaultPasswordAuthenticator is active [ODefaultPasswordAuthenticator] 2016-10-03 14:41:40:813 INFO  OServerConfigAuthenticator is active [OServerConfigAuthenticator] 2016-10-03 14:41:40:814 INFO  OSystemUserAuthenticator is active [OSystemUserAuthenticator] 2016-10-03 14:41:40:848 INFO  Installed GREMLIN language v.2.6.0 - graph.pool.max=50 [OGraphServerHandler] 2016-10-03 14:41:40:848 INFO  [OVariableParser.resolveVariables] Error on resolving property: distributed [orientechnologies] 2016-10-03 14:41:40:852 WARNI Authenticated clients can execute any kind of code into the server by using the following allowed languages: [sql] [OServerSideScriptInterpreter] 2016-10-03 14:41:40:855 INFO  OrientDB Studio available at http://45.56.122.213:2480/studio/index.html [OServer] 2016-10-03 14:41:40:855 INFO  OrientDB Server is active v2.2.11 (build 2.2.x@r8b3a478e3ca7321a48e7cf0f5991569bbe06ed89; 2016-10-03 09:39:41+0000). [OServer] 2016-10-03 14:43:55:296 WARNI {db=OSystem} Storage 'OSystem' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-10-03 14:43:55:297 INFO  {db=OSystem} Looking for last checkpoint... [OLocalPaginatedStorage] 2016-10-03 14:43:55:297 INFO  {db=OSystem} Checkpoints are absent, the restore will start from the beginning. [OLocalPaginatedStorage] 2016-10-03 14:43:55:298 INFO  {db=OSystem} Data restore procedure is started. [OLocalPaginatedStorage] 2016-10-03 14:43:55:305 WARNI {db=OSystem} Non tx operation was used during data modification we will need index rebuild. [OLocalPaginatedStorage] 2016-10-03 14:43:55:311 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=5293}, p$ 2016-10-03 14:43:55:311 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=5301}} will be$ 2016-10-03 14:43:55:318 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=14746}, $ 2016-10-03 14:43:55:319 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=14770}} will b$ 2016-10-03 14:43:55:327 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=42277}, $ 2016-10-03 14:43:55:328 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=42301}} will b$ 2016-10-03 14:43:55:686 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=139035},$ 2016-10-03 14:43:55:686 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=139059}} will $ 2016-10-03 14:43:55:925 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=417812},$ 2016-10-03 14:43:55:926 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=417836}} will $ 2016-10-03 14:43:55:927 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=417843},$ 2016-10-03 14:43:55:927 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=417867}} will $ 2016-10-03 14:43:55:928 WARNI {db=OSystem} Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=417874}} com.orientechnologies.orient.core.storage.impl.local.paginated.wa$ 2016-10-03 14:43:55:928 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=417914}} $ 2016-10-03 14:43:55:929 WARNI {db=OSystem} Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=417921}} com.orientechnologies.orient.core.storage.impl.local.paginated.wa$ 2016-10-03 14:43:55:930 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=417961}} $ 2016-10-03 14:43:55:930 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=417968},$ 2016-10-03 14:43:55:931 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=417992}} will $ 2016-10-03 14:43:55:932 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFullCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=417999},$ 2016-10-03 14:43:55:934 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=418023}} will $ 2016-10-03 14:43:55:935 WARNI {db=OSystem} Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=418030}} com.orientechnologies.orient.core.storage.impl.local.paginated.wa$ 2016-10-03 14:43:55:936 WARNI {db=OSystem} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=418070}} $ 2016-10-03 14:43:55:937 WARNI {db=OSystem} Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=418077}} com.orientechnologies.orient.core.storage.impl.local.paginated.wa$  ```  I tried the repair since whenever I try to access Studio from the browser, I can connect to DB but when selecting "Schema" tab, it reports "Server might be offline". ## Steps to reproduce the problem - open console - connect to db (remote) - run repair database --fix-graph </body>
		<created>2016-10-03 17:36:52</created>
		<closed>2016-11-23 11:36:58</closed>
	</bug>
	<bug>
		<id>6767</id>
		<title>Error exporting database with automatic backup</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.10 ## Operating System - [x] Linux - Ubuntu 14.04 Digital Ocean virtual instance - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  At time of execute the automatic backup, the log shows this errors related to an spatial index:  [orient-server.log.0.txt](https://github.com/orientechnologies/orientdb/files/504646/orient-server.log.0.txt)  And this is my config:  ``` javascript {   "enabled": true,   "mode": "EXPORT",   "exportOptions": "",   "delay": "4h",   "firstTime": "13:00:00",   "targetDirectory": "/var/orientdbBackups",   "targetFileName": "${DBNAME}-${DATE:yyyyMMddHHmmss}.zip",   "dbInclude": "BH",   "compressionLevel": 9,   "bufferSize": 1048576 } ```  The backup file is created, but i get those errors :confused:  </body>
		<created>2016-10-01 20:50:31</created>
		<closed>2016-10-03 16:32:54</closed>
	</bug>
	<bug>
		<id>6766</id>
		<title>Pulling RID of a Vertex from Java JDBC Library</title>
		<body>## Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   I just upgraded from 2.1.x to 2.2.10  I have a query where I want ONLY the rids of a set of vertices that match a condition. I was getting negative rids until I ran across this post:   https://groups.google.com/forum/#!topic/orient-database/EyLm1lVMolI  This worked in 2.1.x but does not anymore. Now `SELECT @rid as rid FROM` whatever returns a list of ODocuments in the rid field of the ResultSet. When I call `resultSet.getString("rid")`, I get the entire ODocument as a String. I cannot imagine this is the intended behavior.  I have not been able to find any documentation in either 2.1 or 2.2 that explains how to do this correctly.  What is the canonical way to get the real rid as a projection and can someone please, please add it to the docs? This appears to be out of date: http://orientdb.com/docs/last/JDBC-Home.html#first-get-a-connection </body>
		<created>2016-09-30 19:02:01</created>
		<closed>2016-10-07 15:03:26</closed>
	</bug>
	<bug>
		<id>6762</id>
		<title>shutdown of 400GB dbase hangs</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.13-20161027.133116-9  ## Operating System - [x] Linux (Ubuntu 14.04LTS) ## Expected behavior and actual behavior  Bundled "shutdown.sh" script, with or without extra arguments, should gracefully shutdown the server, but it does not. Follow-up of #6705  ## Steps to reproduce the problem  1) launched the "shutdown.sh" script without arguments: `# bin/shutdown.sh` pid file detected, killing process waiting for OrientDB server to shutdown (never completes) 2) launched the "shutdown.sh" script with the arguments mentioned in issue #6705 by robfrank (of course filled in the correct values for our case): `# bin/shutdown.sh -h orient1.bc -P 2424-2430 -u root -p ROOT_PASSWORD` Sending shutdown command to remote OrientDB Server instance... Sep 30, 2016 2:11:41 PM com.orientechnologies.common.log.OLogManager log SEVERE: Error on connecting to orient1.bc:2424 java.net.ConnectException: Connection refused ... 3) server process still not shutdown: `# ps -aef|grep java root     42254 42252 82 Sep29 ?        13:27:20 java -server -Xms1024m -Xmx16384m -Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=512g -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 -Dstorage.diskCache.bufferSize=65536 -Djava.util.logging.config.file=/opt/orientdb/orientdb-community-2.2.10/config/orientdb-server-log.properties -Dorientdb.config.file=/opt/orientdb/orientdb-community-2.2.10/config/orientdb-server-config.xml -Dorientdb.www.path=/opt/orientdb/orientdb-community-2.2.10/www -Dorientdb.build.number=2.2.x@rc32d4ee06d4c38e27eb66931d027eb54854872ff; 2016-09-15 08:47:27+0000 -cp /opt/orientdb/orientdb-community-2.2.10/lib/orientdb-server-2.2.10.jar:/opt/orientdb/orientdb-community-2.2.10/lib/*:/opt/orientdb/orientdb-community-2.2.10/plugins/* -Ddistributed=true com.orientechnologies.orient.server.OServerMain`  4) logfile: 2016-09-30 13:52:27:477 WARNI Received signal: SIGTERM [OSignalHandler] </body>
		<created>2016-09-30 12:19:33</created>
		<closed>2016-11-18 11:23:34</closed>
	</bug>
	<bug>
		<id>6759</id>
		<title>Export/import from 2.2.4 to 2.2.10 failed</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2.4 and v2.2.10 ## Operating System  Linux ## Expected behavior and actual behavior  Expected: Successful import of database into 2.2.10 that was exported from 2.2.4 Actual: Empty database after import ## Steps to reproduce the problem  I'm not able to release the database, and I haven't been able to reproduce the problem on another database. Export/import within 2.2.4 works fine. It seems like the import process somehow runs twice, and in the second time deletes all the previously imported data. This is the output:  Command: `import database &lt;path to export file&gt; -preserveClusterIDs=true`  Output:  ``` Started import of database 'plocal:&lt;path to database folder&gt; from /tmp/... Non merge mode (-merge=false): removing all non security classes - Class OFunction was removed. - Class .... ... ... Removed # classes. Importing database info...OK Importing clusters... - Creating cluster &lt;cluster name&gt;...OK, assigned id=0 ... ... ... Rebuilding indexes of truncated clusters ... --- Cluster content was updated ... successfully rebuilt Done # indexes were rebuilt. Done. Imported # clusters. Importing database schema...OK (# classes)  Importing records... - Imported # records into clusters:... ... ... Started import of database 'plocal:/&lt;path to databases&gt;' from /tmp/... Non merge mode (-merge=false): removing all non security classes - Class &lt;class name&gt; was removed. - Class .... ... ... &lt;Here all the classes that were imported were removed!&gt; Removed # classes Rebuild of stale indexes... ... Deleting RID Mapping table...OK  Database import completed in # ms  ``` </body>
		<created>2016-09-29 22:26:51</created>
		<closed>2016-10-26 10:33:01</closed>
	</bug>
	<bug>
		<id>6758</id>
		<title>Errors when using IMPORT DATABASE with the remote protocol</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .8[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Expected: `IMPORT DATABASE` successfully imports any file that was previously exported, without regard for what the hardware configuration of the underlying system currently is, or was at the time of the export.  Actual: `IMPORT DATABASE` on a system A using a file exported from system B causes problems if system A has fewer cores than system B. The problems include: - the console performing `IMPORT DATABASE` hangs - any subsequent connections to the database being imported also hang (e.g. accessing via Studio) ## Steps to reproduce the problem  On a system with 8 cores (so 8 clusters per class), create about 500 classes, then export the database to a file. Then, on a system with only 1 core and 3GB of RAM (I used a VM, and configured OrientDB with `-Xms512m -Xmx1536m`), pull up the console and run:  ``` CREATE DATABASE remote:localhost:2424/test_import &lt;user&gt; &lt;pass&gt; memory graph IMPORT DATABASE /your_export.json.gz ```  Observe a lot of classes being created like:  ``` Creating cluster '&lt;foo&gt;_7'...OK, assigned id=1752 ```  and then at one point, observe that the lines of output stop and never resume again. Then try to connect to the database (e.g. via Studio) and attempt to run a simple query, and observe that the "in-progress" spinner keeps spinning and spinning, and the query never returns. </body>
		<created>2016-09-29 21:05:29</created>
		<closed>2016-10-26 10:35:54</closed>
	</bug>
	<bug>
		<id>6757</id>
		<title>Pyorient Create_Record Passes Null Values to OrientDB When Unicode Object is Used Instead of String</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.1 ## Operating System - [X ] Linux - Debian 8 x64 ## Expected behavior and actual behavior  Just for starters, I'm new to OrientDB and am not a python expert, so if this is an easy fix, my apologies and thanks in advance.   I have an OrientDB with a class called Nodes. The Node class has the following variables: 1. Abs_Address (String) [Also the index... no duplicates allowed] 2. Content (String) 3. Heading (String) 4. Type (String) 5. Value (String) 6. Parent (Link --&gt;Nodes)    Children (Linkset --&gt;Nodes)  I have a pyorient method to create a new node that has created literally thousands of them with no problems... so long as Abs_Address is not a unicode object. However, I've run into a weird problem that I only noticed when the Abs_Address was a unicode object. When my Abs_Address str object contained the unicode character u"\u2013", python treated it as type (unicode). When that happens, I started noticing I was getting a duplicate entry error from OrientDB. This was odd to me, so I traced it and found that pyorient's create record method was working in my code... unless the record I created included a unicode object... whenever that happened... the record that OrientDB reported getting was full of null data. This explained the duplicate record error. Every record that had a unicode character (I assume I can't check tens of thousands of possible records) was either passed by pyorient or interpreted by OrientDB as being null. This clearly happened more than once and that is why the duplicate record error was being thrown.   Here's the code I used to add records  ```   def add_Node(self, Ono = None):      if Ono!=None:          new_Node = {'@Nodes':                 {                     "Abs_Address":Ono.absolute_address,                     'Content':Ono.content,                     'Heading':Ono.heading,                     'Type':Ono.type,                     'Value':Ono.value                 }        }          try:             print 'trying to add'             rec_position = self.pyo_client.record_create(14, new_Node)               return rec_position          except Exception as inst:             print 'Exception:'             print inst             print 'Absolute address arg is'             print Ono.absolute_address             print self.get_Node_By_Address(Ono.absolute_address)             print 'Return rid of new object'             return self.get_Node_By_Address(Ono.absolute_address)[0] #this is what to use where we suspect the Abs_Address already exists... originally this only caught duplicate entry errors but I expanded it to figure out what's wrong with the code.       else:         return 'NONE'  #where record already exists... get it by its absolute address def get_Node_By_Address(self,Abs_Address=''):     return self.pyo_client.query("SELECT * FROM Nodes WHERE Abs_Address='"+str(Abs_Address.replace(u"\u2013","-"))+"'") ```  For more info and some of the error message output, see this stackexchange post: http://stackoverflow.com/questions/39761684/general-python-unicode-ascii-casting-issue-causing-trouble-in-pyorient ## Steps to reproduce the problem  As I said, the code above threw an error that there was a duplicate key anytime Abs_Address was type unicode. I found a way to get around this, but it's not a workable fix for me. Basically, I scanned for the specific unicode character causing trouble (an ndash u"u\2013") and replaced with a minus sign. This works, but there are several problems with this. First of all, I can't be sure this is the only unicode address I'll get, so there may still be errors. Worse, I know other variables will likely have unicode string data as there will be unusual symbols and such. Looking at the errors I was getting, it's clear that, whenever OrientDB got something that was a unicode object, it saw it as a null object. My short-term fix is to check for ndash, replace with minus, and then cast to type str(). This won't work long-term:  ``` new_Node = {"@Nodes":                         {                             "Abs_Address":str(Ono.absolute_address.replace(u"\u2013","-")), # replace utf-8 symbol (ndash) to ascii (-)... WHY CAN'T I USE UTF-8                             "Content":Ono.content.replace(u"\u2013","-"),                             "Heading":Ono.heading.replace(u"\u2013","-"),                             "Type":Ono.type.replace(u"\u2013","-"),                             "Value":Ono.value.replace(u"\u2013","-")                         }         } ``` </body>
		<created>2016-09-29 18:41:09</created>
		<closed>2016-12-27 18:10:43</closed>
	</bug>
	<bug>
		<id>6755</id>
		<title>Default heap/cache size on large data</title>
		<body>As #6666 reveals, there is probably some problem on large data (~300GB) with default heap/cache size settings. Seem like there are some exceptions that somehow got silenced. We should try to recreate the problem on one of our test servers. </body>
		<created>2016-09-29 07:00:58</created>
		<closed>2016-10-13 10:12:25</closed>
	</bug>
	<bug>
		<id>6748</id>
		<title>LIMIT SKIP &amp; ORDER BY - Paging Issue</title>
		<body>## OrientDB Version, operating system, or hardware. - 2.2.6   ## Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  `select mid, path, sz, created FROM (select * from Media ORDER BY created DESC LIMIT 20 SKIP 1)` should skip the first record but it returns all the results.  This query `select * from Media ORDER BY created DESC LIMIT 20 SKIP 1` skips the first record and returns remaining records, which I intend to do.  when I combine it like this `select mid, path, created FROM (select * from Media ORDER BY created DESC LIMIT 20 SKIP 1)` it **doesnt** skip the records. I would expect it to get details for only filtered records but returns details for all  The issue is caused by 'ORDER BY' &amp; 'LIMIT-SKIP' interaction. </body>
		<created>2016-09-27 08:47:31</created>
		<closed>2016-09-27 11:46:11</closed>
	</bug>
	<bug>
		<id>6745</id>
		<title>NULL value was NOT indexed as documented</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.10 ## Operating System - [x] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I created a class node item with 2 properties id and flag  &gt; **id:** type STRING, index: UNIQUE &gt; **flag:** type DECIMAL, it can be set by 1, 0, or null value. Index: NOTUNIQUE  I see that NULL value in **flag** was not indexed.  &gt; select count(*) from item &gt; It returns 38589  Count number of item was indexed by **flag**  &gt; select count(*) from index:item.flag &gt; It returns 34217  And the number of null values in flag is:  &gt; select count(*) from item where flag is null &gt; It returns 4372  I attached my test database at [here](https://drive.google.com/open?id=0B-9uJbevAJq9UjZRMWRKMkYwWE0) </body>
		<created>2016-09-27 04:00:40</created>
		<closed>2016-09-30 09:08:06</closed>
	</bug>
	<bug>
		<id>6742</id>
		<title>Bug when querying with DECIMAL value in WHERE clause</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.7 - v2.2.10  I tested on this 2 versions only. ## Operating System - [x] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I created a class node item with 2 properties id and flag  &gt; **id:** type STRING, index: UNIQUE &gt; **flag:** type DECIMAL, it can be set by 1, 0, or null value.   I use the query below to get all item which has flag is 1  &gt; select from item where **flag = 1**  This query returns nothing. And seem that this issue only occurs if **flag** was defined in schema before feeding data.  **NOTE**: But with the below query, it works like a charm  &gt; select from item where **1 = flag**  I attached my test database used for reproduce this issue at [here](https://drive.google.com/file/d/0B-9uJbevAJq9UjZRMWRKMkYwWE0/view) </body>
		<created>2016-09-26 12:50:32</created>
		<closed>2016-09-26 13:38:24</closed>
	</bug>
	<bug>
		<id>6737</id>
		<title>Incorrect count when using indexes on classes and sub classes</title>
		<body>## OrientDB Version, operating system, or hardware.  2.2.10  Related to #5846 ## Operating System - [ ] Linux - [ ] MacOSX - [x ] Windows - [ ] Other Unix - [ ] Other, name?   In the following scenario  class of Car subclass of Ford and Toyota  Car has boolean property isTaxed build a non unique hash index for Car.isTaxed, Ford.isTaxed and Toyota.isTaxed  I would then expect select count(*) from Car where isTaxed=true  to have a different value to   select count(*) from Ford where isTaxed=true  and   select count(*) from Toyota where isTaxed=true  however all variations return the count from Car.  Using explain does show that all variations only use the Car.isTaxed index rather than the other more specific indexes so i presume this is why the count is wrong. </body>
		<created>2016-09-23 13:11:38</created>
		<closed>2016-09-26 15:42:21</closed>
	</bug>
	<bug>
		<id>6735</id>
		<title>java.lang.ArrayIndexOutOfBoundsException (negative cluster) for subqueries</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2.10, Mac OS X ## Expected behavior and actual behavior  An ArrayIndexOutOfBoundsException is thrown when my java client tries to access "intermediary" vertices created by a subquery, e.g., `SELECT $a LET $a = (SELECT @rid AS parentId, out('AtoB') AS vertices FROM TypeA) FETCHPLAN $a:2`  The result in studio looks good, but the java client crashes while iterating on the property $a.  ``` $a ----- [{"@type":"d","@rid":"#-2:0","@version":0,"parentId":{"@type":"d","@rid":"#171:6","@version":3,"@class":"TypeA","out_AtoB":["#189:12","#190:12"],"@fieldTypes":"out_AtoB=g"},"vertices":[{"@type":"d","@rid":"#181:12","@version":2,"@class":"TypeB","in_AtoB":["#189:12"],"@fieldTypes":"in_AtoB=g"},{"@type":"d","@rid":"#182:12","@version":2,"@class":"TypeB","in_AtoB":["#190:12"],"@fieldTypes":"in_AtoB=g"}],"@fieldTypes":"vertices=z"}]  ```  The java code:  ``` java OrientGraph graph = ...;  OrientVertex root = graph.addVertex("class:TypeA"); graph.commit();  for (int i = 0; i &lt; 2; i++) {     OrientVertex v = graph.addVertex("class:TypeB");     root.addEdge("AtoB", v); } graph.commit();  String query = "SELECT $a LET $a = (SELECT @rid AS parentId, out('AtoB') AS vertices FROM TypeA) FETCHPLAN $a:2";  Iterable&lt;OrientVertex&gt; results = graph.command(new OCommandSQL(query)).execute(); OrientVertex result = results.iterator().next();  Iterable&lt;OrientVertex&gt; vertices = result.getProperty("$a"); // com.tinkerpop.blueprints.impls.orient.OrientElementIterable for (OrientVertex vertex : vertices) { // ArrayIndexOutOfBoundsException when next is called } ```  ``` Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: -2         at com.orientechnologies.orient.client.remote.OStorageRemote.getPhysicalClusterNameById(OStorageRemote.java:1479)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1890)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:112)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1592)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:101)         at com.orientechnologies.orient.core.id.ORecordId.getRecord(ORecordId.java:322)         at com.tinkerpop.blueprints.impls.orient.OrientElementIterator.next(OrientElementIterator.java:62)         at com.tinkerpop.blueprints.impls.orient.OrientElementIterator.next(OrientElementIterator.java:35)         at Test5.main(Test5.java:42) ```  Additional informations: - The problem occurs with and without a FETCHPLAN clause. - The query is a demo for the problem. n my actual queries, I have several variables in the result set. Consequently, as far as i know, I can't use expand.  Intuitively, I think that the problem is related to the "virtual" vertices (-2:0 and -2:1) but I don't know why the java client tries to reload these vertices. Maybe am I using something in the wrong way?  PS: I'm not sure that the current title is clear enough for the problem. </body>
		<created>2016-09-22 11:39:42</created>
		<closed>2016-09-27 11:52:59</closed>
	</bug>
	<bug>
		<id>6733</id>
		<title>Error during releasing of frozen database with Lucene indexes</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .9[X] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behaviour  Error:  ``` 2016-09-21 15:00:19,337 [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:53326)] INFO  c.o.o.s.n.p.b.ONetworkProtocolBinary [27.0.0.1:53326)] - $ANSI{ green {db=wdb}} Realising database 'plocal:/var/erpdb/wdb' 2016-09-21 15:00:19,338 [OrientDB (/127.0.0.1:2424) &lt;- BinaryClient (/127.0.0.1:53326)] ERROR c.o.l.e.OLuceneFullTextIndexEngine [27.0.0.1:53326)] - $ANSI{gr een {db=wdb}} Error on releasing Lucene index org.apache.lucene.store.LockObtainFailedException: Lock held by this virtual machine: /var/erpdb/wdb/luceneIndexes/ft_13_8/write.lock         at org.apache.lucene.store.NativeFSLockFactory.obtainFSLock(NativeFSLockFactory.java:127)         at org.apache.lucene.store.FSLockFactory.obtainLock(FSLockFactory.java:41)         at org.apache.lucene.store.BaseDirectory.obtainLock(BaseDirectory.java:45)         at org.apache.lucene.index.IndexWriter.&lt;init&gt;(IndexWriter.java:775)         at com.orientechnologies.lucene.engine.OLuceneIndexWriterFactory.createIndexWriter(OLuceneIndexWriterFactory.java:22)         at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.createIndexWriter(OLuceneFullTextIndexEngine.java:73)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.reOpen(OLuceneIndexEngineAbstract.java:210)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.release(OLuceneIndexEngineAbstract.java:506)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineDelegate.release(OLuceneIndexEngineDelegate.java:278)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.release(OAbstractPaginatedStorage.java:2629)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.release(ODatabaseDocumentTx.java:2375)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.releaseDatabase(ONetworkProtocolBinary.java:2125)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:601)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:318)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:194)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  Database stays frozen after this. ## Steps to reproduce the problem  It is not stable but very critical: 1. Freeze a database with Lucene indexes 2. Release it </body>
		<created>2016-09-21 22:29:00</created>
		<closed>2016-09-23 09:41:15</closed>
	</bug>
	<bug>
		<id>6731</id>
		<title>Live query stops working after timeout</title>
		<body>## OrientDB Version, operating system, or hardware. -  [x] v2.2.10 ## Operating System - [X] Linux ## Expected behavior and actual behavior ### Expected behavior  All inserts are captured by the onLiveResult() callback. ### Actual behavior  Only the 1st insert is captured, already the 2nd one will end up in onError() callback, and prints `LIVE QUERY ERROR`. The database tries to recover itself later ( `com.orientechnologies.orient.client.remote.OStorageRemote    I Caught Network I/O errors on localhost:2424/testDb, trying an automatic reconnection... (error: Connection reset) ` ), but the onLiveResult() is not called for the particular entity, and the update is lost. ## Steps to reproduce the problem  Launch the com.Main class from the attached example. The code creates db, starts live updater and will insert rows to the table being monitored. Between inserts the code waits 63 minutes.  [liveQueryTimeout.zip](https://github.com/orientechnologies/orientdb/files/485388/liveQueryTimeout.zip) </body>
		<created>2016-09-21 15:35:45</created>
		<closed>2016-09-30 16:55:13</closed>
	</bug>
	<bug>
		<id>6729</id>
		<title>Updating child record via parent. Works on 2.1, fails on ^2.2.0</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ]  Issue replicated on  2.2.10 2.2.4 2.2.1 ## Operating System - [ x] Linux - [ ] MacOSX - [ x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  1) update a parent record and child record from a single command  2) update child record via an update of the parent class ## Steps to reproduce the problem  `sample data`  ``` create class Users create property Users.username create property Users.password  create class Devices create property Devices.name  insert into Users (username, password) values('johndoe','randompassword')    update users add Devices = [{             "@type": "d",             "@class": "Devices",             "name": "Note 7"         }] ```  `Syntax to reproduce` - Works in version 2.1.* - Fails in version ^2.2.*  ```   update users set username = 'johndoethesenior', Devices = [{             "@type": "d",             "@rid":   #14:0,             "@version":1,             "@class": "Devices",             "name": "Note 8"         }] where username = 'johndoe' ``` ## Expected behavior - record #14:0 should be updated to "Note 8" on the `name` property </body>
		<created>2016-09-21 12:02:09</created>
		<closed>2016-09-28 13:50:29</closed>
	</bug>
	<bug>
		<id>6728</id>
		<title>Expand on Traverse queries through OrientJS</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8   ## Operating System - Linux ## Expected behavior and actual behavior  Query  --&gt; Traverse in('Investment') from #24:0  When fired on console or Studio, returns all expected records completely. When fired through query() function of OrientJS, only first record is returned completely, but only the record ids of all the other records is returned.  I also tried --&gt; Select expand(result) from (traverse in('Investment') as result from #24:0) as suggested [here](https://groups.google.com/forum/#!topic/orient-database/iyb0792nOvU) But that doesn't work. ## Steps to reproduce the problem  Fire the sample query through query() function of OrientJS. </body>
		<created>2016-09-21 10:33:04</created>
		<closed>2016-09-22 16:06:03</closed>
	</bug>
	<bug>
		<id>6727</id>
		<title>Fetching from index returns wrong result</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2 SNAPSHOT ## Operating System - [x] Linux - [x] MacOSX ## Expected behavior and actual behavior  I tried to fetch some data from my database and faced with problem. orientdb {db=mydb}&gt; select count(*) from Movie where releaseDate is null  +----+-----+ |#   |count| +----+-----+ |0   |128  | +----+-----+  1 item(s) found. Query executed in 1.104 sec(s). orientdb {db=mydb}&gt; select count(*) from Movie where releaseDate is null order by releaseDate  +----+-----+ |#   |count| +----+-----+ |0   |0    | +----+-----+  It seems "order by" changed result rows for this request. According to "explain" command I found out that second request uses index, so I tried to rebuild this index, but it didn't help me. orientdb {db=mydb}&gt; REBUILD INDEX Movie_releaseDate  Rebuilding index(es)... Rebuilt index(es). Found 16332 link(s) in 2.265000 sec(s).  Index(es) rebuilt successfully orientdb {db=mydb}&gt; select count(*) from Movie where releaseDate is null order by releaseDate  +----+-----+ |#   |count| +----+-----+ |0   |0    | +----+-----+  Then I tried to recreate index and this helped me.  orientdb {db=mydb}&gt; DROP INDEX Movie_releaseDate  Removing index... Dropped index in 0.017000 sec(s).  Index removed successfully orientdb {db=mydb}&gt; CREATE INDEX Movie_releaseDate On Movie (releaseDate) NOTUNIQUE  Creating index... Created index successfully with 16332 entries in 1.868000 sec(s).  Index created successfully  orientdb {db=mydb}&gt; select count(*) from Movie where releaseDate is null order by releaseDate  +----+-----+ |#   |count| +----+-----+ |0   |128  | +----+-----+  First time this index was created through the createIndex method of OClass from java application. movie.createIndex("Movie_releaseDate", OClass.INDEX_TYPE.NOTUNIQUE, "releaseDate");  Expected behaviour - fetching from index should return correct result </body>
		<created>2016-09-21 09:17:50</created>
		<closed>2016-09-21 11:48:10</closed>
	</bug>
	<bug>
		<id>6721</id>
		<title>'HA REMOVE SERVER' doesn't work</title>
		<body>We are running two OrientDB servers.  we are trying 'HA REMOVE SERVER' command but the OrientDB doesn't became OFFLINE.  'HA REMOVE SERVER' doesn't work, as far as I see orientdb.err.  _Before running 'HA REMOVE SERVER'_  HA STATUS -servers -output=text  ``` java +----------+------+------------------------------------+-----+-------------------+------------------+------------------+--------------------------+ |Name      |Status|Databases                           |Conns|StartedOn          |Binary            |HTTP              |UsedMemory                | +----------+------+------------------------------------+-----+-------------------+------------------+------------------+--------------------------+ |orientdb1*|ONLINE|contents=ONLINE (MASTER)            |3    |2016-09-09 18:25:58|172.31.19.247:2424|172.31.19.247:2480|146.96MB/511.00MB (28.76%)| |          |      |Test=ONLINE (MASTER)                |     |                   |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                   |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                   |                  |                  |                          | |orientdb2 |ONLINE|contents=ONLINE (MASTER)            |2    |2016-09-09 18:25:56|172.31.26.7:2424  |172.31.26.7:2480  |397.80MB/505.50MB (78.69%)| |          |      |Test=ONLINE (MASTER)                |     |                   |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                   |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                   |                  |                  |                          | +----------+------+------------------------------------+-----+-------------------+------------------+------------------+--------------------------+ ```  _After running 'HA REMOVE SERVER orientdb2'_  The following information is the result of the comand in the orientdb.err log.  ``` java:orientdb.err 2016-09-20 20:45:30:338 INFO  [orientdb1] Removing server 'orientdb2' from database configuration 'words'... [OHazelcastPlugin] 2016-09-20 20:45:30:338 INFO  [orientdb1] New distributed configuration for database: words (version=18)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+----+-----------+----------+---------+ |        |    |           |          | MASTER  | |        |    |           |          | ONLINE  | +--------+----+-----------+----------+---------+ |CLUSTER |  id|writeQuorum|readQuorum|orientdb1| +--------+----+-----------+----------+---------+ |*       |    |     1     |    1     |    X    | |internal|   0|     1     |    1     |         | +--------+----+-----------+----------+---------+   [OHazelcastPlugin] 2016-09-20 20:45:30:338 INFO  [orientdb1] Saving distributed configuration file for database 'words' to: /opt/orientdb-enterprise-2.2.7/databases/words/distributed-config.json [OHazelcastPlugin] 2016-09-20 20:45:30:445 INFO  [orientdb1] Distributed servers status:  +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |Name      |Status|Databases                           |Conns|StartedOn              |Binary            |HTTP              |UsedMemory                | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |orientdb1*|ONLINE|contents=ONLINE (MASTER)            |3    |2016-09-09 18:25:58.367|172.31.19.247:2424|172.31.19.247:2480|96.02MB/510.50MB (18.81%) | |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                       |                  |                  |                          | |orientdb2 |ONLINE|contents=ONLINE (MASTER)            |2    |2016-09-09 18:25:56.051|172.31.26.7:2424  |172.31.26.7:2480  |420.87MB/506.00MB (83.18%)| |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=OFFLINE (MASTER)              |     |                       |                  |                  |                          | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+  [OHazelcastPlugin] 2016-09-20 20:45:33:756 INFO  [orientdb1]&lt;-[orientdb2] Received new status orientdb2.words=SYNCHRONIZING [OHazelcastPlugin] 2016-09-20 20:45:33:757 INFO  [orientdb1] Distributed servers status:  +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |Name      |Status|Databases                           |Conns|StartedOn              |Binary            |HTTP              |UsedMemory                | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |orientdb1*|ONLINE|contents=ONLINE (MASTER)            |3    |2016-09-09 18:25:58.367|172.31.19.247:2424|172.31.19.247:2480|96.02MB/510.50MB (18.81%) | |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                       |                  |                  |                          | |orientdb2 |ONLINE|contents=ONLINE (MASTER)            |2    |2016-09-09 18:25:56.051|172.31.26.7:2424  |172.31.26.7:2480  |287.46MB/506.00MB (56.81%)| |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=SYNCHRONIZING (MASTER)        |     |                       |                  |                  |                          | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+  [OHazelcastPlugin] 2016-09-20 20:45:33:758 INFO  [orientdb1]&lt;-[orientdb2] Updated configuration db=words [OHazelcastPlugin] 2016-09-20 20:45:33:759 INFO  [orientdb1] New distributed configuration for database: words (version=19)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+---------+-------------+ |        |           |          | MASTER  |   MASTER    | |        |           |          | ONLINE  |SYNCHRONIZING| +--------+-----------+----------+---------+-------------+ |CLUSTER |writeQuorum|readQuorum|orientdb1|  orientdb2  | +--------+-----------+----------+---------+-------------+ |*       |     1     |    1     |    X    |      o      | |internal|     1     |    1     |         |             | +--------+-----------+----------+---------+-------------+   [OHazelcastPlugin] 2016-09-20 20:45:33:759 INFO  [orientdb1] Saving distributed configuration file for database 'words' to: /opt/orientdb-enterprise-2.2.7/databases/words/distributed-config.json [OHazelcastPlugin] 2016-09-20 20:45:33:780 INFO  [orientdb1] Current node started as MASTER for database 'words' [OHazelcastPlugin] 2016-09-20 20:45:33:800 INFO  [orientdb1] Received updated status orientdb2.words=SYNCHRONIZING [OHazelcastPlugin] 2016-09-20 20:45:33:816 INFO  [orientdb1]-&gt;[orientdb2] Deploying database words... [OSyncDatabaseTask] 2016-09-20 20:45:33:816 INFO  [orientdb1]-&gt;[orientdb2] Reusing last backup of database 'words' in directory: /tmp/orientdb/backup_words.zip... [OSyncDatabaseTask] 2016-09-20 20:45:33:819 INFO  [orientdb1]-&gt;[orientdb2] - transferring chunk #1 offset=0 size=5340364... [OSyncDatabaseTask] 2016-09-20 20:45:33:821 INFO  [orientdb1] Received updated status orientdb1.words=SYNCHRONIZING [OHazelcastPlugin] 2016-09-20 20:45:33:822 INFO  [orientdb1] Distributed servers status:  +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |Name      |Status|Databases                           |Conns|StartedOn              |Binary            |HTTP              |UsedMemory                | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |orientdb1*|ONLINE|contents=ONLINE (MASTER)            |3    |2016-09-09 18:25:58.367|172.31.19.247:2424|172.31.19.247:2480|96.02MB/510.50MB (18.81%) | |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=SYNCHRONIZING (MASTER)        |     |                       |                  |                  |                          | |orientdb2 |ONLINE|contents=ONLINE (MASTER)            |2    |2016-09-09 18:25:56.051|172.31.26.7:2424  |172.31.26.7:2480  |287.46MB/506.00MB (56.81%)| |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=SYNCHRONIZING (MASTER)        |     |                       |                  |                  |                          | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+  [OHazelcastPlugin] 2016-09-20 20:45:33:837 INFO  [orientdb1] Received updated status orientdb1.words=ONLINE [OHazelcastPlugin] 2016-09-20 20:45:33:839 INFO  [orientdb1]-&gt;[orientdb2] Deploy database task completed [OSyncDatabaseTask] 2016-09-20 20:45:33:840 INFO  [orientdb1] Distributed servers status:  +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |Name      |Status|Databases                           |Conns|StartedOn              |Binary            |HTTP              |UsedMemory                | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |orientdb1*|ONLINE|contents=ONLINE (MASTER)            |3    |2016-09-09 18:25:58.367|172.31.19.247:2424|172.31.19.247:2480|96.02MB/510.50MB (18.81%) | |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                       |                  |                  |                          | |orientdb2 |ONLINE|contents=ONLINE (MASTER)            |2    |2016-09-09 18:25:56.051|172.31.26.7:2424  |172.31.26.7:2480  |287.46MB/506.00MB (56.81%)| |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=SYNCHRONIZING (MASTER)        |     |                       |                  |                  |                          | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+  [OHazelcastPlugin] 2016-09-20 20:45:34:326 INFO  [orientdb1]&lt;-[orientdb2] Received updated status orientdb2.words=ONLINE [OHazelcastPlugin] 2016-09-20 20:45:34:326 INFO  [orientdb1] Distributed servers status:  +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |Name      |Status|Databases                           |Conns|StartedOn              |Binary            |HTTP              |UsedMemory                | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+ |orientdb1*|ONLINE|contents=ONLINE (MASTER)            |3    |2016-09-09 18:25:58.367|172.31.19.247:2424|172.31.19.247:2480|96.02MB/510.50MB (18.81%) | |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                       |                  |                  |                          | |orientdb2 |ONLINE|contents=ONLINE (MASTER)            |2    |2016-09-09 18:25:56.051|172.31.26.7:2424  |172.31.26.7:2480  |287.46MB/506.00MB (56.81%)| |          |      |Test=ONLINE (MASTER)                |     |                       |                  |                  |                          | |          |      |GratefulDeadConcerts=ONLINE (MASTER)|     |                       |                  |                  |                          | |          |      |words=ONLINE (MASTER)               |     |                       |                  |                  |                          | +----------+------+------------------------------------+-----+-----------------------+------------------+------------------+--------------------------+  [OHazelcastPlugin] 2016-09-20 20:45:34:328 INFO  [orientdb1]&lt;-[orientdb2] Updated configuration db=words [OHazelcastPlugin] 2016-09-20 20:45:34:329 INFO  [orientdb1] New distributed configuration for database: words (version=33)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-----------+-----------+----------+---------+---------+ |           |           |          | MASTER  | MASTER  | |           |           |          | ONLINE  | ONLINE  | +-----------+-----------+----------+---------+---------+ |CLUSTER    |writeQuorum|readQuorum|orientdb1|orientdb2| +-----------+-----------+----------+---------+---------+ |*          |     1     |    1     |    X    |    o    | |_studio    |     1     |    1     |    o    |    X    | |distance_0 |     1     |    1     |    o    |    X    | |e_0        |     1     |    1     |    o    |    X    | |internal   |     1     |    1     |         |         | |ofunction_0|     1     |    1     |    o    |    X    | |orids_0    |     1     |    1     |    o    |    X    | |orole_0    |     1     |    1     |    o    |    X    | |oschedule_0|     1     |    1     |    o    |    X    | |ouser_0    |     1     |    1     |    o    |    X    | |relation2_0|     1     |    1     |    o    |    X    | |relation3_0|     1     |    1     |    o    |    X    | |v_0        |     1     |    1     |    o    |    X    | |word2_0    |     1     |    1     |    o    |    X    | |word3_0    |     1     |    1     |    o    |    X    | |word_0     |     1     |    1     |    o    |    X    | +-----------+-----------+----------+---------+---------+   [OHazelcastPlugin] 2016-09-20 20:45:34:329 INFO  [orientdb1] Saving distributed configuration file for database 'words' to: /opt/orientdb-enterprise-2.2.7/databases/words/distributed-config.json [OHazelcastPlugin] 2016-09-20 20:45:34:329 INFO  [orientdb1] Current node started as MASTER for database 'words' [OHazelcastPlugin]  ```  Does 'HA REMOVE SERVER' works but immediately the server changed OFFLINE goes back ONLINE? </body>
		<created>2016-09-20 12:55:20</created>
		<closed>2016-09-22 06:00:32</closed>
	</bug>
	<bug>
		<id>6718</id>
		<title>WARNI Receiving invalid LiveQuery token: 1857716960 [OStorageRemoteAsynchEventListener]</title>
		<body>## OrientDB Version, operating system, or hardware. - [X] v2.2.10  ## Operating System - [X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior ### Expected behaviour  The application prints only lines like this: `Got live update ORecordOperation [record=#17:0{entry:0} v1, type=CREATE] ` ### Actual behaviour  For every live update also a similar line is logged as warning: `WARNI Receiving invalid LiveQuery token: 1857716960 [OStorageRemoteAsynchEventListener] ` ## Steps to reproduce the problem  Launch the com.Main class from the attached example. The code starts a server at localhost, connects as root, creates a new database, a new (so-called application) user and a test table. Then it connects with the application user, starts live select and inserts some data to the table. The bug is related to the fact that 2 connections were made to the database - one with root user, another with the application user. Only application user should receive live updates, as it ran the live select, but the root user also receives live updates. As it does not have live query listener set up, it will log a warning.  [orientTest.zip](https://github.com/orientechnologies/orientdb/files/482328/orientTest.zip) </body>
		<created>2016-09-20 11:17:36</created>
		<closed>2016-09-28 14:06:16</closed>
	</bug>
	<bug>
		<id>6712</id>
		<title>RETURN clause throws OCommandExecutorNotFoundException with SQL batch script</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2.10 MacOSX Java  ## Expected behavior and actual behavior  According to http://orientdb.com/docs/master/SQL-batch.html the RETURN clause can be used to return the result of a query. However, it fails with an OCommandExecutorNotFoundException ## Steps to reproduce the problem  Consider the following Java snippet:  ``` java OrientGraph graph = ...;  String script = "return 'hello'"; Object result = graph.command(new OCommandScript("sql", script)).execute(); System.out.println(result); // prints "hello" (fine)  script = "let a = select from V\n"         + "return $a"; result = graph.command(new OCommandScript("sql", script)).execute(); System.out.println(result); // prints com.tinkerpop.blueprints.impls.orient.OrientDynaElementIterable@55a147cc (fine)  script = "return (select from V)"; result = graph.command(new OCommandScript("sql", script)).execute(); System.out.println(result); // fails, with the following exception:   Exception in thread "main" com.orientechnologies.orient.core.command.OCommandExecutorNotFoundException: Cannot find a command executor for the command request: sql.(SELECT FROM V)     DB name="testDatabase"     DB name="testDatabase"     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)     at java.lang.reflect.Constructor.newInstance(Constructor.java:422)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:427)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:378)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:260)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:152)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2087)     at com.orientechnologies.orient.client.remote.OStorageRemote$27.execute(OStorageRemote.java:1137)     at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:192)     at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:224)     at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:189)     at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1113)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)     at com.tinkerpop.blueprints.impls.orient.OrientGraphCommand.execute(OrientGraphCommand.java:49)     at Test2.main(Test2.java:38) ```  Note that "return (select $a as something)" fails as well. </body>
		<created>2016-09-19 14:37:08</created>
		<closed>2016-09-22 13:30:31</closed>
	</bug>
	<bug>
		<id>6707</id>
		<title>server error log (it is a bug?)</title>
		<body>## OrientDB Version, operating system, or hardware.  2.2.8 ## Operating System - [x ] Linux ## Expected behavior and actual behavior  `2016-09-17 15:52:23:618 WARNI Token signature failure: AAAAAAhzdHJlYW1lcgAABQAAAAAAAAAAAAABVyz5wG8AACQAF09SZWNvcmRTZXJpYWxpemVyQmluYXJ5AA1PcmllbnREQiBKYXZhAAUyLjIuOFHqT7shN22bGQNacTkM4JbYQnyn2aA38Nlr7Bl+Xs5G [OTokenHandlerImpl]$ANSI{green {db=aa}} Cannot serialize an exception object java.io.NotSerializableException: jdk.nashorn.api.scripting.ScriptObjectMirror     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1184)     at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)     at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)     at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)     at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)     at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:441)     at java.lang.Throwable.writeObject(Throwable.java:985)     at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:498)     at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:1028)     at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1496)     at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)     at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)     at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:441)     at java.lang.Throwable.writeObject(Throwable.java:985)     at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:498)     at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:1028)     at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1496)     at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)     at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:348)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.serializeExceptionObject(ONetworkProtocolBinary.java:2189)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sendError(ONetworkProtocolBinary.java:1006)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sendErrorOrDropConnection(ONetworkProtocolBinary.java:2660)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:335)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:196)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ` </body>
		<created>2016-09-18 10:44:45</created>
		<closed>2017-08-06 08:49:35</closed>
	</bug>
	<bug>
		<id>6704</id>
		<title>Client hanging after unsuccessful vertex batch removal + NPE</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.9 ## Operating System - [ ] Linux ## Expected behavior and actual behavior  After NPE (should not occur anyway) orient db binary client should continue working ## Steps to reproduce the problem  Error occurs during removing vertices  `com.orientechnologies.orient.enterprise.channel.binary.OResponseProcessingException: Exception during response processing     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:444)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:379)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:261)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:153)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2133)     at com.orientechnologies.orient.client.remote.OSBTreeBonsaiRemote$2.execute(OSBTreeBonsaiRemote.java:188)     at com.orientechnologies.orient.client.remote.OSBTreeBonsaiRemote$2.execute(OSBTreeBonsaiRemote.java:172)     at com.orientechnologies.orient.client.remote.OStorageRemote$2.execute(OStorageRemote.java:198)     at com.orientechnologies.orient.client.remote.OStorageRemote.baseNetworkOperation(OStorageRemote.java:230)     at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:195)     at com.orientechnologies.orient.client.remote.OSBTreeBonsaiRemote.fetchEntriesMajor(OSBTreeBonsaiRemote.java:172)     at com.orientechnologies.orient.client.remote.OSBTreeBonsaiRemote.loadEntriesMajor(OSBTreeBonsaiRemote.java:149)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.prefetchData(OSBTreeRidBag.java:465)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.next(OSBTreeRidBag.java:447)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$SBTreeMapEntryIterator.next(OSBTreeRidBag.java:427)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.nextChangedNotRemovedSBTreeEntry(OSBTreeRidBag.java:1068)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag.access$200(OSBTreeRidBag.java:57)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$RIDBagIterator.next(OSBTreeRidBag.java:332)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeRidBag$RIDBagIterator.next(OSBTreeRidBag.java:256)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.removeEdges(OrientBaseGraph.java:2021)     at com.tinkerpop.blueprints.impls.orient.OrientGraph.removeEdgesInternal(OrientGraph.java:440)     at com.tinkerpop.blueprints.impls.orient.OrientVertex.remove(OrientVertex.java:521)     at java.lang.Iterable.forEach(Iterable.java:75)     at com.picklepick.backend.pickle.PickleService.deletePickle(PickleService.java:329)     at com.picklepick.backend.pickle.PickleEndpoint.deletePickle(PickleEndpoint.java:64)     at sun.reflect.GeneratedMethodAccessor212.invoke(Unknown Source)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:498)     at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)     at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)     at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)     at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)     at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:395)     at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:202)     at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)     at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)     at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)     at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)     at io.undertow.servlet.handlers.ServletHandler.handleRequest(ServletHandler.java:85)     at io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:62)     at io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:36)     at io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:131)     at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:57)     at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)     at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:46)     at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:64)     at io.undertow.security.handlers.AuthenticationMechanismsHandler.handleRequest(AuthenticationMechanismsHandler.java:60)     at io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:77)     at io.undertow.security.handlers.AbstractSecurityContextAssociationHandler.handleRequest(AbstractSecurityContextAssociationHandler.java:43)     at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)     at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)     at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:285)     at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:264)     at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:81)     at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:175)     at io.undertow.server.Connectors.executeRootHandler(Connectors.java:202)     at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:792)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.NullPointerException     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerAbstract$SBTreeBonsaiContainer.access$010(OSBTreeCollectionManagerAbstract.java:191)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerAbstract.releaseSBTree(OSBTreeCollectionManagerAbstract.java:132)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sbTreeBonsaiGetEntriesMajor(ONetworkProtocolBinary.java:2259)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:621)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:318)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:194)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ` </body>
		<created>2016-09-17 10:51:04</created>
		<closed>2016-09-30 11:32:57</closed>
	</bug>
	<bug>
		<id>6703</id>
		<title>NPE when creating a Lucine index</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .9[X] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [X] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behaviour  Null pointer exceptions when creating a Lucine index in the log:  ``` ERROR c.o.o.c.s.i.l.p.OLocalPaginatedStorage [lt-dispatcher-9] - $ANSI{green {db=wdb}} Error while flushing index via index engine of class OLuceneIndexEngineDelegate. java.lang.NullPointerException: null         at com.orientechnologies.lucene.engine.OLuceneIndexEngineDelegate.flush(OLuceneIndexEngineDelegate.java:69)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:2428)         at com.orientechnologies.orient.core.index.OIndexManagerShared.createIndex(OIndexManagerShared.java:197)         at com.orientechnologies.orient.core.index.OIndexManagerProxy.createIndex(OIndexManagerProxy.java:87)         at com.erp.db.WorkspaceSearch.check(WorkspaceSearch.scala:84) ```  Nevertheless, the index is working fine after this.  Probably there should be simply a null check in OLuceneIndexEngineDelegate.flush, because it's there in few other methods. ## Steps to reproduce the problem  ``` val itp = OClass.INDEX_TYPE.FULLTEXT.toString val factory: OIndexFactory = OIndexes.getFactory(itp, null) db.getMetadata.getIndexManager.createIndex(name, itp,         new OSimpleKeyIndexDefinition(factory.getLastVersion, OType.STRING), null, null, null,         OLuceneIndexFactory.LUCENE_ALGORITHM) ``` </body>
		<created>2016-09-16 22:17:22</created>
		<closed>2016-12-13 08:28:49</closed>
	</bug>
	<bug>
		<id>6702</id>
		<title>Transaction rollback is inconsistent if exception raised during commit</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.9 and earlier   ## Operating System - [\* ] Linux - [ *] MacOSX - [ *] Windows - [ *] Other Unix - [ *] Other, all ## Expected behavior and actual behavior  Assume Transaction that include changes in the separate blob cluster with ORecordBytes records. and changes in another ODocument record that has a field es linkedlist to these blob records. In that transaction two existing blobs were deleted and new one has been inserted. linked list field has been updated to point to the new blob and then transaction commit is called. During commit an NullPointer exception has been raised due to (whatever reason, it doesn't matter actually). Expected behavior would be that new blob record is not inserted, two old blob records are not deleted and ODocument record still points to the old two records.  Actual behavior: Old 2 Blob records are deleted. New blob record is (half inserted). You can see it if you ask "clusters" in the console but you don't see it if you run statement "select from cluster:blob_cluster". ODocument record still points to a non-existsing Blob records if you issue statement "select from #&lt;document.rid&gt;. In Java code attempt to get filed value returns a List with 2 null elements.  As a result we have a full loss of blob data instead of original values. ## Steps to reproduce the problem  I have compiled a very simple test program that easily reproduces that problem. 1. Extract attached zip into a empty directory. (it contains 2 Eclipse Maven projects (NPESimulatorAgent and OOMTest) 2. Import bothe projects into empty eclipse workspace. 3. Run Maven "package" on the NPESimulatorAgent project. This will generate Java agent.jar that can throw NullPointerException from the com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect() method. NPESimulatorAgent.jar should appear in the NPESimulatorAgent directory. 4. Now open class OutOufMemoryTest in the project OOMTest. This class has a main method and it can be launched using LaunchConfiguration OutOfMemoryTest.launch.  If you run this program it will create new Database, create one class "TestClass" with 2 fields: itemId and blob. Field blob is a linked list. Additionally it creates new cluster called "TestClass_blob" for storing blobs in it.  method writeDataAndCheck() will add one record with itemId = "1" and blob that refers to a chunk1 (512Kb) and Chunk2 (256Kb). Transaction is committed and reloaded to test that all data were saved correctly.  The fun starts in the simulateErrorAndCheck() method.  Here it will load that testclass record into ODocument and then start transaction that replaces chunk1 and chunk2 with new chunk3 (1MB).  In Line 264 you can control whether exception in the commit should be simulated or not. If exception is simulated it will printed to stderr and then database will be closed. and storage will be closed to release all in memory caches.  Then program tries to reopen database and read contents. You can see that if exception is happening during commit, contents of chunk1 and chunk 2 is lost. Chunk3 is actually stored in the cluster but it cannot be accessed anymore.  To me this is a showstopper bug. Blobs are lost without recovery. [OrientTest.zip](https://github.com/orientechnologies/orientdb/files/477430/OrientTest.zip) </body>
		<created>2016-09-16 18:05:15</created>
		<closed>2016-09-27 15:25:04</closed>
	</bug>
	<bug>
		<id>6700</id>
		<title>different behaviour between EMBEDDEDLIST with linkedtype and EMBEDDEDLIST with linked class</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.10  ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I expect that EMBEDDEDLIST with linkedclass will be save with null instead object like in EMBEDDEDLIST with linkedtype ## Steps to reproduce the problem  orientdb {db=test}&gt; **create class test extends V** Class created successfully. Total classes in database now: 11.  orientdb {db=test}&gt; **create property test.et embeddedlist string** Property created successfully with id=1.  orientdb {db=test}&gt; **create property test.ec embeddedlist V** Property created successfully with id=2.  orientdb {db=test}&gt; **select expand(properties)  from ( select expand(classes) from metadata:schema) where name = 'test'** +----+----+----+--------+---------+--------+-------+------------+----+----+----------+------------+-------+-----------+-----------+ |#   |name|type|globalId|mandatory|readonly|notNull|defaultValue|min |max |linkedType|customFields|collate|description|linkedClass| +----+----+----+--------+---------+--------+-------+------------+----+----+----------+------------+-------+-----------+-----------+ |0   |et  |10  |23      |false    |false   |false  |            |    |    |7         |            |default|           |           | |1   |ec  |10  |24      |false    |false   |false  |            |    |    |          |            |default|           |V          | +----+----+----+--------+---------+--------+-------+------------+----+----+----------+------------+-------+-----------+-----------+ 2 item(s) found. Query executed in 0.005 sec(s).  orientdb {db=test}&gt; **insert into test set et=[null,'string']** Inserted record 'test#17:0{et:[2]} v1' in 0,013000 sec(s).  orientdb {db=test}&gt; **insert into test set ec=[null,{"@class":"V","@type":"d"}]** Error: com.orientechnologies.orient.core.exception.OValidationException: The field 'test.ec' has been declared as EMBEDDEDLIST but an incompatible typ e is used. Value: null DB name="test" </body>
		<created>2016-09-16 11:47:51</created>
		<closed>2016-09-28 15:32:49</closed>
	</bug>
	<bug>
		<id>6694</id>
		<title>Order BY @RID DESC stops working in 2.2</title>
		<body>See the question on google groups https://groups.google.com/forum/#!topic/orient-database/v7hPzH-6-4I  Hi altogether  I am in the process of adapting ActiveOrient (https://github.com/topofocus/active-orient) to Version 2.2. And found that  DatabaseClass#Last returns the first instead of the last record.  The following query is transmitted by the test-suite:   select  from industry  order by @rid desc  The result is the same as   select  from industry   I verified this in studio. The documentation @ http://orientdb.com/docs/2.2/SQL-Query.html refers explicit to this feature:  Return records from the class Profile in descending order of their creation:  orientdb&gt; SELECT FROM Profile ORDER BY @rid DESC  Beginning in version 1.7.7, OrientDB can open an inverse cursor against clusters. This is very fast and doesn't require the classic ordering resources, CPU and RAM.  Is this a bug or missed I something? </body>
		<created>2016-09-14 10:03:20</created>
		<closed>2016-10-27 09:31:00</closed>
	</bug>
	<bug>
		<id>6688</id>
		<title>Incorrect calculation (returns negative number) of free disk space available on very large volume (AWS EFS) </title>
		<body>Hello, I am trying to use orientdb with Amazon EFS and are running into problems that seem related to the calculation of free disk space available. ## OrientDB Version, operating system, or hardware.  version 2.2.8  Amazon Elastic File System volume ## Operating System  Linux (Debian on EC2 instances) ## Expected behavior and actual behavior  On a "virtually infinite" storage space such as AWS EFS (running `df` shows space available the orders of 8 exabytes), I expect Orientdb to take into account that very large amount of remaining space correctly. However, it returns a negative number as "free disk space available". ## Steps to reproduce the problem  The EFS volume is mounted in orientdb containers (official 2.2.8 image) to directory `orientdb/databases`   If I mount the EFS volume on an instance and run `df -hT /home/ec2-user/mount_point/` I get the following:  `file system                                                                    Type  Size  Used  Avail. Used%  Mount` `XXXX.efs.YYY.amazonaws.com:/   nfs4   8,0E     0     8,0E   0%       /home/ec2-user/mount_point`  When I run one server container, and run the console in another one to try to create a database, here's my console output:  `orientdb {server=remote:orientdb/}&gt; create database remote:orientdb/test root root local` `Creating database [remote:orientdb/test] using the storage type [plocal]...` `Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot create the remote storage: test`  `Error: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot create database 'test'` `DB name="test"` `DB name="test"`  `Error: com.orientechnologies.orient.core.exception.OLowDiskSpaceException: Error occurred while executing a write operation to database 'test' due to limited free space on the disk (-8796093022208 MB). The database is now working in read-only mode. Please close the database (or stop OrientDB), make room on your hard drive and then reopen the database. The minimal required space is 256 MB. Required space is now set to 256MB (you can change it by setting parameter storage.diskCache.diskFreeSpaceLimit) .` `DB name="test"`  So there is that obvious negative free space left on the disk number. As EFS volumes are supposed to be virtually infinite, I suspect the 8,0E size given by the `df` command correspond to some kind of largest possible integer value. Therefore my initial supposition would be that orientdb misinterprets this number as signed, but I have not investigated this much deeper.  Any hints about this? </body>
		<created>2016-09-13 12:12:33</created>
		<closed>2016-09-16 13:19:19</closed>
	</bug>
	<bug>
		<id>6686</id>
		<title>NullPointerExceptions during stress testing with ORecordCacheSoftRefs</title>
		<body>## OrientDB Version, operating system, or hardware.  2.2.8 ## Operating System  Linux (Ubuntu 16.04) ## Expected behavior and actual behavior  During a stress test with 8+ concurrent connections (2-core machine with hyperthreading) a to an embedded local database with 5M+ nodes while using ORecordCacheSoftRefs, Orient will sometimes fail to retrieve records due to NullPointerExceptions originated in the `evictStaleEntries` method of the underlying `OSoftRefsHashMap` cache.  In some heavily starved situations, `reverseLookup.remove(sv)` will return `null`:  ``` java   private void evictStaleEntries() {     int evicted = 0;      Reference&lt;? extends V&gt; sv;     while ((sv = refQueue.poll()) != null) {       hashCodes.remove(reverseLookup.remove(sv));       evicted++;     }      if (evicted &gt; 0)       OLogManager.instance().debug(this, "Evicted %d items", evicted);   } ``` ## Steps to reproduce the problem - Create N*2 ODatabaseDocumentTx instances pointing to the same plocal:// embedded database. - Run a long running query in all of them at once. - Some of the initial queries will work, but once Java starts to reclaim memory, some of the queries will start to fail.  I am not sure why the `reverseLookup.remove(sv)` call might be returning null: this happens even if I use a simple `ThreadLocal&lt;ODatabaseDocumentTx&gt;` instead of one of Orient's pools (ensuring each thread has its own instance). ## Proposed fix  Adding a simple null check to the method seems to work fine:  ``` java     private void evictStaleEntries() {         int evicted = 0;          Reference&lt;? extends V&gt; sv;         while ((sv = refQueue.poll()) != null) {             final K key = reverseLookup.remove(sv);             if (key != null) {                 hashCodes.remove(key);                 evicted++;             }         }          if (evicted &gt; 0)             OLogManager.instance().debug(this, "Evicted %d items", evicted);     } ``` </body>
		<created>2016-09-12 19:52:07</created>
		<closed>2016-09-14 12:35:29</closed>
	</bug>
	<bug>
		<id>6677</id>
		<title>Bug with incorrect behaviour with linkmap</title>
		<body>After insert new Record with incorrect link map - our class become "locked" on UI part and it seems that we laso cannot make select from orientjs driver. Example: We have property mapLinkTest wth type maplink WE are going to set map link via console ```      create vertex RecordContent set recordContentMap = #85:0, recordContentGUID = "5357c9c4-f468-4c2e-98f0-a7442c8d6157", recordContent = {"717618f7-8bbf-49c7-8119-f83c6a8b1b02":#123:123} ```      #123:123 - there is no any record with this @rid in out database.  WE got response the all ok:  Created vertex 'RecordContent#81:2{recordContentMap:#85:0,recordContentGUID:5357c9c4-f468-4c2e-98f0-a7442c8d6157,recordContent:[1]} v1' in 0.011000 sec(s).  But after select from RecordContent: select \* from RecordContent on UI part (also from nodejs app) - we got          "The command has not been executed"  ```  P.S. but console (console.sh) made response  ```  +----+-----+---------+---------+---------+---------------------------------------------------------------------------------------------------------------------------------+ |#   |@RID |@CLASS   |recordCon|recordCon|recordContent                                                                                                                    | +----+-----+---------+---------+---------+---------------------------------------------------------------------------------------------------------------------------------+ |1   |#81:2|Record...|#85:0    |5357c9...|{717618f7-8bbf-49c7-8119-f83c6a8b1b02:#123:123}                                                                                  | +----+-----+---------+---------+---------+---------------------------------------------------------------------------------------------------------------------------------+ </body>
		<created>2016-09-09 10:15:32</created>
		<closed>2016-11-21 16:39:42</closed>
	</bug>
	<bug>
		<id>6673</id>
		<title>java.lang.NegativeArraySizeException [ONetworkProtocolHttpDb] After Restarting OrientDB</title>
		<body>Following up on my message from last week.  After restarting our database, I received the following messages during restarting our database:  $ANSI{green {db=DATABASE}} Error on fetching record during browsing. The record has been skipped com.orientechnologies.orient.core.exception.ODatabaseException: Error on retrieving record #14:14809 (cluster: classA)  $ANSI{green {db=DATABASE}} Error on fetching record during browsing. The record has been skipped com.orientechnologies.orient.core.exception.ODatabaseException: Error on retrieving record #14:14810 (cluster: classA)  $ANSI{green {db=DATABASE}} Error on fetching record during browsing. The record has been skipped com.orientechnologies.orient.core.exception.ODatabaseException: Error on retrieving record #14:14811 (cluster: classA)  It appears some data is either lost or not indexed properly because I see the following exception when I try to query one of those records skipped:   2016-09-06 14:58:21:816 SEVER Internal server error: java.lang.NegativeArraySizeException [ONetworkProtocolHttpDb]  2016-09-06 15:29:28:051 SEVER Internal server error: java.lang.NegativeArraySizeException [ONetworkProtocolHttpDb]  2016-09-06 18:30:08:314 SEVER Internal server error: java.lang.NegativeArraySizeException [ONetworkProtocolHttpDb]  Also, when I try to query for a specific element based on the index value, I get the wrong vertex:   Here is example:   SQL Query:  select from VERTEXCLASS where attribute = "valueA"  I get a vertex with attribute equal to something completely different and with a different @RID from the original vertex.   result:  attribute= "valueZ"  </body>
		<created>2016-09-08 15:44:28</created>
		<closed>2016-09-28 07:01:35</closed>
	</bug>
	<bug>
		<id>6670</id>
		<title>error when I try create record with "CONTENT" style and property type:EMBEDDEDLIST linkedtype:DECIMAL</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Steps to reproduce the problem  orientdb {db=test}&gt; **create class test extends V** Class created successfully. Total classes in database now: 12.  orientdb {db=test}&gt; **create property test.ed embeddedlist decimal** Property created successfully with id=1.  orientdb {db=test}&gt; **insert into test set ed= [5,null,5]** Inserted record 'test#22:1{ed:[3]} v1' in 0,002000 sec(s).  orientdb {db=test}&gt; **insert into test CONTENT {"ed": [5,null,5]}** Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #23:-1         DB name="test"         DB name="test" Error: com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #23         DB name="test" Error: java.lang.ClassCastException  orientdb {db=test}&gt; **create property test.ef embeddedlist float** Property created successfully with id=3.  orientdb {db=test}&gt; **insert into test CONTENT {"ef": [5,null,5]}** Inserted record 'test#22:2{ef:[3]} v1' in 0,002000 sec(s). </body>
		<created>2016-09-08 09:26:32</created>
		<closed>2016-10-03 12:52:02</closed>
	</bug>
	<bug>
		<id>6668</id>
		<title>Spurious "Database is closed" errors</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[x] .15[x] .14[x] .13[x] .12[x] .11[x] .10[x] .9[x] .8[x] .7[x] .6[x] .5[x] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .8[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Quite frequently, OrientDB will refuse to execute a command on an otherwise-active connection to a database with an error saying `Database '&lt;storage_type&gt;:&lt;db_name&gt;' is closed` even though the network connection was not interrupted (e.g. the database is on the local machine) and the client code did not attempt to close the database. This unfortunate bug has existed at least as early as 2.1.5 (when I started using OrientDB) and still exists in 2.2.8 today.  The types of commands that cause this vary -- SQL queries, database imports/exports, and so on. Here is a stack trace captured from such an error from a database import operation that occurs as part of our test suite:  ``` com.orientechnologies.orient.core.exception.ODatabaseException: Database 'memory:test_db' is closed     DB name="test_db"     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.checkOpeness(ODatabaseDocumentTx.java:3041)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.getMetadata(ODatabaseDocumentTx.java:805)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.getMetadata(ODatabaseDocumentTx.java:103)     at com.orientechnologies.orient.core.db.tool.ODatabaseImport.removeDefaultNonSecurityClasses(ODatabaseImport.java:626)     at com.orientechnologies.orient.core.db.tool.ODatabaseImport.importDatabase(ODatabaseImport.java:396)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.importDatabase(ONetworkProtocolBinary.java:2916)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:635)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:320)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:196)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  Given the non-deterministic nature of the error, and the fact that multiple completely unrelated command types that cause it, I believe this may be some kind of race condition. ## Steps to reproduce the problem  This failure happens non-deterministically, and I have not been able to consistently reproduce it. However, it happens reasonably frequently when the database is under load, and should be reproducible with no more than an hour or two of random load testing using the newest `pyorient` version. </body>
		<created>2016-09-08 02:12:51</created>
		<closed>2017-03-01 15:32:52</closed>
	</bug>
	<bug>
		<id>6666</id>
		<title>adding 2nd node in cluster: dbase copy hang with "node not online yet"</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.7 ## Operating System - [x] Linux  I have my database "cdrarch" running on a first server node, which has been started in distributed mode, and is ONLINE: orientdb {db=cdrarch}&gt; list servers  ``` CONFIGURED SERVERS +----+-----------------+------+-----------+-----------------------+-----------------+-----------------+---------------+---------------+---------+ |#   |Name             |Status|Connections|StartedOn              |Binary           |HTTP             |UsedMemory     |FreeMemory     |MaxMemory| +----+-----------------+------+-----------+-----------------------+-----------------+-----------------+---------------+---------------+---------+ |0   |node1473107743544|ONLINE|1          |2016-09-07 10:27:24.808|10.49.69.190:2424|10.49.69.190:2480|5.51GB (38.74%)|1.71GB (12.05%)|14.22GB  | +----+-----------------+------+-----------+-----------------------+-----------------+-----------------+---------------+---------------+---------+ ```  I have copied the "hazelcast.xml" file to a second server, and started that server as well.  The logs on both nodes say that they get a socket connection: extract from the logs on the second node:  ``` 2016-09-07 12:18:51:293 WARNI Assigning distributed node name: node1473243531293 [OHazelcastPlugin]  2016-09-07 12:18:52:399 INFO  [10.49.69.189]:2434 [cdrcontrols] [3.6.3] Creating MulticastJoiner [Node] 2016-09-07 12:18:52:405 INFO  [10.49.69.189]:2434 [cdrcontrols] [3.6.3] Address[10.49.69.189]:2434 is STARTING [LifecycleService] ... 2016-09-07 12:18:52:668 INFO  [10.49.69.189]:2434 [cdrcontrols] [3.6.3] Connecting to /10.49.69.190:2434, timeout: 0, bind-any: true [InitConnectionTask] 2016-09-07 12:18:52:675 INFO  [10.49.69.189]:2434 [cdrcontrols] [3.6.3] Established socket connection between /10.49.69.189:42394 and /10.49.69.190:2434 [TcpIpConnectionManager] 2016-09-07 12:18:58:692 INFO  [10.49.69.189]:2434 [cdrcontrols] [3.6.3]  Members [2] {         Member [10.49.69.190]:2434         Member [10.49.69.189]:2434 this } ```  Then the database 'GratefulDeadConcerts' gets replicated:  ``` 2016-09-07 12:19:03:593 INFO  [node1473243531293] Current node started as MASTER for database 'GratefulDeadConcerts' [OHazelcastPlugin] 2016-09-07 12:19:03:596 INFO  [node1473243531293] New distributed configuration for database: GratefulDeadConcerts (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+-----------------+ |        |           |          |     MASTER      | |        |           |          |     ONLINE      | +--------+-----------+----------+-----------------+ |CLUSTER |writeQuorum|readQuorum|node1473107743544| +--------+-----------+----------+-----------------+ |*       |     1     |    1     |        X        | |internal|     1     |    1     |                 | +--------+-----------+----------+-----------------+   [OHazelcastPlugin] 2016-09-07 12:19:03:596 INFO  [node1473243531293] Saving distributed configuration file for database 'GratefulDeadConcerts' to: /opt/orientdb/databases/GratefulDeadConcerts/distribut ed-config.json [OHazelcastPlugin] 2016-09-07 12:19:03:600 INFO  [node1473243531293] Distributed servers status:  +------------------+--------+------------------------------------+-----+---------+-----------------+-----------------+-------------------------+ |Name              |Status  |Databases                           |Conns|StartedOn|Binary           |HTTP             |UsedMemory               | +------------------+--------+------------------------------------+-----+---------+-----------------+-----------------+-------------------------+ |node1473243531293*|STARTING|                                    |0    |12:18:50 |10.49.69.189:2424|10.49.69.189:2480|75.77MB/491.00MB (15.43%)| |node1473107743544 |ONLINE  |GratefulDeadConcerts=ONLINE (MASTER)|3    |10:27:24 |10.49.69.190:2424|10.49.69.190:2480|5.35GB/14.22GB (37.63%)  | |                  |        |bvdd-test=ONLINE (MASTER)           |     |         |                 |                 |                         | +------------------+--------+------------------------------------+-----+---------+-----------------+-----------------+-------------------------+ ... 2016-09-07 12:19:05:102 INFO  [node1473243531293] Publishing ONLINE status for database node1473243531293.GratefulDeadConcerts... [ODistributedDatabaseImpl] 2016-09-07 12:19:05:109 INFO  [node1473243531293] New distributed configuration for database: GratefulDeadConcerts (version=31)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+-----------------+-----------------+ |             |    |           |          |     MASTER      |     MASTER      | |             |    |           |          |     ONLINE      |     ONLINE      | +-------------+----+-----------+----------+-----------------+-----------------+ |CLUSTER      |  id|writeQuorum|readQuorum|node1473107743544|node1473243531293| +-------------+----+-----------+----------+-----------------+-----------------+ |*            |    |     2     |    1     |        X        |        o        | |_studio_1    |  50|     2     |    1     |        o        |        X        | |_studio_5    |  54|     2     |    1     |        o        |        X        | |_studio_6    |  55|     2     |    1     |        o        |        X        | |_studio_7    |  56|     2     |    1     |        o        |        X        | |e_4          |  21|     2     |    1     |        o        |        X        | |e_5          |  22|     2     |    1     |        o        |        X        | ... |written_by_7 |  40|     2     |    1     |        o        |        X        | +-------------+----+-----------+----------+-----------------+-----------------+   [OHazelcastPlugin] 2016-09-07 12:19:05:109 INFO  [node1473243531293] Saving distributed configuration file for database 'GratefulDeadConcerts' to: /opt/orientdb/databases/GratefulDeadConcerts/distribut ed-config.json [OHazelcastPlugin] ```  So far so good, it seems.  Then it starts with my big (300GB) database "cdrarch", but here we get problems:  ``` 2016-09-07 12:19:05:119 INFO  [node1473243531293] Current node started as MASTER for database 'cdrarch' [OHazelcastPlugin] 2016-09-07 12:19:05:120 INFO  [node1473243531293] New distributed configuration for database: cdrarch (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +--------+-----------+----------+-----------------+ |        |           |          |     MASTER      | |        |           |          |     ONLINE      | +--------+-----------+----------+-----------------+ |CLUSTER |writeQuorum|readQuorum|node1473107743544| +--------+-----------+----------+-----------------+ |*       |     1     |    1     |        X        | |internal|     1     |    1     |                 | +--------+-----------+----------+-----------------+ 2016-09-07 12:19:05:121 INFO  [node1473243531293] Saving distributed configuration file for database 'cdrarch' to: /opt/orientdb/databases/cdrarch/distributed-config.json [OHazelcast Plugin] 2016-09-07 12:19:05:124 INFO  [node1473243531293] Distributed servers status:  +------------------+--------+------------------------------------+-----+---------+-----------------+-----------------+-------------------------+ |Name              |Status  |Databases                           |Conns|StartedOn|Binary           |HTTP             |UsedMemory               | +------------------+--------+------------------------------------+-----+---------+-----------------+-----------------+-------------------------+ |node1473243531293*|STARTING|                                    |0    |12:18:50 |10.49.69.189:2424|10.49.69.189:2480|75.77MB/491.00MB (15.43%)| |node1473107743544 |ONLINE  |GratefulDeadConcerts=ONLINE (MASTER)|3    |10:27:24 |10.49.69.190:2424|10.49.69.190:2480|5.35GB/14.22GB (37.63%)  | |                  |        |cdrarch=ONLINE (MASTER)             |     |         |                 |                 |                         | |                  |        |bvdd-test=ONLINE (MASTER)           |     |         |                 |                 |                         | +------------------+--------+------------------------------------+-----+---------+-----------------+-----------------+-------------------------+  [OHazelcastPlugin] 2016-09-07 12:19:05:131 WARNI [node1473243531293]-&gt;[[node1473107743544]] Requesting deploy of database 'cdrarch' on local server... [OHazelcastPlugin] 2016-09-07 12:19:05:444 WARNI [node1473243531293] Moving existent database 'cdrarch' in '/opt/orientdb/databases/cdrarch' to '/opt/orientdb/databases//../backup/databases/cdrarch' an d get a fresh copy from a remote node... [OHazelcastPlugin] 2016-09-07 12:19:05:445 SEVER [node1473243531293] Error on moving existent database 'cdrarch' located in '/opt/orientdb/databases/cdrarch' to '/opt/orientdb/databases/../backup/datab ases/cdrarch'. Deleting old database... [OHazelcastPlugin] 2016-09-07 12:19:05:445 INFO  [node1473243531293]&lt;-[node1473107743544] Copying remote database 'cdrarch' to: /tmp/orientdb/install_cdrarch.zip [OHazelcastPlugin] 2016-09-07 12:19:05:446 INFO  [node1473243531293]&lt;-[node1473107743544] Installing database 'cdrarch' to: /opt/orientdb/databases/cdrarch... [OHazelcastPlugin] 2016-09-07 12:19:05:447 INFO  [node1473243531293] - writing chunk #1 offset=0 size=0b [OHazelcastPlugin] 2016-09-07 12:19:05:448 INFO  [node1473243531293] Database copied correctly, size=0b [ODistributedAbstractPlugin$3] 2016-09-07 12:19:07:476 INFO  Node is not online yet (status=STARTING), blocking the command until it is online (retry=1, queue=0 worker=0) [ODistributedWorker] 2016-09-07 12:19:09:476 INFO  Node is not online yet (status=STARTING), blocking the command until it is online (retry=2, queue=0 worker=0) [ODistributedWorker] ... ```  -&gt; what's happening? </body>
		<created>2016-09-07 11:13:01</created>
		<closed>2017-05-03 12:32:27</closed>
	</bug>
	<bug>
		<id>6665</id>
		<title>Batch script from console fails</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [x] Linux - ubuntu 14.04 - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior - Expected: Run the sql script from console - Actual: Get error ## Steps to reproduce the problem  1.- Go to the console: $ORIENTDB_HOME/bin/console.sh 2.- Connect to a database: connect remote:host/databaseName user pass 3.- Try to execute a sql scritp: script sql .... whatever  Example, in my case this is happening: ![seleccion_133](https://cloud.githubusercontent.com/assets/521303/18305794/bd481368-74ae-11e6-9c51-3c536dcb8a17.png)  And my config: ![seleccion_134](https://cloud.githubusercontent.com/assets/521303/18306270/ae545bf8-74b0-11e6-8620-74a968a8265c.png)  And this works in 2.1.x versions, here it is the example that i found: http://stackoverflow.com/questions/27149179/how-do-i-execute-an-orient-db-batch-script </body>
		<created>2016-09-07 09:16:19</created>
		<closed>2016-09-25 07:31:44</closed>
	</bug>
	<bug>
		<id>6663</id>
		<title>java.lang.IllegalArgumentException: Cluster segment #-2 does not exist in database</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System   Linux ## Expected behavior and actual behavior ## Steps to reproduce the problem  begin delete from (select content from  33:740) commit   but if i do  delete from (select content from  33:740)  works.  </body>
		<created>2016-09-06 21:29:27</created>
		<closed>2016-09-14 16:05:47</closed>
	</bug>
	<bug>
		<id>6659</id>
		<title>Bug with Truncate messages</title>
		<body>From a user:  ``` We found strange query behaviour with truncate operation.  We have class: `create class Object extends V`  If we have 5 `Objects` and 7 `V`, when executing `truncate class V unsafe`: - First time: result says that 7 nodes deleted (they are actually deleted) - Second time: results says that 5 nodes deleted (but they are not deleted) ``` </body>
		<created>2016-09-05 23:17:29</created>
		<closed>2016-10-26 10:42:57</closed>
	</bug>
	<bug>
		<id>6655</id>
		<title>custom field is saved wrong when I am writing string with backslash and apostrophe</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I expect string without backslash the same behaviour when I save property's custom attributes ## Steps to reproduce the problem  orientdb {db=testdb}&gt; **create class test extends V** Class created successfully. Total classes in database now: 11.  orientdb {db=testdb}&gt; **alter class test custom `cField`='a\'sd'** Class updated successfully.  orientdb {db=testdb}&gt; **select customFields.cField from ( select expand(classes) from metadata:schema) where name = 'test'** +----+------------+ |#   |customFields| +----+------------+ |0   |**a\'sd**       | +----+------------+ 1 item(s) found. Query executed in 0.004 sec(s). </body>
		<created>2016-09-05 14:43:50</created>
		<closed>2016-10-01 12:53:58</closed>
	</bug>
	<bug>
		<id>6653</id>
		<title>ODB 'Frozen' Issue</title>
		<body>Hi,  Receiving below error after upgrading the version of OrientDB from 2.0.x to 2.1.16. Not immediately but after 30hours of update.  Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:32 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:33 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:34 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:34 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. Sep 04, 2016 7:34:34 PM com.orientechnologies.common.log.OLogManager log WARNING: DB is frozen will wait for 10000 ms. and then retry. </body>
		<created>2016-09-04 15:30:43</created>
		<closed>2016-12-27 15:12:45</closed>
	</bug>
	<bug>
		<id>6651</id>
		<title>NullPointerException on index.getVersion()</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [ ] Linux - [ ] MacOSX - [ X] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  2016-09-02 09:46:01 t.c.s.a.hr [ERROR] failed to drop old indexes:null java.lang.NullPointerException: null     at com.orientechnologies.orient.core.index.OIndexAbstract.getVersion(OIndexAbstract.java:812)     at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.getVersion(OIndexAbstractDelegate.java:275)     ..     at com.stimulus.archiva.domain.bz$a.run(MailArchiva:169)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745)  Expecting not to get NullPtr ## Steps to reproduce the problem </body>
		<created>2016-09-02 16:48:50</created>
		<closed>2017-01-13 15:32:55</closed>
	</bug>
	<bug>
		<id>6648</id>
		<title>deleting property's attribute "regexp"  does not work</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  attribute should be deleted when I use command: **alter property test.prop regexp null** ## Steps to reproduce the problem  orientdb {db=test}&gt; **create class test extends V** Class created successfully. Total classes in database now: 12.  orientdb {db=test}&gt; **create property test.prop string** Property created successfully with id=1.  orientdb {db=test}&gt; **alter property test.prop regexp '[a-z]'** Property updated successfully.  orientdb {db=test}&gt; **select expand(properties)  from ( select expand(classes) from metadata:schema) where name = 'test'**  +----+----+----+--------+---------+--------+-------+------------+----+----+------------+-------+-----------+------+ |#   |name|type|globalId|mandatory|readonly|notNull|defaultValue|min |max |customFields|collate|description|regexp| +----+----+----+--------+---------+--------+-------+------------+----+----+------------+-------+-----------+------+ |0   |prop|7   |23      |false    |false   |false  |            |    |    |            |default|           **|[a-z]** | +----+----+----+--------+---------+--------+-------+------------+----+----+------------+-------+-----------+------+ 1 item(s) found. Query executed in 0.004 sec(s).  orientdb {db=test}&gt; **alter property test.prop regexp null** Property updated successfully.  orientdb {db=test}&gt; **select expand(properties)  from ( select expand(classes) from metadata:schema) where name = 'test'** +----+----+----+--------+---------+--------+-------+------------+----+----+------------+-------+-----------+------+ |#   |name|type|globalId|mandatory|readonly|notNull|defaultValue|min |max |customFields|collate|description|regexp| +----+----+----+--------+---------+--------+-------+------------+----+----+------------+-------+-----------+------+ |0   |prop|7   |23      |false    |false   |false  |            |    |    |            |default|           |**[a-z]** | +----+----+----+--------+---------+--------+-------+------------+----+----+------------+-------+-----------+------+ 1 item(s) found. Query executed in 0.003 sec(s). </body>
		<created>2016-09-02 08:55:29</created>
		<closed>2016-10-01 13:58:31</closed>
	</bug>
	<bug>
		<id>6647</id>
		<title>OrientDB no longer works behind NGINX reverse proxy.</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.8 ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  The issue I am having is that somewhere after 2.2.0, trying to use nginx as reverse proxy for OrientDB no longer works.  When I try to log into the database I get the following error in the browsers:  https://localhost/orientdb/command/-9199765851322639105/sql/-/-1?format=rid,type,version,class,graph net::ERR_INCOMPLETE_CHUNKED_ENCODING  In the NGINX console i get:  2016/09/02 06:16:34 [error] 8#8: *2 upstream prematurely closed connection while reading upstream, client: 172.18.0.1, server: localhost, request: "POST /orientdb/command/-9199765851322639105/sql/-/20?format=rid,type,version,class,graph HTTP/1.1", upstream: "http://172.18.0.5:2480/command/-9199765851322639105/sql/-/20?format=rid,type,version,class,graph", host: "localhost", referrer: "https://localhost/orientdb/studio/index.html"  And in OrientDB console I get:  2016-09-02 06:45:53:254 SEVER Internal server error: java.net.SocketException: Socket closed [ONetworkProtocolHttpDb]  This worked in version 2.2.0, but when I upgrade to 2.2.5 it stopped working.  It is still not working in 2.2.8.  I have done a bunch of reading and it seems that this is likely to do some HTTP streaming / chunked encoding issues.  I noticed that proxies are very sensitive to this, and I also see that in recent version orient has updated how it is doing response streaming. ## Steps to reproduce the problem  I am going to try to create a simple set of docker containers that reproduce the problem, and also narrow down which 2.2.x version cause the problem. </body>
		<created>2016-09-02 07:27:10</created>
		<closed>2017-05-22 12:48:51</closed>
	</bug>
	<bug>
		<id>6646</id>
		<title>NoClassDefFoundError on shutdown</title>
		<body>## OrientDB Version - v2.2.8 ## Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  On Tomcat 8 shutdown Orient DB outputting:  Exception in thread "Thread-109" java.lang.NoClassDefFoundError: com/orientechnologies/common/log/OLogManager$DebugLogManager     at com.orientechnologies.common.log.OLogManager.shutdown(OLogManager.java:303)     at com.orientechnologies.orient.core.OrientShutdownHook.run(OrientShutdownHook.java:37) Caused by: java.lang.ClassNotFoundException: com.orientechnologies.common.log.OLogManager$DebugLogManager     at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1720)     at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1571)     ... 2 more  Expecting a clean shutdown with no errors. ## Steps to reproduce the problem </body>
		<created>2016-09-01 18:20:30</created>
		<closed>2016-09-02 06:49:38</closed>
	</bug>
	<bug>
		<id>6645</id>
		<title>HA: when database is installed, check for complete installation</title>
		<body>This is the error about this problem:  ``` 2016-09-01 13:16:16:837 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=0/100)... [ODistributedWorker] 2016-09-01 13:16:17:142 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=1/100)... [ODistributedWorker] 2016-09-01 13:16:17:446 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=2/100)... [ODistributedWorker] 2016-09-01 13:16:17:750 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=3/100)... [ODistributedWorker] 2016-09-01 13:16:18:054 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=4/100)... [ODistributedWorker] 2016-09-01 13:16:18:359 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=5/100)... [ODistributedWorker] 2016-09-01 13:16:18:663 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=6/100)... [ODistributedWorker] 2016-09-01 13:16:18:967 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=7/100)... [ODistributedWorker] 2016-09-01 13:16:19:272 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=8/100)... [ODistributedWorker] 2016-09-01 13:16:19:576 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=9/100)... [ODistributedWorker] 2016-09-01 13:16:19:882 INFO  [node2] Database 'GamesOfThrones' not present, waiting for it (retry=10/100)... [ODistributedWorker] 2016-09-01 13:16:19:947 INFO  [node2]&lt;-[node3] Copying remote database 'GamesOfThrones' to: /var/folders/zc/y34429014c3bt_x1587qblth0000gn/T//orientdb/install_GamesOfThrones.zip [OHazelcastPlugin] 2016-09-01 13:16:19:948 INFO  [node2]&lt;-[node3] Installing database 'GamesOfThrones' to: /temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones... [OHazelcastPlugin] 2016-09-01 13:16:19:949 INFO  [node2] - writing chunk #1 offset=0 size=2.07MB [OHazelcastPlugin] 2016-09-01 13:16:19:951 WARNI [node2]&lt;-[node3] LSN not found in database from network, database delta sync will be not available for database 'GamesOfThrones' [ODistributedAbstractPlugin$3] 2016-09-01 13:16:19:951 INFO  [node2] Database copied correctly, size=2.07MB [ODistributedAbstractPlugin$3][node2]&lt;-[node1] Error on executing distributed request 0.38: (command_sql(create cluster `orole_0`)) worker=0 com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones' with mode=rw     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:339)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:257)     at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:944)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:911)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:896)     at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.getDatabaseInstance(ODistributedDatabaseImpl.java:658)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.initDatabaseInstance(ODistributedWorker.java:129)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:263)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:96) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot open the storage 'GamesOfThrones' because it does not exist in path: /temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:279)     ... 8 more [node2]&lt;-[node1] Error on executing distributed request 0.40: (command_sql(create cluster `orole_1`)) worker=0 com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones' with mode=rw     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:339)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:257)     at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:944)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:911)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:896)     at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.getDatabaseInstance(ODistributedDatabaseImpl.java:658)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.initDatabaseInstance(ODistributedWorker.java:129)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:263)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:96) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot open the storage 'GamesOfThrones' because it does not exist in path: /temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:279)     ... 8 more [node2]&lt;-[node1] Error on executing distributed request 0.42: (command_sql(create cluster `osequence_0`)) worker=0 com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones' with mode=rw     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:339)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:257)     at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:944)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:911)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:896)     at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.getDatabaseInstance(ODistributedDatabaseImpl.java:658)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.initDatabaseInstance(ODistributedWorker.java:129)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:263)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:96) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot open the storage 'GamesOfThrones' because it does not exist in path: /temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:279)     ... 8 more [node2]&lt;-[node1] Error on executing distributed request 0.44: (command_sql(create cluster `osequence_1`)) worker=0 com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones' with mode=rw     DB name="GamesOfThrones"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:339)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:257)     at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:944)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:911)     at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:896)     at com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.getDatabaseInstance(ODistributedDatabaseImpl.java:658)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.initDatabaseInstance(ODistributedWorker.java:129)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:263)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:96) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Cannot open the storage 'GamesOfThrones' because it does not exist in path: /temp/orientdb/orientdb-community-2.2.1-SNAPSHOT/node2/databases/GamesOfThrones     DB name="GamesOfThrones" ``` </body>
		<created>2016-09-01 18:20:03</created>
		<closed>2017-02-18 06:56:35</closed>
	</bug>
	<bug>
		<id>6641</id>
		<title>Graph creation operation fails with "Invalid value of TX counter"</title>
		<body>We are using orient db 2.2.7 on windows.  Following is the stack trace for the problem.  Exception in thread "main" com.orientechnologies.orient.core.exception.OStorageException: Invalid value of TX counter DB name="lineage_graph"  at com.orientechnologies.orient.core.tx.OTransactionOptimistic.rollback(OTransactionOptimistic.java:153)  at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2678)  at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2634)  at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.shutdown(OrientBaseGraph.java:1141)  at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.shutdown(OrientBaseGraph.java:1127)  at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.shutdown(OrientBaseGraph.java:1120)  We are creating vertices and edges in bulk mode. Commit happens after every 10000 edges are created. Heap size of JVM is 4 GB. Its single threaded application.  Same works in 2.1.11 but not in 2.2.7, because of it we have to revert back to 2.1.11 Is this a regression?  We are using OrientGraphFactory to get transaction graph and Graph.shutdown() to shutdown graph after vertices and edges creation. </body>
		<created>2016-08-31 05:52:09</created>
		<closed>2016-09-27 11:37:22</closed>
	</bug>
	<bug>
		<id>6638</id>
		<title>java.lang.NegativeArraySizeException thrown on vertices that were in orientdb recently</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2 ## Operating System  Linux ## Expected behavior and actual behavior  What is the likely cause of a java.lang.NegativeArraySizeException when querying a vertex in the following manner:   select \* from #14:838  I am querying a few vertices directly and all of sudden I am getting this exception.  I suspect some of my data might be corrupted but wanted to see if you could provide some guidance here.    Just a few days prior, these vertices were available.  I also realized that this exception is being thrown for a batch of vertices with sequential @RIDs.  Its about 100+ vertices.    Any guidance?  </body>
		<created>2016-08-30 17:01:24</created>
		<closed>2017-01-30 21:58:18</closed>
	</bug>
	<bug>
		<id>6636</id>
		<title>Cluster Strategy inexplicably changes to round-robin in distributed setup</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[x] - .rc1[ ] .beta2[ ] .beta1[ ] - v3.0 SNAPSHOT[x] ## Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  This issue concerns 2.2 and 3.0-SNAPSHOT in distributed + embedded mode with transactions enabled:  After adding multiple vertices of a previously added vertex type, the cluster selection strategy inexplicably changes from `OLocalClusterStrategy` to `ORoundRobinClusterSelectionStrategy`, leading to an `OSchemaException`.  Meanwhile `OClass::setClusterSelection()` is not getting called. ## Steps to reproduce the problem - Launch a single embedded node, setup schema and shutdown:    ``` java final String nodeName = "devel1"; System.setProperty("ORIENTDB_NODE_NAME", nodeName); System.setProperty("ORIENTDB_HOME", new File("").getAbsolutePath() + File.separator + nodeName); System.setProperty("ORIENTDB_ROOT_PASSWORD", "123"); final OServer server = OServerMain.create(true); server.startup(config); server.activate();  final OrientGraphFactory factory = new OrientGraphFactory("plocal:" + nodeName + File.separator + "databases" + File.separator + "test"); final OrientGraphNoTx graphNoTx = factory.getNoTx();  if (graphNoTx.getVertexType("Person") == null)     graphNoTx.createVertexType("Person", 1)  final OrientVertexType vtPerson = graphNoTx.getVertexType("Person");  // explicitely set cluster selction strategy to 'local' vtPerson.setClusterSelection(OLocalClusterStrategy.NAME);  if (vtPerson.getProperty("firstName") == null)     vtPerson.createProperty("firstName", OType.STRING);  if (vtPerson.getProperty("lastName") == null)     vtPerson.createProperty("lastName", OType.STRING);  if (vtPerson.getProperty("out_lives") == null)     vtPerson.createEdgeProperty(Direction.OUT, "lives");  if (vtPerson.getProperty("out_history") == null)     vtPerson.createEdgeProperty(Direction.OUT, "history");  vtPerson.setStrictMode(true);  graphNoTx.shutdown(); factory.close(); server.shutdown(); ``` - Relaunch first node and add multiple vertices of class 'Person':  ``` java final String nodeName = "devel1"; System.setProperty("ORIENTDB_NODE_NAME", nodeName); System.setProperty("ORIENTDB_HOME", new File("").getAbsolutePath() + File.separator + nodeName); System.setProperty("ORIENTDB_ROOT_PASSWORD", "123"); final OServer server = OServerMain.create(true); server.startup(config); server.activate();  final OrientGraphFactory factory = new OrientGraphFactory("plocal:" + nodeName + File.separator + "databases" + File.separator + "test");  while (true) {     // press 'return' a few times and then launch second node     System.in.read();      final OrientGraph graph = factory.getTx();      // should always be 'local'     System.out.println("ClusterSelectionStrategy: " + graph.getVertexType("Person").getClusterSelection().getName());      graph.addVertex("class:Person", "firstName", "Roger", "lastName", "Smith");     graph.getRawGraph().commit();      graph.shutdown(); }  factory.close(); server.shutdown(); ``` - Launching the second node and also adding multiple vertices of class 'Person' triggers the described behavior:  ``` java final String nodeName = "devel2"; System.setProperty("ORIENTDB_NODE_NAME", nodeName); System.setProperty("ORIENTDB_HOME", new File("").getAbsolutePath() + File.separator + nodeName); System.setProperty("ORIENTDB_ROOT_PASSWORD", "123"); final OServer server = OServerMain.create(true); server.startup(config); server.activate();  final OrientGraphFactory factory = new OrientGraphFactory("plocal:" + nodeName + File.separator + "databases" + File.separator + "test");  while (true) {     // pressing 'return' 2 to 10 times should trigger the described behavior     System.in.read();      final OrientGraph graph = factory.getTx();      // should always be 'local', but eventually changes to 'round-robin'     System.out.println("ClusterSelectionStrategy: " + graph.getVertexType("Person").getClusterSelection().getName());      graph.addVertex("class:Person", "firstName", "Roger", "lastName", "Smith");     graph.getRawGraph().commit();      graph.shutdown(); }  factory.close(); server.shutdown(); ``` ## Used configuration: - orientdb-server-config.xml:   ``` xml &lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;  &lt;orient-server&gt;     &lt;handlers&gt;         &lt;handler             class="com.orientechnologies.orient.graph.handler.OGraphServerHandler"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="true" /&gt;                 &lt;parameter name="graph.pool.max" value="50" /&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- CLUSTER PLUGIN, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler             class="com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin"&gt;             &lt;parameters&gt;                 &lt;!-- &lt;parameter name="nodeName" value="europe1" /&gt; --&gt;                 &lt;parameter name="enabled" value="true" /&gt;                 &lt;parameter name="configuration.db.default"                     value="${ORIENTDB_HOME}/config/default-distributed-db-config.json" /&gt;                 &lt;parameter name="configuration.hazelcast" value="${ORIENTDB_HOME}/config/hazelcast.xml" /&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- JMX SERVER, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OJMXPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="false" /&gt;                 &lt;parameter name="profilerManaged" value="true" /&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- AUTOMATIC BACKUP, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler             class="com.orientechnologies.orient.server.handler.OAutomaticBackup"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="false" /&gt;                 &lt;!-- LOCATION OF JSON CONFIGURATION FILE --&gt;                 &lt;parameter name="config"                     value="${ORIENTDB_HOME}/config/automatic-backup.json" /&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;!-- SERVER SIDE SCRIPT INTERPRETER. WARNING, THIS CAN BE A SECURITY HOLE              BECAUSE MALICIOUS CODE COULD BE INJECTED. ENABLE IT ONLY IF CLIENTS ARE TRUSTED,              TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;         &lt;handler             class="com.orientechnologies.orient.server.handler.OServerSideScriptInterpreter"&gt;             &lt;parameters&gt;                 &lt;parameter name="enabled" value="true" /&gt;                 &lt;parameter name="allowedLanguages" value="SQL" /&gt;             &lt;/parameters&gt;         &lt;/handler&gt;      &lt;/handlers&gt;     &lt;network&gt;         &lt;sockets&gt;             &lt;socket                 implementation="com.orientechnologies.orient.server.network.OServerTLSSocketFactory"                 name="ssl"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth" /&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.keyStore" /&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword" /&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.trustStore" /&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword" /&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;             &lt;socket                 implementation="com.orientechnologies.orient.server.network.OServerTLSSocketFactory"                 name="https"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth" /&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.keyStore" /&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword" /&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.trustStore" /&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword" /&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;         &lt;/sockets&gt;         &lt;protocols&gt;             &lt;!-- Default registered protocol. It reads commands using the HTTP protocol                  and write data locally --&gt;             &lt;protocol name="binary"                 implementation="com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary" /&gt;             &lt;protocol name="http"                 implementation="com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpDb" /&gt;         &lt;/protocols&gt;         &lt;listeners&gt;             &lt;listener protocol="binary" ip-address="0.0.0.0" port-range="2424-2430"                 socket="default" /&gt;             &lt;listener protocol="http" ip-address="0.0.0.0" port-range="2480-2490"                 socket="default"&gt;                 &lt;parameters&gt;                     &lt;!-- Connection's custom parameters. If not specified the global configuration                          will be taken --&gt;                     &lt;parameter name="network.http.charset" value="utf-8" /&gt;                     &lt;parameter value="true" name="network.http.jsonResponseError" /&gt;                     &lt;!-- Define additional HTTP headers to always send as response --&gt;                     &lt;!-- Allow cross-site scripting --&gt;                     &lt;!-- parameter name="network.http.additionalResponseHeaders" value="Access-Control-Allow-Origin:                          *;Access-Control-Allow-Credentials: true" / --&gt;                 &lt;/parameters&gt;                 &lt;commands&gt;                     &lt;command                         pattern="GET|www GET|studio/ GET| GET|*.htm GET|*.html GET|*.xml GET|*.jpeg GET|*.jpg GET|*.png GET|*.gif GET|*.js GET|*.css GET|*.swf GET|*.ico GET|*.txt GET|*.otf GET|*.pjs GET|*.svg GET|*.json GET|*.woff GET|*.woff2 GET|*.ttf GET|*.svgz"                         implementation="com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetStaticContent"&gt;                         &lt;parameters&gt;                             &lt;!-- Don't cache html resources in development mode --&gt;                             &lt;entry name="http.cache:*.htm *.html"                                 value="Cache-Control: no-cache, no-store, max-age=0, must-revalidate\r\nPragma: no-cache" /&gt;                             &lt;!-- Default caching --&gt;                             &lt;entry name="http.cache:default" value="Cache-Control: max-age=120" /&gt;                         &lt;/parameters&gt;                     &lt;/command&gt;                     &lt;command pattern="GET|gephi/*"                         implementation="com.orientechnologies.orient.graph.server.command.OServerCommandGetGephi" /&gt;                 &lt;/commands&gt;             &lt;/listener&gt;         &lt;/listeners&gt;         &lt;cluster&gt;         &lt;/cluster&gt;     &lt;/network&gt;     &lt;storages&gt;     &lt;/storages&gt;     &lt;users&gt;         &lt;user name="root" password="123" resources="*" /&gt;     &lt;/users&gt;     &lt;properties&gt;         &lt;!-- DATABASE POOL: size min/max --&gt;         &lt;entry name="db.pool.min" value="1" /&gt;         &lt;entry name="db.pool.max" value="50" /&gt;          &lt;!-- PROFILER: configures the profiler as &lt;seconds-for-snapshot&gt;,&lt;archive-snapshot-size&gt;,&lt;summary-size&gt; --&gt;         &lt;entry name="profiler.enabled" value="false" /&gt;         &lt;!-- &lt;entry name="profiler.config" value="30,10,10" /&gt; --&gt;     &lt;/properties&gt; &lt;/orient-server&gt; ``` - default-distributed-db-config.json:  ``` json {   "autoDeploy": true,   "hotAlignment": false,   "readQuorum": 1,   "writeQuorum": "majority",   "executionMode": "undefined",   "readYourWrites": true,   "servers": {     "*": "master"   },   "clusters": {     "internal": {     },     "*": {       "servers": ["&lt;NEW_NODE&gt;"]     }   } } ``` </body>
		<created>2016-08-30 14:45:08</created>
		<closed>2016-10-17 06:38:43</closed>
	</bug>
	<bug>
		<id>6635</id>
		<title>Reached maximum number of concurrent connections</title>
		<body>Orientdb version-2.1.16 Java : Orientdb-client -2.1.16 1. Orient-db-server-config.xml : pool size configuration        ```    &lt;entry name="server.database.path" value="${ORIENT_DB_DIR}/databases"/&gt;    &lt;entry value="30" name="db.pool.min"/&gt;    &lt;entry value="300" name="db.pool.max"/&gt;    &lt;entry name="cache.local.enabled" value="true" /&gt;    &lt;entry value="true" name="profiler.enabled"/&gt;    &lt;entry value="info" name="log.console.level"/&gt;    &lt;entry value="fine" name="log.file.level"/&gt;    &lt;entry name="distributed.crudTaskTimeout" value="15000"/&gt;    &lt;entry name="distributed.queueTimeout" value="30000"/&gt;    &lt;entry name="distributed.asynchResponsesTimeout" value="60000"/&gt;    &lt;entry name="distributed.purgeResponsesTimerDelay" value="60000"/&gt;    &lt;entry name="distributed.commandTaskTimeout" value="120000"/&gt;    ``` 2.  java code connection configuration        dbConntectionPoolA = new OPartitionedDatabasePool("remote:localhost/db", "xyz", "pwd", "10", "120")  and closing the connection in finally block.  Still we are facing this issue of "reached maximum number of connections".  because the number of  opened connections are 951 </body>
		<created>2016-08-30 09:55:46</created>
		<closed>2017-12-29 14:01:32</closed>
	</bug>
	<bug>
		<id>6631</id>
		<title>Possible corrupted database after crashing on DELETE EDGE query</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.1.11 ## Operating System - [x] MacOSX ## Steps to reproduce the problem  OrientDB crashed (out of memory in logs) due to a large DELETE EDGE query I had going to clean up some edges. Now I'm getting nullPointerException errors in console while trying to access some vertexes: &lt;img width="923" alt="screen shot 2016-08-29 at 10 54 42 am" src="https://cloud.githubusercontent.com/assets/3770894/18061443/9207c79e-6dd7-11e6-9ca5-07de9becfbe4.png"&gt;  and, for some reason, when I use subqueries I get an odd error now.  This query works fine:  ``` SELECT expand(out('profile').out('contact'))  FROM User WHERE email='lorem@ipsum' ```  This query does not:  ``` SELECT FROM (   SELECT expand(out('profile').out('contact'))    FROM User WHERE email='lorem@ipsum' ) ```  gives me this error: &lt;img width="924" alt="screen shot 2016-08-29 at 10 55 54 am" src="https://cloud.githubusercontent.com/assets/3770894/18061429/88e373de-6dd7-11e6-9c28-89ed92f7989f.png"&gt;  Tried to use `repair database --fix-graph` but I get `Error: java.lang.NullPointerException`  I've tried to go through and manually update vertexes affected but I keep getting NullPointerExceptions.  Any ideas on how to proceed other than reverting to a prior state? (which is a possibility) </body>
		<created>2016-08-29 18:12:11</created>
		<closed>2016-09-27 08:52:50</closed>
	</bug>
	<bug>
		<id>6629</id>
		<title>unable to find a way working for passing a bytearray to a server</title>
		<body>version 2.2.6 ## Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  ```                 HashMap&lt;String,Object&gt; m=new HashMap();         m.put("a", new byte[]{1,2,3});              db.command(new OCommandSQL("select insertBlock(:a)  ")).execute(m); ```  seams to pass ::a instead byte array </body>
		<created>2016-08-29 13:28:55</created>
		<closed>2016-09-25 11:27:58</closed>
	</bug>
	<bug>
		<id>6627</id>
		<title>Excessive number of total requests to process `graph.getVertices(key, value)`</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.7 (orientdb-graphdb Java API client and server) ## Operating System - Linux ## Expected behavior and actual behavior  **Expected:** binary protocol operation fulfilled in fewer than 10 requests **Actual:** operation fulfilled in over 380 requests ## Steps to reproduce the problem  I have a database with 480 vertices stored, and I'm trying to do a look up of one of those vertices that has a unique property value. I perform this lookup like so:  ``` java OrientBaseGraph graph = factory.getTx; Iterable&lt;Vertex&gt; result = graph.getVertices(key, value); ```  where `key` is an attribute of a subset of the vertices and `value` is a unique string of just one vertex in the database. If I execute `list connections` in the OrientDB console I see that this one operation made 4 requests to the database with a single connection:  ``` orientdb {server=remote:localhost/}&gt; list connections                      +----+----+----------------+------+-------------------+--------+----+-----------+--------+ |#   |ID  |REMOTE_ADDRESS  |PROTOC|LAST_OPERATION_ON  |DATABASE|USER|COMMAND    |TOT_REQS| +----+----+----------------+------+-------------------+--------+----+-----------+--------+ |0   |32  |/127.0.0.1:56834|binary|2016-08-28 15:42:10|-       |-   |Server Info|2       | |1   |31  |/127.0.0.1:56833|binary|2016-08-28 15:42:01|-       |-   |Listening  |4       | +----+----+----------------+------+-------------------+--------+----+-----------+--------+ ```  Seems reasonable, though I would think this could be done in just 1 request. Also, what I get is just a collection of results, I still have to iterate over the result set to get the elements inside (there's guaranteed to be one and only one element in this collection based on the key-value set on those vertices). So I do that with:  ``` java Vertex v = result.iterator().next(); ```  When I check my connections again, I get taken a bit by surprise:  ``` orientdb {server=remote:localhost/}&gt; list connections  +----+----+----------------+------+-------------------+--------+----+-----------+--------+ |#   |ID  |REMOTE_ADDRESS  |PROTOC|LAST_OPERATION_ON  |DATABASE|USER|COMMAND    |TOT_REQS| +----+----+----------------+------+-------------------+--------+----+-----------+--------+ |0   |32  |/127.0.0.1:56834|binary|2016-08-28 15:45:53|-       |-   |Server Info|3       | |1   |31  |/127.0.0.1:56833|binary|2016-08-28 15:45:51|-       |-   |Listening  |383     | +----+----+----------------+------+-------------------+--------+----+-----------+--------+ ```  It took **383 requests** to pull just one element out of an `OrientGraphQueryIterable`!! This seems very bizarre/inefficient. What does the `orientdb-graphdb` client do when it's contacting the server? I can do a simple `select * from V where key = value` from the browser and get results in just one request. I would expect to be able to perform the same operation using the Graph API client in no more than 10 requests. Can someone from the OrientDB team explain what's going on? </body>
		<created>2016-08-29 01:36:51</created>
		<closed>2016-09-29 14:20:18</closed>
	</bug>
	<bug>
		<id>6610</id>
		<title>SQL batch unusable in a distributed multi-master setup </title>
		<body>## OrientDB Version, operating system, or hardware. - v2.1.* - v2.2.6/7/8 - Tried both community and enterprise editions - Using remote connections - Testing this out using 3 AWS EC2 instances, with OrientDB running within docker containers on each host, using Hazelcast's Amazon discovery plugin. ## Operating System - [X] Linux ## Expected behavior  When executing sql batch statements, either via studio, console or the java graph api (OCommandScript), the executed statements should be successful and replicated to all other instances within the cluster. ## Steps to reproduce the problem / Actual behavior ### 1st scenario  Running a 3 instance cluster, all master, with write quorum set to `majority`, a simple create vertex followed by create edge fail with the message:  ``` com.orientechnologies.orient.core.exception.OConcurrentModificationException: Cannot UPDATE the record #31:1 because the version is not the latest. Probably you are updating an old record or it has been modified by another user (db=v2 your=v1) DB name="profiles" ```  What is strange here is that record #31:1 was at v2 in all instances before the above sql was executed.  I don't understand why it thinks it is at v1? ### 2nd scenario  Running a 3 instance cluster, all master, with write quorum set to `all`, the same simple create vertex followed by create edge exhibits the exact same behavior as in the 1st scenario. ### 3rd scenario  Running a 3 instance cluster, all master, with write quorum set to `1`, the same simple create vertex followed by create edge runs successful.  No errors are reported in the logs.  When querying the instances, the server where the command was executed contains the new records, but does not exist in the other 2 masters. ### 4th scenario  Running a 3 instance cluster, 1 master with 2 replicas, the same simple create vertex followed by create edge runs successful, and is replicated to the other instances. </body>
		<created>2016-08-25 19:33:34</created>
		<closed>2016-09-20 05:27:18</closed>
	</bug>
	<bug>
		<id>6606</id>
		<title>if() and eval() produce incorrect results in RETURN section of MATCH</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .7[x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Expected: - The `RETURN` section of `MATCH` should be equivalent in functionality to the section between the `SELECT` and `FROM` section of a `SELECT` statement. For example, using `if()` and `eval()` is allowed and produces equivalent results in both of these. - Regardless of what is in the `RETURN` section of a `MATCH`, the number of rows returned should not change.  Actual: Using `if()` and `eval()` in the `RETURN` section of a `MATCH` does not appear to work correctly, and changes the number of rows relative to when the query ends in `RETURN $matches`. See repro below for concrete examples. ## Steps to reproduce the problem  Setup:  ``` CREATE CLASS V1 EXTENDS V CREATE PROPERTY V1.name String CREATE VERTEX V1 SET name = 'foo' CREATE VERTEX V1 SET name = 'bar' ```  First query, without `if()` or `eval()`, performs as expected:  ``` MATCH {     class: V1,     as: p } RETURN $matches ```  This returns two rows, and the `p` column has the correct values `#12:0` and `#12:1`.  Use `if()` and `eval()` with constants in the "true-value" and "false-value" of the `if()`:  ``` MATCH {     class: V1,     as: p } RETURN if(eval("p.name == 'foo'"), 1, 2) AS b ```  This returns _a single row_ rather than two rows as the previous query, and the `b` column has the value `2` indicating a `false` condition. However, one of the vertices should have satisfied the condition. If I had to guess, my money would be on the alias `p` not being defined inside the `eval()`.  Use `if()` and `eval()` with alias-based expressions in the "true-value" and "false-value" of the `if()`:  ``` MATCH {     class: V1,     as: p } RETURN if(eval("p.name == 'foo'"), p.name, p.name) as b ```  This once again returns a single row rather than two rows, and the `b` column contains the null value, even though both the "true-value" and the "false-value" were the `name` of the `V1` vertex. It again appears as if the alias `p` is not defined inside the scope of the `if()`.  Rewriting these same queries as:  ``` SELECT &lt;selections_with_ifs_and_evals_here&gt; FROM (     MATCH {         class: V1,         as: p     } RETURN $matches ) ```  always produces the expected, correct results -- two rows with the proper "true-value" and "false-value" in each row. </body>
		<created>2016-08-24 22:44:08</created>
		<closed>2016-09-26 14:36:22</closed>
	</bug>
	<bug>
		<id>6605</id>
		<title>@rid values cannot be compared with !=, unlike all other scalar types</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .7 [x] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Expected: @rid values can be checked for inequality with both `!=` and `&lt;&gt;`, similarly to other values like strings and numbers.  Actual: @rid values can only be checked for inequality with `&lt;&gt;`. Trying to use `!=` raises the following error:  ``` java.lang.ClassCastException: com.orientechnologies.orient.code.id.ORecordId cannot be cast to java.lang.Boolean ```  Worse still, in combination with #6604 this means that entire columns from the output are silently dropped for no obvious reason, as #6604 will swallow the raised error in the `eval` statement. ## Steps to reproduce the problem  Follow the setup from #6604, then run:  ``` select @rid, name, if(eval("@rid != @rid"), "match", "no match") as m from V1 where @rid &lt;&gt; #12:0 ```  Observe the error I listed above. Then, remove the `WHERE` clause, and observe that the returned output is missing the `m` column, as in #6604. </body>
		<created>2016-08-24 22:08:05</created>
		<closed>2016-09-26 09:16:14</closed>
	</bug>
	<bug>
		<id>6601</id>
		<title>HTTP API race condition</title>
		<body>## OrientDB Version, operating system, or hardware. - problem occurs since v2.2.4 ## Operating System - [X] Linux - [X] MacOSX ## Expected behavior and actual behavior  Expected: When using the Http API and POST a batch command there should only be one response.  Actual: There are two responses. First is 200, second is 204. ## Steps to reproduce the problem  If you checkout https://github.com/ImmobilienScout24/play-orientdb-client/tree/orientdb2.2.4 and run the tests with `./sbt test` while sniffing the network traffic, the result looks like this:  ``` POST /batch/temp HTTP/1.1 Host: localhost:2480 Authorization: Basic cm9vdDpyb290 User-Agent: akka-http/2.4.7 Content-Type: application/json Content-Length: 230  {"transaction":true,"operations":[{"language":"sql","script":["Update SchemaLock set lockedBy = \"isdeblnnm150.iscout.local\" where (lockedBy is null or lockedBy = \"isdeblnnm150.iscout.local\") and id=\"did\""],"type":"script"}]}HTTP/1.1 200 OK Cache-Control: no-cache, no-store, max-age=0, must-revalidate Pragma: no-cache Date: Wed Aug 24 13:13:11 CEST 2016 Content-Type: application/json; charset=utf-8 Server: OrientDB Server v.2.2.4 Connection: Keep-Alive Content-Transfer-Encoding: binary Transfer-Encoding: chunked  31 {"result":[{"@type":"d","@version":0,"value":1}]} 0  HTTP/1.1 204 OK Cache-Control: no-cache, no-store, max-age=0, must-revalidate Pragma: no-cache Date: Wed Aug 24 13:13:11 CEST 2016 Content-Type: text/plain; charset=utf-8 Server: OrientDB Server v.2.2.4 Connection: Keep-Alive Set-Cookie: OSESSIONID=OS1472037191295-2818016975438360849; Path=/; HttpOnly Content-Length: 0 ```  As you can see there are two responses in the tcp stream. The first is the correct 200. The second is 204 which causes our tests to break.  Maybe an important hint is that the connection is kept alive.  With version 2.2.3 ( https://github.com/ImmobilienScout24/play-orientdb-client ) the problem does not occur. </body>
		<created>2016-08-24 12:11:23</created>
		<closed>2017-01-30 21:28:07</closed>
	</bug>
	<bug>
		<id>6595</id>
		<title>certain float numbers get rounded</title>
		<body>## OrientDB Version, operating system, or hardware. - v.2.1.19 (build 2.1.x@r71509d3123205ed8c61f115a5caa5ece4b87a192; 2016-06-01 12:15:51) - v.2.1.21 (build 2.1.x@rd6619775543ef589bb487c9bd237fc703429d172; 2016-08-10 14:33:00) - v.2.2.6 (build 2.2.x@r4b1cc998b36ca2ae21a1679938912a8f545a994a; 2016-07-27 15:34:14) ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  running query `select 3.193359375`  EXPECTED: `3.193359375` ACTUAL: returned rounded number: `3.1933594`  Tested via REST API, Orient DB studio UI, and python binary client pyorient ver. 1.5.4 - same result on all of them.   BUT if run query `select 3.193359374` i get correct float in return: `3.193359374`  Here is the list of my numbers (value_in, value_out) than i stored and gotten rounded values:  ``` python [(1.529296875, 1.5292969), (-36.2109375, -36.210938), (1.08984375, 1.0898438), (-80.68359375, -80.68359), (70.13671875, 70.13672), (-13.53515625, -13.535156), (-36.03515625, -36.035156), (80.68359375, 80.68359), (-3.33984375, -3.3398438), (1.041015625, 1.0410156), (-4.74609375, -4.7460938), (1.02734375, 1.0273438), (-75.05859375, -75.05859), (-43.41796875, -43.41797), (1.724609375, 1.7246094), (1.072265625, 1.0722656), (87.71484375, 87.71484), (1.595703125, 1.5957031), (53.7890625, 53.789062), (3.791015625, 3.7910156), (1.51953125, 1.5195312), (67.32421875, 67.32422), (-24.2578125, -24.257812), (-45.3515625, -45.351562), (-83.14453125, -83.14453), (4.634765625, 4.6347656), (-36.73828125, -36.73828), (1.576171875, 1.5761719), (-81.9140625, -81.91406), (1.533203125, 1.5332031), (1.70703125, 1.7070312), (1.732421875, 1.7324219), (-24.08203125, -24.082031), (-51.50390625, -51.503906), (1.716796875, 1.7167969), (-49.39453125, -49.39453), (1.04296875, 1.0429688), (1.044921875, 1.0449219), (1.052734375, 1.0527344), (-43.2421875, -43.242188), (67.67578125, 67.67578), (1.00390625, 1.0039062), (-10.72265625, -10.722656), (76.81640625, 76.81641), (-47.28515625, -47.285156), (45.17578125, 45.17578), (1.150390625, 1.1503906), (1.05078125, 1.0507812), (-18.45703125, -18.457031), (-9.31640625, -9.316406), (-85.25390625, -85.25391), (1.599609375, 1.5996094), (-31.81640625, -31.816406), (-72.0703125, -72.07031), (-14.94140625, -14.941406), (-27.0703125, -27.070312), (-42.71484375, -42.714844), (81.73828125, 81.73828), (54.31640625, 54.316406), (4.669921875, 4.669922), (1.15234375, 1.1523438), (-43.9453125, -43.945312), (-68.5546875, -68.55469), (-5.80078125, -5.8007812), (1.14453125, 1.1445312), (1.583984375, 1.5839844), (-7.91015625, -7.9101562), (3.228515625, 3.2285156), (1.525390625, 1.5253906), (-81.03515625, -81.03516), (1.54296875, 1.5429688), (-81.2109375, -81.21094), (4.658203125, 4.658203), (-44.6484375, -44.648438), (1.443359375, 1.4433594), (1.58984375, 1.5898438), (82.08984375, 82.08984), (1.728515625, 1.7285156), (1.03515625, 1.0351562), (-88.76953125, -88.76953), (45.3515625, 45.351562), (4.365234375, 4.3652344), (1.544921875, 1.5449219), (76.46484375, 76.46484), (-6.50390625, -6.5039062), (1.060546875, 1.0605469), (-82.6171875, -82.61719), (-51.6796875, -51.679688), (-78.3984375, -78.39844), (-25.6640625, -25.664062), (-42.5390625, -42.539062), (89.47265625, 89.47266), (4.67578125, 4.6757812), (1.548828125, 1.5488281), (-52.20703125, -52.20703), (4.060546875, 4.060547), (1.033203125, 1.0332031), (59.4140625, 59.414062), (-69.43359375, -69.43359), (-48.69140625, -48.691406), (-8.96484375, -8.964844), (-5.09765625, -5.0976562), (1.73046875, 1.7304688), (89.82421875, 89.82422), (-55.72265625, -55.722656), (-53.0859375, -53.085938), (-10.01953125, -10.019531), (53.61328125, 53.61328), (-71.54296875, -71.54297), (1.001953125, 1.0019531), (53.96484375, 53.964844), (1.55859375, 1.5585938), (72.0703125, 72.07031), (1.056640625, 1.0566406), (-46.0546875, -46.054688), (-25.48828125, -25.488281), (-16.5234375, -16.523438), (1.521484375, 1.5214844), (-34.27734375, -34.277344), (77.16796875, 77.16797), (1.72265625, 1.7226562), (1.41015625, 1.4101562), (-82.44140625, -82.44141), (-16.69921875, -16.699219), (1.541015625, 1.5410156), (1.05859375, 1.0585938), (1.53515625, 1.5351562), (1.064453125, 1.0644531), (1.71484375, 1.7148438), (-46.58203125, -46.58203), (1.07421875, 1.0742188), (66.4453125, 66.44531), (-44.47265625, -44.472656), (-80.5078125, -80.50781), (61.34765625, 61.347656), (67.1484375, 67.14844), (1.52734375, 1.5273438), (3.240234375, 3.2402344), (1.572265625, 1.5722656), (1.048828125, 1.0488281), (-44.82421875, -44.82422), (-16.34765625, -16.347656), (76.11328125, 76.11328), (-34.1015625, -34.101562), (1.60546875, 1.6054688), (63.80859375, 63.808594), (1.517578125, 1.5175781), (1.537109375, 1.5371094), (-76.81640625, -76.81641), (-81.38671875, -81.38672), (-41.66015625, -41.660156), (3.404296875, 3.4042969), (1.591796875, 1.5917969), (-34.98046875, -34.98047), (-24.43359375, -24.433594), (-15.29296875, -15.292969), (-4.39453125, -4.3945312), (-63.80859375, -63.808594), (-12.48046875, -12.480469), (-89.47265625, -89.47266), (4.16015625, 4.1601562), (1.57421875, 1.5742188), (1.556640625, 1.5566406), (1.58203125, 1.5820312), (89.6484375, 89.64844), (-20.7421875, -20.742188), (-6.15234375, -6.1523438), (-39.90234375, -39.902344), (81.38671875, 81.38672), (87.36328125, 87.36328), (-29.1796875, -29.179688), (-66.62109375, -66.62109), (-82.08984375, -82.08984), (4.623046875, 4.623047), (-15.64453125, -15.644531), (3.24609375, 3.2460938), (1.087890625, 1.0878906), (1.69921875, 1.6992188), (-54.66796875, -54.66797), (-51.85546875, -51.85547), (1.705078125, 1.7050781), (3.205078125, 3.2050781), (-79.62890625, -79.62891), (-36.38671875, -36.38672), (54.4921875, 54.492188), (3.22265625, 3.2226562), (1.607421875, 1.6074219), (1.708984375, 1.7089844), (-35.33203125, -35.33203), (-43.06640625, -43.066406), (1.552734375, 1.5527344), (-35.5078125, -35.507812), (88.9453125, 88.94531), (1.029296875, 1.0292969), (-15.99609375, -15.996094), (3.216796875, 3.2167969), (1.720703125, 1.7207031), (1.083984375, 1.0839844), (53.0859375, 53.085938), (-8.61328125, -8.613281), (4.611328125, 4.611328), (-72.24609375, -72.24609), (-87.01171875, -87.01172), (-27.59765625, -27.597656), (1.603515625, 1.6035156), (1.34765625, 1.3476562), (-23.37890625, -23.378906), (-11.77734375, -11.777344), (82.79296875, 82.79297), (1.587890625, 1.5878906), (-83.84765625, -83.84766), (44.6484375, 44.648438), (1.068359375, 1.0683594), (1.373046875, 1.3730469), (-13.88671875, -13.886719), (4.62890625, 4.6289062), (1.513671875, 1.5136719), (1.580078125, 1.5800781), (1.06640625, 1.0664062), (-7.55859375, -7.5585938), (84.90234375, 84.90234), (-32.87109375, -32.871094), (56.6015625, 56.601562), (1.025390625, 1.0253906), (1.59765625, 1.5976562), (-10.37109375, -10.371094), (-45.17578125, -45.17578), (-50.2734375, -50.273438), (4.65234375, 4.6523438), (-17.05078125, -17.050781), (44.82421875, 44.82422), (-74.70703125, -74.70703), (1.55078125, 1.5507812), (4.646484375, 4.6464844), (-13.18359375, -13.183594), (1.701171875, 1.7011719), (-35.68359375, -35.683594), (1.021484375, 1.0214844), (-31.2890625, -31.289062), (-41.1328125, -41.132812), (4.306640625, 4.3066406), (69.43359375, 69.43359), (3.193359375, 3.1933594), (88.76953125, 88.76953), (1.037109375, 1.0371094), (-88.41796875, -88.41797), (-52.3828125, -52.382812), (-89.82421875, -89.82422), (1.712890625, 1.7128906), (-77.6953125, -77.69531), (1.01953125, 1.0195312)] ``` </body>
		<created>2016-08-23 00:06:19</created>
		<closed>2016-09-02 13:24:20</closed>
	</bug>
	<bug>
		<id>6583</id>
		<title>Stored row in cluster  shows different record count after ODB hangs </title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.7 ## Operating System - [x] Linux ## Expected behavior and actual behavior  Orient DB running normally but after the some hours , hangs with cpu usage 100% . the following trace ,   `com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record creation         DB name="BSNTS_DB"         Component Name="fiscaltransaction"         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:494)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3091)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:960)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2075)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:246)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:179)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2598)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:103)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1800)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1791)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:330)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:231)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2680)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2626)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1515)        at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2680)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2626)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1515)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:577)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:318)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:196)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.findFreePage(OPaginatedCluster.java:1970)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.addEntry(OPaginatedCluster.java:1906)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:475)         ... 21 more $ANSI{green {db=BSNTS_DB}} Error on creating record in cluster: plocal cluster: fiscaltransaction com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record creation         DB name="BSNTS_DB"         Component Name="fiscaltransaction"         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:494)       at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:960)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2075)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:246)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:179)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2598)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:103)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1800)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1791)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:63)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.saveRecord(OCommandExecutorSQLInsert.java:330)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:231)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2680)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2626)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1515)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:577)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.sessionRequest(ONetworkProtocolBinary.java:318)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:196)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.findFreePage(OPaginatedCluster.java:1970)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.addEntry(OPaginatedCluster.java:1906)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:475)`  and i'm wondered when run the select count command result that show as below :  ![image](https://cloud.githubusercontent.com/assets/10245423/17748739/076dcf62-64d0-11e6-9f54-a8735fb62033.png)  So when i insert new Record in FiscalTransaction class , randomly raised error and not saving the record .  Please help me . ## Steps to reproduce the problem .  I don't know , this behavior is unexpected .   It seems we have a null pointer for a record in storage  after the database hanging .  i guess there is a problem with cluster 29 because when i insert some record after 3 successful insert the following error appears :   `Error during saving of record with rid #29:-1`  Thanks Saeed Tabrizi </body>
		<created>2016-08-17 18:44:38</created>
		<closed>2016-09-28 14:17:24</closed>
	</bug>
	<bug>
		<id>6578</id>
		<title>Deadlock in embedded server</title>
		<body>v 2.2.7  Threads dump attached. I also made heap dump, but it is 42MB zipped. It is a rather big web app, I cant provide test code to reproduce  [threads_report.txt](https://github.com/orientechnologies/orientdb/files/422714/threads_report.txt) </body>
		<created>2016-08-17 13:57:47</created>
		<closed>2016-08-18 07:53:41</closed>
	</bug>
	<bug>
		<id>6576</id>
		<title>Error on parsing query when I request a non-existing class</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.6 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  when I request a non-existing class I will expect error "this class does not exist" but I receive error "Error on parsing query Query: blablabla ------^ DB name="my_test_db"  I think that is wrong ## Steps to reproduce the problem  SELECT FROM blablabla </body>
		<created>2016-08-17 09:56:36</created>
		<closed>2016-10-01 15:06:08</closed>
	</bug>
	<bug>
		<id>6573</id>
		<title>ETL: csv extractor throws exception when trying to use predefinedFormat: Default</title>
		<body>## OrientDB Version, operating system, or hardware. - [X] v2.2.7 ## Operating System - [ ] Linux - [X] MacOSX (El Capitan) - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Per [http://orientdb.com/docs/2.2.x/Extractor.html](http://orientdb.com/docs/2.2.x/Extractor.html), I have a CSV file that I'm trying to import and I set the "predefinedFormat" value to "DEFAULT" and I get the following output:  ``` OrientDB etl v.2.2.7 (build 2.2.x@rdcab5af4dce4b538bdb4b372abba46e3fc9f19b7; 2016-08-11 15:17:33+0000) www.orientdb.com Exception in thread "main" com.orientechnologies.orient.core.exception.OConfigurationException: Error on creating ETL processor     at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:225)     at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:176)     at com.orientechnologies.orient.etl.OETLProcessor.parseConfigAndParameters(OETLProcessor.java:144)     at com.orientechnologies.orient.etl.OETLProcessor.main(OETLProcessor.java:108) Caused by: java.lang.IllegalArgumentException: No enum constant com.orientechnologies.apache.commons.csv.CSVFormat.Predefined.DEFAULT     at java.lang.Enum.valueOf(Enum.java:238)     at com.orientechnologies.apache.commons.csv.CSVFormat$Predefined.valueOf(CSVFormat.java:155)     at com.orientechnologies.apache.commons.csv.CSVFormat.valueOf(CSVFormat.java:376)     at com.orientechnologies.orient.etl.extractor.OCSVExtractor.configure(OCSVExtractor.java:77)     at com.orientechnologies.orient.etl.OETLProcessor.configureComponent(OETLProcessor.java:449)     at com.orientechnologies.orient.etl.OETLProcessor.configureExtractors(OETLProcessor.java:273)     at com.orientechnologies.orient.etl.OETLProcessor.parse(OETLProcessor.java:207)     ... 3 more ``` ## Steps to reproduce the problem  I have a .json extractor with the following code in it:  ```     "extractor": { "csv": { "predefinedFormat": "DEFAULT",                             "ignoreEmptyLines": true,                             "nullValue": "N/A",                             "dateFormat": "yyyy-mm-dd",                             "columns": ["label:string","data:float","Date:date"]                           }                  }, ``` </body>
		<created>2016-08-17 00:17:45</created>
		<closed>2016-09-14 14:53:47</closed>
	</bug>
	<bug>
		<id>6572</id>
		<title>cannot change the abstract class attribute</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.6 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  when I create class without the abstract class attribute, I cannot change this attribute later if I create abstract class, I can change this attribute ## Steps to reproduce the problem  create class test alter class test abstract true // error com.orientechnologies.orient.core.exception.ODatabaseException: Impossible to remove the last cluster of class 'test' drop the class instead DB name="my_test_db"  create class test2 abstract alter class test2 abstract false // OK </body>
		<created>2016-08-16 14:22:36</created>
		<closed>2016-11-30 15:29:43</closed>
	</bug>
	<bug>
		<id>6563</id>
		<title>different behavior between classes and properties when I create/edit custom fields</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.6  ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  custom fields in classes {"myField":"someValue"} names of custom fields don't contain sign ` (backquote)  custom fields in properties {"**`**myField2**`**":"someValue2"} names of custom fields contain sign ` (backquote) ## Steps to reproduce the problem  create class test create property test.pTest string alter class test custom `myField`='someValue' alter property test.pTest custom `myField2`='someValue2' select from ( select expand(classes) from metadata:schema) where name = 'test' </body>
		<created>2016-08-15 14:02:56</created>
		<closed>2016-08-16 09:23:35</closed>
	</bug>
	<bug>
		<id>6562</id>
		<title>how to clear the custom fields</title>
		<body>Hi. I started use OrientDB 2.2.6 but I can't clear custom fields  for it I use command "alter class myClass custom clear"   this command worked in OrientDB 2.1.19 </body>
		<created>2016-08-15 12:03:28</created>
		<closed>2016-08-16 09:23:27</closed>
	</bug>
	<bug>
		<id>6561</id>
		<title>Incorrect Lucene engine shutdown</title>
		<body>Lucene engine cannot be shutdown from the shutdown hook because of:  ``` com.orientechnologies.orient.core.exception.ODatabaseException: The database instance is not set in the current thread. Be sure to set it with: ODatabaseRecordThreadLocal.INSTANCE.set(db);     at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.get(ODatabaseRecordThreadLocal.java:51)     at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.getDatabase(OLuceneIndexEngineAbstract.java:312)     at com.orientechnologies.lucene.engine.OLuceneFacetManager.delete(OLuceneFacetManager.java:107)     at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.delete(OLuceneFullTextIndexEngine.java:80)     at com.orientechnologies.lucene.engine.OLuceneIndexEngineDelegate.delete(OLuceneIndexEngineDelegate.java:81)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:3568)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:535)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.delete(OAbstractPaginatedStorage.java:543)     at com.orientechnologies.orient.core.storage.impl.memory.ODirectMemoryStorage.shutdown(ODirectMemoryStorage.java:130) ```  `TestVertexIndex` test updated to workaround this. </body>
		<created>2016-08-14 14:15:36</created>
		<closed>2016-10-20 16:18:40</closed>
	</bug>
	<bug>
		<id>6547</id>
		<title>RecordId cannot support negative cluster id. Found: -659</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.6   Linux  om.orientechnologies.orient.core.exception.ODatabaseException: RecordId cannot support negative cluster id. Found: -659         DB name="archiva"         at com.orientechnologies.orient.core.id.ORecordId.checkClusterLimits(ORecordId.java:335)         at com.orientechnologies.orient.core.id.ORecordId.&lt;init&gt;(ORecordId.java:50)         at com.orientechnologies.orient.core.serialization.serializer.binary.impl.OLinkSerializer.deserializeFromByteBufferObject(OLinkSerializer.java:158)         at com.orientechnologies.orient.core.serialization.serializer.stream.OStreamSerializerSBTreeIndexRIDContainer.deserializeFromByteBufferObject(OStreamSerializerSBTreeIndexRIDContainer.java:274)         at com.orientechnologies.orient.core.serialization.serializer.stream.OStreamSerializerSBTreeIndexRIDContainer.deserializeFromByteBufferObject(OStreamSerializerSBTreeIndexRIDContainer.java:43)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.deserializeFromDirectMemory(ODurablePage.java:167)         at com.orientechnologies.orient.core.index.hashindex.local.OHashIndexBucket.getEntry(OHashIndexBucket.java:141)         at com.orientechnologies.orient.core.index.hashindex.local.OHashIndexBucket.find(OHashIndexBucket.java:93)         at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable20.get(OLocalHashTable20.java:364)         at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.get(OHashTableIndexEngine.java:145)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:1913)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:1895)         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:139)         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:51)         at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:916)         at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:761)         at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:734)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:1445)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1412)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:566)         at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:106)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2697)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2666)         at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.commit(OrientTransactionalGraph.java:175)         at com.stimulus.archiva.hm.a(MailArchiva:820)         at com.stimulus.archiva.ic.a(MailArchiva:138)         at com.stimulus.archiva.hu.g(MailArchiva:79)         at com.stimulus.archiva.ss.a(MailArchiva:205)         at com.stimulus.archiva.ss.a(MailArchiva:108)         at com.stimulus.archiva.ss.a(MailArchiva:162)         at com.stimulus.archiva.ss.run(MailArchiva:484)         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745) ## Expected behavior and actual behavior </body>
		<created>2016-08-11 13:00:29</created>
		<closed>2016-11-08 09:26:59</closed>
	</bug>
	<bug>
		<id>6544</id>
		<title>Lucene indexes raise an exception after database backup</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .6[X] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [X] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  ``` java.lang.IllegalArgumentException: targetGen=642 was never returned by the ReferenceManager instance (current gen=27)         at org.apache.lucene.search.ControlledRealTimeReopenThread.waitForGeneration(ControlledRealTimeReopenThread.java:160)         at org.apache.lucene.search.ControlledRealTimeReopenThread.waitForGeneration(ControlledRealTimeReopenThread.java:135)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.searcher(OLuceneIndexEngineAbstract.java:432)         at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.getResults(OLuceneFullTextIndexEngine.java:214)         at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.getInTx(OLuceneFullTextIndexEngine.java:281)         at com.orientechnologies.lucene.engine.OLuceneFullTextIndexEngine.get(OLuceneFullTextIndexEngine.java:112)         at com.orientechnologies.lucene.engine.OLuceneIndexEngineDelegate.get(OLuceneIndexEngineDelegate.java:122)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:1913)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:1902)         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.get(OLuceneIndexNotUnique.java:213)         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.get(OLuceneIndexNotUnique.java:45) ``` ## Steps to reproduce the problem 1. Modify content of Lucene index  2. Make backup of the database  3. Try to use the index (get data or modify) </body>
		<created>2016-08-11 08:31:04</created>
		<closed>2016-08-11 09:45:34</closed>
	</bug>
	<bug>
		<id>6543</id>
		<title>HA: distributed tests fail</title>
		<body>Running the distribute test suite I see this kind of error very often:  ``` 2016-08-11 02:09:59:016 SEVER ********************************************************************************************************** [BasicScenarioTest] 2016-08-11 02:09:59:038 INFO  - closing storage: distributed-basic... [Orient] 2016-08-11 02:09:59:038 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic/cache.stt (No such file or directory)) [O2QCache] 2016-08-11 02:09:59:054 INFO  - closing storage: OSystem... [Orient] 2016-08-11 02:09:59:054 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/OSystem (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/OSystem/cache.stt (No such file or directory)) [O2QCache]-- error on closing storage com.orientechnologies.orient.core.exception.OWriteCacheException: File flush was abnormally terminated     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:696)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:707)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:2875)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:3525)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:459)     at com.orientechnologies.orient.core.Orient.closeAllStorages(Orient.java:385)     at com.orientechnologies.orient.server.distributed.AbstractServerClusterTest.init(AbstractServerClusterTest.java:104)     at com.orientechnologies.orient.server.distributed.scenariotest.BasicShardingNoReplicaScenarioTest.test(BasicShardingNoReplicaScenarioTest.java:59)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)     at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)     at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)     at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)     at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runners.Suite.runChild(Suite.java:128)     at org.junit.runners.Suite.runChild(Suite.java:27)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runner.JUnitCore.run(JUnitCore.java:137)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)     at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)     at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) Caused by: java.util.concurrent.ExecutionException: com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/OSystem/osequence.cpm was not found     at java.util.concurrent.FutureTask.report(FutureTask.java:122)     at java.util.concurrent.FutureTask.get(FutureTask.java:192)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:691)     ... 42 more Caused by: com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/OSystem/osequence.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:1824)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:1809)     at java.util.concurrent.FutureTask.run(FutureTask.java:266)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745)  2016-08-11 02:09:59:060 INFO  - closing storage: OSystem... [Orient] 2016-08-11 02:09:59:060 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/OSystem (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/OSystem/cache.stt (No such file or directory)) [O2QCache] 2016-08-11 02:09:59:085 INFO  - closing storage: distributed-basic... [Orient] 2016-08-11 02:09:59:085 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic/cache.stt (No such file or directory)) [O2QCache] 2016-08-11 02:09:59:117 INFO  - closing storage: OSystem... [Orient] 2016-08-11 02:09:59:117 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/OSystem (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/OSystem/cache.stt (No such file or directory)) [O2QCache]-- error on closing storage com.orientechnologies.orient.core.exception.OWriteCacheException: File flush was abnormally terminated     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:696)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:707)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:2875)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:3525)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:459)     at com.orientechnologies.orient.core.Orient.closeAllStorages(Orient.java:385)     at com.orientechnologies.orient.server.distributed.AbstractServerClusterTest.init(AbstractServerClusterTest.java:104)     at com.orientechnologies.orient.server.distributed.scenariotest.BasicShardingNoReplicaScenarioTest.test(BasicShardingNoReplicaScenarioTest.java:59)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)     at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)     at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)     at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)     at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runners.Suite.runChild(Suite.java:128)     at org.junit.runners.Suite.runChild(Suite.java:27)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runner.JUnitCore.run(JUnitCore.java:137)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)     at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)     at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) Caused by: java.util.concurrent.ExecutionException: com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/OSystem/osequence.cpm was not found     at java.util.concurrent.FutureTask.report(FutureTask.java:122)     at java.util.concurrent.FutureTask.get(FutureTask.java:192)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:691)     ... 42 more Caused by: com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/OSystem/osequence.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:1824)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:1809)     at java.util.concurrent.FutureTask.run(FutureTask.java:266)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745)  2016-08-11 02:09:59:118 INFO  - closing storage: distributed-basic... [Orient] Creating database 'distributed-basic-sharding' under: target/server0/databases/distributed-basic-sharding... Creating database schema... 2016-08-11 02:09:59:118 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic/cache.stt (No such file or directory)) [O2QCache] Starting test against 3 server nodes... Starting server with serverId 0 from target/server0... 2016-08-11 02:09:59:265 INFO  - closing storage: distributed-basic-sharding... [Orient] 2016-08-11 02:09:59:274 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:09:59:274 SEVER STARTING SERVER -&gt; 0... [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:09:59:274 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:09:59:275 INFO  Loading configuration from input stream [OServerConfigurationLoaderXml] 2016-08-11 02:09:59:292 INFO  OrientDB Server v2.2.7-SNAPSHOT is starting up... [OServer] 2016-08-11 02:09:59:292 INFO  Databases directory: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases [OServer] 2016-08-11 02:09:59:293 INFO  {db=OSystem} Creating the system database 'OSystem' for current server [OSystemDatabase] 2016-08-11 02:09:59:377 SEVER ODefaultServerSecurity.loadConfig() Could not access the security JSON file: target/server0/config/security.json [ODefaultServerSecurity] 2016-08-11 02:09:59:377 INFO  Listening binary connections on 0.0.0.0:2424 (protocol v.36, socket=default) [OServerNetworkListener] 2016-08-11 02:09:59:377 INFO  Listening http connections on 0.0.0.0:2480 (protocol v.10, socket=default) [OServerNetworkListener] 2016-08-11 02:09:59:378 WARNI Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] 2016-08-11 02:09:59:378 WARNI onAfterDynamicPlugins() Configuration document is empty [ODefaultServerSecurity] 2016-08-11 02:09:59:378 INFO  Configuring Hazelcast from '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/src/test/resources/sharded-hazelcast.xml'. [FileSystemXmlConfig] 2016-08-11 02:09:59:380 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2016-08-11 02:09:59:386 INFO  [LOCAL] [orientdb] [3.6.3] Picked Address[127.0.0.1]:2434, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=2434], bind any local is true [DefaultAddressPicker] 2016-08-11 02:09:59:387 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Hazelcast 3.6.3 (20160527 - 08b28c3) starting at Address[127.0.0.1]:2434 [system] 2016-08-11 02:09:59:387 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system] 2016-08-11 02:09:59:387 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Configured Hazelcast Serialization version : 1 [system] 2016-08-11 02:09:59:389 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Backpressure is disabled [OperationService] 2016-08-11 02:09:59:389 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Starting with 1 generic operation threads and 1 partition operation threads. [ClassicOperationExecutor] 2016-08-11 02:09:59:391 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Creating TcpIpJoiner [Node] 2016-08-11 02:09:59:391 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Address[127.0.0.1]:2434 is STARTING [LifecycleService] 2016-08-11 02:09:59:393 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads [NonBlockingIOThreadingModel] 2016-08-11 02:09:59:394 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Connecting to /127.0.0.1:2436, timeout: 0, bind-any: true [InitConnectionTask] 2016-08-11 02:09:59:394 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Connecting to /127.0.0.1:2435, timeout: 0, bind-any: true [InitConnectionTask] 2016-08-11 02:09:59:394 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Could not connect to: /127.0.0.1:2436. Reason: SocketException[Connection refused to address /127.0.0.1:2436] [InitConnectionTask] 2016-08-11 02:09:59:394 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Could not connect to: /127.0.0.1:2435. Reason: SocketException[Connection refused to address /127.0.0.1:2435] [InitConnectionTask] 2016-08-11 02:09:59:394 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Address[127.0.0.1]:2436 is added to the blacklist. [TcpIpJoiner] 2016-08-11 02:09:59:394 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Address[127.0.0.1]:2435 is added to the blacklist. [TcpIpJoiner] 2016-08-11 02:10:00:395 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3]    Members [1] {     Member [127.0.0.1]:2434 this }  [TcpIpJoiner] 2016-08-11 02:10:00:396 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Address[127.0.0.1]:2434 is STARTED [LifecycleService] 2016-08-11 02:10:00:396 INFO  Starting distributed server 'usa' (hzID=8c37d430-756b-4fd5-a1b2-56105a349088)... [OHazelcastPlugin] 2016-08-11 02:10:00:396 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Initializing cluster partition table arrangement... [InternalPartitionService] 2016-08-11 02:10:00:401 INFO  [usa] Opening database 'distributed-basic-sharding'... [OHazelcastPlugin] 2016-08-11 02:10:00:402 INFO  [usa] loaded database configuration from disk: src/test/resources/sct-sharded-basic-distrib-config.json [OHazelcastPlugin] 2016-08-11 02:10:00:404 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+-------+-------+-------+ |             |           |          |MASTER |MASTER |MASTER | |             |           |          |OFFLINE|OFFLINE|OFFLINE| +-------------+-----------+----------+-------+-------+-------+ |CLUSTER      |writeQuorum|readQuorum|  usa  |europe | asia  | +-------------+-----------+----------+-------+-------+-------+ |*            |     1     |    1     |       |       |       | |client_asia  |     1     |    1     |       |       |   X   | |client_europe|     1     |    1     |       |   X   |       | |client_usa   |     1     |    1     |   X   |       |       | |internal     |     1     |    1     |       |       |       | +-------------+-----------+----------+-------+-------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:00:404 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:00:404 INFO  [usa] Distributed servers status:  +----+--------+---------+-----+---------+------------------+------------------+------------------------+ |Name|Status  |Databases|Conns|StartedOn|Binary            |HTTP              |UsedMemory              | +----+--------+---------+-----+---------+------------------+------------------+------------------------+ |usa*|STARTING|         |0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|978.27MB/3.56GB (26.87%)| +----+--------+---------+-----+---------+------------------+------------------+------------------------+  [OHazelcastPlugin] 2016-08-11 02:10:00:404 INFO  [usa] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin$4] 2016-08-11 02:10:00:405 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=1)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+-------+-------+-------+ |             |           |          |MASTER |MASTER |MASTER | |             |           |          |OFFLINE|OFFLINE|OFFLINE| +-------------+-----------+----------+-------+-------+-------+ |CLUSTER      |writeQuorum|readQuorum|  usa  |europe | asia  | +-------------+-----------+----------+-------+-------+-------+ |*            |     1     |    1     |       |       |       | |client_asia  |     1     |    1     |       |       |   X   | |client_europe|     1     |    1     |       |   X   |       | |client_usa   |     1     |    1     |   X   |       |       | |internal     |     1     |    1     |       |       |       | +-------------+-----------+----------+-------+-------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:00:405 INFO  [usa] Adding node 'usa' in partition: distributed-basic-sharding db=[*] v=2 [ODistributedDatabaseImpl$1] 2016-08-11 02:10:00:425 INFO  [usa] Reassigning cluster ownership for database distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:00:425 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=2)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+-------------+-------+-------+ |             |    |           |          |   MASTER    |MASTER |MASTER | |             |    |           |          |SYNCHRONIZING|OFFLINE|OFFLINE| +-------------+----+-----------+----------+-------------+-------+-------+ |CLUSTER      |  id|writeQuorum|readQuorum|     usa     |europe | asia  | +-------------+----+-----------+----------+-------------+-------+-------+ |*            |    |     1     |    1     |      X      |       |       | |client_asia  |    |     1     |    1     |             |       |   X   | |client_europe|    |     1     |    1     |             |   X   |       | |client_usa   |    |     1     |    1     |      X      |       |       | |internal     |   0|     1     |    1     |             |       |       | +-------------+----+-----------+----------+-------------+-------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:00:433 INFO  [usa] Publishing ONLINE status for database usa.distributed-basic-sharding... [ODistributedDatabaseImpl] 2016-08-11 02:10:00:434 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=2)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+-------+-------+ |             |           |          |MASTER|MASTER |MASTER | |             |           |          |ONLINE|OFFLINE|OFFLINE| +-------------+-----------+----------+------+-------+-------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe | asia  | +-------------+-----------+----------+------+-------+-------+ |*            |     1     |    1     |  X   |       |       | |client_asia  |     1     |    1     |      |       |   X   | |client_europe|     1     |    1     |      |   X   |       | |client_usa   |     1     |    1     |  X   |       |       | |internal     |     1     |    1     |      |       |       | +-------------+-----------+----------+------+-------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:00:434 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:00:435 WARNI [usa] Updated node status to 'ONLINE' [OHazelcastPlugin] 2016-08-11 02:10:00:437 INFO  [usa] Distributed servers status:  +----+------+------------------------------------------+-----+---------+------------------+------------------+------------------------+ |Name|Status|Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory              | +----+------+------------------------------------------+-----+---------+------------------+------------------+------------------------+ |usa*|ONLINE|distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|988.05MB/3.56GB (27.14%)| +----+------+------------------------------------------+-----+---------+------------------+------------------+------------------------+  [OHazelcastPlugin]Error during fuzzy checkpoint com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-schema/e_7.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicalFuzzyCheckpointTask.run(OWOWCache.java:1762)     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)     at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745)  Starting server with serverId 1 from target/server1... 2016-08-11 02:10:03:442 INFO  OrientDB Studio available at http://192.168.1.248:2480/studio/index.html [OServer] 2016-08-11 02:10:03:442 INFO  OrientDB Server is active v2.2.7-SNAPSHOT. [OServer] 2016-08-11 02:10:03:442 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:03:442 SEVER STARTING SERVER -&gt; 1... [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:03:442 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:03:442 INFO  Loading configuration from input stream [OServerConfigurationLoaderXml] 2016-08-11 02:10:03:455 INFO  OrientDB Server v2.2.7-SNAPSHOT is starting up... [OServer] 2016-08-11 02:10:03:455 INFO  Databases directory: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases [OServer] 2016-08-11 02:10:03:456 INFO  {db=OSystem} Creating the system database 'OSystem' for current server [OSystemDatabase] 2016-08-11 02:10:03:547 SEVER ODefaultServerSecurity.loadConfig() Could not access the security JSON file: target/server1/config/security.json [ODefaultServerSecurity] 2016-08-11 02:10:03:548 WARNI Port 0.0.0.0:2424 busy, trying the next available... [OServerNetworkListener] 2016-08-11 02:10:03:548 INFO  Listening binary connections on 0.0.0.0:2425 (protocol v.36, socket=default) [OServerNetworkListener] 2016-08-11 02:10:03:548 WARNI Port 0.0.0.0:2480 busy, trying the next available... [OServerNetworkListener] 2016-08-11 02:10:03:548 INFO  Listening http connections on 0.0.0.0:2481 (protocol v.10, socket=default) [OServerNetworkListener] 2016-08-11 02:10:03:548 WARNI Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] 2016-08-11 02:10:03:549 WARNI onAfterDynamicPlugins() Configuration document is empty [ODefaultServerSecurity] 2016-08-11 02:10:03:549 INFO  Configuring Hazelcast from '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/src/test/resources/sharded-hazelcast.xml'. [FileSystemXmlConfig] 2016-08-11 02:10:03:551 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2016-08-11 02:10:03:558 INFO  [LOCAL] [orientdb] [3.6.3] Picked Address[127.0.0.1]:2435, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=2435], bind any local is true [DefaultAddressPicker] 2016-08-11 02:10:03:558 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Hazelcast 3.6.3 (20160527 - 08b28c3) starting at Address[127.0.0.1]:2435 [system] 2016-08-11 02:10:03:558 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system] 2016-08-11 02:10:03:558 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Configured Hazelcast Serialization version : 1 [system] 2016-08-11 02:10:03:560 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Backpressure is disabled [OperationService] 2016-08-11 02:10:03:560 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Starting with 1 generic operation threads and 1 partition operation threads. [ClassicOperationExecutor] 2016-08-11 02:10:03:562 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Creating TcpIpJoiner [Node] 2016-08-11 02:10:03:562 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Address[127.0.0.1]:2435 is STARTING [LifecycleService] 2016-08-11 02:10:03:564 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads [NonBlockingIOThreadingModel] 2016-08-11 02:10:03:565 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Connecting to /127.0.0.1:2436, timeout: 0, bind-any: true [InitConnectionTask] 2016-08-11 02:10:03:565 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Connecting to /127.0.0.1:2434, timeout: 0, bind-any: true [InitConnectionTask] 2016-08-11 02:10:03:565 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Could not connect to: /127.0.0.1:2436. Reason: SocketException[Connection refused to address /127.0.0.1:2436] [InitConnectionTask] 2016-08-11 02:10:03:565 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Address[127.0.0.1]:2436 is added to the blacklist. [TcpIpJoiner] 2016-08-11 02:10:03:565 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Accepting socket connection from /127.0.0.1:50250 [SocketAcceptorThread] 2016-08-11 02:10:03:566 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Established socket connection between /127.0.0.1:50250 and /127.0.0.1:2434 [TcpIpConnectionManager] 2016-08-11 02:10:03:566 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Established socket connection between /127.0.0.1:2434 and /127.0.0.1:50250 [TcpIpConnectionManager]Error during fuzzy checkpoint com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/OSystem/osequence.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicalFuzzyCheckpointTask.run(OWOWCache.java:1762)     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)     at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745)  2016-08-11 02:10:06:576 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3]   Members [2] {     Member [127.0.0.1]:2434 this     Member [127.0.0.1]:2435 }  [ClusterService] 2016-08-11 02:10:06:576 WARNI [usa] Added new node id=Member [127.0.0.1]:2435 name=ext:43f8fb64-d761-4f99-8873-90bc4d9d0098 [OHazelcastPlugin] 2016-08-11 02:10:06:576 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3]   Members [2] {     Member [127.0.0.1]:2434     Member [127.0.0.1]:2435 this }  [ClusterService] 2016-08-11 02:10:06:831 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Re-partitioning cluster data... Migration queue size: 135 [InternalPartitionService] 2016-08-11 02:10:07:879 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] All migration tasks have been completed, queues are empty. [InternalPartitionService] 2016-08-11 02:10:08:582 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Address[127.0.0.1]:2435 is STARTED [LifecycleService] 2016-08-11 02:10:08:582 INFO  Starting distributed server 'europe' (hzID=43f8fb64-d761-4f99-8873-90bc4d9d0098)... [OHazelcastPlugin] 2016-08-11 02:10:08:586 INFO  [usa]&lt;-[ext:43f8fb64-d761-4f99-8873-90bc4d9d0098] Received updated about registered nodes [OHazelcastPlugin] 2016-08-11 02:10:08:588 INFO  [usa]&lt;-[europe] Added node configuration id=Member [127.0.0.1]:2435 name=europe, now 2 nodes are configured [OHazelcastPlugin] 2016-08-11 02:10:08:588 INFO  [europe] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:08:589 INFO  [usa] Distributed servers status:  +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe|STARTING|                                          |0    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.03GB/3.56GB (28.88%)| +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:08:589 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=2)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+-------+-------+ |             |           |          |MASTER|MASTER |MASTER | |             |           |          |ONLINE|OFFLINE|OFFLINE| +-------------+-----------+----------+------+-------+-------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe | asia  | +-------------+-----------+----------+------+-------+-------+ |*            |     1     |    1     |  X   |       |       | |client_asia  |     1     |    1     |      |       |   X   | |client_europe|     1     |    1     |      |   X   |       | |client_usa   |     1     |    1     |  X   |       |       | |internal     |     1     |    1     |      |       |       | +-------------+-----------+----------+------+-------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:08:589 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:08:589 INFO  [europe] Distributed servers status:  +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe*|STARTING|                                          |0    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.03GB/3.56GB (28.88%)| +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:08:590 INFO  [europe] Adding node 'europe' in partition: distributed-basic-sharding db=[*] v=3 [ODistributedDatabaseImpl$1] 2016-08-11 02:10:08:590 INFO  [usa]&lt;-[europe] Received new status europe.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:08:590 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=3)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+-------------+-------+ |             |           |          |MASTER|   MASTER    |MASTER | |             |           |          |ONLINE|SYNCHRONIZING|OFFLINE| +-------------+-----------+----------+------+-------------+-------+ |CLUSTER      |writeQuorum|readQuorum| usa  |   europe    | asia  | +-------------+-----------+----------+------+-------------+-------+ |*            |     2     |    1     |  X   |      o      |       | |client_asia  |     2     |    1     |      |             |   X   | |client_europe|     2     |    1     |      |      X      |       | |client_usa   |     2     |    1     |  X   |             |       | |internal     |     2     |    1     |      |             |       | +-------------+-----------+----------+------+-------------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:08:590 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:08:591 INFO  [usa]&lt;-[europe] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:08:591 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=3)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+-------------+-------+ |             |           |          |MASTER|   MASTER    |MASTER | |             |           |          |ONLINE|SYNCHRONIZING|OFFLINE| +-------------+-----------+----------+------+-------------+-------+ |CLUSTER      |writeQuorum|readQuorum| usa  |   europe    | asia  | +-------------+-----------+----------+------+-------------+-------+ |*            |     2     |    1     |  X   |      o      |       | |client_asia  |     2     |    1     |      |             |   X   | |client_europe|     2     |    1     |      |      X      |       | |client_usa   |     2     |    1     |  X   |             |       | |internal     |     2     |    1     |      |             |       | +-------------+-----------+----------+------+-------------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:08:591 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:08:592 WARNI [europe]-&gt;[[usa]] Requesting deploy of database 'distributed-basic-sharding' on local server... [OHazelcastPlugin] 2016-08-11 02:10:08:592 INFO  [usa] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:08:593 INFO  [usa] Received updated status europe.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:08:593 INFO  [usa] Received updated status usa.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:08:594 INFO  [usa]-&gt;[europe] Deploying database distributed-basic-sharding... [OSyncDatabaseTask] 2016-08-11 02:10:08:594 INFO  [usa] Distributed servers status:  +------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                        |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE  |distributed-basic-sharding=SYNCHRONIZING (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe|STARTING|                                                 |0    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.03GB/3.56GB (28.88%)| +------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:08:594 INFO  [usa]-&gt;[europe] Creating backup of database 'distributed-basic-sharding' (compressionRate=7) in directory: /var/folders/zc/y34429014c3bt_x1587qblth0000gn/T/orientdb/backup_distributed-basic-sharding.zip. LSN=OLogSequenceNumber{segment=0, position=860240}... [OSyncDatabaseTask] 2016-08-11 02:10:08:715 INFO  [usa]-&gt;[europe] Backup of database 'distributed-basic-sharding' completed. lastOperationId=1.0... [OSyncDatabaseTask$1] 2016-08-11 02:10:08:898 INFO  [usa]-&gt;[europe] - transferring chunk #1 offset=0 size=54284... [OSyncDatabaseTask] 2016-08-11 02:10:08:899 INFO  [usa] Received updated status usa.distributed-basic-sharding=ONLINE [OHazelcastPlugin] 2016-08-11 02:10:08:899 INFO  [usa] Distributed servers status:  +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe|STARTING|                                          |0    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.03GB/3.56GB (28.88%)| +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:08:899 INFO  [usa]-&gt;[europe] Deploy database task completed [OSyncDatabaseTask] 2016-08-11 02:10:08:900 WARNI [europe] Saving clusters [client_europe] to directory 'target/server1/temp/db_distributed-basic-sharding' to be replaced after distributed full backup... [OHazelcastPlugin] 2016-08-11 02:10:08:900 WARNI [europe] Moving existent database 'distributed-basic-sharding' in '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding' to '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases//../backup/databases/distributed-basic-sharding' and get a fresh copy from a remote node... [OHazelcastPlugin] 2016-08-11 02:10:08:901 SEVER [europe] Error on moving existent database 'distributed-basic-sharding' located in '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding' to '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/../backup/databases/distributed-basic-sharding'. Deleting old database... [OHazelcastPlugin] 2016-08-11 02:10:08:901 INFO  [europe]&lt;-[usa] Copying remote database 'distributed-basic-sharding' to: /var/folders/zc/y34429014c3bt_x1587qblth0000gn/T//orientdb/install_distributed-basic-sharding.zip [OHazelcastPlugin] 2016-08-11 02:10:08:902 INFO  [europe]&lt;-[usa] Installing database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding... [OHazelcastPlugin] 2016-08-11 02:10:08:902 INFO  [europe] - writing chunk #1 offset=0 size=53.01KB [OHazelcastPlugin] 2016-08-11 02:10:08:903 INFO  [europe] Database copied correctly, size=53.01KB [ODistributedAbstractPlugin$3] 2016-08-11 02:10:09:010 WARNI {db=distributed-basic-sharding} Storage 'distributed-basic-sharding' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-08-11 02:10:09:010 SEVER {db=distributed-basic-sharding} Restore is not possible because write ahead log is empty. [OLocalPaginatedStorage] 2016-08-11 02:10:09:010 INFO  {db=distributed-basic-sharding} Storage data recover was completed [OLocalPaginatedStorage] 2016-08-11 02:10:09:018 INFO  {db=distributed-basic-sharding} [europe] Installed database 'distributed-basic-sharding' (LSN=OLogSequenceNumber{segment=0, position=24}) [OHazelcastPlugin] 2016-08-11 02:10:09:022 INFO  [europe] Reassigning cluster ownership for database distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:09:023 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=3)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+------+-------------+-------+ |             |    |           |          |MASTER|   MASTER    |MASTER | |             |    |           |          |ONLINE|SYNCHRONIZING|OFFLINE| +-------------+----+-----------+----------+------+-------------+-------+ |CLUSTER      |  id|writeQuorum|readQuorum| usa  |   europe    | asia  | +-------------+----+-----------+----------+------+-------------+-------+ |*            |    |     2     |    1     |  X   |      o      |       | |client_asia  |    |     2     |    1     |      |             |   X   | |client_europe|    |     2     |    1     |      |      X      |       | |client_usa   |    |     2     |    1     |  X   |             |       | |internal     |   0|     2     |    1     |      |             |       | +-------------+----+-----------+----------+------+-------------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:09:023 INFO  [europe] Distributed servers status:  +-------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status  |Databases                                        |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)       |0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe*|STARTING|distributed-basic-sharding=SYNCHRONIZING (MASTER)|0    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.03GB/3.56GB (28.88%)| +-------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Person': change mastership of cluster 'person_6' (id=31) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Person': change mastership of cluster 'person' (id=25) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Person': change mastership of cluster 'person_7' (id=32) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Person': change mastership of cluster 'person_1' (id=26) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Customer': change mastership of cluster 'customer_6' (id=39) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Customer': change mastership of cluster 'customer_5' (id=38) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Customer': change mastership of cluster 'customer_7' (id=40) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:024 INFO  [europe] Class 'Customer': change mastership of cluster 'customer' (id=33) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:025 INFO  [europe] Class 'OSequence', creation of new local cluster 'osequence_0' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:032 INFO  [europe] Class 'OSequence': change mastership of cluster 'osequence_0' (id=49) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:032 INFO  [europe] Class 'Provider': change mastership of cluster 'provider_4' (id=45) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:032 INFO  [europe] Class 'Provider': change mastership of cluster 'provider_5' (id=46) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:032 INFO  [europe] Class 'Provider': change mastership of cluster 'provider_2' (id=43) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:032 INFO  [europe] Class 'Provider': change mastership of cluster 'provider_3' (id=44) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:032 INFO  [europe] Class 'OFunction', creation of new local cluster 'ofunction_0' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:036 INFO  [europe] Class 'OFunction': change mastership of cluster 'ofunction_0' (id=50) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:036 INFO  [europe] Class 'OSchedule', creation of new local cluster 'oschedule_0' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:042 INFO  [europe] Class 'OSchedule': change mastership of cluster 'oschedule_0' (id=51) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:042 INFO  [europe] Class 'V': change mastership of cluster 'v_3' (id=12) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:042 INFO  [europe] Class 'V': change mastership of cluster 'v_6' (id=15) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:042 INFO  [europe] Class 'V': change mastership of cluster 'v_5' (id=14) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:042 INFO  [europe] Class 'V': change mastership of cluster 'v_7' (id=16) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:042 INFO  [europe] Class 'ORole', creation of new local cluster 'orole_0' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:048 INFO  [europe] Class 'ORole': change mastership of cluster 'orole_0' (id=52) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:048 INFO  [europe] Class 'E': change mastership of cluster 'e_5' (id=22) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:048 INFO  [europe] Class 'E': change mastership of cluster 'e_4' (id=21) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:048 INFO  [europe] Class 'E': change mastership of cluster 'e_7' (id=24) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:048 INFO  [europe] Class 'E': change mastership of cluster 'e_6' (id=23) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:048 INFO  [europe] Class 'OUser', creation of new local cluster 'ouser_0' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:053 INFO  [europe] Class 'OUser': change mastership of cluster 'ouser_0' (id=53) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:09:053 INFO  [europe] Publishing ONLINE status for database europe.distributed-basic-sharding... [ODistributedDatabaseImpl] 2016-08-11 02:10:09:053 INFO  [usa]&lt;-[europe] Received updated status europe.distributed-basic-sharding=ONLINE [OHazelcastPlugin] 2016-08-11 02:10:09:054 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=28)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+------+------+-------+ |             |    |           |          |MASTER|MASTER|MASTER | |             |    |           |          |ONLINE|ONLINE|OFFLINE| +-------------+----+-----------+----------+------+------+-------+ |CLUSTER      |  id|writeQuorum|readQuorum| usa  |europe| asia  | +-------------+----+-----------+----------+------+------+-------+ |*            |    |     2     |    1     |  X   |  o   |       | |client_asia  |    |     2     |    1     |      |      |   X   | |client_europe|    |     2     |    1     |      |  X   |       | |client_usa   |    |     2     |    1     |  X   |      |       | |customer     |  33|     2     |    1     |  o   |  X   |       | |customer_5   |  38|     2     |    1     |  o   |  X   |       | |customer_6   |  39|     2     |    1     |  o   |  X   |       | |customer_7   |  40|     2     |    1     |  o   |  X   |       | |e_4          |  21|     2     |    1     |  o   |  X   |       | |e_5          |  22|     2     |    1     |  o   |  X   |       | |e_6          |  23|     2     |    1     |  o   |  X   |       | |e_7          |  24|     2     |    1     |  o   |  X   |       | |internal     |   0|     2     |    1     |      |      |       | |ofunction_0  |  50|     2     |    1     |  o   |  X   |       | |orole_0      |  52|     2     |    1     |  o   |  X   |       | |oschedule_0  |  51|     2     |    1     |  o   |  X   |       | |osequence_0  |  49|     2     |    1     |  o   |  X   |       | |ouser_0      |  53|     2     |    1     |  o   |  X   |       | |person       |  25|     2     |    1     |  o   |  X   |       | |person_1     |  26|     2     |    1     |  o   |  X   |       | |person_6     |  31|     2     |    1     |  o   |  X   |       | |person_7     |  32|     2     |    1     |  o   |  X   |       | |provider_2   |  43|     2     |    1     |  o   |  X   |       | |provider_3   |  44|     2     |    1     |  o   |  X   |       | |provider_4   |  45|     2     |    1     |  o   |  X   |       | |provider_5   |  46|     2     |    1     |  o   |  X   |       | |v_3          |  12|     2     |    1     |  o   |  X   |       | |v_5          |  14|     2     |    1     |  o   |  X   |       | |v_6          |  15|     2     |    1     |  o   |  X   |       | |v_7          |  16|     2     |    1     |  o   |  X   |       | +-------------+----+-----------+----------+------+------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:09:054 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:09:054 INFO  [europe] Distributed servers status:  +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe*|STARTING|distributed-basic-sharding=ONLINE (MASTER)|0    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.03GB/3.56GB (28.88%)| +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:09:055 INFO  [usa]&lt;-[europe] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:09:055 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=28)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+-------+ |             |           |          |MASTER|MASTER|MASTER | |             |           |          |ONLINE|ONLINE|OFFLINE| +-------------+-----------+----------+------+------+-------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia  | +-------------+-----------+----------+------+------+-------+ |*            |     2     |    1     |  X   |  o   |       | |client_asia  |     2     |    1     |      |      |   X   | |client_europe|     2     |    1     |      |  X   |       | |client_usa   |     2     |    1     |  X   |      |       | |customer     |     2     |    1     |  o   |  X   |       | |customer_5   |     2     |    1     |  o   |  X   |       | |customer_6   |     2     |    1     |  o   |  X   |       | |customer_7   |     2     |    1     |  o   |  X   |       | |e_4          |     2     |    1     |  o   |  X   |       | |e_5          |     2     |    1     |  o   |  X   |       | |e_6          |     2     |    1     |  o   |  X   |       | |e_7          |     2     |    1     |  o   |  X   |       | |internal     |     2     |    1     |      |      |       | |ofunction_0  |     2     |    1     |  o   |  X   |       | |orole_0      |     2     |    1     |  o   |  X   |       | |oschedule_0  |     2     |    1     |  o   |  X   |       | |osequence_0  |     2     |    1     |  o   |  X   |       | |ouser_0      |     2     |    1     |  o   |  X   |       | |person       |     2     |    1     |  o   |  X   |       | |person_1     |     2     |    1     |  o   |  X   |       | |person_6     |     2     |    1     |  o   |  X   |       | |person_7     |     2     |    1     |  o   |  X   |       | |provider_2   |     2     |    1     |  o   |  X   |       | |provider_3   |     2     |    1     |  o   |  X   |       | |provider_4   |     2     |    1     |  o   |  X   |       | |provider_5   |     2     |    1     |  o   |  X   |       | |v_3          |     2     |    1     |  o   |  X   |       | |v_5          |     2     |    1     |  o   |  X   |       | |v_6          |     2     |    1     |  o   |  X   |       | |v_7          |     2     |    1     |  o   |  X   |       | +-------------+-----------+----------+------+------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:09:055 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:09:055 WARNI [europe] Updated node status to 'ONLINE' [OHazelcastPlugin] 2016-08-11 02:10:09:055 INFO  [usa] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin]Error during fuzzy checkpoint com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/dbquerytest/e_7.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicalFuzzyCheckpointTask.run(OWOWCache.java:1762)     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)     at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745)  2016-08-11 02:10:10:445 INFO  [usa] Distributed servers status:  +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status|Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe|ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.06GB/3.56GB (29.80%)| +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:10:446 INFO  [europe] Distributed servers status:  +-------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status|Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|0    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.00GB/3.56GB (28.21%)| |europe*|ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.06GB/3.56GB (29.80%)| +-------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ Starting server with serverId 2 from target/server2...  [OHazelcastPlugin] 2016-08-11 02:10:12:062 INFO  OrientDB Studio available at http://192.168.1.248:2481/studio/index.html [OServer] 2016-08-11 02:10:12:062 INFO  OrientDB Server is active v2.2.7-SNAPSHOT. [OServer] 2016-08-11 02:10:12:062 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:12:062 SEVER STARTING SERVER -&gt; 2... [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:12:062 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:12:063 INFO  Loading configuration from input stream [OServerConfigurationLoaderXml] 2016-08-11 02:10:12:078 INFO  OrientDB Server v2.2.7-SNAPSHOT is starting up... [OServer] 2016-08-11 02:10:12:078 INFO  Databases directory: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases [OServer] 2016-08-11 02:10:12:078 INFO  {db=OSystem} Creating the system database 'OSystem' for current server [OSystemDatabase] 2016-08-11 02:10:12:159 SEVER ODefaultServerSecurity.loadConfig() Could not access the security JSON file: target/server2/config/security.json [ODefaultServerSecurity] 2016-08-11 02:10:12:160 WARNI Port 0.0.0.0:2424 busy, trying the next available... [OServerNetworkListener] 2016-08-11 02:10:12:160 WARNI Port 0.0.0.0:2425 busy, trying the next available... [OServerNetworkListener] 2016-08-11 02:10:12:160 INFO  Listening binary connections on 0.0.0.0:2426 (protocol v.36, socket=default) [OServerNetworkListener] 2016-08-11 02:10:12:160 WARNI Port 0.0.0.0:2480 busy, trying the next available... [OServerNetworkListener] 2016-08-11 02:10:12:160 WARNI Port 0.0.0.0:2481 busy, trying the next available... [OServerNetworkListener] 2016-08-11 02:10:12:161 INFO  Listening http connections on 0.0.0.0:2482 (protocol v.10, socket=default) [OServerNetworkListener] 2016-08-11 02:10:12:161 WARNI Found ORIENTDB_ROOT_PASSWORD variable, using this value as root's password [OServer] 2016-08-11 02:10:12:161 WARNI onAfterDynamicPlugins() Configuration document is empty [ODefaultServerSecurity] 2016-08-11 02:10:12:161 INFO  Configuring Hazelcast from '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/src/test/resources/sharded-hazelcast.xml'. [FileSystemXmlConfig] 2016-08-11 02:10:12:163 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2016-08-11 02:10:12:170 INFO  [LOCAL] [orientdb] [3.6.3] Picked Address[127.0.0.1]:2436, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=2436], bind any local is true [DefaultAddressPicker] 2016-08-11 02:10:12:170 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Hazelcast 3.6.3 (20160527 - 08b28c3) starting at Address[127.0.0.1]:2436 [system] 2016-08-11 02:10:12:170 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Copyright (c) 2008-2016, Hazelcast, Inc. All Rights Reserved. [system] 2016-08-11 02:10:12:170 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Configured Hazelcast Serialization version : 1 [system] 2016-08-11 02:10:12:172 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Backpressure is disabled [OperationService] 2016-08-11 02:10:12:172 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Starting with 1 generic operation threads and 1 partition operation threads. [ClassicOperationExecutor] 2016-08-11 02:10:12:174 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Creating TcpIpJoiner [Node] 2016-08-11 02:10:12:174 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Address[127.0.0.1]:2436 is STARTING [LifecycleService] 2016-08-11 02:10:12:175 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] TcpIpConnectionManager configured with Non Blocking IO-threading model: 3 input threads and 3 output threads [NonBlockingIOThreadingModel] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Connecting to /127.0.0.1:2435, timeout: 0, bind-any: true [InitConnectionTask] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Connecting to /127.0.0.1:2434, timeout: 0, bind-any: true [InitConnectionTask] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Accepting socket connection from /127.0.0.1:50256 [SocketAcceptorThread] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Accepting socket connection from /127.0.0.1:50257 [SocketAcceptorThread] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3] Established socket connection between /127.0.0.1:2435 and /127.0.0.1:50256 [TcpIpConnectionManager] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Established socket connection between /127.0.0.1:2434 and /127.0.0.1:50257 [TcpIpConnectionManager] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Established socket connection between /127.0.0.1:50257 and /127.0.0.1:2434 [TcpIpConnectionManager] 2016-08-11 02:10:12:177 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Established socket connection between /127.0.0.1:50256 and /127.0.0.1:2435 [TcpIpConnectionManager] 2016-08-11 02:10:15:191 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3]   Members [3] {     Member [127.0.0.1]:2434 this     Member [127.0.0.1]:2435     Member [127.0.0.1]:2436 }  [ClusterService] 2016-08-11 02:10:15:191 WARNI [europe] Added new node id=Member [127.0.0.1]:2436 name=ext:2164a821-6c8b-4adf-84ae-7d9d773f3977 [OHazelcastPlugin] 2016-08-11 02:10:15:191 INFO  [127.0.0.1]:2435 [orientdb] [3.6.3]   Members [3] {     Member [127.0.0.1]:2434     Member [127.0.0.1]:2435 this     Member [127.0.0.1]:2436 }  [ClusterService] 2016-08-11 02:10:15:191 WARNI [usa] Added new node id=Member [127.0.0.1]:2436 name=ext:2164a821-6c8b-4adf-84ae-7d9d773f3977 [OHazelcastPlugin] 2016-08-11 02:10:15:191 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3]   Members [3] {     Member [127.0.0.1]:2434     Member [127.0.0.1]:2435     Member [127.0.0.1]:2436 this }  [ClusterService] 2016-08-11 02:10:15:446 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] Re-partitioning cluster data... Migration queue size: 90 [InternalPartitionService] 2016-08-11 02:10:16:485 INFO  [127.0.0.1]:2434 [orientdb] [3.6.3] All migration tasks have been completed, queues are empty. [InternalPartitionService] 2016-08-11 02:10:17:199 INFO  [127.0.0.1]:2436 [orientdb] [3.6.3] Address[127.0.0.1]:2436 is STARTED [LifecycleService] 2016-08-11 02:10:17:199 INFO  Starting distributed server 'asia' (hzID=2164a821-6c8b-4adf-84ae-7d9d773f3977)... [OHazelcastPlugin] 2016-08-11 02:10:17:204 INFO  [europe]&lt;-[ext:2164a821-6c8b-4adf-84ae-7d9d773f3977] Received updated about registered nodes [OHazelcastPlugin] 2016-08-11 02:10:17:204 INFO  [usa]&lt;-[ext:2164a821-6c8b-4adf-84ae-7d9d773f3977] Received updated about registered nodes [OHazelcastPlugin] 2016-08-11 02:10:17:207 INFO  [europe]&lt;-[asia] Added node configuration id=Member [127.0.0.1]:2436 name=asia, now 3 nodes are configured [OHazelcastPlugin] 2016-08-11 02:10:17:208 INFO  [usa]&lt;-[asia] Added node configuration id=Member [127.0.0.1]:2436 name=asia, now 3 nodes are configured [OHazelcastPlugin] 2016-08-11 02:10:17:208 INFO  [europe] Distributed servers status:  +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia   |STARTING|                                          |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe*|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:208 INFO  [usa] Distributed servers status:  +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia  |STARTING|                                          |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:209 INFO  [asia] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:17:210 INFO  [asia] New distributed configuration for database: distributed-basic-sharding (version=28)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+-------+ |             |           |          |MASTER|MASTER|MASTER | |             |           |          |ONLINE|ONLINE|OFFLINE| +-------------+-----------+----------+------+------+-------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia  | +-------------+-----------+----------+------+------+-------+ |*            |     2     |    1     |  X   |  o   |       | |client_asia  |     2     |    1     |      |      |   X   | |client_europe|     2     |    1     |      |  X   |       | |client_usa   |     2     |    1     |  X   |      |       | |customer     |     2     |    1     |  o   |  X   |       | |customer_5   |     2     |    1     |  o   |  X   |       | |customer_6   |     2     |    1     |  o   |  X   |       | |customer_7   |     2     |    1     |  o   |  X   |       | |e_4          |     2     |    1     |  o   |  X   |       | |e_5          |     2     |    1     |  o   |  X   |       | |e_6          |     2     |    1     |  o   |  X   |       | |e_7          |     2     |    1     |  o   |  X   |       | |internal     |     2     |    1     |      |      |       | |ofunction_0  |     2     |    1     |  o   |  X   |       | |orole_0      |     2     |    1     |  o   |  X   |       | |oschedule_0  |     2     |    1     |  o   |  X   |       | |osequence_0  |     2     |    1     |  o   |  X   |       | |ouser_0      |     2     |    1     |  o   |  X   |       | |person       |     2     |    1     |  o   |  X   |       | |person_1     |     2     |    1     |  o   |  X   |       | |person_6     |     2     |    1     |  o   |  X   |       | |person_7     |     2     |    1     |  o   |  X   |       | |provider_2   |     2     |    1     |  o   |  X   |       | |provider_3   |     2     |    1     |  o   |  X   |       | |provider_4   |     2     |    1     |  o   |  X   |       | |provider_5   |     2     |    1     |  o   |  X   |       | |v_3          |     2     |    1     |  o   |  X   |       | |v_5          |     2     |    1     |  o   |  X   |       | |v_6          |     2     |    1     |  o   |  X   |       | |v_7          |     2     |    1     |  o   |  X   |       | +-------------+-----------+----------+------+------+-------+   [OHazelcastPlugin] 2016-08-11 02:10:17:210 INFO  [asia] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:211 INFO  [asia] Distributed servers status:  +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa   |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia* |STARTING|                                          |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:212 INFO  [asia] Adding node 'asia' in partition: distributed-basic-sharding db=[*, person_6, person, person_7, person_1, customer_6, customer_5, customer_7, customer, osequence_0, provider_4, provider_5, provider_2, provider_3, ofunction_0, oschedule_0, v_3, v_6, v_5, v_7, orole_0, e_5, e_4, e_7, e_6, ouser_0] v=29 [ODistributedDatabaseImpl$1] 2016-08-11 02:10:17:212 INFO  [usa]&lt;-[asia] Received new status asia.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:17:212 INFO  [europe]&lt;-[asia] Received new status asia.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:17:212 INFO  [asia] New distributed configuration for database: distributed-basic-sharding (version=29)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+-------------+ |             |           |          |MASTER|MASTER|   MASTER    | |             |           |          |ONLINE|ONLINE|SYNCHRONIZING| +-------------+-----------+----------+------+------+-------------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe|    asia     | +-------------+-----------+----------+------+------+-------------+ |*            |     2     |    1     |  X   |  o   |      o      | |client_asia  |     2     |    1     |      |      |      X      | |client_europe|     2     |    1     |      |  X   |             | |client_usa   |     2     |    1     |  X   |      |             | |customer     |     2     |    1     |  o   |  X   |      o      | |customer_5   |     2     |    1     |  o   |  X   |      o      | |customer_6   |     2     |    1     |  o   |  X   |      o      | |customer_7   |     2     |    1     |  o   |  X   |      o      | |e_4          |     2     |    1     |  o   |  X   |      o      | |e_5          |     2     |    1     |  o   |  X   |      o      | |e_6          |     2     |    1     |  o   |  X   |      o      | |e_7          |     2     |    1     |  o   |  X   |      o      | |internal     |     2     |    1     |      |      |             | |ofunction_0  |     2     |    1     |  o   |  X   |      o      | |orole_0      |     2     |    1     |  o   |  X   |      o      | |oschedule_0  |     2     |    1     |  o   |  X   |      o      | |osequence_0  |     2     |    1     |  o   |  X   |      o      | |ouser_0      |     2     |    1     |  o   |  X   |      o      | |person       |     2     |    1     |  o   |  X   |      o      | |person_1     |     2     |    1     |  o   |  X   |      o      | |person_6     |     2     |    1     |  o   |  X   |      o      | |person_7     |     2     |    1     |  o   |  X   |      o      | |provider_2   |     2     |    1     |  o   |  X   |      o      | |provider_3   |     2     |    1     |  o   |  X   |      o      | |provider_4   |     2     |    1     |  o   |  X   |      o      | |provider_5   |     2     |    1     |  o   |  X   |      o      | |v_3          |     2     |    1     |  o   |  X   |      o      | |v_5          |     2     |    1     |  o   |  X   |      o      | |v_6          |     2     |    1     |  o   |  X   |      o      | |v_7          |     2     |    1     |  o   |  X   |      o      | +-------------+-----------+----------+------+------+-------------+   [OHazelcastPlugin] 2016-08-11 02:10:17:212 INFO  [asia] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:213 INFO  [europe]&lt;-[asia] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:17:213 INFO  [usa]&lt;-[asia] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:17:214 WARNI [asia]-&gt;[[usa]] Requesting deploy of database 'distributed-basic-sharding' on local server... [OHazelcastPlugin] 2016-08-11 02:10:17:214 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=29)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+-------------+ |             |           |          |MASTER|MASTER|   MASTER    | |             |           |          |ONLINE|ONLINE|SYNCHRONIZING| +-------------+-----------+----------+------+------+-------------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe|    asia     | +-------------+-----------+----------+------+------+-------------+ |*            |     2     |    1     |  X   |  o   |      o      | |client_asia  |     2     |    1     |      |      |      X      | |client_europe|     2     |    1     |      |  X   |             | |client_usa   |     2     |    1     |  X   |      |             | |customer     |     2     |    1     |  o   |  X   |      o      | |customer_5   |     2     |    1     |  o   |  X   |      o      | |customer_6   |     2     |    1     |  o   |  X   |      o      | |customer_7   |     2     |    1     |  o   |  X   |      o      | |e_4          |     2     |    1     |  o   |  X   |      o      | |e_5          |     2     |    1     |  o   |  X   |      o      | |e_6          |     2     |    1     |  o   |  X   |      o      | |e_7          |     2     |    1     |  o   |  X   |      o      | |internal     |     2     |    1     |      |      |             | |ofunction_0  |     2     |    1     |  o   |  X   |      o      | |orole_0      |     2     |    1     |  o   |  X   |      o      | |oschedule_0  |     2     |    1     |  o   |  X   |      o      | |osequence_0  |     2     |    1     |  o   |  X   |      o      | |ouser_0      |     2     |    1     |  o   |  X   |      o      | |person       |     2     |    1     |  o   |  X   |      o      | |person_1     |     2     |    1     |  o   |  X   |      o      | |person_6     |     2     |    1     |  o   |  X   |      o      | |person_7     |     2     |    1     |  o   |  X   |      o      | |provider_2   |     2     |    1     |  o   |  X   |      o      | |provider_3   |     2     |    1     |  o   |  X   |      o      | |provider_4   |     2     |    1     |  o   |  X   |      o      | |provider_5   |     2     |    1     |  o   |  X   |      o      | |v_3          |     2     |    1     |  o   |  X   |      o      | |v_5          |     2     |    1     |  o   |  X   |      o      | |v_6          |     2     |    1     |  o   |  X   |      o      | |v_7          |     2     |    1     |  o   |  X   |      o      | +-------------+-----------+----------+------+------+-------------+   [OHazelcastPlugin] 2016-08-11 02:10:17:214 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:214 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=29)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+-------------+ |             |           |          |MASTER|MASTER|   MASTER    | |             |           |          |ONLINE|ONLINE|SYNCHRONIZING| +-------------+-----------+----------+------+------+-------------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe|    asia     | +-------------+-----------+----------+------+------+-------------+ |*            |     2     |    1     |  X   |  o   |      o      | |client_asia  |     2     |    1     |      |      |      X      | |client_europe|     2     |    1     |      |  X   |             | |client_usa   |     2     |    1     |  X   |      |             | |customer     |     2     |    1     |  o   |  X   |      o      | |customer_5   |     2     |    1     |  o   |  X   |      o      | |customer_6   |     2     |    1     |  o   |  X   |      o      | |customer_7   |     2     |    1     |  o   |  X   |      o      | |e_4          |     2     |    1     |  o   |  X   |      o      | |e_5          |     2     |    1     |  o   |  X   |      o      | |e_6          |     2     |    1     |  o   |  X   |      o      | |e_7          |     2     |    1     |  o   |  X   |      o      | |internal     |     2     |    1     |      |      |             | |ofunction_0  |     2     |    1     |  o   |  X   |      o      | |orole_0      |     2     |    1     |  o   |  X   |      o      | |oschedule_0  |     2     |    1     |  o   |  X   |      o      | |osequence_0  |     2     |    1     |  o   |  X   |      o      | |ouser_0      |     2     |    1     |  o   |  X   |      o      | |person       |     2     |    1     |  o   |  X   |      o      | |person_1     |     2     |    1     |  o   |  X   |      o      | |person_6     |     2     |    1     |  o   |  X   |      o      | |person_7     |     2     |    1     |  o   |  X   |      o      | |provider_2   |     2     |    1     |  o   |  X   |      o      | |provider_3   |     2     |    1     |  o   |  X   |      o      | |provider_4   |     2     |    1     |  o   |  X   |      o      | |provider_5   |     2     |    1     |  o   |  X   |      o      | |v_3          |     2     |    1     |  o   |  X   |      o      | |v_5          |     2     |    1     |  o   |  X   |      o      | |v_6          |     2     |    1     |  o   |  X   |      o      | |v_7          |     2     |    1     |  o   |  X   |      o      | +-------------+-----------+----------+------+------+-------------+   [OHazelcastPlugin] 2016-08-11 02:10:17:214 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:214 INFO  [europe] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:17:214 INFO  [usa] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [usa]-&gt;[asia] Deploying database distributed-basic-sharding... [OSyncDatabaseTask] 2016-08-11 02:10:17:215 INFO  [europe]&lt;-[usa] Received updated status asia.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [usa] Received updated status asia.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [europe]&lt;-[usa] Received updated status usa.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [europe] Distributed servers status:  +-------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status  |Databases                                        |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE  |distributed-basic-sharding=SYNCHRONIZING (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia   |STARTING|                                                 |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe*|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)       |2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +-------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [usa] Distributed servers status:  +------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                        |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE  |distributed-basic-sharding=SYNCHRONIZING (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia  |STARTING|                                                 |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)       |2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +------+--------+-------------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [usa] Received updated status usa.distributed-basic-sharding=SYNCHRONIZING [OHazelcastPlugin] 2016-08-11 02:10:17:215 INFO  [usa]-&gt;[asia] Creating backup of database 'distributed-basic-sharding' (compressionRate=7) in directory: /var/folders/zc/y34429014c3bt_x1587qblth0000gn/T/orientdb/backup_distributed-basic-sharding.zip. LSN=OLogSequenceNumber{segment=0, position=933279}... [OSyncDatabaseTask] 2016-08-11 02:10:17:337 INFO  [usa]-&gt;[asia] Backup of database 'distributed-basic-sharding' completed. lastOperationId=2.0... [OSyncDatabaseTask$1] 2016-08-11 02:10:17:519 INFO  [usa]-&gt;[asia] - transferring chunk #1 offset=0 size=56589... [OSyncDatabaseTask] 2016-08-11 02:10:17:520 INFO  [usa] Received updated status usa.distributed-basic-sharding=ONLINE [OHazelcastPlugin] 2016-08-11 02:10:17:520 INFO  [europe]&lt;-[usa] Received updated status usa.distributed-basic-sharding=ONLINE [OHazelcastPlugin] 2016-08-11 02:10:17:521 INFO  [europe] Distributed servers status:  +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia   |STARTING|                                          |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe*|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +-------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:521 INFO  [usa] Distributed servers status:  +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status  |Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia  |STARTING|                                          |0    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.12GB/3.56GB (31.62%)| |europe|ONLINE  |distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +------+--------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:17:521 INFO  [usa]-&gt;[asia] Deploy database task completed [OSyncDatabaseTask] 2016-08-11 02:10:17:524 WARNI [asia] Saving clusters [client_asia] to directory 'target/server2/temp/db_distributed-basic-sharding' to be replaced after distributed full backup... [OHazelcastPlugin] 2016-08-11 02:10:17:525 WARNI [asia] Moving existent database 'distributed-basic-sharding' in '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding' to '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases//../backup/databases/distributed-basic-sharding' and get a fresh copy from a remote node... [OHazelcastPlugin] 2016-08-11 02:10:17:525 SEVER [asia] Error on moving existent database 'distributed-basic-sharding' located in '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding' to '/Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/../backup/databases/distributed-basic-sharding'. Deleting old database... [OHazelcastPlugin] 2016-08-11 02:10:17:525 INFO  [asia]&lt;-[usa] Copying remote database 'distributed-basic-sharding' to: /var/folders/zc/y34429014c3bt_x1587qblth0000gn/T//orientdb/install_distributed-basic-sharding.zip [OHazelcastPlugin] 2016-08-11 02:10:17:525 INFO  [asia]&lt;-[usa] Installing database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding... [OHazelcastPlugin] 2016-08-11 02:10:17:526 INFO  [asia] - writing chunk #1 offset=0 size=55.26KB [OHazelcastPlugin] 2016-08-11 02:10:17:526 INFO  [asia] Database copied correctly, size=55.26KB [ODistributedAbstractPlugin$3] 2016-08-11 02:10:17:624 WARNI {db=distributed-basic-sharding} Storage 'distributed-basic-sharding' was not closed properly. Will try to recover from write ahead log [OLocalPaginatedStorage] 2016-08-11 02:10:17:624 SEVER {db=distributed-basic-sharding} Restore is not possible because write ahead log is empty. [OLocalPaginatedStorage] 2016-08-11 02:10:17:624 INFO  {db=distributed-basic-sharding} Storage data recover was completed [OLocalPaginatedStorage] 2016-08-11 02:10:17:642 INFO  {db=distributed-basic-sharding} [asia] Installed database 'distributed-basic-sharding' (LSN=OLogSequenceNumber{segment=0, position=24}) [OHazelcastPlugin] 2016-08-11 02:10:17:647 INFO  [asia] Reassigning cluster ownership for database distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:17:647 INFO  [asia] New distributed configuration for database: distributed-basic-sharding (version=29)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+------+------+-------------+ |             |    |           |          |MASTER|MASTER|   MASTER    | |             |    |           |          |ONLINE|ONLINE|SYNCHRONIZING| +-------------+----+-----------+----------+------+------+-------------+ |CLUSTER      |  id|writeQuorum|readQuorum| usa  |europe|    asia     | +-------------+----+-----------+----------+------+------+-------------+ |*            |    |     2     |    1     |  X   |  o   |      o      | |client_asia  |    |     2     |    1     |      |      |      X      | |client_europe|    |     2     |    1     |      |  X   |             | |client_usa   |    |     2     |    1     |  X   |      |             | |customer     |  33|     2     |    1     |  o   |  X   |      o      | |customer_5   |  38|     2     |    1     |  o   |  X   |      o      | |customer_6   |  39|     2     |    1     |  o   |  X   |      o      | |customer_7   |  40|     2     |    1     |  o   |  X   |      o      | |e_4          |  21|     2     |    1     |  o   |  X   |      o      | |e_5          |  22|     2     |    1     |  o   |  X   |      o      | |e_6          |  23|     2     |    1     |  o   |  X   |      o      | |e_7          |  24|     2     |    1     |  o   |  X   |      o      | |internal     |   0|     2     |    1     |      |      |             | |ofunction_0  |  50|     2     |    1     |  o   |  X   |      o      | |orole_0      |  52|     2     |    1     |  o   |  X   |      o      | |oschedule_0  |  51|     2     |    1     |  o   |  X   |      o      | |osequence_0  |  49|     2     |    1     |  o   |  X   |      o      | |ouser_0      |  53|     2     |    1     |  o   |  X   |      o      | |person       |  25|     2     |    1     |  o   |  X   |      o      | |person_1     |  26|     2     |    1     |  o   |  X   |      o      | |person_6     |  31|     2     |    1     |  o   |  X   |      o      | |person_7     |  32|     2     |    1     |  o   |  X   |      o      | |provider_2   |  43|     2     |    1     |  o   |  X   |      o      | |provider_3   |  44|     2     |    1     |  o   |  X   |      o      | |provider_4   |  45|     2     |    1     |  o   |  X   |      o      | |provider_5   |  46|     2     |    1     |  o   |  X   |      o      | |v_3          |  12|     2     |    1     |  o   |  X   |      o      | |v_5          |  14|     2     |    1     |  o   |  X   |      o      | |v_6          |  15|     2     |    1     |  o   |  X   |      o      | |v_7          |  16|     2     |    1     |  o   |  X   |      o      | +-------------+----+-----------+----------+------+------+-------------+   [OHazelcastPlugin] 2016-08-11 02:10:17:648 INFO  [asia] Class 'Provider': change mastership of cluster 'provider_1' (id=42) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:648 INFO  [asia] Class 'Provider': change mastership of cluster 'provider_3' (id=44) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:648 INFO  [asia] Class 'V': change mastership of cluster 'v_4' (id=13) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:648 INFO  [asia] Class 'V': change mastership of cluster 'v_7' (id=16) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:649 INFO  [asia] Class 'Customer': change mastership of cluster 'customer_3' (id=36) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:649 INFO  [asia] Class 'Customer': change mastership of cluster 'customer' (id=33) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:650 INFO  [asia] Class 'OSchedule', creation of new local cluster 'oschedule_1' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:658 INFO  [asia] Class 'OSchedule': change mastership of cluster 'oschedule_1' (id=54) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:658 INFO  [asia] Class 'OUser', creation of new local cluster 'ouser_1' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:667 INFO  [asia] Class 'OUser': change mastership of cluster 'ouser_1' (id=55) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:667 INFO  [asia] Class 'ORole', creation of new local cluster 'orole_1' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:672 INFO  [asia] Class 'ORole': change mastership of cluster 'orole_1' (id=56) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:672 INFO  [asia] Class 'OSequence', creation of new local cluster 'osequence_1' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:676 INFO  [asia] Class 'OSequence': change mastership of cluster 'osequence_1' (id=57) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:676 INFO  [asia] Class 'Person': change mastership of cluster 'person_3' (id=28) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:676 INFO  [asia] Class 'Person': change mastership of cluster 'person_1' (id=26) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:676 INFO  [asia] Class 'E': change mastership of cluster 'e_2' (id=19) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:676 INFO  [asia] Class 'E': change mastership of cluster 'e_6' (id=23) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:676 INFO  [asia] Class 'OFunction', creation of new local cluster 'ofunction_1' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:681 INFO  [asia] Class 'OFunction': change mastership of cluster 'ofunction_1' (id=58) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:17:681 INFO  [asia] Publishing ONLINE status for database asia.distributed-basic-sharding... [ODistributedDatabaseImpl] 2016-08-11 02:10:17:682 INFO  [usa]&lt;-[asia] Received updated status asia.distributed-basic-sharding=ONLINE [OHazelcastPlugin] 2016-08-11 02:10:17:682 INFO  [europe]&lt;-[asia] Received updated status asia.distributed-basic-sharding=ONLINE [OHazelcastPlugin] 2016-08-11 02:10:17:682 INFO  [asia] New distributed configuration for database: distributed-basic-sharding (version=44)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+------+------+------+ |             |    |           |          |MASTER|MASTER|MASTER| |             |    |           |          |ONLINE|ONLINE|ONLINE| +-------------+----+-----------+----------+------+------+------+ |CLUSTER      |  id|writeQuorum|readQuorum| usa  |europe| asia | +-------------+----+-----------+----------+------+------+------+ |*            |    |     2     |    1     |  X   |  o   |  o   | |client_asia  |    |     2     |    1     |      |      |  X   | |client_europe|    |     2     |    1     |      |  X   |      | |client_usa   |    |     2     |    1     |  X   |      |      | |customer     |  33|     2     |    1     |  o   |  o   |  X   | |customer_3   |  36|     2     |    1     |  o   |  o   |  X   | |customer_5   |  38|     2     |    1     |  o   |  X   |  o   | |customer_6   |  39|     2     |    1     |  o   |  X   |  o   | |customer_7   |  40|     2     |    1     |  o   |  X   |  o   | |e_2          |  19|     2     |    1     |  o   |  o   |  X   | |e_4          |  21|     2     |    1     |  o   |  X   |  o   | |e_5          |  22|     2     |    1     |  o   |  X   |  o   | |e_6          |  23|     2     |    1     |  o   |  o   |  X   | |e_7          |  24|     2     |    1     |  o   |  X   |  o   | |internal     |   0|     2     |    1     |      |      |      | |ofunction_0  |  50|     2     |    1     |  o   |  X   |  o   | |ofunction_1  |  58|     2     |    1     |  o   |  o   |  X   | |orole_0      |  52|     2     |    1     |  o   |  X   |  o   | |orole_1      |  56|     2     |    1     |  o   |  o   |  X   | |oschedule_0  |  51|     2     |    1     |  o   |  X   |  o   | |oschedule_1  |  54|     2     |    1     |  o   |  o   |  X   | |osequence_0  |  49|     2     |    1     |  o   |  X   |  o   | |osequence_1  |  57|     2     |    1     |  o   |  o   |  X   | |ouser_0      |  53|     2     |    1     |  o   |  X   |  o   | |ouser_1      |  55|     2     |    1     |  o   |  o   |  X   | |person       |  25|     2     |    1     |  o   |  X   |  o   | |person_1     |  26|     2     |    1     |  o   |  o   |  X   | |person_3     |  28|     2     |    1     |  o   |  o   |  X   | |person_6     |  31|     2     |    1     |  o   |  X   |  o   | |person_7     |  32|     2     |    1     |  o   |  X   |  o   | |provider_1   |  42|     2     |    1     |  o   |  o   |  X   | |provider_2   |  43|     2     |    1     |  o   |  X   |  o   | |provider_3   |  44|     2     |    1     |  o   |  o   |  X   | |provider_4   |  45|     2     |    1     |  o   |  X   |  o   | |provider_5   |  46|     2     |    1     |  o   |  X   |  o   | |v_3          |  12|     2     |    1     |  o   |  X   |  o   | |v_4          |  13|     2     |    1     |  o   |  o   |  X   | |v_5          |  14|     2     |    1     |  o   |  X   |  o   | |v_6          |  15|     2     |    1     |  o   |  X   |  o   | |v_7          |  16|     2     |    1     |  o   |  o   |  X   | +-------------+----+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:17:682 INFO  [asia] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:683 INFO  [europe]&lt;-[asia] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:17:683 INFO  [usa]&lt;-[asia] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:17:684 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=44)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:17:684 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=44)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:17:684 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:684 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:17:684 WARNI [asia] Updated node status to 'ONLINE' [OHazelcastPlugin] 2016-08-11 02:10:17:684 INFO  [usa] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:17:684 INFO  [europe] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:17:686 INFO  [asia] Distributed servers status:  +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status|Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa   |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia* |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|4    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.17GB/3.56GB (32.79%)| |europe|ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:19:064 INFO  [europe] Distributed servers status:  +-------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name   |Status|Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +-------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa    |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia   |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|4    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.17GB/3.56GB (32.79%)| |europe*|ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +-------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:19:064 INFO  [usa] Distributed servers status:  +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |Name  |Status|Databases                                 |Conns|StartedOn|Binary            |HTTP              |UsedMemory            | +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+ |usa*  |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:09:59 |192.168.1.248:2424|192.168.1.248:2480|1.10GB/3.56GB (30.93%)| |asia  |ONLINE|distributed-basic-sharding=ONLINE (MASTER)|4    |02:10:12 |192.168.1.248:2426|192.168.1.248:2482|1.17GB/3.56GB (32.79%)| |europe|ONLINE|distributed-basic-sharding=ONLINE (MASTER)|2    |02:10:03 |192.168.1.248:2425|192.168.1.248:2481|1.10GB/3.56GB (30.89%)| +------+------+------------------------------------------+-----+---------+------------------+------------------+----------------------+  [OHazelcastPlugin] 2016-08-11 02:10:20:692 INFO  OrientDB Studio available at http://192.168.1.248:2482/studio/index.html [OServer] 2016-08-11 02:10:20:692 INFO  OrientDB Server is active v2.2.7-SNAPSHOT. [OServer] 2016-08-11 02:10:20:692 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:20:692 SEVER Executing test... [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:20:692 SEVER ********************************************************************************************************** [BasicShardingNoReplicaScenarioTest] 2016-08-11 02:10:20:692 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=45)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:20:692 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:20:694 INFO  [europe]&lt;-[usa] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:20:694 INFO  [asia]&lt;-[usa] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:20:694 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=45)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:20:694 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:20:694 INFO  [asia] New distributed configuration for database: distributed-basic-sharding (version=45)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:20:694 INFO  [asia] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:20:695 INFO  [europe] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:20:695 INFO  [asia] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:20:703 INFO  [usa] Class 'Client', creation of new local cluster 'client_0' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:20:708 INFO  [usa] Class 'Client': change mastership of cluster 'client_0' (id=60) to node 'asia' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:20:708 INFO  [usa] Class 'Client', creation of new local cluster 'client_1' (id=-1) [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:20:711 INFO  [usa] Class 'Client': change mastership of cluster 'client_1' (id=61) to node 'europe' [ODefaultClusterOwnershipAssignmentStrategy] 2016-08-11 02:10:20:712 INFO  [usa] New distributed configuration for database: distributed-basic-sharding (version=47)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+----+-----------+----------+------+------+------+ |             |    |           |          |MASTER|MASTER|MASTER| |             |    |           |          |ONLINE|ONLINE|ONLINE| +-------------+----+-----------+----------+------+------+------+ |CLUSTER      |  id|writeQuorum|readQuorum| usa  |europe| asia | +-------------+----+-----------+----------+------+------+------+ |*            |    |     2     |    1     |  X   |  o   |  o   | |client_0     |  60|     2     |    1     |  o   |  o   |  X   | |client_1     |  61|     2     |    1     |  o   |  X   |  o   | |client_asia  |    |     2     |    1     |      |      |  X   | |client_europe|    |     2     |    1     |      |  X   |      | |client_usa   |    |     2     |    1     |  X   |      |      | |customer     |  33|     2     |    1     |  o   |  o   |  X   | |customer_3   |  36|     2     |    1     |  o   |  o   |  X   | |customer_5   |  38|     2     |    1     |  o   |  X   |  o   | |customer_6   |  39|     2     |    1     |  o   |  X   |  o   | |customer_7   |  40|     2     |    1     |  o   |  X   |  o   | |e_2          |  19|     2     |    1     |  o   |  o   |  X   | |e_4          |  21|     2     |    1     |  o   |  X   |  o   | |e_5          |  22|     2     |    1     |  o   |  X   |  o   | |e_6          |  23|     2     |    1     |  o   |  o   |  X   | |e_7          |  24|     2     |    1     |  o   |  X   |  o   | |internal     |   0|     2     |    1     |      |      |      | |ofunction_0  |  50|     2     |    1     |  o   |  X   |  o   | |ofunction_1  |  58|     2     |    1     |  o   |  o   |  X   | |orole_0      |  52|     2     |    1     |  o   |  X   |  o   | |orole_1      |  56|     2     |    1     |  o   |  o   |  X   | |oschedule_0  |  51|     2     |    1     |  o   |  X   |  o   | |oschedule_1  |  54|     2     |    1     |  o   |  o   |  X   | |osequence_0  |  49|     2     |    1     |  o   |  X   |  o   | |osequence_1  |  57|     2     |    1     |  o   |  o   |  X   | |ouser_0      |  53|     2     |    1     |  o   |  X   |  o   | |ouser_1      |  55|     2     |    1     |  o   |  o   |  X   | |person       |  25|     2     |    1     |  o   |  X   |  o   | |person_1     |  26|     2     |    1     |  o   |  o   |  X   | |person_3     |  28|     2     |    1     |  o   |  o   |  X   | |person_6     |  31|     2     |    1     |  o   |  X   |  o   | |person_7     |  32|     2     |    1     |  o   |  X   |  o   | |provider_1   |  42|     2     |    1     |  o   |  o   |  X   | |provider_2   |  43|     2     |    1     |  o   |  X   |  o   | |provider_3   |  44|     2     |    1     |  o   |  o   |  X   | |provider_4   |  45|     2     |    1     |  o   |  X   |  o   | |provider_5   |  46|     2     |    1     |  o   |  X   |  o   | |v_3          |  12|     2     |    1     |  o   |  X   |  o   | |v_4          |  13|     2     |    1     |  o   |  o   |  X   | |v_5          |  14|     2     |    1     |  o   |  X   |  o   | |v_6          |  15|     2     |    1     |  o   |  X   |  o   | |v_7          |  16|     2     |    1     |  o   |  o   |  X   | +-------------+----+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:20:712 INFO  [usa] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:20:713 INFO  [europe]&lt;-[usa] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:20:713 INFO  [asia]&lt;-[usa] Updated configuration db=distributed-basic-sharding [OHazelcastPlugin] 2016-08-11 02:10:20:713 INFO  [europe] New distributed configuration for database: distributed-basic-sharding (version=47)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_0     |     2     |    1     |  o   |  o   |  X   | |client_1     |     2     |    1     |  o   |  X   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:20:713 INFO  [europe] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:20:713 INFO  [asia] New distributed configuration for database: distributed-basic-sharding (version=47)  CLUSTER CONFIGURATION (LEGEND: X = Owner, o = Copy) +-------------+-----------+----------+------+------+------+ |             |           |          |MASTER|MASTER|MASTER| |             |           |          |ONLINE|ONLINE|ONLINE| +-------------+-----------+----------+------+------+------+ |CLUSTER      |writeQuorum|readQuorum| usa  |europe| asia | +-------------+-----------+----------+------+------+------+ |*            |     2     |    1     |  X   |  o   |  o   | |client_0     |     2     |    1     |  o   |  o   |  X   | |client_1     |     2     |    1     |  o   |  X   |  o   | |client_asia  |     2     |    1     |      |      |  X   | |client_europe|     2     |    1     |      |  X   |      | |client_usa   |     2     |    1     |  X   |      |      | |customer     |     2     |    1     |  o   |  o   |  X   | |customer_3   |     2     |    1     |  o   |  o   |  X   | |customer_5   |     2     |    1     |  o   |  X   |  o   | |customer_6   |     2     |    1     |  o   |  X   |  o   | |customer_7   |     2     |    1     |  o   |  X   |  o   | |e_2          |     2     |    1     |  o   |  o   |  X   | |e_4          |     2     |    1     |  o   |  X   |  o   | |e_5          |     2     |    1     |  o   |  X   |  o   | |e_6          |     2     |    1     |  o   |  o   |  X   | |e_7          |     2     |    1     |  o   |  X   |  o   | |internal     |     2     |    1     |      |      |      | |ofunction_0  |     2     |    1     |  o   |  X   |  o   | |ofunction_1  |     2     |    1     |  o   |  o   |  X   | |orole_0      |     2     |    1     |  o   |  X   |  o   | |orole_1      |     2     |    1     |  o   |  o   |  X   | |oschedule_0  |     2     |    1     |  o   |  X   |  o   | |oschedule_1  |     2     |    1     |  o   |  o   |  X   | |osequence_0  |     2     |    1     |  o   |  X   |  o   | |osequence_1  |     2     |    1     |  o   |  o   |  X   | |ouser_0      |     2     |    1     |  o   |  X   |  o   | |ouser_1      |     2     |    1     |  o   |  o   |  X   | |person       |     2     |    1     |  o   |  X   |  o   | |person_1     |     2     |    1     |  o   |  o   |  X   | |person_3     |     2     |    1     |  o   |  o   |  X   | |person_6     |     2     |    1     |  o   |  X   |  o   | |person_7     |     2     |    1     |  o   |  X   |  o   | |provider_1   |     2     |    1     |  o   |  o   |  X   | |provider_2   |     2     |    1     |  o   |  X   |  o   | |provider_3   |     2     |    1     |  o   |  o   |  X   | |provider_4   |     2     |    1     |  o   |  X   |  o   | |provider_5   |     2     |    1     |  o   |  X   |  o   | |v_3          |     2     |    1     |  o   |  X   |  o   | |v_4          |     2     |    1     |  o   |  o   |  X   | |v_5          |     2     |    1     |  o   |  X   |  o   | |v_6          |     2     |    1     |  o   |  X   |  o   | |v_7          |     2     |    1     |  o   |  o   |  X   | +-------------+-----------+----------+------+------+------+   [OHazelcastPlugin] 2016-08-11 02:10:20:713 INFO  [asia] Saving distributed configuration file for database 'distributed-basic-sharding' to: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server2/databases/distributed-basic-sharding/distributed-config.json [OHazelcastPlugin] 2016-08-11 02:10:20:714 INFO  [europe] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin] 2016-08-11 02:10:20:714 INFO  [asia] Current node started as MASTER for database 'distributed-basic-sharding' [OHazelcastPlugin]Error during fuzzy checkpoint com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/distributed-freeze1node/e_7.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$PeriodicalFuzzyCheckpointTask.run(OWOWCache.java:1762)     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)     at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745) Creating Writers threads... ``` </body>
		<created>2016-08-11 07:11:55</created>
		<closed>2016-10-03 22:39:14</closed>
	</bug>
	<bug>
		<id>6542</id>
		<title>NPE in ODatabaseDocumentTx.open() after index  being restored</title>
		<body>v 2.2.3  DB was stopped during tests, all indexes restored successfully, but during open it throws NPE  Problem is, that OAbstractPaginatedStorage.indexEngines array was changed, and OIndexOneValue.indexId field is invalid  Index instance was returned from OIndexManagerShared.classPropertyIndex, it seems not to be updated during db restore   Error on using index OUser.name in query 'select from OUser where name = ? limit 1'. Probably you need to rebuild indexes. Now executing query using cluster scan java.lang.NullPointerException     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doGetIndexValue(OAbstractPaginatedStorage.java:1820)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getIndexValue(OAbstractPaginatedStorage.java:1809)     at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:55)     at com.orientechnologies.orient.core.index.OIndexOneValue.get(OIndexOneValue.java:39)     at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.get(OIndexAbstractDelegate.java:59)     at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:261)     at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.get(OIndexTxAwareOneValue.java:41)     at com.orientechnologies.orient.core.sql.operator.OQueryOperatorEquals.executeIndexQuery(OQueryOperatorEquals.java:156)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchForIndexes(OCommandExecutorSQLSelect.java:2213)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchInClasses(OCommandExecutorSQLSelect.java:994)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.assignTarget(OCommandExecutorSQLResultsetAbstract.java:202)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.assignTarget(OCommandExecutorSQLSelect.java:515)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:497)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:473)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2577)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2523)     at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78)     at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74)     at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:85)     at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)     at com.orientechnologies.orient.core.metadata.security.OSecurityShared.getUser(OSecurityShared.java:608)     at com.orientechnologies.orient.core.metadata.security.OSecurityExternal.getUser(OSecurityExternal.java:94)     at com.orientechnologies.orient.core.metadata.security.OSecurityShared.authenticate(OSecurityShared.java:235)     at com.orientechnologies.orient.core.metadata.security.OSecurityExternal.authenticate(OSecurityExternal.java:62)     at com.orientechnologies.orient.core.metadata.security.OSecurityProxy.authenticate(OSecurityProxy.java:107)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:249) </body>
		<created>2016-08-10 11:34:07</created>
		<closed>2017-01-18 12:04:34</closed>
	</bug>
	<bug>
		<id>6537</id>
		<title>OIndexTxAware* search for records, changed inside transaction, dont follow index definition</title>
		<body>v 2.2.3  OIndexTxAware dont use underlying delegate (real) index to search inside transaction changes, only simple indexChanges.getChangesPerKey(key) is used  As a result, it is impossible to search for substrings, *, use collated search etc </body>
		<created>2016-08-08 14:35:30</created>
		<closed>2016-09-28 09:17:36</closed>
	</bug>
	<bug>
		<id>6535</id>
		<title>Prepared statement with named parameter at EXPAND function not returning the expected results</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[x] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I am using OrientDB 2.2.6 (plocal) I tried to execute a statement like 'SELECT EXPAND(out("Test_EClass")[Field1 = :param]) FROM Test_VClass' where: - Test_VClass is a class extending 'V' - Test_EClass is a class extending 'E' - Field1 is a field of the target Vertex of the 'Test_EClass'   But no data were returned even though there should be some data returned by the query. I tried to execute the same statement by replacing the named parameter with an actual value and the correct results were returned by the query. ## Steps to reproduce the problem  Execute the following java code:  ``` Map&lt;String, String&gt; params = new HashMap&lt;&gt;(); params.put("param", "some_value"); String selectQuery = "SELECT EXPAND(out(\"Test_EClass\")[Field1 = :param]) FROM Test_VClass"; Iterable&lt;Vertex&gt; results = connection.command(new OSQLSynchQuery&lt;&gt;(selectQuery)).execute(params); ``` </body>
		<created>2016-08-06 10:01:50</created>
		<closed>2016-08-09 13:28:14</closed>
	</bug>
	<bug>
		<id>6533</id>
		<title>Distributed delta-sync random errors</title>
		<body>I see this randomly, like 1 every 20 runs:  ``` 2016-08-05 01:32:36:474 INFO  [europe1] Database copied correctly, size=18.52MB [ODistributedAbstractPlugin$3][europe1]&lt;-[europe0] Error on installing database delta 'platform' on local server com.orientechnologies.orient.core.exception.ODatabaseException: RecordId cannot support cluster id major than 32767. Found: 761673315     DB name="platform"     at com.orientechnologies.orient.core.id.ORecordId.checkClusterLimits(ORecordId.java:338)     at com.orientechnologies.orient.core.id.ORecordId.&lt;init&gt;(ORecordId.java:50)     at com.orientechnologies.orient.server.distributed.impl.OIncrementalServerSync$1.call(OIncrementalServerSync.java:108)     at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70)     at com.orientechnologies.orient.server.distributed.impl.OIncrementalServerSync.importDelta(OIncrementalServerSync.java:78)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$7.call(ODistributedAbstractPlugin.java:1784)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$7.call(ODistributedAbstractPlugin.java:1778)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeInDistributedDatabaseLock(ODistributedAbstractPlugin.java:1517)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.installDatabaseOnLocalNode(ODistributedAbstractPlugin.java:1778)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.installDatabaseFromNetwork(ODistributedAbstractPlugin.java:1367)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.requestDatabaseDelta(ODistributedAbstractPlugin.java:1065)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.installDatabase(ODistributedAbstractPlugin.java:958)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installNewDatabasesFromCluster(OHazelcastPlugin.java:863)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:172)     at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:1207)     at com.orientechnologies.orient.server.OServer.activate(OServer.java:390)     at test.OrientDBCluster.execute(OrientDBCluster.java:67)     at test.OrientDBCluster.main(OrientDBCluster.java:178)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) ``` </body>
		<created>2016-08-05 14:05:31</created>
		<closed>2016-11-18 14:37:17</closed>
	</bug>
	<bug>
		<id>6532</id>
		<title>Distributed test cases random error</title>
		<body>In the distributed tests I see this (it happened in the last weeks):  ``` 2016-08-05 08:09:15:382 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/db-B (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/db-B/cache.stt (No such file or directory)) [O2QCache] 2016-08-05 08:09:15:398 INFO  - closing storage: db-C... [Orient] 2016-08-05 08:09:15:398 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-C (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-C/cache.stt (No such file or directory)) [O2QCache] 2016-08-05 08:09:15:412 INFO  - closing storage: db-B... [Orient] 2016-08-05 08:09:15:412 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-B (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-B/cache.stt (No such file or directory)) [O2QCache] 2016-08-05 08:09:15:426 INFO  - closing storage: db-A... [Orient] 2016-08-05 08:09:15:426 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/db-A (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server1/databases/db-A/cache.stt (No such file or directory)) [O2QCache] 2016-08-05 08:09:15:438 INFO  - closing storage: db-A... [Orient] 2016-08-05 08:09:15:439 SEVER Cannot store state of cache for storage placed under /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-A (error: java.io.FileNotFoundException: /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-A/cache.stt (No such file or directory)) [O2QCache]-- error on closing storage com.orientechnologies.orient.core.exception.OWriteCacheException: File flush was abnormally terminated     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:696)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:707)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:2869)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClose(OAbstractPaginatedStorage.java:3517)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.close(OAbstractPaginatedStorage.java:459)     at com.orientechnologies.orient.core.Orient.closeAllStorages(Orient.java:385)     at com.orientechnologies.orient.server.distributed.AbstractServerClusterTest.init(AbstractServerClusterTest.java:102)     at com.orientechnologies.orient.server.distributed.scenariotest.ThreeClientsRecordDeleteWithTransactionsOnMultipleServersScenarioTest.test(ThreeClientsRecordDeleteWithTransactionsOnMultipleServersScenarioTest.java:59)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)     at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)     at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)     at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)     at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runners.Suite.runChild(Suite.java:128)     at org.junit.runners.Suite.runChild(Suite.java:27)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runner.JUnitCore.run(JUnitCore.java:137)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)     at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)     at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:483)     at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) Caused by: java.util.concurrent.ExecutionException: com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-A/osequence.cpm was not found     at java.util.concurrent.FutureTask.report(FutureTask.java:122)     at java.util.concurrent.FutureTask.get(FutureTask.java:192)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.flush(OWOWCache.java:691)     ... 42 more Caused by: com.orientechnologies.common.io.OIOException: File /Users/luca/work/dev/orientechnologies/orientdb/community/distributed/target/server0/databases/db-A/osequence.cpm was not found     at com.orientechnologies.orient.core.storage.fs.OFileClassic.open(OFileClassic.java:603)     at com.orientechnologies.common.collection.closabledictionary.OClosableEntry.makeAcquiredFromClosed(OClosableEntry.java:98)     at com.orientechnologies.common.collection.closabledictionary.OClosableLinkedContainer.acquire(OClosableLinkedContainer.java:272)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:1833)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache$FileFlushTask.call(OWOWCache.java:1818)     at java.util.concurrent.FutureTask.run(FutureTask.java:266)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745) ``` </body>
		<created>2016-08-05 14:03:51</created>
		<closed>2016-10-25 13:35:12</closed>
	</bug>
	<bug>
		<id>6530</id>
		<title>after truncate class command , the select from command shows the deleted records in result .</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2.5 ## Operating System - Windows ## Expected behavior and actual behavior  expect return empty array in result but returns the deleted records in result . ## Steps to reproduce the problem 1. create a class named by 'Invoice' and insert 5 records to it . 2. `select from Invoice`; -&gt; returns 5 record and it's true  . 3. `truncate  class Invoice` -&gt; must delete all of records in Invoice class now . 4. `select from Invoice` -&gt; shows the deleted record !!! its not true .  5. i guess the query result has been cached so i restart my oriendb service . 6. run `select from Invoice` -&gt; shows the empty array and its true !!!    i guess there is a bug in query caching mechanism .   Thanks Saeed Tabrizi </body>
		<created>2016-08-05 12:20:36</created>
		<closed>2016-08-09 07:57:22</closed>
	</bug>
	<bug>
		<id>6528</id>
		<title>Problem of SKIP and LIMT with UNWIND</title>
		<body>Hi,  I am using v2.2.3 of orientdb.  I have problem with UNWIND with skip and limit.  I have query like   "select IN('Com_has_cat').Industry_Name as Industry_name from category_details where status = 1 and IN('Com_has_cat')[0].Industry_Name like '%Automotive%' and category_ids not in []  order by category_name UNWIND Industry_name SKIP 5 LIMIT 5"  It gives me 0 result  But when I remove UNWIND from query  "select IN('Com_has_cat').Industry_Name as Industry_name from category_details where status = 1 and IN('Com_has_cat')[0].Industry_Name like '%Automotive%' and category_ids not in []  order by category_name SKIP 5 LIMIT 5"  It return 5 results.  So can you please let me know this weird behaviour.  </body>
		<created>2016-08-05 06:31:10</created>
		<closed>2016-10-03 08:15:04</closed>
	</bug>
	<bug>
		<id>6526</id>
		<title>Problem. High CPU usage after connection re-acquired after automatic backups</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .19[x] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?   We have a large mutithreaded java ee application running on Wildfly 8. We are using Orient 2.1.19. After couple of automatic backups our log files contain a lot of messages like following.     11:07:57,739 WARNING [com.orientechnologies.orient.client.remote.OStorageRemote](default task-104) Caught I/O errors from Not connected (local socket=?), trying to reconnect (error: java.io.EOFException)     11:07:57,747 WARNING [com.orientechnologies.orient.client.remote.OStorageRemote](default task-104) Connection re-acquired transparently after 6ms and 1 retries to server '127.0.0.1:2424/vis_demo': no errors will be thrown at application level  Also CPU usage is very high and all threads named "OrientDB &lt;- Asynch Client (/127.0.0.1:2424)" recreated. At some point  we can see (usinf VisualVM) hundreds of such threads. </body>
		<created>2016-08-05 04:19:50</created>
		<closed>2016-10-28 12:30:33</closed>
	</bug>
	<bug>
		<id>6525</id>
		<title>Dates loaded via ETL using dateFormat yyyy-mm-dd in CSV extractor only sets month to january (01)</title>
		<body>## OrientDB Version, operating system, or hardware. - [X] v2.2.5 community - [X] v2.2.6 community ## Operating System - [ ] Linux - [X] MacOSX (10.11.6 El Capitan) - [ ] Windows - [ ] Other Unix - [ ] Other, name?  *\* I've only been testing this on OSX, it may be happening elsewhere.  I downloaded "ZIP for any OS" from the OrientDB website. ## Expected behavior and actual behavior  I'm reporting this as a subset of a bigger problem I'm having with ETL as I [posted on Stack Overflow](http://stackoverflow.com/questions/38702959/edge-properties-clobbering-vertex-properties-in-orientdb-from-etl) in which dates aren't loading properly _and_ edges with date properties are clobbering the vertex dates by overwriting the time field using the edge month value.  This report focuses specifically on the date loading issue.  I have a simple dataset of vertices in vertices.csv:  ``` label,data,vDate v01,0.1234,2015-01-01 v02,0.5678,2015-02-20 v03,0.9012,2015-03-30 ```  I'm loading it into a database using the ETL loader based on what I've been able to find on Stack Overflow + the OrientDB manual.  It seems to work ok but dates get imported incorrectly.  Here's an example of the output when I query the vertices after import:  ``` orientdb {db=bug-etl-dates.orientdb}&gt; SELECT FROM myVertex  +----+-----+--------+------+-----+-------------------+ |#   |@RID |@CLASS  |data  |label|vDate              | +----+-----+--------+------+-----+-------------------+ |0   |#25:0|myVertex|0.1234|v01  |2015-01-01 00:00:00| |1   |#26:0|myVertex|0.5678|v02  |2015-01-20 00:00:00| |2   |#27:0|myVertex|0.9012|v03  |2015-01-30 00:00:00| +----+-----+--------+------+-----+-------------------+ ```  The dates in v02 and v03 have their months set to january, which is incorrect.  The data, ETL, and helper scripts to replicate the issue are provided in the attached ZIP file. ## Steps to reproduce the problem ### Preparation  You need OrientDB Community 2.2.5 Set the ORIENTDB_HOME environment variable to the _path orientdb-community-2.2.5 is located_. ### Steps to execute test 1. Download the attached zip file (2016-08-05_orientdb_bug_etl-dates.zip) 2. Open a shell and go to the location you downloaded the zip file. 3. $ unzip 2016-08-05_orientdb_bug_etl-dates.zip 4. $ cd 2016-08-05_orientdb_bug_etl-dates 5. $ bash execute.sh 6. Observe result showing month field always coming up as January (01) as shown above. ### Explanation  The execute.sh will call 00_build_graph.sh, which will create a plocal graph in the test directory named bug-etl-dates.orientdb.  Next it will execute 01_query_graph.sh which will execute a "SELECT FROM myVertices" query. ### Troubleshooting  If the script doesn't run and you get a bunch of exceptions saying that it can't find the commonVertices.json, etc. files... try editing the oetl.sh file in $ORIENTDB_HOME/bin and comment out the following line:  `cd`dirname $0` `  As best as I can tell, this doesn't affect the execution of oetl negatively by commenting it out... but leaving it in results in the script changing its current working directory into $ORIENTDB_HOME/bin, which is a royal pain in the a$$ forcing the use absolute paths in your command line _and_ in the vertices.json file.  [2016-08-05_orientdb_bug_etl-dates.zip](https://github.com/orientechnologies/orientdb/files/402864/2016-08-05_orientdb_bug_etl-dates.zip) </body>
		<created>2016-08-04 23:23:53</created>
		<closed>2016-08-19 11:35:46</closed>
	</bug>
	<bug>
		<id>6523</id>
		<title>bug rollback not found in batch (no more ,before working )</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[x ] .beta2[ ] .beta1[ ] ## Operating System - [ x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  in batch script a old script is no more working .  "rollback" identified is not found ??? ## Steps to reproduce the problem </body>
		<created>2016-08-04 16:20:56</created>
		<closed>2016-08-05 07:29:20</closed>
	</bug>
	<bug>
		<id>6520</id>
		<title>OSQLMethodSubString doesnt check for field value length, throwing StringIndexOutOfBoundsException</title>
		<body>v2.2.3  Yes, String.substring() is so stupid to throw StringIndexOutOfBoundsException, but should you repeat 20-years old bugs? How can I use substring() method, if it will fail on short strings? </body>
		<created>2016-08-04 12:18:24</created>
		<closed>2016-08-04 13:09:58</closed>
	</bug>
	<bug>
		<id>6515</id>
		<title>Only one wal file is created for few databases with the storage.wal.path setting</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .6[X] .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I have 3 OrientDb database and as suggested I set the storage.wal.path setting in order to store the wal file on a separate disk. It looks like after this all 3 databases started to use only one wal file. 3 wmr files have been created + OSystem.wmr.  ``` [ec2-user@ip-172-31-8-182 wal]$ ls -l total 100 -rw-rw-r-- 1 ec2-user ec2-user 65536 Aug  2 22:20 authdb.0.wal -rw-rw-r-- 1 ec2-user ec2-user    40 Aug  2 22:20 authdb.wmr drwxrwxr-x 2 ec2-user ec2-user  4096 Aug  2 22:03 backup -rw-rw-r-- 1 ec2-user ec2-user    40 Aug  2 22:20 dsldb.wmr drwx------ 2 root     root     16384 Aug  2 03:56 lost+found -rw-rw-r-- 1 ec2-user ec2-user    40 Aug  2 22:20 OSystem.wmr -rw-rw-r-- 1 ec2-user ec2-user    40 Aug  2 22:20 wdb.wmr ```  I would expect to have a wal file per database. ## Steps to reproduce the problem  Have few databases and set the storage.wal.path setting to a directory. </body>
		<created>2016-08-03 23:02:34</created>
		<closed>2016-08-04 11:22:46</closed>
	</bug>
	<bug>
		<id>6499</id>
		<title>OutOfMemory due to hanging client(?)</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.5, 2.2.7 ## Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  We experienced a memory leak / out-of-memory error. Looking at the heap dump a bufferedoutputstream took all the memory: [big.zip](https://github.com/orientechnologies/orientdb/files/397737/big.zip)  Heapdump is available on request.  Most likely the client was disconnected or blocked or simply very slow, and orient stored the data in memory.  Side node: How can I figure out which query needed  500mb data to be transferred? </body>
		<created>2016-08-02 17:50:25</created>
		<closed>2016-09-26 13:46:20</closed>
	</bug>
	<bug>
		<id>6498</id>
		<title>Abnormal memory consumption with 2.2.x and IBM WebSphere 8.5</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.5 ## Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  I am using OrientDB in embedded distributed mode with only one node. Currently, the reason for using the distributed mode is to connect with plocal and remote concurrently.  In the Hazelcast config, I am using tcp/ip instead of multicast. All other config parameters are basically the default distributed config.  I am using a document database primarily through the Java Object API.  After upgrading from 2.1.6 to 2.2.5, I noticed that the memory usage of Java process corresponding to the WAS server containing my embedded app kept growing (which typically signifies a memory leak).   I generated a heap dump and analyzed it. The results looked "normal" but the heap size was just a fraction of the memory used by the Java process. I see that 2.2.x uses "direct memory" which, by deduction, must relate to the issue.   Have you done any testing with WebSphere? Do you have any idea of what might be causing the behavior?  For now, I downgraded to 2.1.20 which seems to cure the side-effects observed following the upgrade, including abnormal memory consumption. </body>
		<created>2016-08-02 17:01:37</created>
		<closed>2016-08-27 19:32:39</closed>
	</bug>
	<bug>
		<id>6495</id>
		<title>NPE during atomic operation freeze/release</title>
		<body>NPE during atomic operation freeze/release  </body>
		<created>2016-08-02 07:08:27</created>
		<closed>2016-08-02 14:04:01</closed>
	</bug>
	<bug>
		<id>6491</id>
		<title>Upgrade from version 2.2.3 to 2.2.6</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ] - **v2.2.6** ## Operating System - [ x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior     **Important:**  database Type = document   Backup is not working errors        http://orientdb.com/docs/2.0/orientdb.wiki/Backup-and-Restore.html   Export &amp; Import is not working for all the database!   Copy database files from version 2.2.3 to version 2.2.6 in a single database configuration are  working as expected!  See advice -&gt;   https://github.com/orientechnologies/orientdb/issues/6319 ## Steps to reproduce the problem  But  if I switch over to a distributed database (./dserver.sh)  2 (servers) then I try to make a new class and  properties + data via Rest, I got :  Bad HTTP response: %v 500.  Rem     Select a database class is working as before, only changes are a problem for the distributed database.  Server logs:  com.orientechnologies.orient.server.distributed.ODistributedException: Quorum (3) cannot be reached because it is major than available nodes (2) [ONetworkProtocolHttpDb]   This is the same problem as the issue number 6319 !    Switch over to a single server (./server.sh) and all Rest requests are working again. </body>
		<created>2016-08-01 17:18:21</created>
		<closed>2016-08-14 10:24:52</closed>
	</bug>
	<bug>
		<id>6490</id>
		<title>NPE while updating Lucene-indexed field</title>
		<body>v2.2.3  1 Create record with Lucene indexed field == null 2 Update record with field not null  After update, trying to remove old (non-existing) value, OLuceneTxChangesMultiRid.remove calls key.toString() with key == null  com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record #561:10     DB name="default"     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:526)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:367)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2534)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:101)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1794)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1785)     at com.tinkerpop.blueprints.impls.orient.OrientElement.save(OrientElement.java:327)     at com.tinkerpop.blueprints.impls.orient.OrientElement.save(OrientElement.java:309)     at com.tinkerpop.blueprints.impls.orient.OrientElement.setProperty(OrientElement.java:196)  Caused by: java.lang.NullPointerException     at com.orientechnologies.lucene.tx.OLuceneTxChangesMultiRid.remove(OLuceneTxChangesMultiRid.java:58)     at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.remove(OLuceneIndexNotUnique.java:159)     at com.orientechnologies.orient.core.index.OClassIndexManager.removeFromIndex(OClassIndexManager.java:617)     at com.orientechnologies.orient.core.index.OClassIndexManager.deleteIndexKey(OClassIndexManager.java:268)     at com.orientechnologies.orient.core.index.OClassIndexManager.processIndexUpdateFieldAssignment(OClassIndexManager.java:206)     at com.orientechnologies.orient.core.index.OClassIndexManager.processSingleIndexUpdate(OClassIndexManager.java:179)     at com.orientechnologies.orient.core.index.OClassIndexManager.processIndexUpdate(OClassIndexManager.java:456)     at com.orientechnologies.orient.core.index.OClassIndexManager.onRecordAfterUpdate(OClassIndexManager.java:440)     at com.orientechnologies.orient.core.hook.ODocumentHookAbstract.onTrigger(ODocumentHookAbstract.java:260)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHooks(ODatabaseDocumentTx.java:1075)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:501) </body>
		<created>2016-08-01 16:01:04</created>
		<closed>2016-10-05 16:06:23</closed>
	</bug>
	<bug>
		<id>6484</id>
		<title>Creating a sequence using the API and the example in the docs throws NPE</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.5 ## Operating System - [X] Linux ## Expected behavior and actual behavior  When using the example from the documentation that describes how to create a sequence using the API, a NullPointerException is generated. The example looks like:  ``` OSequenceLibrary sequenceLibrary = database.getMetadata().getSequenceLibrary(); OSequence seq = sequenceLibrary.createSequence("idseq", SEQUENCE_TYPE.ORDERED, new OSequence.CreateParams().setStart(0)); ```  The issue is on line 98 of OSequence class. The code expects the increment parameter to be set but the example doesn't set a value which causes an NPE. Setting a default value of 1 for the increment should take care of the issue.  ```   protected void initSequence(OSequence.CreateParams params) {     setStart(params.start);     setIncrement(params.increment);     setValue(params.start);      setSequenceType();   } ```  and the stack trace is:  ``` java.lang.NullPointerException     at com.orientechnologies.orient.core.metadata.sequence.OSequence.initSequence(OSequence.java:98)     at com.orientechnologies.orient.core.metadata.sequence.OSequence.&lt;init&gt;(OSequence.java:92)     at com.orientechnologies.orient.core.metadata.sequence.OSequenceOrdered.&lt;init&gt;(OSequenceOrdered.java:25)     at com.orientechnologies.orient.core.metadata.sequence.OSequenceHelper.createSequence(OSequenceHelper.java:16)     at com.orientechnologies.orient.core.metadata.sequence.OSequenceLibraryImpl.createSequence(OSequenceLibraryImpl.java:77)     at com.orientechnologies.orient.core.metadata.sequence.OSequenceLibraryProxy.createSequence(OSequenceLibraryProxy.java:36)     at  ```  It was fixed in our code by initializing the increment parameter in addition to the starting value first. </body>
		<created>2016-07-31 21:22:39</created>
		<closed>2016-08-03 08:27:58</closed>
	</bug>
	<bug>
		<id>6471</id>
		<title>Trying to add an event metric while connect as localhost returns limited and different options</title>
		<body>2.2.5  If you create a new EE event metric while connected as localhost, the drop-down displays many fewer results (and is different from browser to browser).  However, if you connect as the machine's IP address, the drop-down displays all the correct options. </body>
		<created>2016-07-26 20:30:21</created>
		<closed>2016-07-26 20:37:57</closed>
	</bug>
	<bug>
		<id>6470</id>
		<title>date field gets interpreted as datetime</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[ ] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[X] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  'Date' fields get interpreted as 'Datetimes' instead of 'Date' ## Steps to reproduce the problem  ``` CREATE CLASS V1 EXTENDS V CREATE PROPERTY V1.x Date CREATE VERTEX V1 SET x='2016-01-01' SELECT x.type() from V1 ```  Should return 'date' not 'datetime' </body>
		<created>2016-07-26 18:05:03</created>
		<closed>2016-09-25 06:47:04</closed>
	</bug>
	<bug>
		<id>6467</id>
		<title>Impossible to add a null identifiable in a ridbag</title>
		<body>## OrientDB Version, operating system, or hardware.  v2.2.5  ## Operating System - [ X] Linux ## Expected behaviour and actual behaviour  object should be created but fails with the following:  2016-07-26 05:51:23,995 WARNING [com.orientechnologies.orient.server.distributed.ODistributedResponseManager](default task-36) [nodea] Detected 1 node(s) in timeout or in conflict and quorum (2) has not been reached, rolling back changes for request (id=1.31 task=tx user=#5:0) 2016-07-26 05:51:23,997 SEVERE [com.orientechnologies.orient.server.distributed.impl.ODistributedTxContextImpl](default task-36) [nodea] Error on fixing transaction 1.31 db=RuleEngineDB task=record_update(#156:0 v.4726 realV.-2147478922): java.lang.NullPointerException: Impossible to add a null identifiable in a ridbag at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.addEntry(OEmbeddedRidBag.java:492) at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.doDeserialization(OEmbeddedRidBag.java:541) this happens after I restart one of the node (embedded) of my distibuted environment.  ## Steps to reproduce the problem  restart embedded node.  creating an object that is referring to another object. </body>
		<created>2016-07-26 09:58:01</created>
		<closed>2017-01-30 21:54:56</closed>
	</bug>
	<bug>
		<id>6461</id>
		<title>Methods can not be used on value literals</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.0 SNAPSHOT[ ] - .18[ ] .17[ ] .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[ ] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.1 SNAPSHOT[X] - .16[ ] .15[ ] .14[ ] .13[ ] .12[ ] .11[ ] .10[ ] .9[ ] .8[ ] .7[X] .6[ ] .5[ ] .4[ ] .3[ ] .2[ ] .1[ ] .0[ ] - v2.2 SNAPSHOT[ ] - .rc1[ ] .beta2[ ] .beta1[ ] ## Operating System - [X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  Expected the following SQL query to return 1930:  SELECT '1930-1950'.LEFT(4)  The SQL query doesn't trigger an error nor does it return anything however. It seems that all other methods are affected as well, not only string methods being called on string values. The documentation states that the methods can be called on VALUE(s), nit necessarily properties. When making the value a property, the methods work fine though:  SELECT period.LEFT(4) FROM (SELECT '1930-1950' AS period)  This workaround doesn't seem performant though. ## Steps to reproduce the problem  SELECT '1930-1950'.LEFT(4) </body>
		<created>2016-07-23 19:48:39</created>
		<closed>2016-07-30 18:52:51</closed>
	</bug>
	<bug>
		<id>6460</id>
		<title>Cannot delete class 'Liked UNSAFE'</title>
		<body>Hi,  I have somehow created a class with the name 'Liked UNSAFE' that has the space character in the name. I am not able to select from or delete this class. Can you help me delete this class?  From the console I see these messages:  ``` &gt; info class 'Liked UNSAFE' CLASS 'Liked UNSAFE'  Super classes........: [E] Default cluster......: liked unsafe (id=21) Supported clusters...: liked unsafe(21) Cluster selection....: round-robin Oversize.............: 0.0 ```  ``` &gt; select from `Liked UNSAFE`  Error: com.orientechnologies.orient.core.exception.OQueryParsingException: Error on parsing query at position #7: Error on parsing command at position #0: Error on parsing query Query:  `Liked UNSAFE` ------------^  Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Class '`LIKED' was not found in current database ```  ``` &gt; info CLASSES ---------------------+----------------------+------------+----------------+  NAME                | SUPERCLASS | CLUSTERS   | RECORDS        | ---------------------+----------------------+----- --+----------------+ Liked                    | [E] | 28 | 1619 | Liked UNSAFE               | [E] | 21 | 892 | ```  ``` &gt; delete edge `Liked UNSAFE` where out=#24:22033  Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Class '`LIKED' was not found ``` ## OrientDB Version, operating system, or hardware.  OrientDB console v.2.1.10 (build 2.1.x@r877c28613f3b79e91ee40f58e551f3b82d814bcf; 2016-02-04 17:14:18+0000) www.orientdb.com ## Operating System:  Linux </body>
		<created>2016-07-23 18:56:01</created>
		<closed>2016-09-09 07:11:06</closed>
	</bug>
	<bug>
		<id>6456</id>
		<title>[HTTP API] Updating a document via PUT method returns the Content-Type header with invalid value</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.1 SNAPSHOT[ ] - .16 ## Operating System - [ ] Linux  ## Expected behavior and actual behavior  The expected value of `Content-Type` header is `application/json` as the response body is a string in JSON. The actual value is `text/plain`. </body>
		<created>2016-07-22 22:34:35</created>
		<closed>2016-09-23 20:01:11</closed>
	</bug>
	<bug>
		<id>6455</id>
		<title>getVertices(String label, String[] iKey, Object[] iValue) returns empty iterator if null values involved</title>
		<body>## OrientDB Version, operating system, or hardware. - v2.2.4 (using remote connection to server, utilizing:   - orientdb-client-2.2.4.jar,    - orientdb-core-2.2.4.jar,    - orientdb-graphdb-2.2.4.jar,    - gremlin-java-2.6.0.jar,    - blueprints-core-2.6.0.jar,    - pipes-2.6.0.jar ## Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ## Expected behavior and actual behavior  getVertices(String label, String[] iKey, Object[] iValue) does not return all indexed columns, expects to retrieve all the vertices fulfilling the criterion. ## Steps to reproduce the problem 1. create a vertex type having one index column 2. add a new vertex, having a null value for the indexed column 3. use getVertices(String label, String[] iKey, Object[] iValue) with "myType", new String[] {"myIdx"}, and new Object[null] -&gt; no vertices are returned 4. use getVerticesOfClass(String iClassName) returns the null-index vertex, but filtering has to be done manually (not really a solution) 5. make sure there is no index used with any null values and getVertices(String label, String[] iKey, Object[] iValue) works fine.   Nevertheless, the documentation states, that since 2.2 the database should handle null values in indexes, which does not seem to be the case. Any ideas?! ## Related Problem (?)  I also recognized that the method getVertices(String label, String[] iKey, Object[] iValue) only returns one vertex instead of all matching vertices (using a partial matching index).   ``` // the following code only returns exactly one vertex, (vertices iterable) vertices = graph.getVertices(clazz,         properties.keySet().toArray(new String[properties.size()]),        properties.values().toArray(new Object[properties.size()]));   // the following code returns all the vertices correctly, (vertices iterable) final GraphQuery query = graph.query().has("@class", clazz); properties.forEach(query::has); vertices = query.vertices(); ``` </body>
		<created>2016-07-22 17:38:08</created>
		<closed>2016-10-11 12:50:06</closed>
	</bug>
	<bug>
		<id>6437</id>
		<title>In distributed mode deploy databases does not work sometimes between cluster nodes.</title>
		<body>In distributed mode deploy databases does not work sometimes between cluster nodes. ### OrientDB v2.2.4 community edition ### Operating System: Linux (Debian 8.4 x64) ### RAM: 64 gb ### CPU: intel xeon e5 family ### Java Version 8  Each cluster node has its own unique name: node1, node2, node3.  Configuration files are identical on all nodes:  default-distributed-db-config.json:  ``` {   "autoDeploy": true,   "readQuorum": 1,   "writeQuorum": "majority",   "executionMode": "undefined",   "readYourWrites": true,   "servers": {     "*": "master"   },   "clusters": {     "internal": {     },     "client_node1": {       "servers" : [ "node1", "node2" ]     },     "client_node2": {       "servers" : [ "node2", "node3" ]     },     "client_node3": {       "servers" : [ "node3", "node1" ]     },     "*": {       "servers": ["&lt;NEW_NODE&gt;"]     }   } } ```  hazelcast.xml:  ``` &lt;hazelcast         xsi:schemaLocation="http://www.hazelcast.com/schema/config hazelcast-config-3.0.xsd"         xmlns="http://www.hazelcast.com/schema/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;         &lt;group&gt;                 &lt;name&gt;test&lt;/name&gt;                 &lt;password&gt;test&lt;/password&gt;         &lt;/group&gt;         &lt;network&gt;                 &lt;port auto-increment="true"&gt;2434&lt;/port&gt;                 &lt;join&gt;                         &lt;multicast enabled="false"&gt;                                 &lt;multicast-group&gt;235.1.1.1&lt;/multicast-group&gt;                                 &lt;multicast-port&gt;2434&lt;/multicast-port&gt;                         &lt;/multicast&gt;                         &lt;tcp-ip enabled="true"&gt;                                     &lt;member&gt;192.168.200.54:2434&lt;/member&gt;                                     &lt;member&gt;192.168.200.64:2434&lt;/member&gt;                                     &lt;member&gt;192.168.200.74:2434&lt;/member&gt;                         &lt;/tcp-ip&gt;                 &lt;/join&gt;         &lt;/network&gt;         &lt;executor-service&gt;                 &lt;pool-size&gt;16&lt;/pool-size&gt;         &lt;/executor-service&gt; &lt;/hazelcast&gt; ```  I modeled the situation. I stopped all cluster nodes Delete all directories in the databases directory. I run each of the nodes. At the first node, I began to create a blank database.  as a result I have received the following: The first node I had a databases: init_1 init_2 init_3 init_4 init_5 init_6 init_7 init_8 init_9  The second and third node I had a databases: init_1 init_3 init_4 init_5 init_9  Stoping all the nodes and starting anew not start get deploy databases on the cluster nodes in which these databases are no.  orient-server.log.0:  ```  [OHazelcastPlugin] 2016-07-19 17:53:37:118 INFO  [node1] Distributed servers status:  +------+------+----------------------------------+-----+---------+-------------------+-------------------+-----------------------+ |Name  |Status|Databases                         |Conns|StartedOn|Binary             |HTTP               |UsedMemory             | +------+------+----------------------------------+-----+---------+-------------------+-------------------+-----------------------+ |node2 |ONLINE|init_lab1_1=SYNCHRONIZING (MASTER)|7    |17:38:08 |192.168.200.64:2424|192.168.200.64:2480|474,85MB/7,11GB (6,52%)| |      |      |init_lab1_3=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |      |      |init_lab1_9=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |      |      |init_lab1_5=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |      |      |init_lab1_4=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |node3 |ONLINE|init_lab1_1=SYNCHRONIZING (MASTER)|6    |17:38:10 |192.168.200.74:2424|192.168.200.74:2480|354,77MB/7,11GB (4,87%)| |      |      |init_lab1_3=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |      |      |init_lab1_9=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |      |      |init_lab1_5=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |      |      |init_lab1_4=SYNCHRONIZING (MASTER)|     |         |                   |                   |                       | |node1*|ONLINE|init_lab1_1=ONLINE (MASTER)       |14   |17:38:04 |192.168.200.54:2424|192.168.200.54:2480|65,17MB/7,11GB (0,89%) | |      |      |init_lab1_3=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_2=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_9=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_8=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_5=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_4=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_7=ONLINE (MASTER)       |     |         |                   |                   |                       | |      |      |init_lab1_6=ONLINE (MASTER)       |     |         |                   |                   |                       | +------+------+----------------------------------+-----+---------+-------------------+-------------------+-----------------------+  [OHazelcastPlugin] ```  Please tell me why this is happening? </body>
		<created>2016-07-19 16:41:41</created>
		<closed>2016-12-27 15:48:55</closed>
	</bug>
	<bug>
		<id>6435</id>
		<title>Convert STRING to RID(LINK) in SQL not working?</title>
		<body>## Expected behavior and actual behavior  **GOAL**: Convert string represention of an RID into a true RID to address referenced attributes/properties.   Running a SQL method like `.convert("LINK")` off a property that has a string value of an `RID` should result in a `RID` "type"... but it remains as a `STRING` type - and as such is not traversable   (eg. `XXX.convert("LINK").name` won't work) ## Steps to reproduce the problem  Run `XXX.convert('LINK')` method (where XXX is a STRING representation of an RID)  eg: (Class = ci, schemaless, cluster ID = 13) 2 records:   ``` #13:0 : {name:"First",rid2:"#13:1"} #13:1 : {name:"Second",rid2:"#13:0"} ```  `select rid2.convert("LINK").name as linkedname from #13:0;`  Should return `{ "linkedname":"Second" }`, _but it doesn't_ ## Important Questions - Is there another way to convert a string representation of an RID into a true RID? - Shouldn't the above (`.convert("link")`) achieve this?  ### Running Mode - [X] Remote ### Misc - [X] Running a local test instance using console.sh ### OrientDB Version - [X] v2.2.x - Please specify last number: 4 ### Operating System - [X] Linux ### Java Version - [X] 8 </body>
		<created>2016-07-19 13:48:48</created>
		<closed>2016-09-25 13:15:48</closed>
	</bug>
	<bug>
		<id>6434</id>
		<title>cannot rebuild unique index, but cannot find offending duplicate records</title>
		<body>Hi,  running the standard version of OrientDB v2.2.3 currently on a single Ubuntu 14.04 LTS server with 128GB installed RAM, I have a database "cdrarch", with class "@mds_csv_cf14" with all STRING properties except one DATETIME property which is named "START_DATETIME".   Initially (no records in this class yet) I defined a unique index "idx_mds_csv_cf14_0" on the combination of [ START_DATETIME, FILENAME, RECORD_NUMBER ] : CREATE INDEX idx_mds_csv_cf14_0 ON mds_csv_cf14 (START_DATETIME, FILENAME, RECORD_NUMBER) UNIQUE  So far so good, then I started loading records into the class during 2 weeks. Currently there is about 70M records in this table.  For some reasons, the Java process of the OrientDB was leaking (?) or at least growing terribly in consumed memory (see below log extract), so that it finally became inaccessible from a data-loading client program (via REST-api), console, or web interface.   2016-07-18 09:50:02:610 INFO  Database 'OSystem' uses 101,525MB/119,482MB of DISKCACHE memory, while Heap is not completely used (usedHeap=272 6MB maxHeap=7282MB). To improve performance set maxHeap to 3271MB and DISKCACHE to 123492MB [OAbstractProfiler$MemoryChecker] 2016-07-18 09:50:02:611 INFO  -&gt; Open server.sh (or server.bat on Windows) and change the following variables: 1) MAXHEAP=-Xmx3271M 2) MAXDISK CACHE=123492 [OAbstractProfiler$MemoryChecker] 2016-07-18 09:50:02:612 INFO  Database 'cdrarch' uses 101,525MB/119,482MB of DISKCACHE memory, while Heap is not completely used (usedHeap=272 6MB maxHeap=7282MB). To improve performance set maxHeap to 3271MB and DISKCACHE to 123492MB [OAbstractProfiler$MemoryChecker] 2016-07-18 09:50:02:612 INFO  -&gt; Open server.sh (or server.bat on Windows) and change the following variables: 1) MAXHEAP=-Xmx3271M 2) MAXDISK CACHE=123492 [OAbstractProfiler$MemoryChecker]  Had to stop the server process to unblock it.  I found that the "server.sh" script did not have any explicit setting for "MAXDISKCACHE", which -according to certain articles on the web- might have led to this growing Java process.  So I gave that parameter the following value: MAXDISKCACHE="-Dstorage.diskCache.bufferSize=8192" then restarted the server program.  Then I restarted the data-loading program which is attempting to insert new records into "@mds_csv_cf14".  But somehow the unique index got corrupted, because loading new records into this class fails with the message  2016-07-19 12:07:07:160 SEVER Internal server error: com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record #218:1248232: found duplicated key 'OCompositeKey{keys=[Thu Jun 30 23:52:57 CEST 2016, C22N010000000014.001.00665346, 1]}' in index 'idx_mds_csv_cf14_0' previously assigned to the record #214:1248231  When I search for duplicate records in the class for the combination of the unique index, i.e. [ START_DATETIME, FILENAME, RECORD_NUMBER ], around the timestamp indicated in the log message (Jun 30 23:52:57 CEST 2016), there aren't any :   SELECT \* FROM ( SELECT START_DATETIME, FILENAME, RECORD_NUMBER, count(*) AS cnt FROM mds_csv_cf14  WHERE  START_DATETIME BETWEEN DATE('20160630','yyyyMMdd') AND DATE('20160701','yyyyMMdd')  GROUP BY START_DATETIME, FILENAME, RECORD_NUMBER )  WHERE cnt &gt; 1  =&gt; no records returned from this query  So, again based on articles on the web describing that the index sometimes contains data which is not referring to anything really in the class, I dropped the index, and started it re-creation.  This failed again on exactly the same spot :   2016-07-19 12:07:07:160 SEVER Internal server error: com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record #218:1248232: found duplicated key 'OCompositeKey{keys=[Thu Jun 30 23:52:57 CEST 2016, C22N010000000014.001.00665346, 1]}' in index 'idx_mds_csv_cf14_0' previously assigned to the record #214:1248231         DB name="cdrarch"INDEX=idx_mds_csv_cf14_0 RID=#214:1248231   **=&gt; there are no duplicate records found from the "GROUP BY" query earlier, but according to the index-creating there would be duplicates anyhow ??!!** ## Steps to reproduce the problem  Remove the setting for MAXDISKCACHE in the "server.sh" file, and start stuffing tons of records to the database. Hopefully this reproduces the problem. I won't try it, because it risks my database to become even more corrupted. ### OrientDB Version  v2.2.3 ### Operating System  Ubuntu 14.04 ### Java Version  1.8.0_92 </body>
		<created>2016-07-19 11:30:00</created>
		<closed>2016-07-22 15:25:11</closed>
	</bug>
	<bug>
		<id>6433</id>
		<title>[Distributed] Not properly saving record?</title>
		<body>When I run the following for the second time (the second time is when it throws the error, this first still does not save to the other server) this error is thrown:  `com.orientechnologies.orient.core.exception.ODatabaseException: Error during saving of record with rid #27:0     DB name="Carnoot"     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:205)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2541)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:101)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1796)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1787)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLUpdate.result(OCommandExecutorSQLUpdate.java:353)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.pushResult(OCommandExecutorSQLResultsetAbstract.java:278)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:735)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:667)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:616)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1639)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1554)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:511)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:474)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2602)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2548)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.command(ODistributedStorage.java:269)     at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78)     at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74)     at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:696)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLUpdate.execute(OCommandExecutorSQLUpdate.java:288)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2602)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2548)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.command(ODistributedStorage.java:269)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)     at com.carnoot.server.functions.Authentication.heartbeat(Authentication.java:93)     at com.carnoot.server.WebHandler.handle(WebHandler.java:57)     at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:79)     at sun.net.httpserver.AuthFilter.doFilter(AuthFilter.java:83)     at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:82)     at sun.net.httpserver.ServerImpl$Exchange$LinkHandler.handle(ServerImpl.java:675)     at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:79)     at sun.net.httpserver.ServerImpl$Exchange.run(ServerImpl.java:647)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745) Caused by: com.orientechnologies.orient.server.distributed.task.ODistributedRecordLockedException: Record with rid #27:0 is locked by request 0.1     DB name="Carnoot"     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.acquireRecordLock(ODistributedStorage.java:1260)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.executeRecordOperationInLock(ODistributedStorage.java:1029)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.updateRecord(ODistributedStorage.java:798)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2046)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:186)     ... 38 more `  The program receives a HTTP request, and gets the user's ID via their session ID:  ` public class AuthenticatedUser {  ``` ORID userID;  public AuthenticatedUser(String sessionID) {     ODatabase DB = CarnootDB.newDBConnection();     try {         if (sessionID != "empty") {              List&lt;ODocument&gt; queryResult = DB.query(new OSQLSynchQuery("SELECT expand(both('SESSION')) FROM (SELECT FROM SESSIONS WHERE SESSIONID=decode('" + sessionID + "','base64'))"));             if (queryResult.size() &gt; 0) {                 userID = queryResult.get(0).getIdentity();             }         }     } finally {         DB.close();     }  }  public ORID getUser() throws Exception {     if (userID != null) {         return userID;     } else {         throw new AuthenticationException(AuthenticationException.ErrorType.SESSION_ID_INVALID);     } } ```  }`  An instance of this class is then passed to the heartbeat function:  `  ODatabase DB = CarnootDB.newDBConnection(); try {             DB.activateOnCurrentThread();             DB.command(new OCommandSQL("UPDATE " + user.getUser().toString() + " SET HEARTBEAT=sysdate()")).execute();  ```     } catch (Exception E) {         E.printStackTrace();     } finally {         DB.close();     }` ``` </body>
		<created>2016-07-19 06:42:16</created>
		<closed>2016-07-20 17:28:08</closed>
	</bug>
	<bug>
		<id>6427</id>
		<title>NumberFormatException on inserting record with implicit attribute "id" set to uuid() as default</title>
		<body>Hi all, - I have a parent class which has an attribute called `id` which is a string and default value is `uuid()` - There's a child class `I18N` which extends this parent class - When i try to insert a record into `I18N` studio throws a `java.lang.NumberFormatException`  I was able to reproduce it in my DB with whole schema seeded, but somehow it worked on  a test db  with only parent and child classes in place.  Here's a log btw:  ``` 2016-07-18 11:47:00:463 FINE  {db=OSystem} onClose [OLuceneIndexFactory] 2016-07-18 11:47:00:464 FINE  {db=nsdev} Read record #5:0 v.1 size=171 bytes [OLocalPaginatedStorage] 2016-07-18 11:47:00:465 FINE  {db=nsdev} Read record #4:0 v.2 size=69 bytes [OLocalPaginatedStorage] 2016-07-18 11:47:00:465 FINE  {db=nsdev} onOpen [OLuceneIndexFactory] 2016-07-18 11:47:00:466 FINE  {db=nsdev} onClose [OLuceneIndexFactory]Caught exception com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.insert into I18N set  name="test", language="test"         DB name="nsdev"         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2623)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2548)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)         at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:107)         at com.orientechnologies.orient.graph.server.command.OServerCommandPostCommandGraph.execute(OServerCommandPostCommandGraph.java:37)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:165)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:613)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: java.lang.NumberFormatException: For input string: "84102b55-8218-4e5b-be98-9ae398b7c727"         at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)         at java.lang.Integer.parseInt(Integer.java:580)         at java.lang.Byte.parseByte(Byte.java:149)         at java.lang.Byte.parseByte(Byte.java:175)         at com.orientechnologies.orient.core.sql.OSQLHelper.parseStringNumber(OSQLHelper.java:200)         at com.orientechnologies.orient.core.sql.OSQLHelper.parseValue(OSQLHelper.java:179)         at com.orientechnologies.orient.core.sql.OSQLHelper.parseDefaultValue(OSQLHelper.java:70)         at com.orientechnologies.orient.core.record.impl.ODocument.convertFieldsToClass(ODocument.java:2643)         at com.orientechnologies.orient.core.record.impl.ODocument.setClassName(ODocument.java:2004)         at com.orientechnologies.orient.core.record.impl.ODocument.&lt;init&gt;(ODocument.java:161)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLInsert.execute(OCommandExecutorSQLInsert.java:228)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2602)         ... 7 more  2016-07-18 11:47:00:469 SEVER Internal server error: java.lang.NumberFormatException: For input string: "84102b55-8218-4e5b-be98-9ae398b7c727" [ONetworkProtocolHttpDb] 2016-07-18 11:47:03:567 FINE  [ONetworkProtocolHttpAbstract.execute] Requested: GET /listDatabases [ONetworkProtocolHttpDb] 2016-07-18 11:47:03:568 FINE  {db=OSystem} onOpen [OLuceneIndexFactory]  ``` ## Important Questions ### Running Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number:  ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-07-18 11:49:34</created>
		<closed>2016-07-21 09:37:12</closed>
	</bug>
	<bug>
		<id>6419</id>
		<title>Unable to store data to the database using orient db etl</title>
		<body>## Expected behavior and actual behavior  Im running oetl.bat to import data to database using json file. The oetl process will success, but it did not store data to the database, Im using document type database  ## Note  Here is my etl_config.json and input json file  {      "config":{         "log":"debug"    },      "begin": [],      "source":{         "file":{            "path":"C:/Users/lnvithanage/Desktop/Testting/server/webserver/bin/work/reports/report.json"       }    },    "extractor":{         "json":{}    },      "transformers" : [],      "loader":{         "orientdb":{            "dbURL":"remote:localhost/Test",          "dbUser":"root",          "serverUser":"root",          "serverPassword":"root",          "dbPassword":"root",          "standardElementConstraints":false,          "tx":false,          "wal":false,          "batchCommit":1000,          "dbType":"document"  ```   } ```     },        "end": [] }  ---  [      {         "@type":"d",       "@version":1,       "@class":"Project",       "moduleName":"HibernateExample",       "isSuccess":false,       "fromDate":"1970-01-01 05:30:00",       "toDate":"2016-06-21 14:22:47"    },    {         "@type":"d",       "@version":1,       "@class":"Project",       "moduleName":"HibernateExample",       "isSuccess":false,       "fromDate":"1970-01-01 05:30:00",       "toDate":"2016-06-21 14:30:43"    },    {         "@type":"d",       "@version":1,       "@class":"Project",       "moduleName":"HibernateExample",       "isSuccess":false,       "fromDate":"1970-01-01 05:30:00",       "toDate":"2016-06-21 14:32:04"    },{         "@type":"d",       "@version":1,       "@class":"UpdateDetails",       "moduleName":"HibernateExample",       "toolName":"Hibernate",       "timeOfLastRun":"2016-06-21 14:34:44",       "timeOfLastSuccess":"2016-06-21 14:34:44",       "timeOfFirstRun":"2016-06-21 14:34:44",       "timeOfLastFullRun":"2016-06-21 14:34:44"    }    ] ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition - [x] orientdb-community single server ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number: orientdb-community-2.2.4 ### Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-07-14 11:34:18</created>
		<closed>2016-08-03 09:44:19</closed>
	</bug>
	<bug>
		<id>6418</id>
		<title>Sequences in distributed configuration don't work anymore with 2.2.5-SNAPSHOT</title>
		<body>Run this test case: `ServerClusterLocalSequenceTest`. Now a transaction is always executed. This changes the behavior of the trigger in some way. </body>
		<created>2016-07-13 18:52:22</created>
		<closed>2016-10-13 10:57:51</closed>
	</bug>
	<bug>
		<id>6404</id>
		<title>Return of (fixed) 2.0 issue in 2.1/2.2: NoClassDefFoundError for ODatabaseRecordThreadLocal</title>
		<body>Windows 10, Orientdb 2.2.4  I'm trying to upgrade from 2.0 to 2.2.4 and ran into the same issue that I had when upgrading from 1.7 to 2.0. We are running OSGI and are embedding all Orientdb bundles and their dependencies into our bundle.  I posted on the google group when I tried the same upgrade to 2.1.3 and got these answers from you guys: https://groups.google.com/d/msg/orient-database/gjkfiywvIvs/4g0O0pXNDAAJ But it doesn't look like anyone actually did something...  2016-07-11 09:59:58,228 [Thread-3] ERROR com.aaa.bootstrap.OSGiLogger - com.aaa.orientdb [131]: [ERROR]  : java.lang.NoClassDefFoundError: Could not initialize class com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal null org.apache.felix.log.LogException: java.lang.IllegalStateException: java.lang.NoClassDefFoundError: Could not initialize class com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal     at org.apache.felix.ipojo.handlers.lifecycle.callback.LifecycleCallbackHandler.__M_stateChanged(LifecycleCallbackHandler.java:171)     at org.apache.felix.ipojo.handlers.lifecycle.callback.LifecycleCallbackHandler.stateChanged(LifecycleCallbackHandler.java)     at org.apache.felix.ipojo.InstanceManager.setState(InstanceManager.java:560)     at org.apache.felix.ipojo.InstanceManager.start(InstanceManager.java:440)     at org.apache.felix.ipojo.ComponentFactory.createInstance(ComponentFactory.java:179)     at org.apache.felix.ipojo.IPojoFactory.createComponentInstance(IPojoFactory.java:319)     at org.apache.felix.ipojo.IPojoFactory.createComponentInstance(IPojoFactory.java:240)     at org.apache.felix.ipojo.extender.internal.linker.ManagedType$InstanceSupport$1.call(ManagedType.java:312)     at org.apache.felix.ipojo.extender.internal.linker.ManagedType$InstanceSupport$1.call(ManagedType.java:306)     at org.apache.felix.ipojo.extender.internal.queue.JobInfoCallable.call(JobInfoCallable.java:114)     at java.util.concurrent.FutureTask.run(FutureTask.java:266)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.NoClassDefFoundError: Could not initialize class com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.activateOnCurrentThread(ODatabaseDocumentTx.java:2966)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.&lt;init&gt;(ODatabaseDocumentTx.java:157)     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPolled.&lt;init&gt;(OPartitionedDatabasePool.java:118)     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPolled.&lt;init&gt;(OPartitionedDatabasePool.java:114)     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.initQueue(OPartitionedDatabasePool.java:442)     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.&lt;init&gt;(OPartitionedDatabasePool.java:217)     at com.ceesoft.ceeview.datastore.impl.blueprints.orientdb.DatabaseManagerProvider.__M_validate(DatabaseManagerProvider.java:190)     at com.ceesoft.ceeview.datastore.impl.blueprints.orientdb.DatabaseManagerProvider.validate(DatabaseManagerProvider.java)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:497)     at org.apache.felix.ipojo.util.Callback.call(Callback.java:233)     at org.apache.felix.ipojo.util.Callback.call(Callback.java:193)     at org.apache.felix.ipojo.handlers.lifecycle.callback.LifecycleCallback.call(LifecycleCallback.java:86)     at org.apache.felix.ipojo.handlers.lifecycle.callback.LifecycleCallbackHandler.__M_stateChanged(LifecycleCallbackHandler.java:162)     ... 13 more  It took several versions of 2.0 before the issue was finally fixed. Since the issue now is back, does that mean that the bug fixes done late in 2.0 have not been merged into 2.1 or is there another reason that the problem has returned in 2.1?  Regards, Roar </body>
		<created>2016-07-11 08:13:42</created>
		<closed>2016-12-08 12:55:11</closed>
	</bug>
	<bug>
		<id>6401</id>
		<title>Edges only listed unidirectional in vertices</title>
		<body>## Expected behavior and actual behavior  Expected behavior: An edge connecting two vertices should be visible in both vertices as either in or out property.  Actual behavior: As depicted in the picture below I have two vertices #20:0 and #20:3 connected to each other via the edges #24:452 (#20:3 -&gt; #20:0) and #24:453 (#20:0 -&gt; #20:3). However only vertex #20:3 lists the edges as in / out edge? Recreating fails, since a Unique out/in index prevents orientdb from creating duplicates.   From a first inspection it looks like the OMultiCollectionIterator used in OrientVertex.getEdges does not return the proper amount of edges. ## Steps to reproduce the problem  To be done, since the error just occurred (at lease to my current understanding) after the migration to 2.2.3. ## Important Questions  The edge should be symmetrically visible from both vertices.  ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote (localhost) ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number: 3 ### Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8  ![image](https://cloud.githubusercontent.com/assets/5039358/16697598/b6fa4c30-454a-11e6-8017-ffb26a9543fa.png) </body>
		<created>2016-07-08 18:36:40</created>
		<closed>2016-11-11 14:36:31</closed>
	</bug>
	<bug>
		<id>6399</id>
		<title>Calculations with sysdate in WHERE condition prevents index usage</title>
		<body>## Expected behavior and actual behavior  I need to get the vertices in time window, which should be calculated based on the current date (for example, last 5 minutes; last hour). I created property `V.recordedAt` with type `DATETIME` with `NOTUNIQUE` index, and use queries kinda `SELECT FROM V WHERE recordedAt &gt; sysdate() - 350000`. It works, however, OrientDB performs full scan of a class instead of index use, and the following message appears in the log.  ``` $ANSI{green {db=test}} Error on using index V.recordedAt in query 'select FROM V WHERE recordedAt &gt; sysdate() - 350000'. Probably you need to rebuild indexes. Now executing query using cluster scan java.lang.ClassCastException: com.orientechnologies.orient.core.sql.filter.OSQLFilterCondition cannot be cast to java.util.Date     at com.orientechnologies.common.serialization.types.ODateTimeSerializer.preprocess(ODateTimeSerializer.java:35)     at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.iterateEntriesMajorAsc(OSBTree.java:1185)     at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.iterateEntriesMajor(OSBTree.java:735)     at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.iterateEntriesMajor(OSBTreeIndexEngine.java:186)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doIterateIndexEntriesMajor(OAbstractPaginatedStorage.java:2052)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.iterateIndexEntriesMajor(OAbstractPaginatedStorage.java:2040)     at com.orientechnologies.orient.core.index.OIndexMultiValues.iterateEntriesMajor(OIndexMultiValues.java:240)     at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.iterateEntriesMajor(OIndexAbstractDelegate.java:110)     at com.orientechnologies.orient.core.index.OIndexTxAwareMultiValue.iterateEntriesMajor(OIndexTxAwareMultiValue.java:365)     at com.orientechnologies.orient.core.sql.operator.OQueryOperatorMajor.executeIndexQuery(OQueryOperatorMajor.java:97)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchForIndexes(OCommandExecutorSQLSelect.java:2213)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchInClasses(OCommandExecutorSQLSelect.java:994)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.assignTarget(OCommandExecutorSQLResultsetAbstract.java:202)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.assignTarget(OCommandExecutorSQLSelect.java:515)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:497)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:473)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2577)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2523)     at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78)     at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74)     at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:85)     at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1421)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:456)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:199)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  Also I noticed if use `eval` it works as expected: `SELECT FROM V WHERE recordedAt &gt; eval("sysdate() - 350000")` (the error is not appeared and index is used). Is it correct behavior, or it's a bug? ## Steps to reproduce the problem  Create database and run the following commands:  ``` sql ALTER DATABASE DATETIMEFORMAT "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'" ALTER DATABASE DATEFORMAT "yyyy-MM-dd" ALTER DATABASE TIMEZONE "UTC"  CREATE PROPERTY V.recordedAt DATETIME ALTER PROPERTY V.recordedAt MANDATORY TRUE ALTER PROPERTY V.recordedAt NOTNULL TRUE  CREATE INDEX V.recordedAt NOTUNIQUE METADATA {ignoreNullValues: true}  CREATE VERTEX V SET name="test1", recordedAt=sysdate() CREATE VERTEX V SET name="test2", recordedAt=sysdate() CREATE VERTEX V SET name="test3", recordedAt=sysdate()  SELECT FROM V WHERE recordedAt &gt; sysdate() - 350000 ```  Last query returns correct result, but doesn't use index. ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - [ ] v2.1.x - [x] v2.2.x - OrientDB 2.2.3 Community ### Operating System - [x] Linux, image from [dockerhub](https://hub.docker.com/_/orientdb/) - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-07-08 12:56:59</created>
		<closed>2016-07-14 15:47:21</closed>
	</bug>
	<bug>
		<id>6398</id>
		<title>NPE in OEmbeddedRidBag if OIntentMassiveInsert is declared</title>
		<body>Orientdb v2.2.3  OIntentMassiveInsert switches off validation.  ODocument.validate(), besides all, deserialize fields and clears _source in  checkForFields() (that is unclear and error prone) During commit,  if validation is switched off, _source remains filled with temporary ids in ORidBag's (so commit depends on validation). Ids are converted to persistent, but not in _source - no serialization This invalid binary is written to storage During deserialization, OEmbeddedRidBag cant get record with temporary RID, and fails in addEntry()  Bug is hard to catch, because ODocument.toString() fill fields - if breakpoint is set too early, everything works  Code to reproduce  ```        final ODatabaseDocumentTx db = new ODatabaseDocumentTx("memory:default").open("admin", "admin");         final OrientGraph graph = new OrientGraph(db, false);         graph.setUseLightweightEdges(true);         final OrientVertexType c1 = graph.createVertexType("C1");         c1.createProperty("p1", OType.INTEGER);         graph.createEdgeType("parent");         ODatabaseRecordThreadLocal.INSTANCE.get().declareIntent(new OIntentMassiveInsert());         graph.begin();         final OrientVertex first = graph.addVertex("class:C1");         first.setProperty("p1", -1);         for (int i = 0; i &lt; 10; i++) {             final OrientVertex v = graph.addVertex("class:C1");             v.setProperty("p1", i);             first.addEdge("parent", v);             //this search fills _source             db.command(new OSQLSynchQuery&lt;&gt;("SELECT from V where p1='" + i + "'")).execute();         }         graph.commit();         //here NPE will be thrown         final Iterable&lt;Edge&gt; edges = first.getEdges(Direction.BOTH);` ``` </body>
		<created>2016-07-08 12:46:44</created>
		<closed>2016-07-18 14:12:46</closed>
	</bug>
	<bug>
		<id>6396</id>
		<title>Error oteleporter (Too many open files)</title>
		<body>## Expected behavior and actual behavior  Error when try using oteleporter for large DB using Postresql ## Steps to reproduce the problem  ./oteleporter.sh -jdriver postgresql -jurl jdbc:postgresql://localhost:5433/382 -juser adempiere  -jpasswd adempiere  -ourl plocal:/Users/e-Evolution/Desktop/databases/382 ### OrientDB Version  orientdb-enterprise-2.2.3 ### Operating System - [Capitan ] MacOSX ### Java Version - [ ] 8  ./oteleporter.sh -jdriver postgresql -jurl jdbc:postgresql://localhost:5433/382 -juser adempiere  -jpasswd adempiere  -ourl plocal:/Users/e-Evolution/Desktop/databases/382   OrientDB                    ---   ___  **/**  ____/__  /___  ____/__  __ _  __ __  **\**  **/**  ____/__  _ _ \    __  /  __  **/  __  / __  __/  __  /_/ /  / / /_  /_/ /_  /  __  __/  __  /_/ /  _  /   _  /_**  _  /___  /___  _  ____// /_/ /_  _, _/_  /   _  /___  _  _, _/   /_/    /_____/  /_____/_____/  /_/     ____/ /_/ |_| /_/    /_____/  /_/ |_|    ```                                               http://orientdb.com/teleporter ```  No configuration file was found. Migration will be performed with standard mapping policies. (1/4) Source DB Schema building:    100% [....................]  Elapsed: 00:00:55  Remaining: 00:00:00  Warnings: 6 (2/4) Graph Model building:         100% [....................]  Elapsed: 00:00:00  Remaining: 00:00:00  Warnings: 6  (3/4) OrientDB Schema writing:       29% [.....               ]  Elapsed: 00:10:54  Remaining: 00:26:42  Warnings: 8memory errors. Please set the -XX:MaxDirectMemorySize=16384m option when you start the JVM. [Class] ERROR:  com.orientechnologies.orient.core.exception.OPaginatedClusterException - Error during creation of cluster with name pa_ratioelement_2     DB name="382"     Component Name="pa_ratioelement_2" ERROR:  com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during creation of cluster with name pa_ratioelement_2     DB name="382"     Component Name="pa_ratioelement_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.create(OPaginatedCluster.java:201)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.addClusterInternal(OAbstractPaginatedStorage.java:3398)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doAddCluster(OAbstractPaginatedStorage.java:3379)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.addCluster(OAbstractPaginatedStorage.java:511)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.addCluster(ODatabaseDocumentTx.java:1302)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClusters(OSchemaShared.java:1218)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClusters(OSchemaShared.java:1191)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:382)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:363)     at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.createClass(OSchemaProxy.java:95)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1311)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1309)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1829)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1309)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1276)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1247)     at com.orientechnologies.teleporter.writer.OGraphModelWriter.writeModelOnOrient(OGraphModelWriter.java:102)     at com.orientechnologies.teleporter.strategy.rdbms.ODBMSNaiveAggregationStrategy.createSchemaMapper(ODBMSNaiveAggregationStrategy.java:92)     at com.orientechnologies.teleporter.strategy.rdbms.ODBMSImportStrategy.executeStrategy(ODBMSImportStrategy.java:85)     at com.orientechnologies.teleporter.main.OTeleporter.execute(OTeleporter.java:272)     at com.orientechnologies.teleporter.main.OTeleporter.main(OTeleporter.java:206) Caused by: java.io.FileNotFoundException: /Users/e-Evolution/Desktop/databases/382/pa_ratioelement_2.cpm (Too many open files)     at java.io.RandomAccessFile.open0(Native Method)     at java.io.RandomAccessFile.open(RandomAccessFile.java:316)     at java.io.RandomAccessFile.&lt;init&gt;(RandomAccessFile.java:243)     at com.orientechnologies.orient.core.storage.fs.OFileClassic.openChannel(OFileClassic.java:791)     at com.orientechnologies.orient.core.storage.fs.OFileClassic.create(OFileClassic.java:528)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.addFile(OWOWCache.java:1055)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.addFile(OWOWCache.java:450)     at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.addFile(O2QCache.java:275)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.commitChanges(OAtomicOperation.java:411)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:420)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.create(OPaginatedCluster.java:197)     ... 20 more  Exception in thread "main" com.orientechnologies.teleporter.exception.OTeleporterRuntimeException: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during creation of cluster with name pa_ratioelement_2     DB name="382"     Component Name="pa_ratioelement_2"     at com.orientechnologies.teleporter.writer.OGraphModelWriter.writeModelOnOrient(OGraphModelWriter.java:261)     at com.orientechnologies.teleporter.strategy.rdbms.ODBMSNaiveAggregationStrategy.createSchemaMapper(ODBMSNaiveAggregationStrategy.java:92)     at com.orientechnologies.teleporter.strategy.rdbms.ODBMSImportStrategy.executeStrategy(ODBMSImportStrategy.java:85)     at com.orientechnologies.teleporter.main.OTeleporter.execute(OTeleporter.java:272)     at com.orientechnologies.teleporter.main.OTeleporter.main(OTeleporter.java:206) Caused by: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during creation of cluster with name pa_ratioelement_2     DB name="382"     Component Name="pa_ratioelement_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.create(OPaginatedCluster.java:201)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.addClusterInternal(OAbstractPaginatedStorage.java:3398)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doAddCluster(OAbstractPaginatedStorage.java:3379)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.addCluster(OAbstractPaginatedStorage.java:511)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.addCluster(ODatabaseDocumentTx.java:1302)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClusters(OSchemaShared.java:1218)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClusters(OSchemaShared.java:1191)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:382)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.createClass(OSchemaShared.java:363)     at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.createClass(OSchemaProxy.java:95)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1311)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$5.call(OrientBaseGraph.java:1309)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1829)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1309)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1276)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.createVertexType(OrientBaseGraph.java:1247)     at com.orientechnologies.teleporter.writer.OGraphModelWriter.writeModelOnOrient(OGraphModelWriter.java:102)     ... 4 more Caused by: java.io.FileNotFoundException: /Users/e-Evolution/Desktop/databases/382/pa_ratioelement_2.cpm (Too many open files)     at java.io.RandomAccessFile.open0(Native Method)     at java.io.RandomAccessFile.open(RandomAccessFile.java:316)     at java.io.RandomAccessFile.&lt;init&gt;(RandomAccessFile.java:243)     at com.orientechnologies.orient.core.storage.fs.OFileClassic.openChannel(OFileClassic.java:791)     at com.orientechnologies.orient.core.storage.fs.OFileClassic.create(OFileClassic.java:528)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.addFile(OWOWCache.java:1055)     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.addFile(OWOWCache.java:450)     at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.addFile(O2QCache.java:275)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.commitChanges(OAtomicOperation.java:411)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:420)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:116)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.create(OPaginatedCluster.java:197)     ... 20 more </body>
		<created>2016-07-08 02:13:14</created>
		<closed>2016-07-11 13:35:02</closed>
	</bug>
	<bug>
		<id>6394</id>
		<title>@size variable is null in select</title>
		<body>## Expected behavior and actual behavior  select @size from #33:1   where the record is binary record   &lt;pre&gt; ----+------ #   |@CLASS ----+------ 0   |null   ----+------ &lt;/pre&gt;   i can't know the size of the binary record ## Steps to reproduce the problem  select @size from #33:1  ## Important Questions - [ ] v2.0.x - Please specify last number:  - [x ] v2.1.x - Please specify last number: 2.1.18 - [ ] v2.2.x - Please specify last number:  ### Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x ] 8 </body>
		<created>2016-07-07 17:22:10</created>
		<closed>2016-07-15 11:23:52</closed>
	</bug>
	<bug>
		<id>6392</id>
		<title>Database setting for record conflict strategy is not taken at database load time</title>
		<body></body>
		<created>2016-07-07 04:23:11</created>
		<closed>2016-07-07 04:26:24</closed>
	</bug>
	<bug>
		<id>6387</id>
		<title>Big in binary protocol and auto-merge conflict strategy</title>
		<body>Using Auto-Merge conflict strategy in case the content is merged, the updated byte[] is never sent to the client, so the client has an old version and corrupts the database.  I've patched the binary protocol (version=37), please review it. </body>
		<created>2016-07-06 06:30:45</created>
		<closed>2016-07-25 09:33:07</closed>
	</bug>
	<bug>
		<id>6382</id>
		<title>Orientdb UI</title>
		<body>## Expected behavior and actual behavior  When i enter a query in UI , it used to keep a history of previously ran queries on that view , i dont see orientdb doing this anymore on 2.2.3 . why did you guys remove this feature ? its pretty annoying when i query something , click on record to check something and when im back i just lose that previous view . thanks ## Steps to reproduce the problem ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [X ] Remote ### Misc - [ X] I have a distributed setup with multiple servers. How many? 3 - [X ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [ ] v2.2.x - Please specify last number: 3 ### Operating System - [ ] Linux - [ ] MacOSX - [ X ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [ X ] 8 </body>
		<created>2016-07-05 03:16:26</created>
		<closed>2016-09-23 10:20:20</closed>
	</bug>
	<bug>
		<id>6381</id>
		<title>[ OrientDB version &gt;= 2.1.12 ] Token based authentication behaviour</title>
		<body>Can you explain better how this kind of authentication works now?  Token authentication still not working or the behaviour is changed.   I provided a payload for this here: https://github.com/orientechnologies/orientdb/issues/6259 but i think that this could be a change in the behaviour more than a bug.  Php and Python drivers are not working with this functionality.  They works with OrientDB versions &lt; 2.1.12, so i think that something is changed.  This is the old behaviour, can you check if it is still valid? https://github.com/Ostico/PhpOrient#persistent-connections--session-token-  Tnx </body>
		<created>2016-07-05 00:30:20</created>
		<closed>2016-09-29 16:28:42</closed>
	</bug>
	<bug>
		<id>6380</id>
		<title>Concurrent INSERTs and DELETEs cause deadlock.</title>
		<body>## Expected behavior and actual behavior  Concurrent INSERTs and DELETEs cause deadlock. ![img](http://i.imgur.com/SzjrjA4.png)  Stacktrace (taken with jvisualvm)  ``` Found one Java-level deadlock: ============================= "Thread-7":   waiting for ownable synchronizer 0x00000000d59c41d0, (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync),   which is held by "Thread-6" "Thread-6":   waiting for ownable synchronizer 0x00000000d59c41a0, (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync),   which is held by "Thread-7"  Java stack information for the threads listed above: =================================================== "Thread-7":     at sun.misc.Unsafe.park(Native Method)     - parking to wait for  &lt;0x00000000d59c41d0&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)     at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)     at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)     at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870)     at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199)     at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.lock(ReentrantReadWriteLock.java:943)     at com.orientechnologies.common.concur.lock.OOneEntryPerKeyLockManager.acquireLock(OOneEntryPerKeyLockManager.java:173)     at com.orientechnologies.common.concur.lock.OOneEntryPerKeyLockManager.acquireLock(OOneEntryPerKeyLockManager.java:100)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.acquireExclusiveLockTillOperationComplete(OAtomicOperationsManager.java:464)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:175)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:140)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.startAtomicOperation(ODurableComponent.java:123)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.remove(OClusterPositionMap.java:411)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.deleteRecord(OPaginatedCluster.java:806)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doDeleteRecord(OAbstractPaginatedStorage.java:3205)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.deleteRecord(OAbstractPaginatedStorage.java:1151)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeDeleteRecord(ODatabaseDocumentTx.java:2139)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.deleteRecord(OTransactionNoTx.java:274)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.delete(ODatabaseDocumentTx.java:2563)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.delete(ODatabaseDocumentTx.java:101)     at com.orientechnologies.orient.core.record.ORecordAbstract.delete(ORecordAbstract.java:296)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelete.result(OCommandExecutorSQLDelete.java:325)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.pushResult(OCommandExecutorSQLResultsetAbstract.java:278)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:734)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:666)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:615)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.serialIterator(OCommandExecutorSQLSelect.java:1638)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1553)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:510)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:473)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2577)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2523)     at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:78)     at com.orientechnologies.orient.core.sql.query.OSQLAsynchQuery.run(OSQLAsynchQuery.java:74)     at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelete.execute(OCommandExecutorSQLDelete.java:205)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:72)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:2577)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:2523)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:69)     at Hello$$anon$2.run(Hello.scala:752) "Thread-6":     at sun.misc.Unsafe.park(Native Method)     - parking to wait for  &lt;0x00000000d59c41a0&gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)     at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)     at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)     at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870)     at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199)     at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.lock(ReentrantReadWriteLock.java:943)     at com.orientechnologies.common.concur.lock.OOneEntryPerKeyLockManager.acquireLock(OOneEntryPerKeyLockManager.java:173)     at com.orientechnologies.common.concur.lock.OOneEntryPerKeyLockManager.acquireLock(OOneEntryPerKeyLockManager.java:100)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.acquireExclusiveLockTillOperationComplete(OAtomicOperationsManager.java:464)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:175)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.startAtomicOperation(OAtomicOperationsManager.java:140)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.startAtomicOperation(ODurableComponent.java:123)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:441)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:3023)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:3584)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1344)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:555)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:109)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2665)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2634)     at Hello$$anon$1.run(Hello.scala:728)  Found 1 deadlock.  ```  Expected no deadlock. ## Steps to reproduce the problem  Run the code and wait a little (usually less than a minute)  ```       locally {         val db = new ODatabaseDocumentTx("plocal:databases/TestDb")         FileUtils.deleteDirectory(new java.io.File("databases/TestDb"))         db.create()         db.close()          db.open("admin", "admin")         try {           println(Try(db.command[OCommandRequest](new OCommandSQL("CREATE CLASS Ping")).execute[Object]()))         } finally {           db.close()         }       }        new Thread {         override def run {           while(true) {             // insert a simple record             val db = new ODatabaseDocumentTx("plocal:databases/TestDb")             db.open("admin", "admin")             try {               db.begin(OTransaction.TXTYPE.OPTIMISTIC)               try {                 val d = new ODocument("Ping")                 d.field("time", System.currentTimeMillis)                 d.save()                 db.commit()                 print(GREEN+"."+RESET)               } catch {                 case e: Throwable =&gt;                   e.printStackTrace                   db.rollback()               }             } finally {               db.close()             }             Thread sleep 5           }         }       }.start()        new Thread {         override def run {           while(true) {             // delete records older than 5 sec             val db = new ODatabaseDocumentTx("plocal:databases/TestDb")             db.open("admin", "admin")             try {               val now = System.currentTimeMillis               println(s"${RED}deleting:${RESET}")               val rc = db .command[OCommandRequest](new OCommandSQL("delete from Ping where time &lt; ?")) .execute[Int]((now - 5000).asInstanceOf[AnyRef])               println(s"${RED}deleted old msgs ${BOLD}${rc}${RESET+RED} in ${BOLD}${System.currentTimeMillis - now}${RESET+RED} ms${RESET}")             } finally {               db.close()             }             Thread sleep 5000           }         }       }.start() ``` ## Important Questions ### Runninng Mode - [ x] Embedded, using PLOCAL access mode - [  ] Embedded, using MEMORY access mode - [ x] Remote  I have the issue with embedded PLOCAL, remote PLOCAL and remote MEMORY (single-server setup, no distribution). In the remote case, the deadlock occurs in the OrientDB server process. ### Misc - [  ] I have a distributed setup with multiple servers. How many?  - [  ] I'm using the Enterprise Edition ### OrientDB Version - [  ] v2.0.x - Please specify last number:  - [  ] v2.1.x - Please specify last number:  - [x ] v2.2.x - Please specify last number: 2.2.3 community edition ### Operating System - [  ] Linux - [  ] MacOSX - [ x] Windows (Windows Server 2008, Java 8) - [  ] Other Unix - [  ] Other, name?  ### Java Version - [  ] 6 - [ x] 7 - [ x] 8 </body>
		<created>2016-07-04 14:28:37</created>
		<closed>2016-07-05 14:26:28</closed>
	</bug>
	<bug>
		<id>6378</id>
		<title>UPDATE EDGE command does not check the graph consistency properly</title>
		<body>## Expected behavior and actual behavior  UPDATE EDGE command does not check the graph consistency in proper way when change `in`/`out` properties of an edge.  **Actual behavior**: new vertex' `in`/`out` is updating, but the vertex that was previously assigned to the edge still contain info about the edge. **Expected behavior**: `in`/`out` of both new and old vertices changed properly - the edge reference removed from the old vertex, and added to the new one.  Checked on OrientDB 2.2.0 and 2.2.3 and reproduced on both. ## Steps to reproduce the problem  Small example that illustrates this behaviour.  ``` CREATE VERTEX V SET label='vertex 1' CREATE VERTEX V SET label='vertex 2' CREATE VERTEX V SET label='vertex 3' CREATE EDGE E FROM #9:0 to #10:0  SELECT FROM V  +-------+----------+--------+----------+-------+-------+ | @rid  | @version | @class | label    | IN    | OUT   | +-------+----------+--------+----------+-------+-------+ |  #9:0 | 2        | V      | vertex 1 |       | #13:0 | | #10:0 | 2        | V      | vertex 2 | #13:0 |       | | #11:0 | 1        | V      | vertex 3 |       |       | +-------+----------+--------+----------+-------+-------+  SELECT FROM E  +-------+----------+--------+-------+-------+ | @rid  | @version | @class | OUT   | IN    | +-------+----------+--------+-------+-------+ | #13:0 | 1        | E      | #9:0  | #10:0 | +-------+----------+--------+-------+-------+ ```  Change the edge endpoint to another vertex:  ``` UPDATE EDGE #13:0 SET in=#11:0 SELECT FROM E  +-------+----------+--------+-------+-------+ | @rid  | @version | @class | OUT   | IN    | +-------+----------+--------+-------+-------+ | #13:0 | 2        | E      | #9:0  | #11:0 | +-------+----------+--------+-------+-------+  SELECT FROM V  +-------+----------+--------+----------+-------+-------+ | @rid  | @version | @class | label    | IN    | OUT   | +-------+----------+--------+----------+-------+-------+ |  #9:0 | 2        | V      | vertex 1 |       | #13:0 | | #10:0 | 2        | V      | vertex 2 | #13:0 |       | | #11:0 | 2        | V      | vertex 3 | #13:0 |       | +-------+----------+--------+----------+-------+-------+ ```  Values of `in` for both edge `#13:0` and vertex `#11:0` has been changed properly (and its versions also has been increased), but the vertex `#10:0` still contain info about the edge (and has unchanged version). If change `out` property of an edge will get the same result. ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote (with OrientDB studio) ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - [ ] v2.1.x - [x] v2.2.x - checked on 2.2.0 and 2.2.3 ### Operating System - [x] Linux, image from [dockerhub](https://hub.docker.com/_/orientdb/) - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-07-02 08:40:51</created>
		<closed>2016-07-02 11:43:30</closed>
	</bug>
	<bug>
		<id>6371</id>
		<title>Automatic conversion between embedded rid bag and bonsai rid bag is broken in the tx mode</title>
		<body>Seem like there is a special update handling logic applied in the tx mode to lower the overhead on remote commit, as a side effect the conversion is broken.  `com.orientechnologies.orient.test.database.auto.ORidBagTest#testFromEmbeddedToSBTreeAndBack` will be disabled. </body>
		<created>2016-06-30 13:45:09</created>
		<closed>2016-07-12 09:49:09</closed>
	</bug>
	<bug>
		<id>6365</id>
		<title>error creating abstract class in studio (wrong order in syntax)</title>
		<body>## Expected behavior and actual behavior  Creating an abstract class in studio gives an error: Error parsing query: CREATE CLASS APA ABSTRACT extends E ^ Encountered " &lt;EXTENDS&gt; "extends "" at line 1, column 28. Was expecting one of: &lt;EOF&gt; ";" ...   DB name="test"  It seems that the syntax should be "CREATE CLASS APA extends E ABSTRACT" instead. ## Steps to reproduce the problem  Go into Schema Choose "New class" Class name "APA" Extend E Check "Abstract" Click "Save" ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number: - [x] v2.2.x - Please specify last number: 3 ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-06-30 08:34:40</created>
		<closed>2016-06-30 09:31:30</closed>
	</bug>
	<bug>
		<id>6354</id>
		<title>Altering the name of a property if it already has a value returns both property names and values</title>
		<body>Tested on 2.2.4-snapshot but affects 2.1.x and 2.0.x too.  Steps to reproduce: create class PropTest create property PropTest.Name String insert into PropTest set Name = "Bob" alter property PropTest.Name name Nomen  select from PropTest  There will now be a "Name" property and a "Nomen" property returned, and both will have a value of "Bob". </body>
		<created>2016-06-27 17:31:57</created>
		<closed>2016-06-28 13:58:55</closed>
	</bug>
	<bug>
		<id>6353</id>
		<title>Querying a previously abstract class returns an empty result set</title>
		<body>Tested against 2.2.4-snapshot  Simple to reproduce:  ``` create class Test abstract alter class Test abstract false insert into Test set Name = "Jill" ```  The record will be created, and you can retrieve the record by RID fine.  However, "select from Test" will return nothing. </body>
		<created>2016-06-27 16:14:08</created>
		<closed>2016-06-28 16:04:56</closed>
	</bug>
	<bug>
		<id>6345</id>
		<title>Distributed Cluster Issue (Orientdb 2.1.16):  error: file with name 'file_xxx-yyy-zzz.irs' does not exist in storage</title>
		<body>We were running cluster of 3 nodes and it was stable for while, until we exceeded disk space on one of the cluster nodes and decided to restart orientdb on all 3 after cleaning up disk space on that cluster node. After that we started seeing this error on all 3 nodes. I think after disk space exceeded on one node, some of the vertices went into bad state. Is it a known issue ? And how to recover such cluster ? </body>
		<created>2016-06-25 00:12:29</created>
		<closed>2016-08-03 14:27:16</closed>
	</bug>
	<bug>
		<id>6341</id>
		<title>Studio always draws standard edge first time</title>
		<body>## Expected behavior and actual behavior  When drawing a lightweight edge between vertexes in the "Graph" panel of studio, the edge arrow should be dashed. Instead, it is solid. ## Steps to reproduce the problem 1. Create a vertex class 2. Create an edge class with no constraints 3. Create two vertexes 4. Go into Graph panel in Studio, run a query to show the vertexes 5. Draw an edge between the two vertexes, select "use lightweight edge" 6. See that the drawn edge is solid. 7. Click "clear canvas" 8. Run the same query 9. See that the edge is drawn dashed. ## Important Questions ### Runninng Mode - [ x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x ] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [ x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x ] 8 </body>
		<created>2016-06-23 12:12:00</created>
		<closed>2016-07-28 10:41:04</closed>
	</bug>
	<bug>
		<id>6336</id>
		<title>OrientDB 2.2.3 - noTx.drop() leads to NPE in OrientBaseGraph</title>
		<body>## Expected behavior and actual behavior  I'm currently trying to upgrade from OrientDB 2.1.x to 2.2.x unfortunately a strange NPE is causing a lot of test errors.  ``` 19:53:40.980 [Cherished Rayquaza] ERROR [vert.x-worker-thread-5] [AbstractDatabase.java:129] - Error while handling no-transaction. java.lang.NullPointerException: null     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertices(OrientBaseGraph.java:893) ~[orientdb-graphdb-2.2.3.jar:2.2.3]     at com.gentics.mesh.graphdb.OrientDBDatabase.getVertices(OrientDBDatabase.java:199) ~[classes/:na]     at com.gentics.mesh.core.data.root.impl.UserRootImpl.findMeshAuthUserByUuid(UserRootImpl.java:97) ~[classes/:na]     at com.gentics.mesh.auth.MeshJWTAuthProvider.lambda$1(MeshJWTAuthProvider.java:66) ~[classes/:na]     at com.gentics.mesh.graphdb.spi.AbstractDatabase.lambda$1(AbstractDatabase.java:121) ~[classes/:na]     at io.vertx.core.impl.ContextImpl.lambda$executeBlocking$17(ContextImpl.java:296) ~[vertx-core-3.2.1.jar:na]     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_74]     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_74] ```  In OrientBaseGraph:892 clazz is `null`.  ```     final OClass clazz = getDatabase().getMetadata().getImmutableSchemaSnapshot().getClass(label); ``` ## Steps to reproduce the problem  Unfortunately I was unable to create a reproducer. I tried to isolate the code but as soon as I removed it from the vert.x thread context the issue could not be reproduced. ### Our Setup  In our test suite we are executing a lot of unit tests which access the OrientDBGraph. Some transactions we use are created within a thread pool that is most likely not recreated in between tests. The transactions are fetched from a central `OrientGraphFactory` and closed via the tx.shutdown() call. Instead of closing the factory we reuse the previously created OrientGraphFactory for each test case. In between tests the Database is purged via:  ```    OrientGraphNoTx noTx = factory.getNoTx();    try {     noTx.drop();    } finally {     noTx.shutdown();   } ```  For 2.1.x this was sufficient but in 2.2.x the NPE is occurring.  ### Clue 1:  If I change our test setup slightly and _close_ the factory instead of reusing it for the tests. In that case the tests pass. ### Clue 2:  The tests also pass if I replace the noTx.drop() call with:  ``` try (Trx tx = trx()) {     tx.getGraph().e().removeAll();     tx.getGraph().v().removeAll();     tx.success(); } ```  I believe that the issue is located around `noTx.drop()`. ## Important Questions ### Runninng Mode - [x] Embedded, using MEMORY access mode ### OrientDB Version - [x] v2.2.3 ### Operating System - [x] Linux ### Java Version - [x] 8 </body>
		<created>2016-06-21 18:37:58</created>
		<closed>2016-09-19 08:21:21</closed>
	</bug>
	<bug>
		<id>6332</id>
		<title>Migrate non-tx index updates to atomic operations manager</title>
		<body>Currently we use two separate methods of updating indexes in tx and non-tx mode. In the non-tx one data and index updates are not grouped into one atomic task, this results in various glitches while mixing tx and non-tx code.  This should be fixed by unifying both methods, so both the tx path and the non-tx path use atomic operations. </body>
		<created>2016-06-21 12:41:38</created>
		<closed>2016-07-12 07:49:30</closed>
	</bug>
	<bug>
		<id>6331</id>
		<title>Caught I/O errors from localhost, trying to reconnect (error: java.io.InvalidClassException: com.orientechnologies.orient.core.exception.OCoreException: local class incompatible)</title>
		<body>## Expected behavior and actual behavior  Moved to orientdb v2.2.2 to counter issue(s) #6219 &amp; #6234. Running the same code as in #6219 &amp; #6234 to insert dbpedia data as a linked data graph in orientDB. While I am not getting the issue as in #6234, after insertion of some 20k more vertices and similar no. of edges from the point i got the #6234 issue, i get this issue. Kindly refer to the jpeg attached to get the full error stack. While the program is running, as you can see from the jpeg, its losing connection again &amp; again from the OrientDB server at localhost, and as such further inserts are not happening.  ![screenshot from 2016-06-21 15 50 51](https://cloud.githubusercontent.com/assets/14372749/16227229/17dd8f66-37cd-11e6-8cac-7cca52f6c8f2.png) ## Steps to reproduce the problem - Steps to reproduce the problem are mentioned in the comments of #6234, as i am running the same code. ### Running Mode - Remote, on the same machine. ### OrientDB Version - v2.2.2 ### Operating System - Linux, Ubuntu 14.04  ### Java Version - Java 8  This has been very frustrating. After 2 months, 3 bugs filed, I am still not able to upload a simple real-world graph to OrientDB.  </body>
		<created>2016-06-21 11:09:08</created>
		<closed>2016-06-23 11:47:46</closed>
	</bug>
	<bug>
		<id>6327</id>
		<title>OrientDB cannot open a local database inside a folder containing dollar signs</title>
		<body>## Expected behavior and actual behavior  If I try to open a local OrientDB database in a path such as the following I should be able to do so.  C:/my$path/Stores/Graph Database/graphf28b0f4ca68f41cc88cbb40af2458c5f  Instead in OIOUtils.getPathFromDatabaseName it replaces the valid dollar symbol to a forward slash which gets recognized as a path separator and it throws the following exception:  Location passed in WAL does not exist, or IO error was happened. DB cannot work in durable mode in such case     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog.&lt;init&gt;(ODiskWriteAheadLog.java:674)     at ODiskWriteAheadLog.java:616     at OLocalPaginatedStorage.java:292     at OAbstractPaginatedStorage.java:276     at OLocalPaginatedStorage.java:113     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.create(ODatabaseDocumentTx.java:383) ## Steps to reproduce the problem  Create a path with a folder containing a dollar symbol. ## Important Questions  Can you change the logic of using a dollar sign as a replacement character to a much less likely character combination like a high range unicode char wrapping a dollar sign. ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [ ] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [ ] MacOSX - [x ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ x] 7 - [ x] 8 </body>
		<created>2016-06-21 03:49:06</created>
		<closed>2016-07-05 10:45:44</closed>
	</bug>
	<bug>
		<id>6323</id>
		<title>New record allocated but expected another rid</title>
		<body>When using OrientDB 2.1.16 all the tests pass. After moving to OrientDB 2.2.0 some tests fail. Sometime I get exception on creating new object:  Caused by: com.orientechnologies.orient.core.exception.OTransactionException: New record allocated #302:36 but the expected was #302:41     Storage URL="plocal:/home/orientdb-community-2.2.0/databases/RuleEngineDB"     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1321)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.commit(ODistributedStorage.java:1214)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:555)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:109)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2664)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2634)     at com.orientechnologies.orient.server.distributed.impl.task.OTxTask.execute(OTxTask.java:118)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(ODistributedAbstractPlugin.java:591)     at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70)     at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(ODistributedAbstractPlugin.java:587)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:241)     at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:93) </body>
		<created>2016-06-19 14:15:13</created>
		<closed>2016-06-21 11:20:15</closed>
	</bug>
	<bug>
		<id>6320</id>
		<title>Lucene index error in migration from standalone to distributed</title>
		<body>## Steps to reproduce the problem ### Create base standalone database e.g. `testdb` in `node-1` 1. Start a server in standalone mode `server.sh` 2. Create a class say `Person` with property `id(INT), name(STRING)` 3. Create a `FULLTEXT LUCENE` index on `Person.name` 4. **Add** a Person record ### Deploy it as distributed databases 1. Stop standalone OrientDB 2. Copy testdb from `node-1` to `$ORIENTDB_HOME/databases/` in a different node e.g. `node-2` 3. Start OrientDB server in node-1 `bin/dserver.sh` 4. Wait until it finished initalizing, then execute `bin/dserver.sh` in node-2 5. An exception is thrown  ``` 2016-06-19 13:18:47:975 INFO  [node-2]-&gt;[node-1] Creating backup of database 'testdb' (compressionRate=7) in directory: /tmp/orientdb/backup_testdb.zip... [OSyncDatabaseTask]Exception in thread "OrientDB SyncDatabase node=node-2 db=testdb" com.orientechnologies.orient.core.exception.ODatabaseException: The database instance is not set in the current thread. Be sure to set it with: ODatabaseRecordThreadLocal.INSTANCE.set(db);     at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.get(ODatabaseRecordThreadLocal.java:51)     at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.getDatabase(OLuceneIndexEngineAbstract.java:311)     at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.reOpen(OLuceneIndexEngineAbstract.java:209)     at com.orientechnologies.lucene.engine.OLuceneIndexEngineAbstract.release(OLuceneIndexEngineAbstract.java:501)     at com.orientechnologies.lucene.engine.OLuceneIndexEngineDelegate.release(OLuceneIndexEngineDelegate.java:275)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.release(OAbstractPaginatedStorage.java:2459)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.backup(OLocalPaginatedStorage.java:188)     at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.backup(ODistributedStorage.java:1567)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.backup(ODatabaseDocumentTx.java:2847)     at com.orientechnologies.orient.server.distributed.impl.task.OSyncDatabaseTask$1.run(OSyncDatabaseTask.java:125)     at java.lang.Thread.run(Thread.java:745) ``` ## Important Questions ### Runninng Mode - [x] Remote ### Misc - [x] I have a distributed setup with 2 servers ### OrientDB Version - [x] v2.2.2 ### Operating System - [x] Linux ### Java Version - [x] 8 ### NB  I think it has something to do with the way Lucene indexes are being replicated in distributed mode.  If I create the base DB _without_ Lucene index and then I replicate it to another node in the same way as above. Then, only _after the 2 nodes finsished synchronizing_, I created the Lucene index, no error comes up. **This is my current workaround** which is rather inconvenient.  Also the exception does not come up with other built in indexes (happens only with Lucene) </body>
		<created>2016-06-19 05:39:29</created>
		<closed>2016-07-15 14:24:25</closed>
	</bug>
	<bug>
		<id>6319</id>
		<title>Create index blocks database</title>
		<body>## Expected behavior and actual behavior ## Steps to reproduce the problem  1) Create class 2) create index on all the fields and the database blocks. ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x ] Remote ### Misc - [ x] I have a distributed setup with multiple servers. How many? 2  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x ] v2.2.x - Please specify last number:  ### Operating System - [x ] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [ x] 8  1) Create a new class with 5 properties. **Blocking command: 2) create index inps_20160618 on nps_20160618 (ip,nbr,date,aic,stat) NOTUNIQUE METADATA {ignoreNullValues : false}**  This actions are no problem in OrientDB 2.2.0  but in OrientDB 2.2.2 the OrientWebsite blocks also interrupt don't help! If I stop the browser and check on the index page I see that the index is created but it seems that the process is running in loop after this action.  Rem: There is no data in de database! Only a new database with a new class and properties. </body>
		<created>2016-06-18 06:05:02</created>
		<closed>2016-07-21 07:26:02</closed>
	</bug>
	<bug>
		<id>6312</id>
		<title>NullPointerException when invoking OClass::truncate</title>
		<body>This is related to [this issue](https://github.com/orientechnologies/orientdb/issues/6303).  So I have an application which uses intensively OrientDB and I have a lot of integration tests.  When using OrientDB 2.1.5 al the tests pass. After moving to OrientDB 2.2.2 some tests fail.  In this particular case this test passes in eclipse as well as when run via maven in my windows machine. It also passes when it's run by jenkins in a linux machine for a certain job, but fails when run by another different job.  The stack trace:  ``` Stacktrace  com.orientechnologies.orient.core.index.OIndexException:  Error on rebuilding the index for clusters: [aenclosure_14, adocument_10, aenclosure_13, adocument_11, aenclosure_16, aenclosure_15, aenclosure_18, adocument_14, aenclosure_17, adocument_15, adocument_12, aenclosure_19, adocument_13, adocument_18, adocument_19, aenclosure, adocument_16, adocument_17, aenclosure_10, aenclosure_12, aenclosure_11, adocument_7, adocument_21, aenclosure_3, adocument_8, adocument_22, aenclosure_2, adocument_9, aenclosure_5, adocument_20, aenclosure_4, adocument_3, adocument_4, adocument_5, adocument_23, aenclosure_1, adocument_6, aenclosure_7, aenclosure_6, aenclosure_9, aenclosure_8, adocument, adocument_1, adocument_2, aenclosure_21, aenclosure_20, aenclosure_23, aenclosure_22]     DB name="dclosure_integration"     at com.compart.tec.destiny.core.db.browse.FlattenedBrowseUsingBlueprintsIT.&lt;init&gt;(FlattenedBrowseUsingBlueprintsIT.java:42) Caused by: com.orientechnologies.orient.core.exception.OStorageException:  File File: ADocument.bundleid.irs, stored=0 does not exist.     DB name="dclosure_integration"     at com.compart.tec.destiny.core.db.browse.FlattenedBrowseUsingBlueprintsIT.&lt;init&gt;(FlattenedBrowseUsingBlueprintsIT.java:42)  Standard Error  Jun 16, 2016 12:47:28 PM com.orientechnologies.common.log.OLogManager log SEVERE: $ANSI{green {db=dclosure_integration}} Error during index 'ADocument.bundleid' delete Jun 16, 2016 12:47:28 PM com.orientechnologies.common.log.OLogManager log SEVERE: $ANSI{green {db=dclosure_integration}} Error during index rebuild java.lang.NullPointerException     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doClearIndex(OAbstractPaginatedStorage.java:1785)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.clearIndex(OAbstractPaginatedStorage.java:1772)     at com.orientechnologies.orient.core.index.OIndexAbstract.rebuild(OIndexAbstract.java:449)     at com.orientechnologies.orient.core.index.OIndexAbstract.rebuild(OIndexAbstract.java:377)     at com.orientechnologies.orient.core.index.OIndexAbstractDelegate.rebuild(OIndexAbstractDelegate.java:168)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.truncate(OClassImpl.java:1547) ``` ### Runninng Mode - [ ] Embedded, using PLOCAL access mode ### OrientDB Version - [ ] v2.2.x - Please specify last number: 2 ### Operating System - [ ] Linux ### Java Version - [ ] 8 </body>
		<created>2016-06-16 13:08:43</created>
		<closed>2016-07-11 10:08:45</closed>
	</bug>
	<bug>
		<id>6311</id>
		<title>maximum allowed chunk length error on remote access with default settings</title>
		<body>When accessing OrientDB 2.2.2 remote and creating an empty database, with default settings, I get this error:  ``` com.orientechnologies.common.io.OIOException: Impossible to read a chunk of length:1949459553 max allowed chunk length:16777216 see NETWORK_BINARY_MAX_CONTENT_LENGTH settings          at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readBytes(OChannelBinary.java:157)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.solveSession(ONetworkProtocolBinary.java:274)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeRequest(ONetworkProtocolBinary.java:227)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:185)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  The fact that the documentation is wrongly stating the size unit (bytes instead of kB) doesn't help, either,-) See #6310  ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [X] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.x - Please specify last number: 2 ### Operating System - [X] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-06-16 12:46:22</created>
		<closed>2016-08-27 19:29:47</closed>
	</bug>
	<bug>
		<id>6309</id>
		<title>Unsupported backup against remote storage locks database on writes</title>
		<body>## Expected behavior and actual behavior  I'm running embedded server http://orientdb.com/docs/2.2/Embedded-Server.html . So my java app connects in plocal mode.  When I run `bin/backup.sh remote:/test USER PASS ../backup.zip` message shows: Error: java.lang.UnsupportedOperationException: backup is not supported against remote storage...  And database became locked on writes infinitely  It'should't freeze in this case. ## Steps to reproduce the problem  run `./backup.sh remote:/DBNAME USER PASS ../backup.zip` against remote storage and try to write in db ## Important Questions ### Runninng Mode - [ x] Remote (embedded server) ### Misc ### OrientDB Version - [ x] v2.2.2 - Please specify last number:  ### Operating System - [ x] MacOSX ### Java Version - [ x] 8 </body>
		<created>2016-06-16 11:40:08</created>
		<closed>2016-08-16 14:13:29</closed>
	</bug>
	<bug>
		<id>6307</id>
		<title>Unable to create new users in distributed setup</title>
		<body>## Expected behavior and actual behavior  The "create user" command doesn't work in a distributed setup in version 2.2.2  Any time I use it, I get a distributed operation exception (screenshot: https://www.dropbox.com/s/nd9m52i8dbk7r4t/Screenshot%202016-06-15%2010.51.13.png?dl=0)  It seems that the entry is created in both servers, just with a different password hash which collides. Screenshot of user creation process (redacted) https://www.dropbox.com/s/r4oywkc5gqj6lsj/Screenshot%202016-06-15%2012.26.04.png?dl=0 and https://www.dropbox.com/s/2poi06z9mxxqr26/Screenshot%202016-06-15%2012.26.43.png?dl=0  Strangely, if I run the command on devgro1, I can login using the credentials on the OTHER server (devgro2), but not on the server I ran the command on.  To add to the confusion, I can't use the old method of inserting into OUser either, as it seems the password encryption hook doesn't get run: https://www.dropbox.com/s/ruxes4vkop4kigb/Screenshot%202016-06-15%2012.19.30.png?dl=0  This doesn't seem to work either: INSERT INTO OUser SET name = 'grl_loader_app', password = '{PBKDF2WithHmacSHA1}D3F6F762A910E692041EA6E08F9C2B7D59C4943111B84809:2E294F86AC8EC6FEF1B909C2881EBAB6800F59A3AFA4BC61:65536', status = 'ACTIVE', roles = (SELECT FROM ORole WHERE name = 'writer')  And UPDATE OUser causes the same conflicting update as the CREATE USER ## Steps to reproduce the problem  see above ## Important Questions  How can I work around this? ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [X] Remote ### Misc - [X] I have a distributed setup with multiple servers. How many? 2, "writeQuorum": "majority" - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.x - Please specify last number: 2.2.2 ### Operating System - [X] Linux  CentOS 7.1 - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [X] 7 - [ ] 8 </body>
		<created>2016-06-15 19:56:47</created>
		<closed>2016-08-27 19:29:59</closed>
	</bug>
	<bug>
		<id>6306</id>
		<title>remote access using Java API broken in 2.2.2 in OSGi environment?</title>
		<body>I'm running OrientDB 2.2.2 from the official docker image (with minor tweaks mainly preprocessing our environment etc.). Running on Linux (Ubuntu 14.04) 64bit. Accessing from Java API (Oracle JDK8, OSGi 4.3) using the client, core and graphdb JARs and the Blueprints 2.6.0 (wrapped as OSGi bundles using OPS4J Pax Tipi master POM).  The OSGi Java process is also running in a separate Docker container and accessing OrientDB over the network, using the URL `remote:orientdb/t2database`  Using 2.1.x, everything worked fine (but we faced some issues with concurrent access we need to track down, this is why we want to make sure to use the latest stable version to rule out OrientDB as a cause).  Now, after upgrading to 2.2.2, I always get this error (but can connect perfectly from the orientdb docker host using console):  ``` the engine 'remote' was not found. URL was: remote:orientdb/t2database. Registered engines are: [memory, plocal]     DB name="remote:orientdb/t2database"     at com.orientechnologies.orient.core.Orient.loadStorage(Orient.java:476)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.&lt;init&gt;(ODatabaseDocumentTx.java:167) ```  Seems like the server doesn't bring up the remote engine, but I see no reason why, and no error in the log, only this:  ``` Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot create the remote storage: t2database ```  and this (but seems to be #3073 which can supposedly be ignored):  ``` INFO  [OVariableParser.resolveVariables] Error on resolving property: distributed [orientechnologies] ```  Any hints on what might be the cause?  There was #4883 but it's slightly different, since it _never_ works for me from the Java client, and I have memory and plocal registered.  I am facing this issue since 2.2.0, before it worked. </body>
		<created>2016-06-15 17:29:50</created>
		<closed>2016-10-07 07:42:07</closed>
	</bug>
	<bug>
		<id>6302</id>
		<title>broken uuid() function</title>
		<body>The batch code below behave in a very inconsistent way, raising 2 critical problems: 1. It may raise java.lang.NumberFormatException when it shouldn't ....  just try to execute the code several times and it will fail at some point. 2. But even worse, when it doesn't fail it generate identical UUIDs!!!  The following image shows both issues in one place:  ![uuid](https://cloud.githubusercontent.com/assets/7320843/16065003/01a1a23c-3296-11e6-96f5-40d95838c75e.png)  Copy &amp; paste batch code:  ``` /* do not include &lt;drop class&gt; commands the first time */ drop class User; drop class Model; drop class Record;  create class Record abstract; create property Record._id string; create property Record._txn string; alter property Record._id default uuid(); alter property Record._id readonly true;  create class User extends Record clusters 1; create class Model extends Record clusters 1;  insert into Model set name = 'ModelA'; insert into User set name = 'bob'; ``` ## Important Questions ### Runninng Mode - [X] Remote (storage: PLOCAL / dbtype: DOCUMENT) ### Misc - [X] I'm using the Enterprise Edition ### OrientDB Version - [X] v2.2.2 ### Operating System - [X] Linux ### Java Version - [X] 8  java version "1.8.0_51" Java(TM) SE Runtime Environment (build 1.8.0_51-b16) Java HotSpot(TM) 64-Bit Server VM (build 25.51-b03, mixed mode) </body>
		<created>2016-06-15 00:00:14</created>
		<closed>2016-06-15 13:23:30</closed>
	</bug>
	<bug>
		<id>6300</id>
		<title>Incorrect work of sequence in 2.2.2 version</title>
		<body>## Expected behavior and actual behavior  Version 2.2.0 returns **11**.  Version 2.2.2. returns **10**. ## Steps to reproduce the problem  1) Create sequence by command: CREATE SEQUENCE song_sequence_name TYPE ORDERED START 1 INCREMENT 10  2) Get next value by command:  select sequence('song_sequence_name').next() ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [X] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [ X] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [ ] MacOSX - [X] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-06-14 08:52:54</created>
		<closed>2016-06-15 13:46:46</closed>
	</bug>
	<bug>
		<id>6280</id>
		<title>.OConcurrentModificationException: Cannot UPDATE the record #0:1 because the version is not the latest. </title>
		<body>## Expected behavior and actual behavior  Creating a new class in Orient Studio does fail [Screenshot](http://i.imgur.com/JB7wn1F.png) ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number:  ### Operating System - [x] Linux (Server) - [ ] MacOSX - [x] Windows (Client) - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-06-10 10:55:21</created>
		<closed>2016-10-11 12:01:41</closed>
	</bug>
	<bug>
		<id>6278</id>
		<title>Can not CREATE / ALTER / DROP SEQUENCE in OCommandScript</title>
		<body>## Expected behavior and actual behavior  A statement such as `CREATE SEQUENCE mySeq TYPE ORDERED` should be able to be executed but instead throws an exception:  ``` Invalid script:Encountered " &lt;CREATE&gt; "CREATE "" at line 1, column 1. Was expecting one of:     &lt;IF&gt; ...     ";" ...     &lt;IF&gt; ... ```  The issue here is actually with the parser.  The parseScript method defined in the Grammar contains the following:  ``` (         LOOKAHEAD(StatementSemicolon())         last = StatementSemicolon() {result.add(last);}         |         last = IfStatement() {result.add(last);}         |         &lt;SEMICOLON&gt;     )* ```  The key here is the StatementSemicolon() call in the LOOKAHEAD which is defined as follows:  ``` OStatement StatementSemicolon(): {OStatement result = null;} {     result = StatementInternal()     &lt;SEMICOLON&gt;     {return result;} } ```  The issue is that StatementInternal has entries for CreateClassStatement(), CreatePropertyStatement(), etc.  But CreateSequenceStatement() does not exist in the grammar.  This means that a CREATE SEQUENCE statement can never be valid in a script.  I then noticed that the work "SEQUENCE" is not even a token defined in the grammar.  This seemed odd to me since I can run the following:  ``` db.command(new OCommandSQL("CREATE SEQUENCE didSeq TYPE ORDERED;")).execute(); ```  So the "SEQUENCE" is being parsed.  Upon investigation of the `OCommandExecutorSQLCreateSequence.parse(...)` method, I noticed that it appears to be skipping the "preParse" step.  In most all other Executors the top of the parse method looks like this:  ``` Java    String queryText = textRequest.getText();     String originalQuery = queryText;     try {       queryText = preParse(queryText, iRequest);       textRequest.setText(queryText); ```  This engages the new parser.  However this step was skipped for the Create Sequence Executor.  So essentially when running a OCommandSQL, the parser is never used, so the sequence works.  But this fails when processing a OCommandScript since the Parser is invoked.  This also applies for ALTERing and DROPing a sequence.  Using a sequence is fine since that is treated as a function.   The CREATE / ALTER / DELETE SEQUENCE syntax needs be added to the parser. ## Steps to reproduce the problem  ``` Java db.command(new OCommandScript("CREATE SEQUENCE didSeq TYPE ORDERED;")).execute(); ``` ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [X] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [X] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-06-10 06:24:11</created>
		<closed>2016-06-10 12:52:44</closed>
	</bug>
	<bug>
		<id>6277</id>
		<title>Import Database Fails if DEFAULT is set on any property</title>
		<body>In 2.2.0, you can not import a database that had a default value set for one of the properties. There is a problem in the 2.2.0 version of ODatabasImport.    Starting on line 989:  ``` if (attrib.equals("\"min\""))         min = value;       else if (attrib.equals("\"max\""))         max = value;       else if (attrib.equals("\"linked-class\""))         linkedClass = value;       else if (attrib.equals("\"mandatory\""))         mandatory = Boolean.parseBoolean(value);       else if (attrib.equals("\"readonly\""))         readonly = Boolean.parseBoolean(value);       else if (attrib.equals("\"not-null\""))         notNull = Boolean.parseBoolean(value);       else if (attrib.equals("\"linked-type\""))         linkedType = OType.valueOf(value);       else if (attrib.equals("\"collate\""))         collate = value;       else if (attrib.equals("\"default-value\""))         collate = value;       else if (attrib.equals("\"customFields\""))         customFields = importCustomFields(); ```  Notice that when we get default-value we set collate.  This results in a null pointer exception later on in the code.  I noted that in the develop branch, commit 1b0f490c28a9778a74703a4adde48f7066667140 actually fixes this, even though it was trying to fix another issue.  I am not sure if this has been targeted for a 2.2.x release or not, so I wanted to bring this up in a separate issue to be tracked. ## Expected behavior and actual behavior  The database import should succeed. ## Steps to reproduce the problem  Export a database with any property that has a default value.  You will get a null pointer exception when importing that database. ## Important Questions ### Runninng Mode - [X] Embedded, using PLOCAL access mode - [X] Embedded, using MEMORY access mode - [X] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-06-09 20:38:57</created>
		<closed>2016-06-10 15:13:46</closed>
	</bug>
	<bug>
		<id>6275</id>
		<title>Error message in orientdb studo</title>
		<body>![orientdbstudiobug2](https://cloud.githubusercontent.com/assets/3005511/15930129/7a4b18e2-2e51-11e6-8758-f041f77aa280.png) ## Expected behavior and actual behavior  Error message must not get so big that you cant close the dialog.  To continue you need to refresh the browser and then you loose the queries you were working on. ## Steps to reproduce the problem  I forgot to report this bug a couple of weeks ago when i encountered it, so I cant remember the query that triggered it, but i did take a screenshot at the time. See attached file. Maybe limit the dialog dimensions and add scroll or better yet remove all the error tags displayed. ### Runninng Mode  studio ### OrientDB Version - v2.1.17  ### Operating System -  Linux  -### Java Version - 8 </body>
		<created>2016-06-09 13:04:38</created>
		<closed>2016-06-17 14:17:38</closed>
	</bug>
	<bug>
		<id>6271</id>
		<title>Associated vertices considered new, not updated, by ODirtyManager while adding edge</title>
		<body>For some reason `ODirtyManager` thinks associated vertices are new, not updated, while connecting them with the edge using graph API. As a result vertices got reinserted into indexes/storage, screwing changes commit to unique ones.  I will create a branch with the attached test case in a few minutes. </body>
		<created>2016-06-08 11:30:18</created>
		<closed>2016-06-08 13:19:52</closed>
	</bug>
	<bug>
		<id>6270</id>
		<title>storage.diskCache.bufferSize does not take effect?</title>
		<body>## Expected behavior and actual behavior  The upstart script:  ``` script exec /usr/bin/java -server -Xms384m -Xmx384m -XX:PermSize=128m -XX:MaxPermSize=128m -Dstorage.diskCache.bufferSize=1024 \     -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled \     -Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError \     -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 \     -Djava.util.logging.config.file=/etc/orientdb/logging.properties \     -Dorientdb.config.file=/etc/orientdb/config.xml \     -Dorientdb.www.path=/usr/local/orientdb-community-2.1.5/www \     -Dorientdb.build.number="salt@2.1.5" \     -cp "/usr/local/orientdb-community-2.1.5/2.1.5/lib/orientdb-server-2.1.5.jar:/usr/local/orientdb-community-2.1.5/lib/*" \     com.orientechnologies.orient.server.OServerMain end script ```  Expected behavior: `storage.diskCache.bufferSize` should take effect instead of calling [autoConfigDiskCacheSize](https://github.com/orientechnologies/orientdb/blob/master/core/src/main/java/com/orientechnologies/orient/core/config/OGlobalConfiguration.java#L774). ## Steps to reproduce the problem  Install OrientDB 2.1.5 on a VM with 2GB memory. ## Important Questions  Due to this: https://github.com/orientechnologies/orientdb/blob/master/core/src/main/java/com/orientechnologies/orient/core/config/OGlobalConfiguration.java#L784  `diskCacheInMB`  is always &lt; 0 if `osMemory`  &lt;= 2GB. So, we got this warning so often:  &gt; Not enough physical memory available for DISKCACHE: 2,001MB (heap=592MB). Set lower Maximum Heap (-Xmx setting on JVM) and restart OrientDB. Now running with DISKCACHE=256MB  The question is: why `-Dstorage.diskCache.bufferSize` does not take effect?  ``` orientdb-upstart:  + storage.diskCache.bufferSize = 1024 ```  I set it to 1GB but for some reasons: https://github.com/orientechnologies/orientdb/blob/master/core/src/main/java/com/orientechnologies/orient/core/config/OGlobalConfiguration.java#L759  `System.getProperty(DISK_CACHE_SIZE.key) == null` and `autoConfigDiskCacheSize` was called. ### Runninng Mode - [x ] Embedded, using PLOCAL access mode ### OrientDB Version - [x ] v2.1.5 ### Operating System - [x ] Linux ### Java Version - [x ] 7 </body>
		<created>2016-06-08 04:56:23</created>
		<closed>2016-07-06 09:40:41</closed>
	</bug>
	<bug>
		<id>6269</id>
		<title>java.net.SocketException: Too many open files</title>
		<body>Hello  Log files have thousands of entries like this one:  java.net.SocketException: Too many open files     at java.net.PlainSocketImpl.socketAccept(Native Method)     at java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:409)     at java.net.ServerSocket.implAccept(ServerSocket.java:545)     at java.net.ServerSocket.accept(ServerSocket.java:513)     at com.orientechnologies.orient.server.network.OServerNetworkListener.run(OServerNetworkListener.java:194)  I executed this command (while OrientDb was running):  sudo lsof | wc -l 129235  It seems orientDb open files and they never are closed. I saw for example a .pcl file opened 30 times.  Is it because we are doing something wrong from the client side or is it a bug? If it is a bug. Could you please suggest a workaround until it is fixed?  I was using Odb 2.1.15 before and I did not have this issue. But perhaps it did not happen to me before because I was not storing too much data.   In my current DB Version I created 600+ clusters.  Any help will be appreciated. </body>
		<created>2016-06-08 04:19:06</created>
		<closed>2016-07-08 09:50:39</closed>
	</bug>
	<bug>
		<id>6267</id>
		<title>OSQLNonBlockingQuery not working</title>
		<body>## Steps to reproduce the problem ## Expected behavior and actual behavior  I tried using OSQLNonBlockingQuery but i get different errors when actually using the returned odocument  (see below).  ```     OrientGraph graph = graphFactory.getTx();                try {          OSQLNonBlockingQuery&lt;Object&gt; test = new OSQLNonBlockingQuery&lt;Object&gt;("select * from Prod where pid = '421'", new OCommandResultListener() {               int resultCount = 0;               @Override               public boolean result(Object iRecord) {                 resultCount++;                  ODocument odoc = ((ODocument)iRecord);                  for(String name : odoc.fieldNames()) {     //  &lt;----------- PROBLEM                     System.out.println("Name:"+name);                 }                  System.out.println("callback "+resultCount+" invoked");                 return resultCount &gt; 20 ? false : true;               }                @Override               public void end() {               }             });          Future future = graph.command(test).execute();             System.out.println("query executed");     } catch (Exception e) {         e.printStackTrace();     } finally {          if (graph != null) {             graph.shutdown(); // &lt;------- If i remove this bit it wont throw the last exception but how do I then release resources         }     } ```  java.lang.UnsupportedOperationException: Trying to iterate over a non-blocking query result     at com.orientechnologies.orient.core.sql.query.OSQLNonBlockingQuery$ONonBlockingQueryFuture.iterator(OSQLNonBlockingQuery.java:102)     at com.tinkerpop.blueprints.impls.orient.OrientGraphCommand.execute(OrientGraphCommand.java:51)     at com.myapp.Endpoint.main(Endpoint.java:57)  May 17, 2016 11:14:40 AM com.orientechnologies.common.log.OLogManager log WARNING: Error deserializing record with id #38:235 send this data for debugging: ABpEYXRhX1Byb2R1Y3RzRwAAANdNAAAA20kAAADvSwAAASVFAAAC1kMAAALZFGVnZW5za2FiZXIAAAMaCgxncm91cHMAAAMcChRhbnZlbmRlbHNlAAADUgoYcHJvZHVjdF9uYW1lAAADVAcGdXJsAAADaAcMSU1QT1JUAAADmQcSZG93bmxvYWRzAAADuQoQcmVscGFnZXMAAASTChRyZWxwcm9kdWN0AAAElQoOc2VnbWVudAAABPIHGHByb2R1Y3Rncm91cAAABPcHTwAABP9RAAAFAAAGNDIxJlRyw6RsaW0gUFUgTGp1cyA0MjFqVmF0dGVuZmFzdCBENC1saW0gZsO2ciB0csOkLCBtZXRhbGwsIGjDpXJkIHBsYXN0IG0ubS7eBjxwIGNsYXNzPSJib2R5dGV4dCI+VHLDpGxpbSBQVSBManVzIDQyMSDDpHIgZXR0IDEta29tcG9uZW50IGZ1a3Row6RyZGFuZGUgcG9seXVyZXRhbmxpbSwgc3BlY2llbGx0IGzDpG1wbGlndCBmw7ZyIGxpbW5pbmcgYXYgdHLDpCBtZWQgaMO2ZyBmdWt0aGFsdCBzYW10IGbDtnIgbGltbmluZyBhdiBtZXRhbGwsIGjDpXJkIHBsYXN0LCBleHBhbmRlcmFkIHBvbHlzdHlyZW4gKGNlbGxwbGFzdCksIGtlcmFtaXNrYSBtYXRlcmlhbCBtLm0uIDwvcD48cCBjbGFzcz0iYm9keXRleHQiPlRyw6RsaW0gUFUgTGp1cyA0MjEgYW52w6RuZHMgZMOkciBkZXQgc3TDpGxscyBzw6Ryc2tpbHQgaMO2Z2Ega3JhdiBww6UgdmFudHRlbmZhc3RoZXQgb2NoIHN0eXJrYS4gTGltbWV0IHVwcGZ5bGxlciBrcmF2ZW4gdGlsbCBrbGFzcyBENCwgZW5sLiBFTiAyMDQvMjA1LiA8L3A+BHNlBAcKdXJsLWwAAALwBwcGdXJsAAADBQcoL3BpY3MvMGEzNWE1ZTMyYy5qcGcoL3BpY3MvNGU4ZjZmNGY1Yy5qcGcAFwgXBxxwcm9kdWt0a2F0YWxvZwcIYnlnZwcOdHJhZWxpbQcmdHJhZWxpbS1wdS1sanVzLTQyMQAXJnRyYWVsaW0tcHUtbGp1cy00MjFgcHJvZHVrdGthdGFsb2cvYnlnZy90cmFlbGltL3RyYWVsaW0tcHUtbGp1cy00MjEvPkRBTkFMSU1fSU1QT1JUXzIwMTYtMjgtMTIgMTE6MjgGFwwEBwZhbHQAAAPRBwcGdXJsAAAD5AckUHJvZHVrdGluZm9ybWF0aW9uPC9wcm9kdWt0aW5mb3JtYXRpb24vc2UvNDIxLnBkZgwEBwZhbHQAAAQZBwcGdXJsAAAELAckU8Oka2VyaGV0c2RhdGFibGFkPC9zaWtrZXJoZWRzZGF0YWJsYWQvc2UvNDIxLnBkZgwEBwZhbHQAAARhBwcGdXJsAAAEdQcmQnlnZ3ZhcnVkZWtsYXJhdGlvbjovYnlnZ3ZhcnVkZWtsYXRpb24vc2UvNDIxLnBkZgAXAhcMBAcEdjEAAASrBwcEdjIAAATdB2Jwcm9kdWt0a2F0YWxvZy9ieWdnL3RyYWVsaW0vdHJhZWxpbS1wdS1tb2Vyay00MjIvKFRyw6RsaW0gUFUgTcO2cmsgNDIyCGJ5Z2cOdHJhZWxpbQAA Exception in thread "Thread-3" com.orientechnologies.orient.core.exception.ODatabaseException: Database 'remote:orientdb:2424/mydb' is closed     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.checkOpeness(ODatabaseDocumentTx.java:2920)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.getMetadata(ODatabaseDocumentTx.java:793)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.getMetadata(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.setClassNameIfExists(ODocument.java:1917)     at com.orientechnologies.orient.core.record.impl.ODocument.fillClassIfNeed(ODocument.java:2180)     at com.orientechnologies.orient.core.record.impl.ODocumentInternal.fillClassNameIfNeeded(ODocumentInternal.java:64)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserialize(ORecordSerializerBinaryV0.java:159)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.fromStream(ORecordSerializerBinary.java:74)     at com.orientechnologies.orient.core.record.impl.ODocument.deserializeFields(ODocument.java:1817)     at com.orientechnologies.orient.core.record.impl.ODocument.checkForFields(ODocument.java:2416)     at com.orientechnologies.orient.core.record.impl.ODocument.fieldNames(ODocument.java:736)     at com.myapp.Endpoint$1.result(Endpoint.java:42)     at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1214)     at com.orientechnologies.orient.client.remote.OStorageRemoteThread.command(OStorageRemoteThread.java:453)     at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:72)     at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)     at com.orientechnologies.orient.core.sql.query.OSQLNonBlockingQuery.access$001(OSQLNonBlockingQuery.java:47)     at com.orientechnologies.orient.core.sql.query.OSQLNonBlockingQuery$1.run(OSQLNonBlockingQuery.java:258)     at java.lang.Thread.run(Thread.java:745) ## Important Questions  If I dont do a graph.shutdown() it will print the fieldnames and not throw the last exception but then how do I release my resources?  In the event I get the non-blocking query working is it possible to return results in batches (I suspect otherwise I will get into trouble with latency given Im using a remote connection)? ### Runninng Mode - Remote ### OrientDB Version - v2.1.17 ### Operating System - Linux ### Java Version -  8 </body>
		<created>2016-06-07 13:05:02</created>
		<closed>2016-11-24 20:18:47</closed>
	</bug>
	<bug>
		<id>6261</id>
		<title>CREATE VERTEX fails, INSERT INTO works</title>
		<body>## Expected behavior and actual behavior  com.orientechnologies.orient.core.exception.OValidationException: The field 'MyVertex.test' has been declared as EMBEDDED but an incompatible type is used. Value: {name=Luca}     Storage URL="plocal:/home/lucafrosini/workspace/orientdb-community-2.2.0/databases/test" [ONetworkProtocolHttpDb] ## Steps to reproduce the problem  ``` sql CREATE CLASS MyVertex EXTENDS V CREATE CLASS MyEmbedded CREATE PROPERTY MyVertex.test EMBEDDED MyEmbedded CREATE PROPERTY MyEmbedded.name STRING ```  These queries fail:  ``` sql CREATE VERTEX MyVertex SET test = {"name":"Luca"} CREATE VERTEX MyVertex CONTENT { "test" : {"name":"Luca"} } ```  This query works instead:  ``` sql INSERT INTO MyVertex SET test = {"name":"Luca"} ``` ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode (OrientDB Studio) - [ ] Embedded, using MEMORY access mode - [] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number:  ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [x] 7 - [ ] 8 </body>
		<created>2016-06-06 09:39:48</created>
		<closed>2016-06-06 10:38:55</closed>
	</bug>
	<bug>
		<id>6259</id>
		<title>[ OrientDB v2.2.0 ] Query with an old TokenAuth cause a NullPointerException</title>
		<body>Query with an old TokenAuth cause a NullPointerException with an error message shifted by one position in the protocol.  I performed a query passing to the protocol an TokenAuth from a preeceding connection:  ``` python         self.client = pyorient.OrientDB("localhost", 2424)         assert self.client.get_session_token() == b''          global old_token ##   'GratefulDeadConcertsU#$ORecordDocument2csv(OrientDB Python binary client (pyorient)1.4.9Io4Kl}hZEC'          self.client.set_session_token( old_token )         record = self.client.query( 'select from V limit 2' ) ```  I receive a NullPointerException without a debug message:  ```  2016-06-06 01:02:08:351 INFO  /127.0.0.1:63984 - Writing byte (1 byte): 1 [OChannelBinaryServer] 2016-06-06 01:02:08:351 INFO  /127.0.0.1:63984 - Writing string (4+30=34 bytes): java.lang.NullPointerException [OChannelBinaryServer]  ### THIS Field string seems wrong 2016-06-06 01:02:08:351 INFO  /127.0.0.1:63984 - Writing string (4+0=4 bytes): null [OChannelBinaryServer] 2016-06-06 01:02:08:351 INFO  /127.0.0.1:63984 - Writing byte (1 byte): 0 [OChannelBinaryServer]  ## This should be the java exception string 2016-06-06 01:02:08:351 INFO  /127.0.0.1:63984 - Writing bytes (4+983=987 bytes): [-84, -19, 0, 5, 115, 114, 0, 30, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 78, 117, 108, 108, 80, 111, 105, 110, 116, 101, 114, 69, 120, 99, 101, 112, 116, 105, 111, 110, 71, -91, -95, -114, -1, 49, -31, -72, 2, 0, 0, 120, 114, 0, 26, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101, 69, 120, 99, 101, 112, 116, 105, 111, 110, -98, 95, 6, 71, 10, 52, -125, -27, 2, 0, 0, 120, 114, 0, 19, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 69, 120, 99, 101, 112, 116, 105, 111, 110, -48, -3, 31, 62, 26, 59, 28, -60, 2, 0, 0, 120, 114, 0, 19, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 84, 104, 114, 111, 119, 97, 98, 108, 101, -43, -58, 53, 39, 57, 119, -72, -53, 3, 0, 4, 76, 0, 5, 99, 97, 117, 115, 101, 116, 0, 21, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 84, 104, 114, 111, 119, 97, 98, 108, 101, 59, 76, 0, 13, 100, 101, 116, 97, 105, 108, 77, 101, 115, 115, 97, 103, 101, 116, 0, 18, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 91, 0, 10, 115, 116, 97, 99, 107, 84, 114, 97, 99, 101, 116, 0, 30, 91, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 97, 99, 107, 84, 114, 97, 99, 101, 69, 108, 101, 109, 101, 110, 116, 59, 76, 0, 20, 115, 117, 112, 112, 114, 101, 115, 115, 101, 100, 69, 120, 99, 101, 112, 116, 105, 111, 110, 115, 116, 0, 16, 76, 106, 97, 118, 97, 47, 117, 116, 105, 108, 47, 76, 105, 115, 116, 59, 120, 112, 113, 0, 126, 0, 8, 112, 117, 114, 0, 30, 91, 76, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 97, 99, 107, 84, 114, 97, 99, 101, 69, 108, 101, 109, 101, 110, 116, 59, 2, 70, 42, 60, 60, -3, 34, 57, 2, 0, 0, 120, 112, 0, 0, 0, 4, 115, 114, 0, 27, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 97, 99, 107, 84, 114, 97, 99, 101, 69, 108, 101, 109, 101, 110, 116, 97, 9, -59, -102, 38, 54, -35, -123, 2, 0, 4, 73, 0, 10, 108, 105, 110, 101, 78, 117, 109, 98, 101, 114, 76, 0, 14, 100, 101, 99, 108, 97, 114, 105, 110, 103, 67, 108, 97, 115, 115, 113, 0, 126, 0, 5, 76, 0, 8, 102, 105, 108, 101, 78, 97, 109, 101, 113, 0, 126, 0, 5, 76, 0, 10, 109, 101, 116, 104, 111, 100, 78, 97, 109, 101, 113, 0, 126, 0, 5, 120, 112, 0, 0, 5, 32, 116, 0, 82, 99, 111, 109, 46, 111, 114, 105, 101, 110, 116, 101, 99, 104, 110, 111, 108, 111, 103, 105, 101, 115, 46, 111, 114, 105, 101, 110, 116, 46, 115, 101, 114, 118, 101, 114, 46, 110, 101, 116, 119, 111, 114, 107, 46, 112, 114, 111, 116, 111, 99, 111, 108, 46, 98, 105, 110, 97, 114, 121, 46, 79, 78, 101, 116, 119, 111, 114, 107, 80, 114, 111, 116, 111, 99, 111, 108, 66, 105, 110, 97, 114, 121, 116, 0, 27, 79, 78, 101, 116, 119, 111, 114, 107, 80, 114, 111, 116, 111, 99, 111, 108, 66, 105, 110, 97, 114, 121, 46, 106, 97, 118, 97, 116, 0, 7, 99, 111, 109, 109, 97, 110, 100, 115, 113, 0, 126, 0, 11, 0, 0, 1, -69, 113, 0, 126, 0, 13, 113, 0, 126, 0, 14, 116, 0, 14, 101, 120, 101, 99, 117, 116, 101, 82, 101, 113, 117, 101, 115, 116, 115, 113, 0, 126, 0, 11, 0, 0, 0, -69, 113, 0, 126, 0, 13, 113, 0, 126, 0, 14, 116, 0, 7, 101, 120, 101, 99, 117, 116, 101, 115, 113, 0, 126, 0, 11, 0, 0, 0, 77, 116, 0, 47, 99, 111, 109, 46, 111, 114, 105, 101, 110, 116, 101, 99, 104, 110, 111, 108, 111, 103, 105, 101, 115, 46, 99, 111, 109, 109, 111, 110, 46, 116, 104, 114, 101, 97, 100, 46, 79, 83, 111, 102, 116, 84, 104, 114, 101, 97, 100, 116, 0, 16, 79, 83, 111, 102, 116, 84, 104, 114, 101, 97, 100, 46, 106, 97, 118, 97, 116, 0, 3, 114, 117, 110, 115, 114, 0, 38, 106, 97, 118, 97, 46, 117, 116, 105, 108, 46, 67, 111, 108, 108, 101, 99, 116, 105, 111, 110, 115, 36, 85, 110, 109, 111, 100, 105, 102, 105, 97, 98, 108, 101, 76, 105, 115, 116, -4, 15, 37, 49, -75, -20, -114, 16, 2, 0, 1, 76, 0, 4, 108, 105, 115, 116, 113, 0, 126, 0, 7, 120, 114, 0, 44, 106, 97, 118, 97, 46, 117, 116, 105, 108, 46, 67, 111, 108, 108, 101, 99, 116, 105, 111, 110, 115, 36, 85, 110, 109, 111, 100, 105, 102, 105, 97, 98, 108, 101, 67, 111, 108, 108, 101, 99, 116, 105, 111, 110, 25, 66, 0, -128, -53, 94, -9, 30, 2, 0, 1, 76, 0, 1, 99, 116, 0, 22, 76, 106, 97, 118, 97, 47, 117, 116, 105, 108, 47, 67, 111, 108, 108, 101, 99, 116, 105, 111, 110, 59, 120, 112, 115, 114, 0, 19, 106, 97, 118, 97, 46, 117, 116, 105, 108, 46, 65, 114, 114, 97, 121, 76, 105, 115, 116, 120, -127, -46, 29, -103, -57, 97, -99, 3, 0, 1, 73, 0, 4, 115, 105, 122, 101, 120, 112, 0, 0, 0, 0, 119, 4, 0, 0, 0, 0, 120, 113, 0, 126, 0, 29, 120] [OChannelBinaryServer]  # ---&gt;  java.lang.NullPointerException -  ``` </body>
		<created>2016-06-05 23:11:13</created>
		<closed>2016-07-07 11:30:37</closed>
	</bug>
	<bug>
		<id>6255</id>
		<title>Error retrieving record</title>
		<body>`Jun 03, 2016 5:49:50 PM com.orientechnologies.common.log.OLogManager log SEVERE: {db=$home$alex$.openchrom$1.1.x$net.openchrom.chromatogram.xxd.identifier.supplier.chromident$test11} Error on fetching record during browsing. The record has been skipped com.orientechnologies.orient.core.exception.ODatabaseException: Error on retrieving record #15:77 (cluster: chromident_reference_peak)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1855)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.loadRecord(OTransactionNoTx.java:96)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1596)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:122)     at com.orientechnologies.orient.core.iterator.OIdentifiableIterator.readCurrentRecord(OIdentifiableIterator.java:287)     at com.orientechnologies.orient.core.iterator.ORecordIteratorClusters.hasNext(ORecordIteratorClusters.java:160)     at net.openchrom.chromatogram.xxd.identifier.supplier.xident.database.controller.DatabasesOrientDB.deleteOrigin(DatabasesOrientDB.java:148)     at net.openchrom.chromatogram.xxd.identifier.supplier.xident.ui.internal.runnables.DatabaseOriginDeleteRunnable.run(DatabaseOriginDeleteRunnable.java:35)     at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:119) Caused by: com.orientechnologies.common.directmemory.ODirectMemoryViolationException: Last position of provided data interval [771883588] is more than size of allocated area [65552]     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.rangeCheck(OUntrackedDirectMemoryPointer.java:240)     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.get(OUntrackedDirectMemoryPointer.java:83)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.getBinaryValue(ODurablePage.java:113)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPage.getRecordBinaryValue(OClusterPage.java:395)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readFullEntry(OPaginatedCluster.java:1341)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:516)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doReadRecord(OAbstractPaginatedStorage.java:2076)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1804)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:782)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3092)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1820)     ... 8 more` ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [x] v2.1.x - Please specify last number:  - [ ] v2.2.x - Please specify last number:  ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-06-03 15:55:47</created>
		<closed>2016-08-10 11:01:05</closed>
	</bug>
	<bug>
		<id>6250</id>
		<title>Passing quoted strings to methods removes quotes.</title>
		<body>## Expected behavior and actual behavior  When passing a quoted string to a function the function should use the quoted version of the string.  Instead the quotes seem to be stripped. ## Steps to reproduce the problem  Run the following SQL.  ``` SQL DROP CLASS test; CREATE CLASS test; CREATE PROPERTY test.id String; CREATE PROPERTY test.value String;  INSERT INTO test SET id = "1", value = "Test 1: "; UPDATE test SET value = value.append("\"double quotes\"") WHERE id = "1";  INSERT INTO test SET id = "2", value = "Test 2: "; UPDATE test SET value = value.append("'single quotes'") WHERE id = "2";  INSERT INTO test SET id = "3", value = "Test 3: "; UPDATE test SET value = value.append("\"mixed quotes'") WHERE id = "3";  INSERT INTO test SET id = "4", value = "Test 4: "; UPDATE test SET value = value.append("\"one quote") WHERE id = "4";  INSERT INTO test SET id = "5", value = "Test 5: "; UPDATE test SET value = value.append("\"nested \"quotes\" in quotes\"") WHERE id = "5";  SELECT * FROM test; ```  Output:  Test 1: double quotes - Both surrounding quotes are stripped  Test 2: single quotes - Both surrounding quotes are stripped  Test 3: "mixed quotes' - Both quotes left  Test 4: "one quote - preceding quote intact  Test 5: nested "quotes" in quotes - Outer quotes are stripped, inner quotes are left.  It seems that this might be a parser issue given the sensitivity to matched quotes and the fact that only outer quotes are being stripped.  This is not unique to the append method, it also was noted in "right", and "substring" as well.  Also, when doing an INSERT, the quotes seem to be just fine, so it appears to be related to quoted strings passed to functions. ## Important Questions  None ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ X] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X ] v2.2.x - Please specify last number: 2.2.0 ### Operating System - [ ] Linux - [ X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [ X] 8 </body>
		<created>2016-06-03 06:13:06</created>
		<closed>2018-10-24 06:23:09</closed>
	</bug>
	<bug>
		<id>6244</id>
		<title>Can't get rid of MaxDirectMemorySize warning</title>
		<body># This started to happen with community v2.2.0  When deploying web app to tomcat 8, I started to see the warnings below, even when the values are apparently correctly set in configuration:  ``` 02-Jun-2016 10:29:36.370 INFO [localhost-startStop-3] com.orientechnologies.common.log.OLogManager.log OrientDB auto-config DISKCACHE=1,877MB (heap=1,877MB direct=1,877MB os=7,982MB), assuming maximum direct memory size equals to maximum JVM heap size 02-Jun-2016 10:29:36.399 WARNING [localhost-startStop-3] com.orientechnologies.common.log.OLogManager.log MaxDirectMemorySize JVM option is not set or has invalid value, that may cause out of memory errors. Please set the -XX:MaxDirectMemorySize=7982m option when you start the JVM. 02-Jun-2016 10:29:36.402 WARNING [localhost-startStop-3] com.orientechnologies.common.log.OLogManager.log MBean with name com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean has already registered. Probably your system was not shutdown correctly or you have several running applications which use OrientDB engine inside 02-Jun-2016 10:29:36.403 WARNING [localhost-startStop-3] com.orientechnologies.common.log.OLogManager.log MaxDirectMemorySize JVM option is not set or has invalid value, that may cause out of memory errors. Please set the -XX:MaxDirectMemorySize=7982m option when you start the JVM. 02-Jun-2016 10:29:36.416 WARNING [localhost-startStop-3] com.orientechnologies.common.log.OLogManager.log MBean with name com.orientechnologies.common.directmemory:type=OByteBufferPoolMXBean has already registered. Probably your system was not shutdown correctly or you have several running applications which use OrientDB engine inside 02-Jun-2016 10:29:36.475 INFO [localhost-startStop-3] com.orientechnologies.common.log.OLogManager.log Registered the new available server 'dev.vlasni.com:2424' ``` ## server.sh  `JAVA_OPTS_SCRIPT="-Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError -XX:MaxDirectMemorySize=512g -Djava.awt.headless=true -Dfile.encoding=UTF8 -Drhino.opt.level=9 -XX:+AggressiveOpts -XX:CompileThreshold=200" ` `ORIENTDB_OPTS_MEMORY="-Xms768m -Xmx768m"` `MAXDISKCACHE="-Dstorage.diskCache.bufferSize=5376"`  Is there something I am missing in configuration that produces these warnings?  Any help would be greatly appreciated. ### Runninng Mode - [ ] Remote ### OrientDB Version - [ ] v2.2.0 ### Operating System - [ ] Linux ### Java Version - [ ] 8  Thanks </body>
		<created>2016-06-02 13:41:13</created>
		<closed>2016-06-03 11:12:50</closed>
	</bug>
	<bug>
		<id>6243</id>
		<title>False duplicate record exception when using Graph API</title>
		<body>## Expected behavior and actual behavior  I want to create two vertices connected by an edge in one transaction. The vertex class has an index on a field named "label". I should be able to set up the indexed property "label" (with different values) just before the commit of the transaction but an ODuplicateRecordException is triggered in this case.  I have been impacted by this issue when migrating to v2.2.0, because of the new default setting for indices "ignoreNullValues", explained in [this doc](https://github.com/orientechnologies/orientdb-docs/blob/master/Release-2.2.0.md) I am now setting ignoreNullValues to true on index creation as a temporary workaround. ## Steps to reproduce the problem  1) Transaction begins 2) Create the 2 vertices with addVertex(myClass). 3) Call firstVertex.addEdge(edgeName, secondVertex) 4) Set up the labels :  firstVertex.setProperty(label, "firstLabel"); secondVertex.setProperty(label, "secondLabel"); 5) Commit ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number:  ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-06-02 13:18:48</created>
		<closed>2016-06-16 08:38:45</closed>
	</bug>
	<bug>
		<id>6241</id>
		<title>Match is not supported from the console</title>
		<body>The MATCH is not supported in console. </body>
		<created>2016-06-01 22:15:33</created>
		<closed>2016-06-03 08:01:49</closed>
	</bug>
	<bug>
		<id>6236</id>
		<title>IN filter parameter binding problem</title>
		<body>hey,  I have to queries:  1. `SELECT EXPAND(out()[age = :value]) FROM #11:0 ORDER BY age asc ` This works as expected.  2. `SELECT EXPAND(out()[age IN :values]) FROM #11:0 ORDER BY age asc ` This throws an exception.  com.orientechnologies.orient.core.exception.OQueryParsingException: Error on parsing command at position #0: Error on parsing query Query: age IN [31, 34 ------^  ``` at com.orientechnologies.orient.core.sql.filter.OSQLPredicate.text(OSQLPredicate.java:103) at com.orientechnologies.orient.core.sql.filter.OSQLPredicate.&lt;init&gt;(OSQLPredicate.java:58) at com.orientechnologies.orient.core.record.impl.ODocumentHelper.getFieldValue(ODocumentHelper.java:470) at com.orientechnologies.orient.core.sql.functions.coll.OSQLMethodMultiValue.execute(OSQLMethodMultiValue.java:54) at com.orientechnologies.orient.core.sql.methods.OSQLMethodRuntime.execute(OSQLMethodRuntime.java:139) at com.orientechnologies.orient.core.sql.filter.OSQLFilterItemAbstract.transformValue(OSQLFilterItemAbstract.java:141) at com.orientechnologies.orient.core.sql.functions.OSQLFunctionRuntime.execute(OSQLFunctionRuntime.java:133) at com.orientechnologies.orient.core.sql.functions.OSQLFunctionRuntime.getValue(OSQLFunctionRuntime.java:147) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.applyExpand(OCommandExecutorSQLSelect.java:2255) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:447) at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1433) at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1406) at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:72) at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:85) at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.query(ODatabaseDocumentTx.java:717) ```  ....  Caused by: java.lang.IllegalStateException: Missing closed braket character: ']', position: 14     at com.orientechnologies.common.parser.OBaseParser.parserNextWord(OBaseParser.java:624)     at com.orientechnologies.common.parser.OBaseParser.parserNextWord(OBaseParser.java:494)     at com.orientechnologies.orient.core.sql.filter.OSQLPredicate.extractConditionItem(OSQLPredicate.java:264)     at com.orientechnologies.orient.core.sql.filter.OSQLPredicate.extractCondition(OSQLPredicate.java:195)     at com.orientechnologies.orient.core.sql.filter.OSQLPredicate.extractConditions(OSQLPredicate.java:139)     at com.orientechnologies.orient.core.sql.filter.OSQLPredicate.text(OSQLPredicate.java:93)     ... 53 more  I'm using 2.1.17.  What could be the issue here? </body>
		<created>2016-05-31 16:27:29</created>
		<closed>2016-06-03 09:45:30</closed>
	</bug>
	<bug>
		<id>6235</id>
		<title>Server side warning when unsubscribing from live query</title>
		<body>## Expected behavior and actual behavior  Unsubscribing from a live query outputs a warning in the server side console, like  &gt; 2016-05-31 16:50:29:911 WARNI {db=GratefulDeadConcerts} Error on unsubscribing client [Class]  Expectation is to not get a warning. Btw, why is **WARNI** ouput instead of **WARNING** (typo?) ## Steps to reproduce the problem - Connect to GratefulDeadConcerts db from OrientDB studio - run `live select from V` (note the returned token) - run `live unsubscribe -2077293922` (actually provide the token from previous step) - check the server console output, the warning should be visible. ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [X] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.0 - Please specify last number:  ### Operating System - [ ] Linux - [ ] MacOSX - [X] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-05-31 14:57:03</created>
		<closed>2016-06-07 10:14:33</closed>
	</bug>
	<bug>
		<id>6234</id>
		<title>com.orientechnologies.orient.core.exception.OStorageException: Cannot put key value entry in index</title>
		<body>## Expected behavior and actual behavior  As advised by @laa, I had moved to orientdb v2.2.0 from v2.1.10 to counter issue #6219. I am running the same code as in #6219 on v2.2.0. Consequently, that issue is not happening, but I am facing an OStorageException. I suspect it is again an index issue. Given below is the exception stack for this issue: **Exception in thread "main" com.orientechnologies.orient.core.exception.OStorageException: Cannot put key value entry in index**     Storage URL="plocal:/home/intern/orientdb-community-2.2.0/databases/LinkedDataStore"     Storage URL="plocal:/home/intern/orientdb-community-2.2.0/databases/LinkedDataStore"     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)     at java.lang.reflect.Constructor.newInstance(Constructor.java:423)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.throwSerializedException(OChannelBinaryAsynchClient.java:431)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.handleStatus(OChannelBinaryAsynchClient.java:382)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:264)     at com.orientechnologies.orient.client.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:152)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2204)     at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2199)     at com.orientechnologies.orient.client.remote.OStorageRemote$20.execute(OStorageRemote.java:1271)     at com.orientechnologies.orient.client.remote.OStorageRemote$20.execute(OStorageRemote.java:1244)     at com.orientechnologies.orient.client.remote.OStorageRemote.networkOperation(OStorageRemote.java:160)     at com.orientechnologies.orient.client.remote.OStorageRemote.commit(OStorageRemote.java:1244)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:549)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:109)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2664)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2634)     at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.commit(OrientTransactionalGraph.java:175)     at org.formcept.knowledge.base.graph.FCOrientGraph.addNode(FCOrientGraph.java:104)     at org.formcept.knowledge.base.core.KnowledgeBuilder.addResources(KnowledgeBuilder.java:192)     at org.formcept.knowledge.base.core.KnowledgeBuilder.traverseEntireGraph(KnowledgeBuilder.java:274)     at org.formcept.knowledge.base.core.KnowledgeBuilder.initKnowledgeGraph(KnowledgeBuilder.java:158)     at test.TestKnowledgeBase.main(TestKnowledgeBase.java:44) **Caused by: com.orientechnologies.orient.core.exception.OStorageException: Error during index update**     Storage URL="plocal:/home/intern/orientdb-community-2.2.0/databases/LinkedDataStore"     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:418)     at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.put(OHashTableIndexEngine.java:153)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateIndexEntry(OAbstractPaginatedStorage.java:1885)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateIndexEntry(OAbstractPaginatedStorage.java:1813)     at com.orientechnologies.orient.core.index.OIndexFullText.put(OIndexFullText.java:110)     at com.orientechnologies.orient.core.index.OIndexFullText.put(OIndexFullText.java:45)     at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:897)     at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:742)     at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:729)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitIndexes(OAbstractPaginatedStorage.java:1374)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1335)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:555)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:109)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2664)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2634)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1255)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:447)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:187)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) **Caused by: java.lang.IllegalArgumentException: Given value is present in bucket.**     at com.orientechnologies.orient.core.index.hashindex.local.OHashIndexBucket.addEntry(OHashIndexBucket.java:249)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1501)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:410)     ... 18 more ### Running Mode - Remote ### OrientDB Version - v2.2.0 ### Operating System - Linux ### Java Version - 8  Prompt reply is much appreciated. It is kind of urgent for us. Thanks. </body>
		<created>2016-05-31 11:01:10</created>
		<closed>2016-08-27 19:24:02</closed>
	</bug>
	<bug>
		<id>6229</id>
		<title>Encryption at rest accepts any key</title>
		<body>## Expected behavior and actual behavior  Expected : Create followed by Open of an ODatabaseDocumentTx honors the encryption key. Actual : Create followed by Open of an ODatabaseDocumentTx does not honor the encryption key during the Open.  The open ignores the encryption key in this case. ## Steps to reproduce the problem  Execute the deleteCreateOpenDeleteDB test which will show that you can create the database with an encryption key and then open it with an incorrect key in the same process.  To prove that the database is encrypted run the following tests independently in sequence: Run the following test: `deleteCreateOpenDeleteDB()`  This succeeds but it should not.  It creates the database with one key and then opens it with another key which should not be allowed.  To prove that the database is actually encrypted and requires the correct key to open, run the following one at a time (separate vm processes):  ``` dropDB : drop the database if it exists createDB : creates the db with the correct key openDB : tries to open the db with an incorrect key and this correctly fails! ```  ``` package orientdb;  import com.orientechnologies.orient.core.config.OGlobalConfiguration; import com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx; import org.junit.Test;  public class EncryptionTest {     private final String url    = "plocal:tmp/orientdb/encryption";     private final String method = "aes";     private final String key    = "E95F22239273CA4F52A8847F27F76507";     private final String badKey = "11111111111111111111111111111111";     private final String user   = "admin";     private final String pword  = "admin";      @Test     public void deleteCreateOpenDeleteDB() {                 dropDB();         createDB();         openDB();         dropDB();     }     @Test     public void createDB() {         System.out.format("Creating %s%n", url);         ODatabaseDocumentTx db = new ODatabaseDocumentTx(url);         db.setProperty(OGlobalConfiguration.STORAGE_ENCRYPTION_METHOD.getKey(), method);         db.setProperty(OGlobalConfiguration.STORAGE_ENCRYPTION_KEY.getKey(), key);         db.create().close();     }     @Test     public void openDB() {         System.out.format("Opening %s%n", url);         ODatabaseDocumentTx db = new ODatabaseDocumentTx(url);         db.setProperty(OGlobalConfiguration.STORAGE_ENCRYPTION_KEY.getKey(), badKey);         db.open(user, pword).close();     }     @Test     public void dropDB() {         System.out.format("Dropping %s%n", url);         ODatabaseDocumentTx db = new ODatabaseDocumentTx(url);         db.setProperty(OGlobalConfiguration.STORAGE_ENCRYPTION_KEY.getKey(), key);         if (db.exists()) {             db.open(user, pword).drop();         }     } } ``` ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number: 0 ### Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-05-30 17:02:24</created>
		<closed>2016-07-19 20:12:35</closed>
	</bug>
	<bug>
		<id>6227</id>
		<title>OGlobalConfiguration.autoConfigDiskCacheSize throws NumberFormatException </title>
		<body>## Expected behavior and actual behavior  I use OrientDB v2.2.0 with the IKVM (.NET based) JAVA runtime and get NumberFormatException in function OGlobalConfiguration.autoConfigDiskCacheSize during the call `DISK_CACHE_SIZE.setValue(diskCacheInMB);` in the `if (maxDirectMemory == -1)`code path  diskCacheInMB is a long value and is derived from `jvmMaxMemory = Runtime.getRuntime().maxMemory();` The IKVM runtime returns long.MAX_VALUE for `Runtime.getRuntime().maxMemory();` which makes diskCacheInMB still out of range for integer values and finally causes the exception.  The expected behaviour would be that any long value is considered valid and is handled correctly. ## Steps to reproduce the problem  Due to the complexity to setup the IKVM environment the easiest to reproduce would be to replace the call `final long jvmMaxMemory = Runtime.getRuntime().maxMemory();` in OGlobalConfiguration.autoConfigDiskCacheSize with `final long jvmMaxMemory = Long.MAX_VALUE;` ## Important Questions ### Runninng Mode - [X] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.0 - Please specify last number:  ### Operating System - [ ] Linux - [ ] MacOSX - [X] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version (IKVM Runtime) - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-05-30 15:03:17</created>
		<closed>2016-06-01 12:48:51</closed>
	</bug>
	<bug>
		<id>6219</id>
		<title>com.orientechnologies.orient.core.index.OIndexException: Error during insertion of key in index</title>
		<body>## Expected behavior and actual behavior  OrientDB version used: 2.1.10 I am uploading full dbpedia dataset into orientDB. I have created a schema in which i have some properties defined on my custom vertex and edge classes. There are some Hash indices also defined on some of those properties. I am parsing the dbpedia graph from top to bottom in breadth-first fashion from Jena TDB and inserting into OrientDB. But i am getting this OIndexException after insertion of 27151 nodes and 30605 edges, though there was considerable amount of system-memory left. All indices used are of type HASH_INDEX (UNIQUE, NOT_UNIQUE, and FULL_TEXT). The full stack trace is given below: Exception in thread "main" com.orientechnologies.orient.core.index.OIndexException: Error during insertion of key in index     at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:162)     at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:52)     at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:965)     at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:1151)     at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:762)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic$CommitIndexesCallback.run(OTransactionOptimistic.java:101)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1211)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2689)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2658)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1225)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:404)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OStorageException     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:381)     at com.orientechnologies.orient.core.index.engine.OHashTableIndexEngine.put(OHashTableIndexEngine.java:153)     at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:155)     ... 14 more **Caused by: java.lang.IllegalStateException: Extendible hashing tree in corrupted state.**     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.getBucket(OLocalHashTable.java:1848)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1315)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.doPut(OLocalHashTable.java:1413)     at com.orientechnologies.orient.core.index.hashindex.local.OLocalHashTable.put(OLocalHashTable.java:373)     ... 16 more ### Running Mode - Remote on the same machine. ### OrientDB Version - v2.1.10 ### Operating System - Linux ### Java Version - 8  This is an urgent issue for us as we are trying to deploy OrientDB in our production environment. Any help is much appreciated. Thanks. </body>
		<created>2016-05-27 10:39:58</created>
		<closed>2016-05-31 06:01:54</closed>
	</bug>
	<bug>
		<id>6217</id>
		<title>LiveQuery do not work after an exceptional shutdown of  NodeJS</title>
		<body>OrientDB 2.1.6  OrientJS 2.2 ## My code is like the following.  var OrientDB = require('orientjs'); var server = OrientDB({host: 'localhost', port: 2424}); var db = server.use({name: 'test', username: 'admin', password: 'admin'}); db.liveQuery("live select from V")     .on('live-insert', function(data){           .......     })     .on('live-delete', function(data){           .......     })     .on('live-update', function(data){           .......     })  ........ LIVE UNSUBSCRIBE iToken (I get the iToken by changing OrientJS source code) ## ........  It works as I wish.  However, if  I kill the NodeJS process left the UNSUBSCRIBE command not executed,  the problem comes. None of the callbacks( .on('live-XXX', function(data){...} )  is called when data changed, while no exception thrown.  Until the OrientDB re-started, LiveQuery get normal. </body>
		<created>2016-05-27 04:56:54</created>
		<closed>2016-06-21 07:11:05</closed>
	</bug>
	<bug>
		<id>6216</id>
		<title>SQL: create user doesn't work</title>
		<body>The command:  ``` create user TestUser identified by password ROLE ['reader','writer'] ```  Is transformed in  ``` INSERT INTO OUser SET name='TestUser',password='password',status='ACTIVE',roles=(SELECT FROM ORole WHERE name IN [''reader'', ''writer'']) ``` </body>
		<created>2016-05-26 16:42:01</created>
		<closed>2016-05-28 07:59:51</closed>
	</bug>
	<bug>
		<id>6210</id>
		<title>Test cases failing with " SIG TRAP " errors"</title>
		<body>Getting test case failures with below errors on  ``` $ mvn clean install -------------------------------------------------------  T E S T S ------------------------------------------------------- Running TestSuite May 25, 2016 7:24:28 AM com.orientechnologies.common.log.OLogManager log INFO: OrientDB auto-config DISKCACHE=30,286MB (heap=1,820MB os=127,852MB disk=60,573MB) May 25, 2016 7:24:28 AM com.orientechnologies.common.log.OLogManager log INFO: Received signal: SIGTRAP May 25, 2016 7:24:28 AM com.orientechnologies.common.log.OLogManager log INFO: Received signal: SIGTRAP May 25, 2016 7:24:28 AM com.orientechnologies.common.log.OLogManager log INFO: Received signal: SIGTRAP # # A fatal error has been detected by the Java Runtime Environment: # #  Internal Error (safepoint.cpp:310), pid=1714, tid=70366099075488 #  guarantee(PageArmed == 0) failed: invariant # # JRE version: OpenJDK Runtime Environment (8.0_03-b03) (build 1.8.0_03-Ubuntu-8u77-b03-3ubuntu3-b03) # Java VM: OpenJDK 64-Bit Server VM (25.03-b03 mixed mode linux-ppc64 compressed oops) # Core dump written. Default location: /home/orientdb/core/core or core.1714 # # An error report file with more information is saved as: # /home/orientdb/core/hs_err_pid1714.log # # If you would like to submit a bug report, please visit: #   http://bugreport.java.com/bugreport/crash.jsp # Aborted (core dumped)  Results :  Tests run: 0, Failures: 0, Errors: 0, Skipped: 0  [INFO] ------------------------------------------------------------------------ [INFO] Reactor Summary: [INFO] [INFO] OrientDB ........................................... SUCCESS [  2.109 s] [INFO] OrientDB Test Commons .............................. SUCCESS [  2.472 s] [INFO] OrientDB Core ...................................... FAILURE [43:17 min] [INFO] OrientDB Enterprise ................................ SKIPPED [INFO] OrientDB Client .................................... SKIPPED [INFO] OrientDB Object .................................... SKIPPED [INFO] OrientDB Server .................................... SKIPPED [INFO] OrientDB Tools ..................................... SKIPPED [INFO] OrientDB GraphDB ................................... SKIPPED [INFO] OrientDB Tests ..................................... SKIPPED [INFO] OrientDB Distributed Server ........................ SKIPPED [INFO] OrientDB Lucene full text and spatial index ........ SKIPPED [INFO] OrientDB JDBC Driver ............................... SKIPPED [INFO] OrientDB ETL ....................................... SKIPPED [INFO] OrientDB Community Distribution .................... SKIPPED [INFO] ------------------------------------------------------------------------ [INFO] BUILD FAILURE [INFO] ------------------------------------------------------------------------ [INFO] Total time: 43:22 min [INFO] Finished at: 2016-05-25T08:07:19+00:00 [INFO] Final Memory: 36M/437M [INFO] ------------------------------------------------------------------------ [ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.19.1:test (default-test) on project orientdb-core: Execution default-test of goal org.apache.maven.plugins:maven-surefire-plugin:2.19.1:test failed: The forked VM terminated without properly saying goodbye. VM crash or System.exit called? [ERROR] Command was /bin/sh -c cd /home/orientdb/core &amp;&amp; /usr/lib/jvm/java-8-openjdk-ppc64el/jre/bin/java -ea -Xmx2048m -Dindex.flushAfterCreate=false -Dstorage.makeFullCheckpointAfterCreate=false -Dstorage.makeFullCheckpointAfterOpen=false -Dstorage.makeFullCheckpointAfterClusterCreate=false -Dstorage.wal.syncOnPageFlush=false -Dstorage.configuration.syncOnUpdate=false -Ddb.makeFullCheckpointOnIndexChange=false -Ddb.makeFullCheckpointOnSchemaChange=false -jar /home/orientdb/core/target/surefire/surefirebooter3525119745377553230.jar /home/orientdb/core/target/surefire/surefire521712066030713187tmp /home/orientdb/core/target/surefire/surefire_08450310273360802813tmp [ERROR] -&gt; [Help 1] [ERROR] [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch. [ERROR] Re-run Maven using the -X switch to enable full debug logging. [ERROR] [ERROR] For more information about the errors and possible solutions, please read the following articles: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginExecutionException [ERROR] [ERROR] After correcting the problems, you can resume the build with the command [ERROR]   mvn &lt;goals&gt; -rf :orientdb-core   Also other details are as below. root@51f9ab09782a:/home/orientdb# mvn --version Apache Maven 3.3.9 Maven home: /usr/share/maven Java version: 1.8.0_03-Ubuntu, vendor: Oracle Corporation Java home: /usr/lib/jvm/java-8-openjdk-ppc64el/jre Default locale: en_US, platform encoding: ANSI_X3.4-1968 OS name: "linux", version: "4.2.0-16-generic", arch: "ppc64le", family: "unix"  root@51f9ab09782a:/home/orientdb# java -version openjdk version "1.8.0_03-Ubuntu" OpenJDK Runtime Environment (build 1.8.0_03-Ubuntu-8u77-b03-3ubuntu3-b03) OpenJDK 64-Bit Server VM (build 25.03-b03, mixed mode)  root@51f9ab09782a:/home/orientdb# arch ppc64le  root@51f9ab09782a:/home/orientdb# cat /etc/os-release NAME="Ubuntu" VERSION="16.04 LTS (Xenial Xerus)" ID=ubuntu ID_LIKE=debian PRETTY_NAME="Ubuntu 16.04 LTS" VERSION_ID="16.04" HOME_URL="http://www.ubuntu.com/" SUPPORT_URL="http://help.ubuntu.com/" BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/" UBUNTU_CODENAME=xenial  ```  Any pointers to resolve above test case failures.  Regards, Amit </body>
		<created>2016-05-25 10:09:24</created>
		<closed>2016-09-29 16:44:32</closed>
	</bug>
	<bug>
		<id>6202</id>
		<title>Index Engine error at startup for OrientDB 2.2.0</title>
		<body>I just upgraded to OrientDB 2.2.0 GA release from OrientDB 2.2.0-beta. Now every time I start my application with embeded OrientDB, I see the error message below  SEVERE: $ANSI{green {db=$graphdb}} Index 'expressible.name' cannot be created and will be removed from configuration  Then immediately follow that I will see a warning  WARNING: $ANSI{green {db=$graphdb}} Index engine with name 'expressible.name' already contained in database configuration  OrientDB seems up and running correctly. However, every time I restart my application, I will see the exact same error and warning. Just wondering what it is and I could get rid of it.  Thanks,  Tai </body>
		<created>2016-05-24 11:16:27</created>
		<closed>2016-07-04 10:23:29</closed>
	</bug>
	<bug>
		<id>6200</id>
		<title>Distributed : many errors</title>
		<body>## Expected behavior and actual behavior  ``` May 24 08:02:32 node-03 jruby[24505]: [WARN] com.orientechnologies.orient.server.distributed.impl.ODistributedResponseManager : [node-03] Detected 1 node(s) in timeout or in conflict and quorum (2) has not been reached, rolling back changes for request (id=1.8 task=tx user=#5:4) May 24 08:02:32 node-03 jruby[24505]: [WARN] com.orientechnologies.orient.server.distributed.impl.ODistributedResponseManager : [node-03]-&gt;[node-02] Sending undo message (tx-completed type: fix (4 ops) [[record_update(#5:4 v.1 realV.-2147483647), record_delete(#46:1), record_delete(#49:2), record_delete(#3:6)]]) for request (id=1.8 task=tx user=#5:4) to server node-02 May 24 08:02:33 node-03 jruby[24505]: [ERROR] ruby.api.flowcontroller : exception Java::ComOrientechnologiesOrientServerDistributedTask::ODistributedOperationException : Quorum 2 not reached for request (id=1.8 task=tx user=#5:4). Elapsed=490ms Servers in timeout/conflict are: May 24 08:02:33 node-03 jruby[24505]:  - node-02: TX[result=4] May 24 08:02:33 node-03 jruby[24505]: Received: May 24 08:02:33 node-03 jruby[24505]:  - node-03: TX[result=4] May 24 08:02:33 node-03 jruby[24505]:  - node-02: TX[result=4] May 24 08:02:33 node-03 jruby[24505]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedResponseManager.manageConflicts(com/orientechnologies/orient/server/distributed/impl/ODistributedResponseManager.java:597) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedResponseManager.getFinalResponse(com/orientechnologies/orient/server/distributed/impl/ODistributedResponseManager.java:337) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.waitForResponse(com/orientechnologies/orient/server/distributed/impl/ODistributedDatabaseImpl.java:577) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedDatabaseImpl.send2Nodes(com/orientechnologies/orient/server/distributed/impl/ODistributedDatabaseImpl.java:314) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.sendRequest(com/orientechnologies/orient/server/distributed/impl/ODistributedAbstractPlugin.java:573) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedTransactionManager$1.call(com/orientechnologies/orient/server/distributed/impl/ODistributedTransactionManager.java:151) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedTransactionManager$1.call(com/orientechnologies/orient/server/distributed/impl/ODistributedTransactionManager.java:105) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.executeOperationInLock(com/orientechnologies/orient/server/distributed/impl/ODistributedStorage.java:1086) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedTransactionManager.commit(com/orientechnologies/orient/server/distributed/impl/ODistributedTransactionManager.java:105) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.commit(com/orientechnologies/orient/server/distributed/impl/ODistributedStorage.java:1235) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(com/orientechnologies/orient/core/tx/OTransactionOptimistic.java:555) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(com/orientechnologies/orient/core/tx/OTransactionOptimistic.java:109) May 24 08:02:33 node-03 jruby[24505]: com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(com/orientechnologies/orient/core/tx/OTransactionOptimistic.java:86) ```  ``` May 24 08:12:59 node-02 jruby[31938]: [ERROR] com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage : Error on recycling record #44:2 (cluster: plocal cluster: attachmentflow) May 24 08:12:59 node-02 jruby[31938]: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record recycling May 24 08:12:59 node-02 jruby[31938]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-02 jruby[31938]:         Component Name="attachmentflow" May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.recycleRecord(OPaginatedCluster.java:1254) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doRecycleRecord(OAbstractPaginatedStorage.java:3108) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.recyclePosition(OAbstractPaginatedStorage.java:1093) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.recyclePosition(ODistributedStorage.java:896) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.task.OResurrectRecordTask.executeRecordTask(OResurrectRecordTask.java:57) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.task.OAbstractRecordReplicatedTask.execute(OAbstractRecordReplicatedTask.java:105) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedTxContextImpl.fix(ODistributedTxContextImpl.java:79) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.task.OCompletedTxTask.execute(OCompletedTxTask.java:101) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(ODistributedAbstractPlugin.java:592) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(ODistributedAbstractPlugin.java:588) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:241) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:93) May 24 08:12:59 node-02 jruby[31938]: Caused by: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Record with rid #44:2 was not deleted May 24 08:12:59 node-02 jruby[31938]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-02 jruby[31938]:         Component Name="attachmentflow" May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.recycleRecord(OPaginatedCluster.java:1124) May 24 08:12:59 node-02 jruby[31938]:         ... 12 more May 24 08:12:59 node-02 jruby[31938]: [ERROR] com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage : Error on recycling record #47:2 (cluster: plocal cluster: attachmentflowchunk) May 24 08:12:59 node-02 jruby[31938]: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record recycling May 24 08:12:59 node-02 jruby[31938]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-02 jruby[31938]:         Component Name="attachmentflowchunk" May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.recycleRecord(OPaginatedCluster.java:1254) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doRecycleRecord(OAbstractPaginatedStorage.java:3108) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.recyclePosition(OAbstractPaginatedStorage.java:1093) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.recyclePosition(ODistributedStorage.java:896) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.task.OResurrectRecordTask.executeRecordTask(OResurrectRecordTask.java:57) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.task.OAbstractRecordReplicatedTask.execute(OAbstractRecordReplicatedTask.java:105) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedTxContextImpl.fix(ODistributedTxContextImpl.java:79) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.task.OCompletedTxTask.execute(OCompletedTxTask.java:101) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(ODistributedAbstractPlugin.java:592) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(ODistributedAbstractPlugin.java:588) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:241) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:93) May 24 08:12:59 node-02 jruby[31938]: Caused by: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Record with rid #47:2 was not deleted May 24 08:12:59 node-02 jruby[31938]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-02 jruby[31938]:         Component Name="attachmentflowchunk" May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.recycleRecord(OPaginatedCluster.java:1124) May 24 08:12:59 node-02 jruby[31938]:         ... 12 more May 24 08:12:59 node-02 jruby[31938]: [ERROR] com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage : Error on recycling record #3:11 (cluster: plocal cluster: default) May 24 08:12:59 node-02 jruby[31938]: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record recycling May 24 08:12:59 node-02 jruby[31938]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-02 jruby[31938]:         Component Name="default" May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.recycleRecord(OPaginatedCluster.java:1254) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doRecycleRecord(OAbstractPaginatedStorage.java:3108) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.recyclePosition(OAbstractPaginatedStorage.java:1093) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedStorage.recyclePosition(ODistributedStorage.java:896) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.task.OResurrectRecordTask.executeRecordTask(OResurrectRecordTask.java:57) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.task.OAbstractRecordReplicatedTask.execute(OAbstractRecordReplicatedTask.java:105) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedTxContextImpl.fix(ODistributedTxContextImpl.java:79) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.task.OCompletedTxTask.execute(OCompletedTxTask.java:101) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(ODistributedAbstractPlugin.java:592) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:70) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(ODistributedAbstractPlugin.java:588) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(ODistributedWorker.java:241) May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(ODistributedWorker.java:93) May 24 08:12:59 node-02 jruby[31938]: Caused by: com.orientechnologies.orient.core.exception.OPaginatedClusterException: Record with rid #3:11 was not deleted May 24 08:12:59 node-02 jruby[31938]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-02 jruby[31938]:         Component Name="default" May 24 08:12:59 node-02 jruby[31938]:         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.recycleRecord(OPaginatedCluster.java:1124) May 24 08:12:59 node-02 jruby[31938]:         ... 12 more ```  ``` May 24 08:12:59 node-03 jruby[24505]: [WARN] com.orientechnologies.orient.server.distributed.impl.ODistributedResponseManager : [node-03] Detected 1 node(s) in timeout or in conflict and quorum (2) has not been reached, rolling back changes for request (id=1.26 task=tx user=#5:4) May 24 08:12:59 node-03 jruby[24505]: [WARN] com.orientechnologies.orient.server.distributed.impl.ODistributedResponseManager : [node-03]-&gt;[node-02] Sending undo message (tx-completed type: fix (5 ops) [[fix_record_delete(#44:2 v.0), fix_record_delete(#47:2 v.0), fix_record_delete(#3:11 v.0), record_update(#5:4 v.7 realV.-2147483641), record_delete(#54:2)]]) for request (id=1.26 task=tx user=#5:4) to server node-02 May 24 08:12:59 node-03 jruby[24505]: [ERROR] ruby.api.flowcontroller : exception Java::ComOrientechnologiesOrientCoreException::OSecurityException : Cannot update record #44:2: the resource has restricted access May 24 08:12:59 node-03 jruby[24505]:         Storage URL="plocal:/srv/orientdb/databases/devaprint-production" May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.metadata.security.ORestrictedAccessHook.onRecordBeforeUpdate(com/orientechnologies/orient/core/metadata/security/ORestrictedAccessHook.java:91) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.hook.ODocumentHookAbstract.onTrigger(com/orientechnologies/orient/core/hook/ODocumentHookAbstract.java:257) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHooks(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:1052) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(com/orientechnologies/orient/core/tx/OTransactionOptimistic.java:423) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(com/orientechnologies/orient/core/tx/OTransactionOptimistic.java:370) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:2529) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(com/orientechnologies/orient/core/db/document/ODatabaseDocumentTx.java:99) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.record.impl.ODocument.save(com/orientechnologies/orient/core/record/impl/ODocument.java:1794) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.record.impl.ODocument.save(com/orientechnologies/orient/core/record/impl/ODocument.java:61) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.task.OCreateRecordTask.executeRecordTask(com/orientechnologies/orient/server/distributed/impl/task/OCreateRecordTask.java:142) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.task.OAbstractRecordReplicatedTask.execute(com/orientechnologies/orient/server/distributed/task/OAbstractRecordReplicatedTask.java:105) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.task.OTxTask.execute(com/orientechnologies/orient/server/distributed/impl/task/OTxTask.java:110) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin$1.call(com/orientechnologies/orient/server/distributed/impl/ODistributedAbstractPlugin.java:592) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(com/orientechnologies/orient/core/db/OScenarioThreadLocal.java:70) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedAbstractPlugin.executeOnLocalNode(com/orientechnologies/orient/server/distributed/impl/ODistributedAbstractPlugin.java:588) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.onMessage(com/orientechnologies/orient/server/distributed/impl/ODistributedWorker.java:241) May 24 08:12:59 node-03 jruby[24505]: com.orientechnologies.orient.server.distributed.impl.ODistributedWorker.run(com/orientechnologies/orient/server/distributed/impl/ODistributedWorker.java:93) May 24 08:12:59 node-03 jruby[24505]: [INFO] ruby.rails : Completed 500 Internal Server Error in 151ms (Views: 12.8ms) ``` ## Steps to reproduce the problem  I don't know exactly. But the application works perfectly with a single node. It may be related to ORecordByte because a part of application involving it always fails when a second node comes in the setup. ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [x] I have a distributed setup with multiple servers. How many? 2 - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number: 2.2.1-SNAPSHOT ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-05-24 06:22:29</created>
		<closed>2016-06-08 20:19:26</closed>
	</bug>
	<bug>
		<id>6192</id>
		<title>Reimport fails with OType.CUSTOM for enum values</title>
		<body>## Expected behavior and actual behavior  When you define a vertex property of OType.CUSTOM for storing enum values everything works fine. You're able to store and read the data properly, the values are returned as strings. But when you export the data and try to re-import it the import fails with a EOFException. ## Steps to reproduce the problem  The following unit test describes the use case.  ``` java import java.io.ByteArrayInputStream; import java.io.ByteArrayOutputStream; import java.io.IOException;  import com.orientechnologies.orient.core.db.tool.ODatabaseExport; import com.orientechnologies.orient.core.db.tool.ODatabaseImport; import com.orientechnologies.orient.core.metadata.schema.OType; import com.tinkerpop.blueprints.impls.orient.OrientBaseGraph; import com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx; import com.tinkerpop.blueprints.impls.orient.OrientVertex; import com.tinkerpop.blueprints.impls.orient.OrientVertexType; import org.junit.After; import org.junit.Assert; import org.junit.Before; import org.junit.Test;  public class CustomPropertyTypeImportTest {      private OrientGraphNoTx orientGraph;      public enum CarType {         SPORTSCAR, VAN, TRUCK     }      @Before     public void setUp() {         orientGraph = new OrientGraphNoTx("memory:MyDb", "test", "test");     }      @After     public void tearDown() throws Exception {         orientGraph.drop();     }      @Test     public void test() {         OrientVertexType vertexType = orientGraph.createVertexType("Car");         vertexType.createProperty("type", OType.CUSTOM);          OrientVertex car = orientGraph.addVertex("class:Car");         car.setProperty("type", CarType.TRUCK);          // Property value is returned as string         Assert.assertEquals(CarType.valueOf(orientGraph.getVerticesOfClass("Car").iterator().next().getProperty("type")), CarType.TRUCK);          // Export works fine         String json = exportData(orientGraph);          // Import fails         importData(orientGraph, json);     }      private String exportData(OrientBaseGraph graph) {         try (ByteArrayOutputStream out = new ByteArrayOutputStream()) {             ODatabaseExport export = new ODatabaseExport(graph.getRawGraph(), out, message -&gt; System.out.println(message));             export.exportDatabase();             export.close();             return new String(out.toByteArray());         } catch (IOException e) {             throw new RuntimeException(e);         }     }      private void importData(OrientBaseGraph graph, String json) {         try (ByteArrayInputStream in = new ByteArrayInputStream(json.getBytes())) {             ODatabaseImport dataImport = new ODatabaseImport(graph.getRawGraph(), in, message -&gt; System.out.println(message));             dataImport.importDatabase();             dataImport.close();         } catch (IOException e) {             throw new RuntimeException(e);         }     }  } ``` ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [x] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [x] v2.1.x - Please specify last number: 17 - [x] v2.2.x - Please specify last number: 0 ### Operating System - [ ] Linux - [ ] MacOSX - [x] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-05-23 14:38:02</created>
		<closed>2016-05-25 16:14:02</closed>
	</bug>
	<bug>
		<id>6189</id>
		<title>2.2.0 Migration of manual Lucene indexes</title>
		<body>## Expected behavior and actual behavior  I had manual Lucene indexes in 2.1.17. I updated to 2.2.0. When I open db it gives me the error for every index:  ``` ERROR c.o.l.i.OLuceneFullTextIndex [lt-dispatcher-3] - $ANSI{green {db=db}} Error during load of index 'i13_1__ w13_1_Error__search' java.lang.NullPointerException: null         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.loadExternalIndexEngine(OAbstractPaginatedStorage.java:1549)         at com.orientechnologies.orient.core.index.OIndexAbstract.loadFromConfiguration(OIndexAbstract.java:309)         at com.orientechnologies.orient.core.index.OIndexManagerShared.fromStream(OIndexManagerShared.java:414)         at com.orientechnologies.orient.core.type.ODocumentWrapperNoClass.reload(ODocumentWrapperNoClass.java:74)         at com.orientechnologies.orient.core.index.OIndexManagerAbstract.load(OIndexManagerAbstract.java:85)         at com.orientechnologies.orient.core.index.OIndexManagerAbstract.load(OIndexManagerAbstract.java:57)         at com.orientechnologies.orient.core.metadata.OMetadataDefault$2.call(OMetadataDefault.java:191)         at com.orientechnologies.orient.core.metadata.OMetadataDefault$2.call(OMetadataDefault.java:181)         at com.orientechnologies.common.concur.resource.OSharedContainerImpl.getResource(OSharedContainerImpl.java:58)         at com.orientechnologies.orient.core.storage.OStorageAbstract.getResource(OStorageAbstract.java:149)         at com.orientechnologies.orient.core.metadata.OMetadataDefault.init(OMetadataDefault.java:181)         at com.orientechnologies.orient.core.metadata.OMetadataDefault.load(OMetadataDefault.java:89)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.initAtFirstOpen(ODatabaseDocumentTx.java:3004)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:243)         at com.erp.db.DbActor.preStart(DbActor.scala:51)         at akka.actor.Actor$class.aroundPreStart(Actor.scala:487)         at com.erp.db.DbActor.aroundPreStart(DbActor.scala:31)         at akka.actor.ActorCell.create(ActorCell.scala:590)         at akka.actor.ActorCell.invokeAll$1(ActorCell.scala:461)         at akka.actor.ActorCell.systemInvoke(ActorCell.scala:483)         at akka.dispatch.Mailbox.processAllSystemMessages(Mailbox.scala:282)         at akka.dispatch.Mailbox.run(Mailbox.scala:223)         at akka.dispatch.Mailbox.exec(Mailbox.scala:234)         at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)         at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)         at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)         at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) ```  If I try to access the index. For example to delete it, it gives me the error:  ``` Engine with id -1 is not registered inside of storage         Storage URL="plocal:/var/erpdb/db" com.orientechnologies.orient.core.index.OIndexException: Engine with id -1 is not registered inside of storage         Storage URL="plocal:/var/erpdb/db"         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkIndexId(OAbstractPaginatedStorage.java:1684)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCallIndexEngine(OAbstractPaginatedStorage.java:1834)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.callIndexEngine(OAbstractPaginatedStorage.java:1827)         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.getTransactionChanges(OLuceneIndexNotUnique.java:403)         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.put(OLuceneIndexNotUnique.java:118)         at com.orientechnologies.lucene.index.OLuceneIndexNotUnique.put(OLuceneIndexNotUnique.java:44)         at com.erp.db.WorkspaceSearch$ClassIndex.updateIndex(WorkspaceSearch.scala:66)         at com.erp.db.WorkspaceSearch.updateIndex(WorkspaceSearch.scala:42)         at com.erp.db.WorkspaceDb.save(WorkspaceDb.scala:49)         at com.erp.db.WorkspaceDbUsers$$anonfun$4.apply(WorkspaceDbUsers.scala:89)         at com.erp.db.WorkspaceDbUsers$$anonfun$4.apply(WorkspaceDbUsers.scala:82)         at scala.collection.TraversableLike$WithFilter$$anonfun$map$2.apply(TraversableLike.scala:683)         at scala.collection.immutable.HashMap$HashMap1.foreach(HashMap.scala:221)         at scala.collection.immutable.HashMap$HashTrieMap.foreach(HashMap.scala:428)         at scala.collection.TraversableLike$WithFilter.map(TraversableLike.scala:682)         at com.erp.db.WorkspaceDbUsers.updateUserWorkspaces(WorkspaceDbUsers.scala:82)         at com.erp.db.WorkspaceDbActor.com$erp$db$WorkspaceDbActor$$becomeActiveIfLoaded(WorkspaceDbActor.scala:75)         at com.erp.db.WorkspaceDbActor$$anonfun$receive$1.applyOrElse(WorkspaceDbActor.scala:46)         at akka.actor.Actor$class.aroundReceive(Actor.scala:482)         at com.erp.db.WorkspaceDbActor.aroundReceive(WorkspaceDbActor.scala:21)         at akka.actor.ActorCell.receiveMessage(ActorCell.scala:526)         at akka.actor.ActorCell.invoke(ActorCell.scala:495)         at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:257)         at akka.dispatch.Mailbox.run(Mailbox.scala:224)         at akka.dispatch.Mailbox.exec(Mailbox.scala:234)         at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)         at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)         at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)         at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) ```  So the main problem is that I cannot do anything about this. I can create new indexes but I cannot drop old.   I expect that it should be able to convert indexes in a new format if required, even if it's manual indexes. Or at least there should be a way how to drop them. ## Steps to reproduce the problem 1. Create manual Lucene index in 2.1; 2. Start the database with 2.2. ## Important Questions  How to drop these broken indexes? ### Runninng Mode - [X] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X] v2.2.x - Please specify last number: 0 ### Operating System - [X] Linux - [X] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [X] 8 </body>
		<created>2016-05-23 09:48:54</created>
		<closed>2016-06-08 10:00:14</closed>
	</bug>
	<bug>
		<id>6188</id>
		<title>Storage-related NPEs</title>
		<body>## Expected behavior and actual behavior  I'm upgrading a database from 2.1.17 to 2.2.0.  Logging in to studio doesn't seem to work. There are many exceptions in the log:  ``` 2016-05-23 10:58:45:335 SEVER {db=mydb} Cannot store state of cache for storage placed under /san/orientdb-community/databases/mydb [O2QCache]$ANSI{green {db=mydb}} Error during storage close java.lang.NullPointerException         at com.orientechnologies.common.directmemory.OByteBufferPool.acquireDirect(OByteBufferPool.java:269)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.cacheFileContent(OWOWCache.java:1206)         at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:617)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.updateCache(O2QCache.java:1200)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.doLoad(O2QCache.java:439)         at com.orientechnologies.orient.core.storage.cache.local.twoq.O2QCache.load(O2QCache.java:384)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:150)         at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:144)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.open(OPaginatedCluster.java:219)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.openClusters(OAbstractPaginatedStorage.java:285)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.open(OAbstractPaginatedStorage.java:208)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:231)         at com.orientechnologies.orient.server.OServer.openDatabaseBypassingSecurity(OServer.java:934)         at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:913)         at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:886)         at com.orientechnologies.orient.server.OServer.openDatabase(OServer.java:873)         at com.orientechnologies.orient.server.network.protocol.http.command.OServerCommandAuthenticatedDbAbstract.authenticate(OServerCommandAuthenticatedDbAbstract.java:163)         at com.orientechnologies.orient.server.network.protocol.http.command.OServerCommandAuthenticatedDbAbstract.beforeExecute(OServerCommandAuthenticatedDbAbstract.java:123)         at com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetConnect.beforeExecute(OServerCommandGetConnect.java:50)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:163)         at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:617)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  2016-05-23 10:58:45:371 SEVER {db=mydb} Internal server error: com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/san/orientdb-community/databases/mydb' with mode=rw         Storage URL="plocal:/san/orientdb-community/databases/mydb" --&gt; java.lang.NullPointerException [ONetworkProtocolHttpDb] 2016-05-23 10:58:46:246 SEVER isAuthorized() Exception: Cannot open local storage '/san/orientdb-community/databases/OSystem' with mode=rw         Storage URL="plocal:/san/orientdb-community/databases/OSystem" [OSystemUserAuthenticator] 2016-05-23 10:58:46:718 SEVER isAuthorized() Exception: Cannot open local storage '/san/orientdb-community/databases/OSystem' with mode=rw         Storage URL="plocal:/san/orientdb-community/databases/OSystem" [OSystemUserAuthenticator] 2016-05-23 10:58:48:467 SEVER {db=mydb} authenticate() Exception: Cannot open local storage '/san/orientdb-community/databases/OSystem' with mode=rw         Storage URL="plocal:/san/orientdb-community/databases/OSystem" [OSystemUserAuthenticator] ``` ## Important Questions ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [x] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [x] v2.2.x - Please specify last number:  ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-05-23 09:03:06</created>
		<closed>2016-05-25 14:08:39</closed>
	</bug>
	<bug>
		<id>6184</id>
		<title>Type ANY does not support converting value:</title>
		<body>## Expected behavior and actual behaviour  I cannot create a model who has a property type of ANY.  ## Steps to reproduce the problem  I have a model (A) with a property of type ANY. I have another model (B) with a property that is an embeddedList of model (A). When I create model B's property i get an error everytime the type of the value is a string, bool, integer ect. I only works if the property of the type ANY is an array or object.  ## Important Questions  My question is how can i store a string, bool, date, integer ect in a property who's type is ANY? ### Runninng Mode - [X ] Embedded, using PLOCAL access mode ### Misc ### OrientDB Version - [ x] v2.2.x - Please specify last number: 0 ### Operating System - [ x] MacOSX ### Java Version - [ ] 6 - [ ] 7 - [ ] 8 </body>
		<created>2016-05-22 19:54:21</created>
		<closed>2016-06-27 13:07:13</closed>
	</bug>
	<bug>
		<id>6177</id>
		<title>Long running application using OPartitionedDatabasePool causing a OTokenSecurityException: missing session and token</title>
		<body>We have been testing our application with 2.2.0 GA to validate if being investigate migration from using it the 2.1.x versions. For context our application connects to the OrientDB server remotely as a client on the same environment and we use the OPartitionedDatabasePool for handling the accessing ODatabaseDocumentTx instances from multiple threads.   All was going well in our testing, the application was acquiring ODatabaseDocumentTx instances via multiple threads via OPartitionedDatabasePool and performing several CRUD operations. However after running for a while and we begin to see the following exceptions logged out on the orientdb server logs.  _com.orientechnologies.orient.enterprise.channel.binary.OTokenSecurityException: missing session and token     Storage URL="plocal:/Applications/OrientDB/orientdb-community-2.2.0/databases/dbname"     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.solveSession(ONetworkProtocolBinary.java:268)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeRequest(ONetworkProtocolBinary.java:215)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.execute(ONetworkProtocolBinary.java:173)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)_  Which we have never seen before in the 2.0.x or 2.1.x versions.  Also Corresponding on our application logs we are seeing the following multiple instances of the following messages  _May 20, 2016 10:32:26 PM com.orientechnologies.common.log.OLogManager log WARNING: Caught I/O errors from Not connected (local socket=/127.0.0.1:50297), trying to reconnect (error: java.io.EOFException) May 20, 2016 10:32:26 PM com.orientechnologies.common.log.OLogManager log WARNING: Connection re-acquired transparently after 2ms and 1 retries to server '127.0.0.1:2424/dbname': no errors will be thrown at application level May 20, 2016 10:32:26 PM com.orientechnologies.common.log.OLogManager log WARNING: Caught I/O errors from Not connected (local socket=0.0.0.0/0.0.0.0:50300), trying to reconnect (error: java.io.EOFException) May 20, 2016 10:32:26 PM com.orientechnologies.common.log.OLogManager log_  However even though these messages indicate a reconnection, from the point that these messages begin to be thrown no CRUD operations persist, which causes our multiple thread instances to hang, repeating the same CRUD operation over and over.  Restart the app and it starts off ok as before but again will begin to exhibit the above behaviour after some time has passed.  Has anyone else seen this behaviour or these messages? I have looked at the documentation for 2.2 to see if there some additional steps that I maybe missing in the migration however I don't believe I am.  This behaviour is occurring on both our local Mac Development environments and our Linux Test environments. ### Runninng Mode  Remote ### OrientDB Version   v2.2.0 ### Operating System  Linux &amp; MacOSX ### Java Version  8 </body>
		<created>2016-05-21 00:45:23</created>
		<closed>2016-08-24 14:25:40</closed>
	</bug>
	<bug>
		<id>6175</id>
		<title>JDBC prepared statement returns NullPointerException</title>
		<body>## Expected behavior and actual behavior  Calling a prepared statement via jdbc interface returns NullPointerException  Exception in thread "main" java.lang.NullPointerException     at com.orientechnologies.orient.jdbc.OrientJdbcResultSetMetaData.getColumnType(OrientJdbcResultSetMetaData.java:192)     at TestOrientdb.main(TestOrientdb.java:42)  A prepared statement should work without problems via jdbc interface. ## Steps to reproduce the problem  Using the default database:  ```       OrientJdbcConnection conn = (OrientJdbcConnection) DriverManager.getConnection("jdbc:orient:" + dbUrl, info);         //create and execute statement        String stmtStr = "SELECT FROM V WHERE song_type like ?";         PreparedStatement stmt = conn.prepareStatement(stmtStr);       stmt.setString(1, "original");        ResultSet rs = stmt.executeQuery();        int type = rs.getMetaData().getColumnType(1); ``` ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ X] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [ ] v2.1.x - Please specify last number:  - [X ] v2.2.x - Please specify last number: 0 ### Operating System - [ ] Linux - [X ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [ X] 8 </body>
		<created>2016-05-20 20:32:13</created>
		<closed>2016-09-27 20:04:35</closed>
	</bug>
	<bug>
		<id>6174</id>
		<title>Where clause not working in deleting records selected with subquery</title>
		<body>## Expected behavior and actual behavior  I try to delete record selected with subquery, but 'WHERE' clause not working, it's ignores, all records removes instead: `delete from (select expand(accounts) from #30:0) where type = 'test2'` - removes all accounts from #30:0,   However same with select: where working `select from (select expand(accounts) from #30:0) where type = 'test2'` ## Steps to reproduce the problem  ``` CREATE CLASS Account CREATE CLASS Profile CREATE PROPERTY Profile.accounts LINKLIST Insert into Account set type = 'test1' Insert into Account set type = 'test2' Insert into Account set type = 'test3' Insert into Profile set accounts = [#29:0,#29:1]   //29 - account cluster, change yours  delete from (select expand(accounts) from #30:0) where type = 'test2'  //30 - profile cluster, change yours select from Account  // #29:0  and #29:1 not exist select from Profile // accounts is [null,"#29:1"] in studio ``` ## Important Questions ### Runninng Mode - [x] Remote ### OrientDB Version - [x ] v2.1.x - Please specify last number: 2.1.17 ### Operating System - [ x] Linux ubuntu 14 ### Java Version - [ x] 8 </body>
		<created>2016-05-20 13:27:09</created>
		<closed>2016-05-23 12:56:15</closed>
	</bug>
	<bug>
		<id>6171</id>
		<title>Clearing OrientDB 2.2.0-rc1 for tests leads to NPE's</title>
		<body>## Expected behavior and actual behavior  We are currently clearing our OrientDB 2.1.7 embedded in-memory db for unit tests using OrientGraphNoTx#drop().   In 2.2.0-rc1 this is now effectively closing the internal OrientDB storage and thus setting all storage references to null. Further calls (using 2.2.0-rc1) would now cause NPE's since "storage" is null.  ``` SEVERE: Error during context close for db null java.lang.NullPointerException     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPolled.close(OPartitionedDatabasePool.java:160)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.shutdown(OrientBaseGraph.java:1160)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.shutdown(OrientBaseGraph.java:1132)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.shutdown(OrientBaseGraph.java:1125)     at com.gentics.mesh.graphdb.orientdb.OrientDBDropTest.cleanup(OrientDBDropTest.java:21)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:497)     at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)     at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)     at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)     at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)     at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:86)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:459)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:675)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:382)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:192) ``` ## Steps to reproduce the problem  ``` import static org.junit.Assert.assertEquals;  import org.junit.After; import org.junit.Test;  import com.tinkerpop.blueprints.impls.orient.OrientGraphFactory; import com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx;  public class OrientDBDropTest {      OrientGraphFactory factory = new OrientGraphFactory("memory:tinkerpop");      @After     public void cleanup() {         OrientGraphNoTx noTx = factory.getNoTx();         try {             noTx.drop();         } finally {             noTx.shutdown();         }     }      @Test     public void testOne() {         assertCleanup();     }      @Test     public void testTwo() {         assertCleanup();     }      private void assertCleanup() {         OrientGraphNoTx noTx = factory.getNoTx();         try {             noTx.addVertex(null);             assertEquals(1, noTx.countVertices());         } finally {             noTx.shutdown();         }     } } ``` ## Important Questions ### Runninng Mode - [ x] Embedded, using MEMORY access mode ### OrientDB Version - [x ] v2.2.0-rc1  ### Operating System - [x ] Linux ### Java Version - [x ] 8 </body>
		<created>2016-05-20 09:10:11</created>
		<closed>2016-05-22 11:15:17</closed>
	</bug>
	<bug>
		<id>6170</id>
		<title>error "Found unknown session xx"</title>
		<body>Found a lot of following errors in server log at peak hours:  &gt; Error executing request &gt; com.orientechnologies.common.io.OIOException: Found unknown session 814 &gt;         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.onBeforeRequest(ONetworkProtocolBinary.java:240) &gt;         at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:214) &gt;         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)   and some errors in client log (much less than server log):  &gt; error=Error on executing command: sql.select from v where pk='150001984621' &gt; com.orientechnologies.orient.core.exception.OStorageException: Error on executing command: sql.select from v where pk='150001984621' &gt;         at com.orientechnologies.orient.client.remote.OStorageRemote.handleException(OStorageRemote.java:1841) ~[orientdb-client-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1241) ~[orientdb-client-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.client.remote.OStorageRemoteThread.command(OStorageRemoteThread.java:444) ~[orientdb-client-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67) ~[orientdb-core-2.1.7.jar:2.1.7] &gt;         at com.tinkerpop.blueprints.impls.orient.OrientGraphCommand.execute(OrientGraphCommand.java:49) ~[orientdb-graphdb-2.1.7.jar:2.1.7] &gt; Caused by: java.io.EOFException: null &gt;         at java.io.DataInputStream.readByte(DataInputStream.java:267) ~[na:1.7.0_79] &gt;         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.readByte(OChannelBinary.java:73) ~[orientdb-enterprise-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:200) ~[orientdb-enterprise-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:171) ~[orientdb-enterprise-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:2155) ~[orientdb-client-2.1.7.jar:2.1.7] &gt;         at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:1188) ~[orientdb-client-2.1.7.jar:2.1.7] &gt;         ... 52 common frames omitted  seems connections to server reached max size(client.channel.maxPool=100) leading to connection lose, after reduce db.pool.max  the error disappear.  will follow up.  what might be the root cause of this issue, thanks.  Seems default 100 of client.channel.maxPool is not enough in our case. any suggestion? ## Expected behavior and actual behavior ## Steps to reproduce the problem ## Important Questions ### Runninng Mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  2 ### OrientDB Version  2.1.16 ### Operating System - [ ] Linux ### Java Version - [ ] 7 </body>
		<created>2016-05-20 09:08:03</created>
		<closed>2016-06-27 12:10:27</closed>
	</bug>
	<bug>
		<id>6163</id>
		<title>source record is not a vertex</title>
		<body>## Expected behavior and actual behavior  I am using the `script sql` command in the console to run a batch query that `selects` a `Person` vertex then `selects` an `Email` vertex and then creates an edge `HAS` from person to email. When I run the command I get the following error.  ``` Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.create edge has from $user to $email  Error: java.lang.IllegalArgumentException: source record is not a vertex ``` ## Steps to reproduce the problem  ``` orientdb {db=test}&gt; script sql [Started multi-line command. Type just 'end' to finish and execute] orientdb {db=test}&gt; begin orientdb {db=test}&gt; let user = select from person where uid = '12345' orientdb {db=test}&gt; let email = select from email where email = 'amyth@gmail.com' orientdb {db=test}&gt; let edge = create edge has from $user to $email orientdb {db=test}&gt; commit orientdb {db=test}&gt; return $edge orientdb {db=test}&gt; end ``` ## Important Questions  As far as I know both `Person` and `Email` are vertexes in the database. The data and schema was inserted using a `.graphml` database exported from neo4j. What is source record here ? the person ? Why is it not being treated as a vertex ? Another thing I would like to point out is for the same records if I directly create an edge using the records' `rid`'s, the edge between the vertexes are successfully created. ### Runninng Mode - [x] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [ ] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [x] v2.1.17 - Please specify last number:  - [ ] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [x] 7 - [ ] 8 </body>
		<created>2016-05-19 11:22:08</created>
		<closed>2016-05-19 17:17:21</closed>
	</bug>
	<bug>
		<id>6155</id>
		<title>Problem with out() function when you combine it with the name of edge using underscore characters and dot syntax</title>
		<body>### Steps to reproduce the problem #### Create a graph database with lightweight edges  ``` JAVASCRIPT ALTER DATABASE custom useLightweightEdges=true ``` #### Create Classes and Properties  ``` JAVASCRIPT create class H extends V create class isHyperedgeOf extends E  create class WORD extends V create class INT extends V create class REAL extends V  create property WORD.dval STRING create property INT.dval INTEGER create property REAL.dval DOUBLE  create class NameGR extends V create class NameEN extends V create class Enum extends V create class Price extends V  create property NameGR.dptr LINK WORD create property NameEN.dptr LINK WORD create property Enum.dptr LINK INT create property Price.dptr LINK REAL ``` #### Create Nodes  ``` JAVASCRIPT create vertex H  create vertex WORD set dval="" create vertex WORD set dval="FG" create vertex INT set dval=1 create vertex REAL set dval=1.9  In my setup 14:0, 14:1, 15:0, 16:0 have been created  create vertex NameGR set dptr=14:0 create vertex NameEN set dptr=14:1 create vertex Enum set dptr=15:0 create vertex Price set dptr=16:0 ```  At this step 17:0, 18:0, 19:0, 20:0 have been created and they are linked to 14:0, 14:1, 15:0, 16:0 respectively  #### Create Edges  ``` JAVASCRIPT create edge isHyperedgeOf from 12:0 to 17:0 create edge isHyperedgeOf from 12:0 to 18:0 create edge isHyperedgeOf from 12:0 to 19:0 create edge isHyperedgeOf from 12:0 to 20:0 ``` #### Query  ``` JAVASCRIPT select out_isHyperedgeOf from 12:0 this returns the list of adjacent outgoing vertices and the result is as expected 17:0, 18:0, 19:0, 20:0  and the same result is obtained by select out() from 12:0 ``` #### Problem  ``` JAVASCRIPT select out().dptr from 12:0 #14:0  #14:1  #15:0  #16:0  select out().dptr.dval from 12:0 ["","FG",1,1.9]  This is as expected, but if I use  select out_isHyperedgeOf.dptr from 12:0 #16:0  #15:0  #14:0  #14:1  select out_isHyperedgeOf.dptr.dval from 12:0 [1.9,1,"","FG"]  As you see the returned list has lost its order of elements ``` #### Is that a Bug ?  ....when you combine out() function with the name of edge using underscore characters..... #### Solution  ``` JAVASCRIPT select out('isHyperedgeOf').dptr.dval from 12:0 ["", "FG", 1, 1.9] ``` ## Important Questions ### Runninng Mode - [X ] Embedded, using PLOCAL access mode ### OrientDB Version - [X] v2.1.16 ### Operating System - [X ] Windows </body>
		<created>2016-05-18 10:16:54</created>
		<closed>2016-05-23 14:22:39</closed>
	</bug>
	<bug>
		<id>6154</id>
		<title>REST auth: 2.2 vs. 2.1</title>
		<body>2.2: - wait 15 seconds - headers  ``` time curl -XGET http://127.0.0.1:2480/connect/test ```  ``` Set-Cookie: OSESSIONID=-; Path=/; HttpOnly Content-Length: 129  {   "errors": [     {       "code": 401,       "reason": "Unauthorized",       "content": "401 Unauthorized."     }   ] } real    0m15.048s user    0m0.008s sys 0m0.012s ```  2.1  ``` time curl -XGET http://127.0.0.1:2480/connect/test ```  ``` {   "errors": [     {       "code": 401,       "reason": "Unauthorized",       "content": "401 Unauthorized."     }   ] } real    0m0.027s user    0m0.016s sys 0m0.004s ``` </body>
		<created>2016-05-18 05:37:44</created>
		<closed>2016-05-18 09:24:54</closed>
	</bug>
	<bug>
		<id>6153</id>
		<title>Unable to import DB with record containing a property of type ANY</title>
		<body>I attempted to import (via Java: ODatabaseImport) a previously exported db. Within the db is a class that contains a property of type ANY. The exported db contains a record of this class that has saved a boolean for that property i.e. false.  I imported by:  ``` OrientGraphNoTx graph = new OrientGraphNoTx(dbUrl, user, password);             ODatabaseImport databaseImport = new ODatabaseImport(graph.getRawGraph(), in, listener);             try {                 databaseImport.importDatabase();                 System.out.println("Import for " + dbUrl + " complete.");             } catch (Exception e) {                 e.printStackTrace();             } finally {                 databaseImport.close();             } ```  The exception occurs within ODatabaseImport.importRecord() `Type ANY does not support converting value: false`  Debugging further shows that the import uses ORecordSerializerJSON to unmarshall the exported JSON. The method ORecordSerializerJSON.getValue() is called. This cannot handle type 'ANY' and defaults to OStringSerializerHelper.fieldTypeFromStream(). This also cannot handle type 'ANY' and therefore throws an exception.  Shouldn't import handle all types? Or is there something I'm missing. ### OrientDB Version - v2.1.4 </body>
		<created>2016-05-18 02:17:31</created>
		<closed>2016-05-20 15:37:05</closed>
	</bug>
	<bug>
		<id>6151</id>
		<title>Different @version for same entity in different nodes of distributed cluster when one of them is temporarily frozen.</title>
		<body>## Expected behavior and actual behavior  In a distributed cluster with 2 nodes (node A and node B) when node A is frozen and B receives a create command which goes ahead in B; so far so good. However, when A is released the write goes through BUT the version of the created entity A is higher than that of the one in B. The longer the freeze is the higher the version of the entity in A. This entity will never be able to be updated from A or B because of concurrent modification errors. Expected behavior is: after A is released the write goes through and the versions in both nodes are the same. ## Steps to reproduce the problem  With 2.1.16.  Setup a cluster with two nodes. Freeze db in node A. Issue a create vertex command on B. Release db in A. Issue a select for that vertex in B -&gt; you get it with a @version=1. Issue a select for that vertex in A -&gt; you get it with @version&gt;1. Restarting nodes first A then B results in entity in B set to same higher @version as A. Restarting B and then A sets entity in A to same lower @version as B. The cluster is setup with default configs that ship with distribution. ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [x] I have a distributed setup with multiple servers. How many?  2 - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [x] v2.1.x - Please specify last number: 16 - [ ] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-05-17 14:12:50</created>
		<closed>2017-02-18 08:01:53</closed>
	</bug>
	<bug>
		<id>6150</id>
		<title>Corrupt state of distributed cluster when frozen db gets a write and then is released.</title>
		<body>## Expected behavior and actual behavior  In a distributed cluster with 2 nodes (node A and node B) when node A is frozen and receives a write the client gets an error and B does not get a write; so far so good. When A is released the write goes through!!! but B gets no write, thus the cluster is in a corrupted state.  Expected behavior is: after A issues an error to the client, the write should never go through. ## Steps to reproduce the problem  With 2.1.16.  Setup a cluster with two nodes. Freeze db in node A. Issue a create vertex command on A. Release db in A. Issue a select for that vertex in A -&gt; you get it back. Issue a select for that vertex in B -&gt; you do not get it back and will never get it back. If node A is restarted then the faulty vertex is removed. The cluster is setup with default configs that ship with distribution.  In the logs for A (named ntl1) I get this:  &gt; 2016-05-17 13:12:21:179 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=1) [ODistributedWorker] &gt; 2016-05-17 13:12:22:184 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=2) [ODistributedWorker] &gt; 2016-05-17 13:12:23:189 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=3) [ODistributedWorker] &gt; 2016-05-17 13:12:24:193 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=4) [ODistributedWorker] &gt; 2016-05-17 13:12:25:197 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=5) [ODistributedWorker] &gt; 2016-05-17 13:12:26:200 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=6) [ODistributedWorker] &gt; 2016-05-17 13:12:27:185 WARNI [ntl1] timeout (6004ms) on waiting for synchronous responses from nodes=[ntl1, ntl2] responsesSoFar=[ntl2] request=id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 [OHazelcastDistributedDatabase] &gt; 2016-05-17 13:12:27:185 WARNI [ntl1] detected 1 node(s) in timeout or in conflict and quorum (2) has not been reached, rolling back changes for request (id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0) [ODistributedResponseManager] &gt; 2016-05-17 13:12:27:186 WARNI [ntl1] Quorum 2 not reached for request (id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0). Elapsed=6018ms No server in conflict. Received: {ntl1=waiting-for-response, ntl2=#14:1164 v.1} [ODistributedResponseManager] &gt; 2016-05-17 13:12:27:187 WARNI [ntl1] sending undo message (record_delete(#14:1164 delayed=false)) for request (id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0) to server ntl2 [ODistributedResponseManager] &gt; 2016-05-17 13:12:27:204 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=7) [ODistributedWorker] &gt; 2016-05-17 13:12:28:208 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=8) [ODistributedWorker]  then just the last line over and over until the database is released:   &gt; 2016-05-17 13:40:26:055 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=1680) [ODistributedWorker] &gt; 2016-05-17 13:40:27:059 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=1681) [ODistributedWorker] &gt; 2016-05-17 13:40:28:065 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=1682) [ODistributedWorker] &gt; 2016-05-17 13:40:29:069 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=1683) [ODistributedWorker] &gt; 2016-05-17 13:40:30:074 INFO  [ntl1] Database is frozen, waiting and retrying. Request id=5 from=ntl1 task=record_create(#14:-1 v.0) user=#5:0 (retry=1684) [ODistributedWorker] &gt; 2016-05-17 13:40:30:456 INFO  {db=testdb} Releasing database 'plocal:/blahblah/databases/testdb' [ONetworkProtocolBinary] &gt; 2016-05-17 13:40:30:457 INFO  [ntl1] received updated status ntl1.testdb=ONLINE [OHazelcastPlugin] &gt; 2016-05-17 13:40:31:121 INFO  [ntl1] Request id=5 from=ntl1 task=record_create(#14:1164 v.0) user=#5:0 succeed after retry=1685 [ODistributedWorker]  So it looks like a rollback is issued to the other nodes but the rollback never happens in the local one. ## Important Questions ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [x] I have a distributed setup with multiple servers. How many? 2 - [ ] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [x] v2.1.x - Please specify last number: 16 - [ ] v2.2.x - Please specify last number:  ### Operating System - [ ] Linux - [x] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-05-17 12:42:02</created>
		<closed>2017-01-30 21:44:07</closed>
	</bug>
	<bug>
		<id>6149</id>
		<title>Lucene doesn't create index on string fields with MAX constraint</title>
		<body>## Expected behavior and actual behavior  **Expected:** Lucene should create an index on all fields regardless of what constraints are on them, OR throw an error if it can't create it for some reason  **Actual:** Lucene works properly when no constraints are given for a field. When, for example MAX, constraint is added to a string field then it fails to create indexes and throws no errors ## Steps to reproduce the problem  In an empty database:  ``` CREATE CLASS test CREATE PROPERTY test.field1 STRING CREATE PROPERTY test.field2 STRING ALTER PROPERTY test.field2 MAX 8 CREATE PROPERTY test.field3 STRING CREATE PROPERTY test.field4 STRING INSERT INTO test CONTENT {"field1":"One", "field2":"Two", "field3":"Three", "field4":"Four"} INSERT INTO test CONTENT {"field1":"Five", "field2":"Six", "field3":"Seven", "field4":"Eight"}  CREATE INDEX test.field1 on test(field1) fulltext engine lucene SELECT count(*) FROM index:test.field1 ```  **Result:** count=2 which is correct  ``` CREATE INDEX test.field2 on test(field2) fulltext engine lucene SELECT count(*) FROM index:test.field2 ```  **Result:** count=0 which is incorrect! ## Important Questions ### Runninng Mode  Standard Windows install running server at default port accessed via Studio in browser ### Misc  Single computer setup.  ### OrientDB Version  v2.1.16 ### Operating System  Windows 7 x64 ### Java Version  Java 8 Update 91 </body>
		<created>2016-05-17 08:08:05</created>
		<closed>2016-05-18 06:38:17</closed>
	</bug>
	<bug>
		<id>6148</id>
		<title>Property attributes missing in export</title>
		<body>## Expected behavior and actual behavior  Expected behavior is to have all property attributes in exported schema.  Actual behavior: in exported schema property attributes DEFAULT and REGEXP are missing (DEFAULT is present in 2.2.0) ## Steps to reproduce the problem  create or connect to database  ``` CREATE CLASS ClassName EXTENDS V CREATE PROPERTY ClassName.propertyREGEXP STRING ALTER PROPERTY ClassName.propertyREGEXP REGEXP [a-z] CREATE PROPERTY ClassName.propertyDEFAULT STRING ALTER PROPERTY ClassName.propertyDEFAULT DEFAULT "defaultValue" ```  then create export file  `EXPORT DATABASE /path/to/file`  or   `EXPORT SCHEMA /path/to/file` ### Runninng Mode - [ ] Embedded, using PLOCAL access mode - [ ] Embedded, using MEMORY access mode - [x] Remote ### Misc - [ ] I have a distributed setup with multiple servers. How many?  - [x] I'm using the Enterprise Edition ### OrientDB Version - [ ] v2.0.x - Please specify last number:  - [x] v2.1.x - Please specify last number: 2.1.16 - [x] v2.2.x - Please specify last number: 2.2.0 ### Operating System - [x] Linux - [ ] MacOSX - [ ] Windows - [ ] Other Unix - [ ] Other, name?  ### Java Version - [ ] 6 - [ ] 7 - [x] 8 </body>
		<created>2016-05-17 07:28:27</created>
		<closed>2016-05-19 15:23:41</closed>
	</bug>
	<bug>
		<id>6133</id>
		<title>Error deserializing record</title>
		<body>`WARNING: {db=XXX} Error deserializing record with id #15:5132 send this data for debugging: ABxSZWZlcmVuY2VfUGVhaxx1bmRlclRocmVzaG9sZAAAARQAHE5vcm1hbGl6ZWRBcmVhAAABFQU2/v//a0FyZWEAAAEdBSBSZXRlbnRpb25UaW1lTWluAAABJQEiUmV0ZW50aW9uVGltZVNlYzEAAAEpASJSZXRlbnRpb25UaW1lU2VjMgAAAS0BHFJldGVudGlvbkluZGV4AAABLwEmUGVha0ludGVuc2l0eVZhbHVlcwAAATEKHENsYXNzaWZpY2F0aW9uAAABdAcGSGl0AAABggcYTWFzc1NwZWN0cnVtAAABng0SU3Vic3RhbmNlAAABog0MT3JpZ2luAAABpA0YTGlicmFyeVBlYWtzAAABpg8AAD+wrI2Ib1pHQVLouQAAAAC8+fACwNPwAvwl6jwaFw0g8osIDSD0iwgNIPaLCA0g+IsIDSD6iwgNIPyLCA0g/osIDSCAjAgNIIKMCA0ghIwIDSCGjAgNIIiMCA0giowIGm4tL2lzby1BbGthbmU2RG9kZWNhbmUsIDIsNywxMC10cmltZXRoeWwtIqrwARwGGggCJqJP` </body>
		<created>2016-05-13 12:24:11</created>
		<closed>2016-05-25 12:43:55</closed>
	</bug>
	<bug>
		<id>6131</id>
		<title>You have reached maximum pool size for given partition</title>
		<body>java.lang.IllegalStateException: You have reached maximum pool size for given partition at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.acquire(OPartitionedDatabasePool.java:324) at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.(OrientBaseGraph.java:162) at com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx.(OrientGraphNoTx.java:61) at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getNoTx(OrientGraphFactory.java:88) at au.com.foxsports.subscription.service.SubscriptionServiceImpl.getByUserId(SubscriptionServiceImpl.java:224) at sun.reflect.GeneratedMethodAccessor150.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:606) at org.mule.processor.InvokerMessageProcessor.process(InvokerMessageProcessor.java:170) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.processor.AsyncInterceptingMessageProcessor.process(AsyncInterceptingMessageProcessor.java:102) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.construct.DynamicPipelineMessageProcessor.process(DynamicPipelineMessageProcessor.java:54) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.interceptor.AbstractEnvelopeInterceptor.process(AbstractEnvelopeInterceptor.java:51) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.processor.AbstractFilteringMessageProcessor.process(AbstractFilteringMessageProcessor.java:40) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) at org.mule.execution.MessageProcessorNotificationExecutionInterceptor.execute(MessageProcessorNotificationExecutionInterceptor.java:58) at org.mule.execution.MessageProcessorExecutionTemplate.execute(MessageProcessorExecutionTemplate.java:44) at org.mule.construct.AbstractPipeline$1.process(AbstractPipeline.java:109) at org.mule.execution.ExceptionToMessagingExceptionExecutionInterceptor.execute(ExceptionToMessagingExceptionExecutionInterceptor.java:24) </body>
		<created>2016-05-13 07:14:28</created>
		<closed>2016-07-22 08:48:25</closed>
	</bug>
	<bug>
		<id>6127</id>
		<title>Database became corrupted if there is no space to keep database journal on disk</title>
		<body>Related exception is - ERROR [ODiskWriteAheadLog$LogSegment$FlushTask] Error during WAL background flush java.io.IOException: No space left on device at java.io.RandomAccessFile.writeBytes(Native Method) ~[na:1.8.0_45] at java.io.RandomAccessFile.write(RandomAccessFile.java:512) ~[na:1.8.0_45] at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.ODiskWriteAheadLog$LogSegment$FlushTask.flushPage(ODiskWriteAheadLog.java:232) </body>
		<created>2016-05-12 18:39:36</created>
		<closed>2016-05-25 07:02:27</closed>
	</bug>
	<bug>
		<id>6124</id>
		<title>Error in LiveQuery for clusters</title>
		<body>I use LiveQery for select cluster (live select from cluster:Cluster1), but an error in Exception in thread "LiveQueryQueueThread" java.lang.IllegalStateException: Current database instance (com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx@1afaccf7) is not active on current thread I watched OCommandExecutorSQLLiveSelect: public void onLiveResult(final ORecordOperation iOp) {  ``` final OIdentifiable value = iOp.getRecord();  if (!matchesTarget(value)) {    return; } if (!matchesFilters(value)) {   return; } if (!checkSecurity(value)) {   return; }  final OCommandResultListener listener = request.getResultListener(); if (listener instanceof OLiveResultListener) {   execInSeparateDatabase(new OCallable() {     @Override     public Object call(Object iArgument) {       execDb.activateOnCurrentThread();       ((OLiveResultListener) listener).onLiveResult(token, iOp);       return null;     }   }); } ```    }  if (!matchesTarget(value)) - **It requires the installation of an activateOnCurrentThread() (for execDb.getClusterNameById(value.getIdentity().getClusterId())**, **But this is below** -   public Object call(Object iArgument) {           execDb.activateOnCurrentThread();           ((OLiveResultListener) listener).onLiveResult(token, iOp);           return null;         } </body>
		<created>2016-05-12 08:23:49</created>
		<closed>2016-05-16 13:03:06</closed>
	</bug>
	<bug>
		<id>6119</id>
		<title>NPE when server shutdowns</title>
		<body>Occurs when OServer.shutdown is called (not always, maybe ~50%) Does not seem to cause other problems but just to be sure.  ``` [INFO] com.orientechnologies.orient.server.OServer : OrientDB Server is shutting down... [INFO] com.orientechnologies.orient.server.OServer : Shutting down listeners: [INFO] com.orientechnologies.orient.server.OServer : - ONetworkProtocolBinary /SECOND-NODE:2424: [INFO] com.orientechnologies.orient.server.OServer : - ONetworkProtocolHttpDb /SECOND-NODE:2480: [INFO] com.orientechnologies.orient.server.OServer : Shutting down protocols [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending shutdown to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19839),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing input socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19839),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19839),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : I/O Error on client clientId=0 reqType=-1 [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending interrupt signal to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19839),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending shutdown to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19841),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing input socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19841),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19841),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : I/O Error on client clientId=0 reqType=-1 [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending interrupt signal to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/THIRD-NODE:19841),5,] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending shutdown to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42235),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing input socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42235),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42235),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : I/O Error on client clientId=0 reqType=-1 [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending interrupt signal to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42235),5,] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending shutdown to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42237),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing input socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42237),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Closing socket of thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42237),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.OClientConnectionManager : Sending interrupt signal to thread Thread[OrientDB (/SECOND-NODE:2424) &lt;- BinaryClient (/FIRST-NODE:42237),5,OrientDB] [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : I/O Error on client clientId=0 reqType=-1 [INFO] com.orientechnologies.orient.server.plugin.OServerPluginManager : Shutting down plugins: [INFO] com.orientechnologies.orient.server.plugin.OServerPluginManager : - cluster [WARN] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : Shutting down node node-02... [WARN] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [node-02] Updated node status to 'SHUTTINGDOWN' [INFO] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [node-02] Received updated status node-02.devaprint-production=OFFLINE [INFO] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [node-02] Received updated status node-02.OSystem=OFFLINE [INFO] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [node-02] Distributed servers status: +--------+------+-------------------------------------+-----+-----------------------+--------------------+--------------------+---------------------------+ |Name    |Status|Databases                            |Conns|StartedOn              |Binary              |HTTP                |UsedMemory                 | +--------+------+-------------------------------------+-----+-----------------------+--------------------+--------------------+---------------------------+ |node-03 |ONLINE|                                     |4    |2016-05-10 17:44:17.601|                    |                    |                           | |node-02*|ONLINE|devaprint-production=OFFLINE (MASTER)|4    |2016-05-10 17:40:58.749|SECOND-NODE:2424|SECOND-NODE:2480|262.07MB/1011.25MB (25.92%)| |        |      |OSystem=OFFLINE (MASTER)             |     |                       |                    |                    |                           | |node-01 |ONLINE|devaprint-production=ONLINE (MASTER) |4    |2016-05-10 17:50:27.864|FIRST-NODE:2424|FIRST-NODE:2480|261.25MB/1011.25MB (25.83%)| |        |      |OSystem=ONLINE (MASTER)              |     |                       |                    |                    |                           | +--------+------+-------------------------------------+-----+-----------------------+--------------------+--------------------+---------------------------+ [INFO] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [node-02] Distributed servers status: +--------+------+-------------------------------------+-----+-----------------------+--------------------+--------------------+---------------------------+ |Name    |Status|Databases                            |Conns|StartedOn              |Binary              |HTTP                |UsedMemory                 | +--------+------+-------------------------------------+-----+-----------------------+--------------------+--------------------+---------------------------+ |node-03 |ONLINE|devaprint-production=ONLINE (MASTER) |4    |2016-05-10 17:44:17.601|THIRD-NODE:2424|THIRD-NODE:2480|169.35MB/1011.25MB (16.75%)| |        |      |OSystem=ONLINE (MASTER)              |     |                       |                    |                    |                           | |node-02*|ONLINE|devaprint-production=OFFLINE (MASTER)|4    |2016-05-10 17:40:58.749|SECOND-NODE:2424|SECOND-NODE:2480|262.07MB/1011.25MB (25.92%)| |        |      |OSystem=OFFLINE (MASTER)             |     |                       |                    |                    |                           | |node-01 |ONLINE|devaprint-production=ONLINE (MASTER) |4    |2016-05-10 17:50:27.864|FIRST-NODE:2424|FIRST-NODE:2480|261.25MB/1011.25MB (25.83%)| |        |      |OSystem=ONLINE (MASTER)              |     |                       |                    |                    |                           | +--------+------+-------------------------------------+-----+-----------------------+--------------------+--------------------+---------------------------+ [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database devaprint-production [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [INFO] com.orientechnologies.orient.server.distributed.ODistributedDatabaseImpl : [node-02] Shutting down distributed database manager 'devaprint-production'. Pending objects: txs=0 locks=0 [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] end of reading requests for database OSystem [WARN] com.orientechnologies.orient.server.distributed.ODistributedWorker : [node-02] Shutdown distributed worker completed [INFO] com.orientechnologies.orient.server.distributed.ODistributedDatabaseImpl : [node-02] Shutting down distributed database manager 'OSystem'. Pending objects: txs=0 locks=0 [WARN] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [node-02] Updated node status to 'OFFLINE' [WARN] com.orientechnologies.orient.server.distributed.ODistributedStorage$1 : [node-02] Shutdown asynchronous queue worker for database 'devaprint-production' completed [WARN] com.orientechnologies.orient.server.distributed.ODistributedStorage$1 : [node-02] Shutdown asynchronous queue worker for database 'OSystem' completed [INFO] com.hazelcast.core.LifecycleService : [SECOND-NODE]:2434 [quark] [3.6.1] Address[SECOND-NODE]:2434 is SHUTTING_DOWN [INFO] com.hazelcast.instance.Node : [SECOND-NODE]:2434 [quark] [3.6.1] Shutting down connection manager... [WARN] com.hazelcast.nio.tcp.nonblocking.NonBlockingSocketReader : [SECOND-NODE]:2434 [quark] [3.6.1] hz._hzInstance_1_quark.IO.thread-in-1 Closing socket to endpoint Address[FIRST-NODE]:2434, Cause:java.nio.channels.CancelledKeyException java.nio.channels.CancelledKeyException         at com.hazelcast.nio.tcp.nonblocking.NonBlockingIOThread.handleSelectionKey(NonBlockingIOThread.java:265)         at com.hazelcast.nio.tcp.nonblocking.NonBlockingIOThread.handleSelectionKeys(NonBlockingIOThread.java:256)         at com.hazelcast.nio.tcp.nonblocking.NonBlockingIOThread.runSelectLoop(NonBlockingIOThread.java:206)         at com.hazelcast.nio.tcp.nonblocking.NonBlockingIOThread.run(NonBlockingIOThread.java:163) [INFO] com.hazelcast.nio.tcp.TcpIpConnection : [SECOND-NODE]:2434 [quark] [3.6.1] Connection [Address[FIRST-NODE]:2434] lost. Reason: Socket explicitly closed [INFO] com.hazelcast.nio.tcp.TcpIpConnection : [SECOND-NODE]:2434 [quark] [3.6.1] Connection [Address[THIRD-NODE]:2434] lost. Reason: java.io.EOFException[Remote socket closed!] [WARN] com.hazelcast.nio.tcp.nonblocking.NonBlockingSocketReader : [SECOND-NODE]:2434 [quark] [3.6.1] hz._hzInstance_1_quark.IO.thread-in-0 Closing socket to endpoint Address[THIRD-NODE]:2434, Cause:java.io.EOFException: Remote socket closed! [INFO] com.hazelcast.instance.Node : [SECOND-NODE]:2434 [quark] [3.6.1] Shutting down node engine... : enp0s3: truncated packet (281) from 149.202.160.1 [INFO] com.hazelcast.instance.NodeExtension : [SECOND-NODE]:2434 [quark] [3.6.1] Destroying node NodeExtension. [INFO] com.hazelcast.instance.Node : [SECOND-NODE]:2434 [quark] [3.6.1] Hazelcast Shutdown is completed in 3323 ms. [INFO] com.hazelcast.core.LifecycleService : [SECOND-NODE]:2434 [quark] [3.6.1] Address[SECOND-NODE]:2434 is SHUTDOWN [INFO] com.orientechnologies.orient.server.plugin.OServerPluginManager : - graph [INFO] com.orientechnologies.orient.server.OServer : Shutting down databases: [INFO] com.orientechnologies.orient.core.Orient : Orient Engine is shutting down... [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownWorkersHandler is going to be called [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownWorkersHandler completed [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownEnginesHandler is going to be called [INFO] com.orientechnologies.orient.core.Orient : - shutdown storage: devaprint-production... [INFO] com.orientechnologies.orient.core.Orient : - shutdown storage: OSystem... [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownEnginesHandler completed [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownPendingThreadsHandler is going to be called [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownPendingThreadsHandler completed [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownProfilerHandler is going to be called [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownProfilerHandler completed [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownCallListenersHandler is going to be called [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) 80991.412: [Full GC (System.gc()) 80991.412: [CMS: 176289K-&gt;156575K(917504K), 4.4943057 secs] 280368K-&gt;156575K(1035520K), [Metaspace: 104862K-&gt;104862K(1153024K)], 4.4972262 secs] [Times: user=1.91 sys=0.07, real=4.50 secs] [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [ERROR] com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler : Error during orient shutdown java.lang.NullPointerException         at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:77)         at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:51)         at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:70)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.isClosed(OAbstractPaginatedStorage.java:416)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.isClosed(ODistributedStorage.java:1212)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1203)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.close(ODistributedStorage.java:1188)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.close(OPartitionedDatabasePool.java:425)         at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.onShutdown(OPartitionedDatabasePool.java:400)         at com.orientechnologies.orient.core.Orient$OShutdownCallListenersHandler.shutdown(Orient.java:962)         at com.orientechnologies.orient.core.Orient.shutdown(Orient.java:333)         at com.orientechnologies.orient.server.OServer.shutdown(OServer.java:472)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:438)         at org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:302)         at org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:35)         at org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:293)         at org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:131)         at org.jruby.ir.interpreter.InterpreterEngine.processCall(InterpreterEngine.java:332)         at org.jruby.ir.interpreter.StartupInterpreterEngine.interpret(StartupInterpreterEngine.java:77)         at org.jruby.ir.interpreter.Interpreter.INTERPRET_BLOCK(Interpreter.java:132)         at org.jruby.runtime.MixedModeIRBlockBody.commonYieldPath(MixedModeIRBlockBody.java:148)         at org.jruby.runtime.IRBlockBody.call(IRBlockBody.java:66)         at org.jruby.runtime.Block.call(Block.java:126)         at org.jruby.RubyProc.call(RubyProc.java:342)         at org.jruby.RubyProc.call(RubyProc.java:248)         at org.jruby.Ruby.tearDown(Ruby.java:3316)         at org.jruby.Ruby.tearDown(Ruby.java:3289)         at org.jruby.Main$1.run(Main.java:293) [INFO] com.orientechnologies.orient.core.Orient : Shutdown handler OShutdownCallListenersHandler completed [INFO] com.orientechnologies.orient.core.Orient : OrientDB Engine shutdown complete [INFO] com.orientechnologies.orient.server.OServer : OrientDB Server shutdown complete ``` </body>
		<created>2016-05-11 14:34:18</created>
		<closed>2016-05-16 08:11:58</closed>
	</bug>
	<bug>
		<id>6112</id>
		<title>OrientDB - UI Issue - Properties layer on the left hand side is not scrollable</title>
		<body>It is observed that the properties layer on the left hand side does not scroll if there are more number of properties. Hence user cannot see more than a certain number of properties even if they exist as they are out of the page view. Also the text displayed in the property-value pairs is not wrapped, thus making it difficult to read. </body>
		<created>2016-05-10 07:11:36</created>
		<closed>2016-06-10 12:54:37</closed>
	</bug>
	<bug>
		<id>6111</id>
		<title>OrientDB - Corrupt display after continuous use of OrientDB Studio.</title>
		<body>After using OrientDB Studio for more than 15 mins, the UI starts behaving weird. Few of the vertices get disappeared from the graph. This behavior is not predictable always. But it is observed that it normally happens after continuous use of the OrientDB Studio. The version of studio used is 2.1. The images are attached below to explain the issue.  ![orientdb ui issue](https://cloud.githubusercontent.com/assets/19280129/15138159/b3e957de-16ab-11e6-906e-61b48a6fbeaf.png) </body>
		<created>2016-05-10 07:06:11</created>
		<closed>2016-09-26 14:34:56</closed>
	</bug>
	<bug>
		<id>6104</id>
		<title>Distributed : Wrong user/password to [connect] to the remote OrientDB Server instance.</title>
		<body>I have two nodes with default settings regarding security (2.2.0-rc1). The same setup worked fine maybe two months ago (+/- one month).  First node :  ``` [INFO] com.hazelcast.nio.tcp.SocketAcceptorThread : [FIRST-NODE]:2434 [quark] [3.6.1] Accepting socket connection from /SECOND-NODE:52461 [INFO] com.hazelcast.nio.tcp.TcpIpConnectionManager : [FIRST-NODE]:2434 [quark] [3.6.1] Established socket connection between /FIRST-NODE:2434 and /SECOND-NODE:52461 [DEBUG] com.hazelcast.cluster.impl.ClusterHeartbeatManager : [FIRST-NODE]:2434 [quark] [3.6.1] Received heartbeat from Member [SECOND-NODE]:2434 (now: Mon May 09 11:08:29 CEST 2016, timestamp: Mon May 09 11:08:29 CEST 2016) [INFO] com.hazelcast.cluster.ClusterService : [FIRST-NODE]:2434 [quark] [3.6.1] Members [2] {         Member [FIRST-NODE]:2434 this          Member [SECOND-NODE]:2434 } [INFO] com.hazelcast.partition.InternalPartitionService : [FIRST-NODE]:2434 [quark] [3.6.1] Re-partitioning cluster data... Migration queue size: 135 [DEBUG] com.hazelcast.spi.OperationService : [FIRST-NODE]:2434 [quark] [3.6.1] Invocations:1 timeouts:0 backup-timeouts:0 [INFO] com.hazelcast.partition.InternalPartitionService : [FIRST-NODE]:2434 [quark] [3.6.1] All migration tasks have been completed, queues are empty. [INFO] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : [FIRST-NODE-NAME]&lt;-[ext:02368c29-a2fb-4651-a8fe-045423384c02] Received updated about registered nodes [INFO] com.orientechnologies.orient.server.OClientConnectionManager : Remote client connected from: OClientConnection [id=1, source=/127.0.0.1:39069, since=1462784912291] [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : Request id:-1 type:2 [ERROR] com.hazelcast.spi.impl.eventservice.impl.EventServiceImpl : [FIRST-NODE]:2434 [quark] [3.6.1] hz._hzInstance_1_quark.event-4 caught an exception while processing task:com.hazelcast.spi.impl.eventservice.impl.LocalEventDispatcher@67a22b0a com.orientechnologies.orient.core.exception.OSecurityAccessException: Wrong user/password to [connect] to the remote OrientDB Server instance. Get the user/password from the config/orientdb-server-config.xml file         at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)         at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)         at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)         at java.lang.reflect.Constructor.newInstance(Constructor.java:423)         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryClientAbstract.throwSerializedException(OChannelBinaryClientAbstract.java:250)         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryClientAbstract.handleStatus(OChannelBinaryClientAbstract.java:201)         at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinarySynchClient.beginResponse(OChannelBinarySynchClient.java:56)         at com.orientechnologies.orient.server.distributed.ORemoteServerChannel$3.execute(ORemoteServerChannel.java:161)         at com.orientechnologies.orient.server.distributed.ORemoteServerChannel$3.execute(ORemoteServerChannel.java:146)         at com.orientechnologies.orient.server.distributed.ORemoteServerChannel.networkOperation(ORemoteServerChannel.java:188)         at com.orientechnologies.orient.server.distributed.ORemoteServerChannel.connect(ORemoteServerChannel.java:146)         at com.orientechnologies.orient.server.distributed.ORemoteServerChannel.&lt;init&gt;(ORemoteServerChannel.java:68)         at com.orientechnologies.orient.server.distributed.ORemoteServerController.&lt;init&gt;(ORemoteServerController.java:35)         at com.orientechnologies.orient.server.distributed.ODistributedAbstractPlugin.getRemoteServer(ODistributedAbstractPlugin.java:663)         at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.entryAdded(OHazelcastPlugin.java:468)         at com.hazelcast.map.impl.MapListenerAdaptors$1$1.onEvent(MapListenerAdaptors.java:66)         at com.hazelcast.map.impl.MapListenerAdaptors$1$1.onEvent(MapListenerAdaptors.java:63)         at com.hazelcast.map.impl.InternalMapListenerAdapter.onEvent(InternalMapListenerAdapter.java:56)         at com.hazelcast.map.impl.InternalMapListenerAdapter.onEvent(InternalMapListenerAdapter.java:35)         at com.hazelcast.map.impl.event.MapEventPublishingService.callListener(MapEventPublishingService.java:109)         at com.hazelcast.map.impl.event.MapEventPublishingService.dispatchEntryEventData(MapEventPublishingService.java:121)         at com.hazelcast.map.impl.event.MapEventPublishingService.dispatchEvent(MapEventPublishingService.java:51)         at com.hazelcast.map.impl.event.MapEventPublishingService.dispatchEvent(MapEventPublishingService.java:38)         at com.hazelcast.map.impl.MapService.dispatchEvent(MapService.java:94)         at com.hazelcast.map.impl.MapService.dispatchEvent(MapService.java:68)         at com.hazelcast.spi.impl.eventservice.impl.LocalEventDispatcher.run(LocalEventDispatcher.java:56)         at com.hazelcast.util.executor.StripedExecutor$Worker.process(StripedExecutor.java:187)         at com.hazelcast.util.executor.StripedExecutor$Worker.run(StripedExecutor.java:171) [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : I/O Error on client clientId=0 reqType=-1  [DEBUG] com.hazelcast.cluster.impl.ClusterHeartbeatManager : [FIRST-NODE]:2434 [quark] [3.6.1] Received heartbeat from Member [SECOND-NODE]:2434 (now: Mon May 09 11:08:33 CEST 2016, timestamp: Mon May 09 11:08:33 CEST 2016) [INFO] com.hazelcast.nio.tcp.TcpIpConnection : [FIRST-NODE]:2434 [quark] [3.6.1] Connection [Address[SECOND-NODE]:2434] lost. Reason: java.io.IOException[Connection reset by peer]  ```  Second node :   ``` [INFO] com.hazelcast.nio.tcp.TcpIpConnectionManager : [SECOND-NODE]:2434 [quark] [3.6.1] Established socket connection between /SECOND-NODE:52461 and /FIRST-NODE:2434 [WARN] com.hazelcast.partition.InternalPartitionService : [SECOND-NODE]:2434 [quark] [3.6.1] Ignoring received partition table, startup is not completed yet. Sender: Address[FIRST-NODE]:2434  [DEBUG] com.hazelcast.cluster.impl.ClusterHeartbeatManager : [SECOND-NODE]:2434 [quark] [3.6.1] Received heartbeat from Member [FIRST-NODE]:2434 (now: Mon May 09 11:08:29 CEST 2016, timestamp: Mon May 09 11:08:29 CEST 2016)  [DEBUG] com.hazelcast.cluster.impl.ClusterHeartbeatManager : [SECOND-NODE]:2434 [quark] [3.6.1] Received heartbeat from Member [FIRST-NODE]:2434 (now: Mon May 09 11:08:29 CEST 2016, timestamp: Mon May 09 11:08:29 CEST 2016) [INFO] com.hazelcast.cluster.ClusterService : [SECOND-NODE]:2434 [quark] [3.6.1] Members [2] {         Member [FIRST-NODE]:2434         Member [SECOND-NODE]:2434 this } [INFO] com.hazelcast.core.LifecycleService : [SECOND-NODE]:2434 [quark] [3.6.1] Address[SECOND-NODE]:2434 is STARTED  [INFO] com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin : Starting distributed server 'SECOND-NODE-NAME' (hzID=-1)... [DEBUG] com.hazelcast.cluster.impl.ClusterHeartbeatManager : [SECOND-NODE]:2434 [quark] [3.6.1] Received heartbeat from Member [FIRST-NODE]:2434 (now: Mon May 09 11:08:32 CEST 2016, timestamp: Mon May 09 11:08:32 CEST 2016) [INFO] com.orientechnologies.orient.server.OClientConnectionManager : Remote client connected from: OClientConnection [id=1, source=/127.0.0.1:43241, since=1462784912710] [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : Request id:-1 type:2 [DEBUG] com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary : I/O Error on client clientId=0 reqType=-1 [ERROR] ruby.quark.application : exception Java::ComOrientechnologiesOrientCoreException::OSecurityAccessException : Wrong user/password to [connect] to the remote OrientDB Server instance. Get the user/password from the config/orientdb-server-config.xml file [DEBUG] ruby.quark.application : java.lang.reflect.Constructor.newInstance(java/lang/reflect/Constructor.java:423) com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryClientAbstract.throwSerializedException(com/orientechnologies/orient/enterprise/channel/binary/OChannelBinaryClientAbstract.java:250) com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryClientAbstract.handleStatus(com/orientechnologies/orient/enterprise/channel/binary/OChannelBinaryClientAbstract.java:201) com.orientechnologies.orient.enterprise.channel.binary.OChannelBinarySynchClient.beginResponse(com/orientechnologies/orient/enterprise/channel/binary/OChannelBinarySynchClient.java:56) com.orientechnologies.orient.server.distributed.ORemoteServerChannel$3.execute(com/orientechnologies/orient/server/distributed/ORemoteServerChannel.java:161) com.orientechnologies.orient.server.distributed.ORemoteServerChannel$3.execute(com/orientechnologies/orient/server/distributed/ORemoteServerChannel.java:146) com.orientechnologies.orient.server.distributed.ORemoteServerChannel.networkOperation(com/orientechnologies/orient/server/distributed/ORemoteServerChannel.java:188) com.orientechnologies.orient.server.distributed.ORemoteServerChannel.connect(com/orientechnologies/orient/server/distributed/ORemoteServerChannel.java:146) com.orientechnologies.orient.server.distributed.ORemoteServerChannel.&lt;init&gt;(com/orientechnologies/orient/server/distributed/ORemoteServerChannel.java:68) com.orientechnologies.orient.server.distributed.ORemoteServerController.&lt;init&gt;(com/orientechnologies/orient/server/distributed/ORemoteServerController.java:35) com.orientechnologies.orient.server.distributed.ODistributedAbstractPlugin.getRemoteServer(com/orientechnologies/orient/server/distributed/ODistributedAbstractPlugin.java:663) com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(com/orientechnologies/orient/server/hazelcast/OHazelcastPlugin.java:204) com.orientechnologies.orient.server.OServer.registerPlugins(com/orientechnologies/orient/server/OServer.java:1167) com.orientechnologies.orient.server.OServer.activate(com/orientechnologies/orient/server/OServer.java:380)  ```  security.json (on both nodes) :   ``` {   "enabled": true,   "debug": false,   "server": {     "createDefaultUsers": true   },   "authentication": {     "allowDefault": true,     "authenticators": [       {         "name": "Password",         "class": "com.orientechnologies.orient.server.security.authenticator.ODefaultPasswordAuthenticator",         "enabled": true,         "users": [           {             "username": "guest",             "resources": "server.listDatabases,server.dblist"           }         ]       },       {         "name": "ServerConfig",         "class": "com.orientechnologies.orient.server.security.authenticator.OServerConfigAuthenticator",         "enabled": true       },       {         "name": "SystemAuthenticator",         "class": "com.orientechnologies.orient.server.security.authenticator.OSystemUserAuthenticator",         "enabled": true       } ]   },   "auditing": {     "class": "com.orientechnologies.security.auditing.ODefaultAuditing",     "enabled": false                                                                                                                                                                                                                                                                                                              }                                                                                                                                                                                                                                                                                                                             }  ```  orientdb-server-config.xml (both nodes) :   ``` [...] &lt;users/&gt; [...] ```  I also tried with a root and guest user with sha256 passwords but same result.  Did I miss something ? </body>
		<created>2016-05-09 09:27:01</created>
		<closed>2016-12-28 11:36:50</closed>
	</bug>
	<bug>
		<id>6099</id>
		<title>OReadersWriterSpinLock - Not able to make any database operation</title>
		<body></body>
		<created>2016-05-07 04:48:57</created>
		<closed>2016-08-11 13:16:07</closed>
	</bug>
	<bug>
		<id>6094</id>
		<title>Rebuild index in embedded mode stuck in loop</title>
		<body>``` orientdb {db=hola}&gt; rebuild index contact_link.linkIndex;   Rebuilding index(es)... Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Index 'contact_link.linkIndex' not found  orientdb {db=hola}&gt; rebuild index linkIndex;   Rebuilding index(es)... ```  This was the command which was given, however index keep rebuilding again and again and this is the third time it is in progress despite command was given two times only.  2016-05-06 06:27:19:474 INFO  {db=hola} - Rebuilding index hola.linkIndex (estimated 67,251,242 items)... [OIndexRebuildOutputListener]May 06, 2016 6:27:19 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} - Rebuilding index hola.linkIndex (estimated 67,251,242 items)...  2016-05-06 06:27:29:475 INFO  {db=hola} --&gt; 0.28% progress, 185,825 indexed so far (18,582 items/sec) [OIndexRebuildOutputListener]May 06, 2016 6:27:29 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; 0.28% progress, 185,825 indexed so far (18,582 items/sec)  2016-05-06 08:09:42:274 INFO  {db=hola} --&gt; 99.89% progress, 67,175,248 indexed so far (7,961 items/sec) [OIndexRebuildOutputListener]May 06, 2016 8:09:42 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; 99.89% progress, 67,175,248 indexed so far (7,961 items/sec)  2016-05-06 08:09:50:590 INFO  {db=hola} --&gt; OK, indexed 67,251,242 items in 6,151,116 ms [OIndexRebuildOutputListener]May 06, 2016 8:09:50 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; OK, indexed 67,251,242 items in 6,151,116 ms  2016-05-06 08:09:51:321 INFO  {db=hola} - Rebuilding index hola.linkIndex (estimated 67,251,242 items)... [OIndexRebuildOutputListener]May 06, 2016 8:09:51 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} - Rebuilding index hola.linkIndex (estimated 67,251,242 items)...  2016-05-06 08:10:01:322 INFO  {db=hola} --&gt; 0.24% progress, 163,249 indexed so far (16,324 items/sec) [OIndexRebuildOutputListener]May 06, 2016 8:10:01 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; 0.24% progress, 163,249 indexed so far (16,324 items/sec)  2016-05-06 09:48:22:765 INFO  {db=hola} --&gt; 99.91% progress, 67,191,295 indexed so far (6,497 items/sec) [OIndexRebuildOutputListener]May 06, 2016 9:48:22 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; 99.91% progress, 67,191,295 indexed so far (6,497 items/sec)  2016-05-06 09:48:30:767 INFO  {db=hola} --&gt; OK, indexed 67,251,242 items in 5,919,446 ms [OIndexRebuildOutputListener]May 06, 2016 9:48:30 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; OK, indexed 67,251,242 items in 5,919,446 ms  2016-05-06 09:48:31:473 INFO  {db=hola} - Rebuilding index hola.linkIndex (estimated 67,251,242 items)... [OIndexRebuildOutputListener]May 06, 2016 9:48:31 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} - Rebuilding index hola.linkIndex (estimated 67,251,242 items)...  2016-05-06 09:48:41:474 INFO  {db=hola} --&gt; 0.26% progress, 171,570 indexed so far (17,157 items/sec) [OIndexRebuildOutputListener]May 06, 2016 9:48:41 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; 0.26% progress, 171,570 indexed so far (17,157 items/sec)  2016-05-06 09:48:51:475 INFO  {db=hola} --&gt; 0.50% progress, 337,755 indexed so far (16,618 items/sec) [OIndexRebuildOutputListener]May 06, 2016 9:48:51 AM com.orientechnologies.common.log.OLogManager log INFO: {db=hola} --&gt; 0.50% progress, 337,755 indexed so far (16,618 items/sec)  **Why it is getting below exception on executing first command ? Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Index 'contact_link.linkIndex' not found** </body>
		<created>2016-05-06 10:15:11</created>
		<closed>2016-06-13 07:47:00</closed>
	</bug>
	<bug>
		<id>6093</id>
		<title>insert fail on distributed mode</title>
		<body>After running stably for 3 months, suddenly there were a lot of following exceptions, seems node1 cannot accept insert operation, but update/query is ok. and insert is ok on node2.  Now we disabled distributed mode. Thanks for any idea.  version: 2.1.7 "executionMode": "synchronous" data size:  vert 2500k, edge 2500k  &gt; Caused by: com.orientechnologies.orient.server.distributed.ODistributedException: Error on executing distributed request (id=5022941 from=node1 task=record_create(#11:-1 v.0) user=#5:0) against database 'orion.[orion_v]' to nodes [node1, node2] &gt;     at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.send2Nodes(OHazelcastDistributedDatabase.java:189) &gt;     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.sendRequest(OHazelcastPlugin.java:360) &gt;     at com.orientechnologies.orient.server.distributed.ODistributedStorage.createRecord(ODistributedStorage.java:547) &gt;     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1999) &gt;     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:159) &gt;     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2568) &gt;     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2409) &gt;     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121) &gt;     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.createRecord(OBinaryNetworkProtocolAbstract.java:367) &gt;     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createRecord(ONetworkProtocolBinary.java:1569) &gt;     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:365) &gt;     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223) &gt;     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) &gt; Caused by: com.orientechnologies.orient.server.distributed.ODistributedException: Quorum 2 not reached for request (id=5022941 from=node1 task=record_create(#11:-1 v.0) user=#5:0). Elapsed=6ms Servers in timeout/conflict are: &gt; - node2: #11:2660136 v.1 &gt;   Received: {node1=#11:2660169 v.1, node2=#11:2660136 v.1} &gt;   at com.orientechnologies.orient.server.distributed.ODistributedResponseManager.manageConflicts(ODistributedResponseManager.java:570) &gt;   at com.orientechnologies.orient.server.distributed.ODistributedResponseManager.getFinalResponse(ODistributedResponseManager.java:339) &gt;   at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.waitForResponse(OHazelcastDistributedDatabase.java:423) &gt;   at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.send2Nodes(OHazelcastDistributedDatabase.java:186) &gt;   ... 12 more </body>
		<created>2016-05-06 05:37:55</created>
		<closed>2016-05-20 10:55:45</closed>
	</bug>
	<bug>
		<id>6087</id>
		<title>Index errors when using the IN operator with embedded collection types</title>
		<body>Setup, using OrientDB 2.1.16:  ``` CREATE CLASS Foo CREATE PROPERTY Foo.bar EmbeddedSet String CREATE INDEX Foo.bar NOTUNIQUE INSERT INTO Foo SET bar = ['abc', 'def'] INSERT INTO Foo SET bar = ['abcd', 'defg'] INSERT INTO Foo SET bar = ['xyz', '123'] ```  [Per the docs](http://orientdb.com/docs/last/SQL-Where.html#conditional-operators), the following two queries should be identical and should hit the index:  ``` SELECT * FROM Foo WHERE bar CONTAINS 'xyz' SELECT * FROM Foo WHERE 'xyz' IN bar ```  The first query hits the index (as evidenced by `EXPLAIN`) and works as expected. However, the second query does not hit the index (`EXPLAIN` says 3 records were read, and `involvedIndexes` is null) and causes the following error to be printed to the logs:  ``` Error on using index Foo.bar in query 'SELECT * FROM Foo WHERE 'xyz' IN bar'. Probably you need to rebuild indexes. Now executing query using cluster scan java.lang.IllegalArgumentException: Key 'xyz' is not valid     at com.orientechnologies.orient.core.sql.operator.OQueryOperatorIn.executeIndexQuery(OQueryOperatorIn.java:81)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchForIndexes(OCommandExecutorSQLSelect.java:1929)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchInClasses(OCommandExecutorSQLSelect.java:922)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.assignTarget(OCommandExecutorSQLResultsetAbstract.java:199)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.assignTarget(OCommandExecutorSQLSelect.java:493)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:475)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:446)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLExplain.execute(OCommandExecutorSQLExplain.java:51)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1433)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1406)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:81)     at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:180)     at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:627)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  This bug is causing significant performance degradation in my project and making the error logs near-useless. </body>
		<created>2016-05-04 18:48:45</created>
		<closed>2016-05-17 10:40:36</closed>
	</bug>
	<bug>
		<id>6085</id>
		<title>Strange behavior after OrientGraphNoTx.dropVertexType() </title>
		<body>We are facing a strange behavior in a migration scenario. We have some existing data where vertices have to be migrate from one type to another.  Basically there are vertex types A and B which are connected with an edge. During the migration a new vertex type is created (C) and for every vertex of type B a new vertex of type C is created with the same relations. At the end the old vertex type B is deleted.  After the deletion of the old vertex type the data remains in a unexpected state.The following tests should describe it. The state depends on the usage of lightweight edges and the used version. I've tested it with 2.1.16 ans 2.2.0-beta2.  ``` java import static org.hamcrest.Matchers.hasSize; import static org.hamcrest.Matchers.notNullValue; import static org.junit.Assert.assertThat;  import com.google.common.collect.Lists; import com.tinkerpop.blueprints.Direction; import com.tinkerpop.blueprints.Edge; import com.tinkerpop.blueprints.Vertex; import com.tinkerpop.blueprints.impls.orient.OrientGraphNoTx; import com.tinkerpop.blueprints.impls.orient.OrientVertex; import org.junit.Rule; import org.junit.Test; import org.junit.rules.TemporaryFolder;  /*  * Merge from  * A -[Relates]-&gt; B  * to  * A -[Relates]-&gt; C  */ public class VertexTypeMigrationTest {      @Rule     public TemporaryFolder temporaryFolder = new TemporaryFolder();      @Test     public void testDropVertexTypeUsingLightweightEdges() throws Exception {          OrientGraphNoTx orientGraph = new OrientGraphNoTx("plocal:" + temporaryFolder.getRoot().getAbsolutePath());         orientGraph.setUseLightweightEdges(true);          orientGraph.createVertexType("A");         orientGraph.createVertexType("B");         orientGraph.createEdgeType("Relates");          /**          * A -[Relates]-&gt; B          */         OrientVertex aVertex = orientGraph.addVertex("class:A");         OrientVertex bVertex = orientGraph.addVertex("class:B");         aVertex.addEdge("Relates", bVertex);          /**          * Migrate B -&gt; C          */         orientGraph.createVertexType("C");          for (Vertex oldbVertex : orientGraph.getVerticesOfClass("B")) {             Vertex cVertex = orientGraph.addVertex("class:C");             for (Edge edge : oldbVertex.getEdges(Direction.IN, "Relates")) {                 edge.getVertex(Direction.OUT).addEdge("Relates", cVertex);             }         }          orientGraph.dropVertexType("B");          // 2.1.16 -&gt; size 1         // 2.2.0-beta2 -&gt; size 2         assertThat(Lists.newArrayList(aVertex.getEdges(Direction.OUT)), hasSize(2));         assertThat(Lists.newArrayList(orientGraph.getVertex(aVertex.getId()).getEdges(Direction.OUT)), hasSize(2));          // 2.1.16 NullPointerException         // 2.2.0-beta2 -&gt; size 2         assertThat(Lists.newArrayList(aVertex.getVertices(Direction.OUT)), hasSize(2));          Iterable&lt;Vertex&gt; vertices = orientGraph.getVertex(aVertex.getId()).getVertices(Direction.OUT);         // 2.1.16 NullPointerException         assertThat(Lists.newArrayList(vertices), hasSize(2));          // 2.1.16 NullPointerException         while (vertices.iterator().hasNext()) {             // direct access using the id             // 2.2.0-beta2 -&gt; IllegalArgumentException, cluster xx is null!             assertThat(orientGraph.getVertex(vertices.iterator().next().getId()), notNullValue());         }      }      @Test     public void testDropVertexType() throws Exception {          OrientGraphNoTx orientGraph = new OrientGraphNoTx("plocal:" + temporaryFolder.getRoot().getAbsolutePath());         orientGraph.setUseLightweightEdges(false);          orientGraph.createVertexType("A");         orientGraph.createVertexType("B");         orientGraph.createEdgeType("Relates");          /**          * A -[Relates]-&gt; B          */         OrientVertex aVertex = orientGraph.addVertex("class:A");         OrientVertex bVertex = orientGraph.addVertex("class:B");         aVertex.addEdge("Relates", bVertex);          /**          * Migrate B -&gt; C          */         orientGraph.createVertexType("C");          for (Vertex oldbVertex : orientGraph.getVerticesOfClass("B")) {             Vertex cVertex = orientGraph.addVertex("class:C");             for (Edge edge : oldbVertex.getEdges(Direction.IN, "Relates")) {                 edge.getVertex(Direction.OUT).addEdge("Relates", cVertex);             }         }          orientGraph.dropVertexType("B");          // 2.1.16 &amp; 2.2.0-beta2 -&gt; size 2         assertThat(Lists.newArrayList(aVertex.getEdges(Direction.OUT)), hasSize(2));         assertThat(Lists.newArrayList(orientGraph.getVertex(aVertex.getId()).getEdges(Direction.OUT)), hasSize(2));          // 2.1.16 &amp; 2.2.0-beta2 -&gt; size 2         assertThat(Lists.newArrayList(aVertex.getVertices(Direction.OUT)), hasSize(2));         Iterable&lt;Vertex&gt; vertices = orientGraph.getVertex(aVertex.getId()).getVertices(Direction.OUT);         assertThat(Lists.newArrayList(vertices), hasSize(2));          while (vertices.iterator().hasNext()) {             // direct access using the id             // 2.1.6 &amp; 2.2.0-beta2-&gt; IllegalArgumentException, cluster xx is null!             assertThat(orientGraph.getVertex(vertices.iterator().next().getId()), notNullValue());         }     } ``` </body>
		<created>2016-05-04 14:29:57</created>
		<closed>2016-06-15 12:54:48</closed>
	</bug>
	<bug>
		<id>6084</id>
		<title>ORecordDuplicateException for non-duplicate record</title>
		<body>I am using latest version of orientdb i.e. 2.1.16 and I have a index at phoneNumber While inserting (massive inserts) in embedded mode at document level the below exception comes.  Phone number to be insert is `*141*10` and it is found duplicate with phone number `*141*10#` present at  RID#24:117 and following exception comes  com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record contact_info#17:9387{phoneNumber:`*141*10`,lastname:loan,firstname:Air tel,spamScore:0.0,circle:null,fullname:Airtel loan,city:null,in_contact_link:[#38:9373]} v1: found duplicated key '`*141*10`' in index 'contact_info.phoneNumber ' previously assigned to the record #24:117 RID=#24:117 at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.checkEntry(OIndexTxAwareOneValue.java:224)         at com.orientechnologies.orient.core.index.OClassIndexManager.checkIndexedPropertiesOnUpdate(OClassIndexManager.java:376)         at com.orientechnologies.orient.core.index.OClassIndexManager.checkIndexes(OClassIndexManager.java:583)         at com.orientechnologies.orient.core.index.OClassIndexManager.onRecordBeforeUpdate(OClassIndexManager.java:430)         at com.orientechnologies.orient.core.hook.ODocumentHookAbstract.onTrigger(ODocumentHookAbstract.java:256)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHooks(ODatabaseDocumentTx.java:1070)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1936)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:159)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2492)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:122)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759) </body>
		<created>2016-05-04 12:36:50</created>
		<closed>2016-06-10 05:23:56</closed>
	</bug>
	<bug>
		<id>6076</id>
		<title>Distributed database breaks down after removing node</title>
		<body>Running `2.2-beta` After I remove a node (kill it) from a distributed setup that is using Hazelcast in AWS, the distributed setup (trying not to use the word cluster here) still tries to communicate with the removed node which still appears in the `clusters&gt;*&gt;servers` of that database. Is there a way to impose a timeout to purge a node after it has been unresponsive for a predetermined amount of time? Or what is the correct way to scale down a cluster? </body>
		<created>2016-05-02 16:16:49</created>
		<closed>2016-05-03 20:34:01</closed>
	</bug>
	<bug>
		<id>6075</id>
		<title>Error on creating a class</title>
		<body>From Studio with version 2.2-beta2 from IDE when I create a new class it can't extend no class.  ![schema](https://cloud.githubusercontent.com/assets/12543436/14952212/e7eadee8-105e-11e6-8fe2-4a45083a2d9a.png) </body>
		<created>2016-05-02 10:11:45</created>
		<closed>2016-05-10 08:01:59</closed>
	</bug>
	<bug>
		<id>6073</id>
		<title>JSON escaping not supported </title>
		<body>The issue linked with [https://github.com/orientechnologies/orientdb/issues/5911](url). The bug occurs in version 2.2.0-beta2.  IInsert query not parsed. insert into Book mark content {"data":"eLuLeqkmovJI1a7WR2OTvVAbLowD\/N4WEHJ6\/2UMmTQNeNSeSE87fZvMvfFStfLYpA0PFGmZ\/m+QmyJ4PPdVm63qoSAW+\/cY1DvmrJ2H4fYhkjasKzUmcOuxhiPUpzYfZXXfAGk0AgqX3fOZ8XkBeoe KyhFpJDojxcMtG9BO8WjGgpDizD0WgqkSY7hoQZ+PV2Vig7fDn3MnRDGZZLPyyWaSL3J+5DWPdALaQfN+eAhacvqJnnHDPf2yV5Xc8RpqXVUyEPGig60=","isRead":"N","id":"bcf92040-8813-488c-92a7-422cff70dafa"," isPrivate":"F","isShared":0} </body>
		<created>2016-05-01 07:20:53</created>
		<closed>2016-05-02 07:56:05</closed>
	</bug>
	<bug>
		<id>6064</id>
		<title>Cached sequences created with an increment value greater than 1 don't use increment value</title>
		<body>``` create sequence seqcache2 type cached increment 30 orientdb {db=MovieRatings}&gt; select sequence('SEQCache2').next()  +----+--------+ |#   |sequence| +----+--------+ |0   |1       | +----+--------+  1 item(s) found. Query executed in 0.01 sec(s). orientdb {db=MovieRatings}&gt; select sequence('SEQCache2').next()  +----+--------+ |#   |sequence| +----+--------+ |0   |2       | +----+--------+ ``` </body>
		<created>2016-04-28 14:39:37</created>
		<closed>2016-04-28 16:21:42</closed>
	</bug>
	<bug>
		<id>6062</id>
		<title>Size method doesn't work with intersect function.</title>
		<body>Hi,  I am using 2.1.16 orientdb version. There if I use intersect function  with size() to aggregate  it doesn't work. Even though intersect returns the data but intersect size always returns 0. It was working fine in orientdb version 2.0.14. Now we are trying to upgrade and facing this problem.  **example:** SELECT expand(r) FROM ( SELECT @rid as r, intersect($allowed, $direct).size() as intersect FROM Resource LET $allowed = ( traverse out('Belongs') FROM ( SELECT FROM Subject WHERE id='Joe' ) ), $direct = in("Can").asSet() WHERE (_domainId='fileName' and _appId='app1') OR (_domainId='fileName2' and _appId='app1') ) WHERE intersect &gt; 0;  Here even though intersect function returns records but size it always returning 0. </body>
		<created>2016-04-28 11:33:06</created>
		<closed>2016-05-02 07:09:01</closed>
	</bug>
	<bug>
		<id>6057</id>
		<title>corrupt edge data</title>
		<body>We are running orientdb version 2.1.5 community, ruby driver over HTTP, and appear to have some corrupt edge data in our database, concerning a "Follow" edge between "CpUser" vertices. `[user_ids]` here is a single-element array with one CpUser user_id value.  See the attached screenshot.  You'll notice a few oddities: - the first two queries that I believe _should_ report essentially the same results have a discrepancy - when I query the `out_Follow` values for the given vertex, one of the results has a value for the `out` field that does not match the vertex in question (rid `#11:81821`).  The corrupt data is preventing some queries from running correctly for this vertex (we get a `NullPointerException` message in the response body).  ![screen shot 2016-04-27 at 1 27 36 pm](https://cloud.githubusercontent.com/assets/816444/14866767/3aa80662-0c93-11e6-807b-d1d5c3303a2d.png) </body>
		<created>2016-04-27 20:16:00</created>
		<closed>2016-06-08 11:14:06</closed>
	</bug>
	<bug>
		<id>6054</id>
		<title>NPE in ORecordInteral Line 71 when deleting records in parallel</title>
		<body>When deleting the same list of records in parallel with two Threads a NullPointerException occurs in ORecordInternal Line 71. The null-reference actually is recognized in OTransactionOptimisticProxy, Line 115, but the exception is not thrown, only kept in memory for throwing it later. ![2016-04-27_12h41_29](https://cloud.githubusercontent.com/assets/8393975/14849909/f8b58efe-0c75-11e6-9761-24aeb7b27123.png) Then ORecordInternal#setVersion is called using the null-reference and the is running into the NPE.  `Caused by: java.lang.NullPointerException: null     at com.orientechnologies.orient.core.record.ORecordInternal.setVersion(ORecordInternal.java:71)     at com.orientechnologies.orient.server.tx.OTransactionOptimisticProxy.begin(OTransactionOptimisticProxy.java:115)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.begin(ODatabaseDocumentTx.java:1679)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.commit(ONetworkProtocolBinary.java:1216)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:403)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)`  I am using OrientDB v2.1.15 </body>
		<created>2016-04-27 10:48:52</created>
		<closed>2016-04-27 16:00:25</closed>
	</bug>
	<bug>
		<id>6050</id>
		<title>Case sensitivity of property names in query is compromised when the property has an index</title>
		<body>Hi, I faced this issue while executing a query. The case sensitivity of property name is compromised when there is an index for that property.  e.g.  Assume there is a property "rolename" in class Role.  `SELECT FROM ROLE WHERE ROLENAME='USER'`   and   `SELECT FROM ROLE WHERE rolename='USER'`  **works** when there is an **index** for ROLE.rolename.  But   `SELECT FROM ROLE WHERE ROLENAME='USER'`    **does not work** when there is **no index** for ROLE.rolename.  So the case sensitivity validation seems to be not working when there is an index for the property.  Please let me know if any more information is needed.  [Stack Overflow Discussion](http://stackoverflow.com/questions/36824800/orientdb-queries-syntax-uses-case-sensitivity-arbitarily) </body>
		<created>2016-04-27 07:03:59</created>
		<closed>2017-12-29 14:03:28</closed>
	</bug>
	<bug>
		<id>6049</id>
		<title>Error when concatenating a param and a string in a LIKE filter. v2.1.16</title>
		<body>#### This fails in v2.1.16:  `Select * From ACNodeAuthentication where acNodeID like ? + '%'`  It used to work in Orient DB 2.0.3 #### It works without the param:  `Select * From ACNodeAuthentication where acNodeID like '89837db0' + '%'`  It also works if I pass the % in the param value instead of concatenating in the query and it also works if I use a js function to concat: `where acNodeID like concatStr(?, '%')` #### The error:  ``` Encountered " "+" "+ "" at line 1, column 58. Was expecting one of:     &lt;EOF&gt;      &lt;AND&gt; ...     &lt;OR&gt; ...     &lt;ORDER&gt; ...     &lt;GROUP&gt; ... ... ``` </body>
		<created>2016-04-26 16:27:22</created>
		<closed>2016-04-27 10:44:29</closed>
	</bug>
	<bug>
		<id>6038</id>
		<title>Add "test" suffix to allow maven surefire to execute tests</title>
		<body>Some test classes lack the Test suffix on their name, as **OLocalHashTableWAL**. Maven surefire, which execute tests in the CI env, discovers tests to be executed using a pattern:  _By default, the Surefire Plugin will automatically include all test classes with the following wildcard patterns:  "**/Test*.java" - includes all of its subdirectories and all Java filenames that start with "Test". "**/_Test.java" - includes all of its subdirectories and all Java filenames that end with "Test". "__/_TestCase.java" - includes all of its subdirectories and all Java filenames that end with "TestCase". If the test classes do not follow any of these naming conventions, then configure Surefire Plugin and specify the tests you want to include._   Please fix tests that are not executed. </body>
		<created>2016-04-24 09:54:19</created>
		<closed>2016-06-06 14:49:25</closed>
	</bug>
	<bug>
		<id>6033</id>
		<title>Can't update embedded field when cluster is selected</title>
		<body>Orientdb: 2.1.15 Studio: Yes  Hi,  I have one base Class called `Node` and a cluster called `de_business`. Julia is in the correct cluster I checked it twice by:  ``` sql SELECT FROM cluster:[de_business] ```  Subscription is an embedded document.  This works:  ``` sql UPDATE Node SET Subscription = { "test": true } WHERE Email = "julia@local" ```  This fails:  ``` UPDATE CLUSTER:[de_business] SET Subscription = { "test": true } WHERE Email = "julia@local" ```  I get this exception in orientdb studio:  ``` com.orientechnologies.orient.core.exception.OValidationException: The field 'Node.Subscription' has been declared as EMBEDDED but an incompatible type is used. Value: {test=true} ``` </body>
		<created>2016-04-23 10:17:16</created>
		<closed>2016-04-26 10:07:07</closed>
	</bug>
	<bug>
		<id>6032</id>
		<title>Persistently locked vertex</title>
		<body>We have a few vertices that are in a persistently locked state, by which I mean whenever we try to add or remove and edge to/from them, we get a `com.orientechnologies.orient.server.distributed.task.ODistributedRecordLockedException` error.  Changing fields on the vertex works fine. Edges are not being added/removed to the vertex by any other process, as far as I can tell.  This has happened a few times now. The only way we've been able to fix it is to restart orientdb.  We are running one orientdb node in distributed mode. - ruby driver over HTTP - version 2.1.5 community  Thanks </body>
		<created>2016-04-22 16:31:24</created>
		<closed>2017-02-18 08:04:46</closed>
	</bug>
	<bug>
		<id>6006</id>
		<title>java.lang.ArithmeticException "/ by zero" when using PARALLEL keyword</title>
		<body>I get these errors sometimes for the query  ``` SQL Select from [some ids...] PARALLEL ```  But not always. Anyone else experiencing this issue? I'll see if I can provide better data to reproduce this error otherwise.   What I want to do is to speed up the query   ``` SQL Select slowFunction(@rid) from [some ids...] ```  by appending the PARALLEL keyword, thus running slowFunction() for every '@rid' in parallel. Does anyone know if this will actually work?  </body>
		<created>2016-04-20 12:04:42</created>
		<closed>2016-04-22 11:30:35</closed>
	</bug>
	<bug>
		<id>6000</id>
		<title>Http tests are not stable on users environment and on orientdb-develop-coverage build</title>
		<body>Several users including commercial customers reported that HTTP test are not stable. The same issue may be observed on our CI build http://helios.orientdb.com/job/orientdb-develop-coverage .  Would be cool fix the tests or issue inside production code. </body>
		<created>2016-04-19 13:36:00</created>
		<closed>2016-07-07 11:32:50</closed>
	</bug>
	<bug>
		<id>5998</id>
		<title>Exception on checkpoint listener of OLuceneIndexFactory in Distributed Mode</title>
		<body>``` Error while invoking full checkpoint listener of class OLuceneIndexFactory. com.orientechnologies.orient.core.exception.ODatabaseException: Database instance is not set in current thread. Assure to set it with: ODatabaseRecordThreadLocal.INSTANCE.set(db);         at com.orientechnologies.orient.core.db.ODatabaseRecordThreadLocal.get(ODatabaseRecordThreadLocal.java:51)         at com.orientechnologies.lucene.OLuceneIndexFactory.fullCheckpointMade(OLuceneIndexFactory.java:196)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.notifyFullCheckpointListeners(OAbstractPaginatedStorage.java:1678)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.makeFullCheckpoint(OAbstractPaginatedStorage.java:1635)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:1174)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.freeze(OAbstractPaginatedStorage.java:1333)         at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.backup(OLocalPaginatedStorage.java:147)         at com.orientechnologies.orient.server.distributed.ODistributedStorage.backup(ODistributedStorage.java:1553)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.backup(ODatabaseDocumentTx.java:2739)         at com.orientechnologies.orient.server.distributed.task.OSyncDatabaseTask$1.run(OSyncDatabaseTask.java:130)         at java.lang.Thread.run(Thread.java:745) ``` </body>
		<created>2016-04-18 22:13:28</created>
		<closed>2016-04-19 10:54:47</closed>
	</bug>
	<bug>
		<id>5997</id>
		<title>Random NullPointer on CI tests</title>
		<body>It happened once during general tests branch 2.1.x, at commit 6d44b06a5cdcac6eae6bac511b7d0ae40aa91851  Exception in thread "OrientDB ETL pipeline-2" java.lang.NullPointerException     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager$WaitingListNode.access$200(OAtomicOperationsManager.java:487)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.cutWaitingList(OAtomicOperationsManager.java:418)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.releaseAtomicOperations(OAtomicOperationsManager.java:206)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:1188)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared$1.call(OSchemaShared.java:1214)     at com.orientechnologies.orient.core.db.OScenarioThreadLocal.executeAsDistributed(OScenarioThreadLocal.java:71)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.saveInternal(OSchemaShared.java:1207)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.releaseSchemaWriteLock(OSchemaShared.java:634)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.releaseSchemaWriteLock(OClassImpl.java:1888)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.releaseSchemaWriteLock(OClassImpl.java:1883)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addCluster(OClassImpl.java:1095)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addClusters(OClassImpl.java:1063)     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.beginLoader(OOrientDBLoader.java:433)     at com.orientechnologies.orient.etl.OETLPipeline.begin(OETLPipeline.java:68)     at com.orientechnologies.orient.etl.OETLProcessor$2.run(OETLProcessor.java:349)     at java.lang.Thread.run(Thread.java:744) </body>
		<created>2016-04-18 13:28:48</created>
		<closed>2016-04-19 11:03:19</closed>
	</bug>
	<bug>
		<id>5993</id>
		<title>Case-sensitive commands in console</title>
		<body>OrientDB Enterprise 2.1.13.  ``` SELECT out.uid, in.uid from FOLLOWS where out.uid = 1 LIMIT 1  ----+------+----------+--------- #   |@CLASS|out       |in ----+------+----------+--------- 0   |null  |                 1|                 2 ----+------+----------+---------  SELECT out.uid, in.uid from FOLLOWS where out.uid = 1 Limit 100  ----+------+----------+---------- #   |@CLASS|out       |in ----+------+----------+---------- 0   |null  |                 1|                 2 ... 19  |null  |                 1|                 21 ----+------+----------+---------- LIMIT EXCEEDED: resultset contains more items not displayed (limit=20) ```  The same record limit also gives LIMIT -1 etc. As far as I understand, the LIMIT N (writing other than lowercase) gives correct results only in cases when N is in the interval (0, 20). Seems like the LIMIT statement is case-sensitive in console and binary protocol (with pyorient) because it works correctly only in lowercase.  So and quit/exit...  ``` orientdb {db=data}&gt; EXIT  !Unrecognized command: 'EXIT' orientdb {db=data}&gt; QUIT  !Unrecognized command: 'QUIT' orientdb {db=data}&gt; exit ```  May be I misunderstand something and some commands are made case-sensitive?.  Another thing with limit:  ``` orientdb {db=logistics}&gt; select from container LIMIT 0  Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #27: Invalid LIMIT value setted to ZERO. Use -1 to ignore the limit or use a positive number. Example: LIMIT 10 Command: SELECT FROM container LIMIT 0 -----------------------------------^ ```  What's the problem with selecting 0 records?.. PostgreSQL 9.4.5  ``` data=# select from container limit 0; -- (0 rows) ```  Why do I set as an example PostgreSQL? Because in my (and not only my) practice it is very stable, mature and its developer interface is VERY, VERY convenient. I wish that to OrientDB! Thanks. </body>
		<created>2016-04-15 18:34:54</created>
		<closed>2016-05-04 11:14:35</closed>
	</bug>
	<bug>
		<id>5991</id>
		<title>Absent values in automatic composite SB-Tree index</title>
		<body>I'm working with OrientDB Enterprise Server v2.1.13 and have faced some problems I can't find explanation and solution for yet.  It seems that automatic composite SB-Tree index works improperly and doesn't index new values (or I misunderstand something). A have the following edge classes:  ``` CREATE CLASS ACTION EXTENDS E CLUSTERS 0 ABSTRACT  CREATE PROPERTY ACTION.out LINK   ALTER PROPERTY ACTION.out MANDATORY true   ALTER PROPERTY ACTION.out NOTNULL true  CREATE PROPERTY ACTION.in LINK   ALTER PROPERTY ACTION.in MANDATORY true   ALTER PROPERTY ACTION.in NOTNULL true  CREATE PROPERTY ACTION.action STRING   ALTER PROPERTY ACTION.action MANDATORY true  CREATE PROPERTY ACTION.status STRING   ALTER PROPERTY ACTION.status DEFAULT 'NEW'  CREATE INDEX ACTION.out_action_in ON ACTION (out, action, in) UNIQUE  CREATE CLASS LINK EXTENDS ACTION CLUSTERS 8   ALTER CLASS LINK CLUSTERSELECTION balanced  CREATE INDEX LINK.out_action_in ON LINK (out, action, in) UNIQUE ```  Suppose we have some vertices - with RIDs #12:0 and #30:0. Then we do inserts:  `CREATE EDGE LINK FROM #12:0 TO #30:0 SET action = 'a';`  We can SELECT and see that it was inserted correctly into the database:  ``` orientdb {db=data}&gt; SELECT FROM LINK WHERE action = 'a';  ----+-----+------+------+-----+-----+------ #   |@RID |@CLASS|action|out  |in   |status ----+-----+------+------+-----+-----+------ 0   |#36:0|LINK  |a     |#12:0|#30:0|NEW    ----+-----+------+------+-----+-----+------ ```  Now let's create SB-Tree NOTUNIQUE index (the default):  `CREATE INDEX LINK.action_status ON LINK (action, status) NOTUNIQUE`  Now we CREATE a new record:  ``` orientdb {db=data}&gt; CREATE EDGE LINK FROM #12:0 TO #30:0 SET action = 'b'; orientdb {db=data}&gt; SELECT FROM LINK  ----+-----+------+------+-----+-----+------ #   |@RID |@CLASS|action|out  |in   |status ----+-----+------+------+-----+-----+------ 0   |#36:0|LINK  |a     |#12:0|#30:0|NEW    1   |#37:8|LINK  |b     |#12:0|#30:0|NEW    ----+-----+------+------+-----+-----+------ ```  Now we try to SELECT the 'a' and 'b' values:  ``` orientdb {db=data}&gt; SELECT FROM LINK WHERE action = 'a';   ----+-----+------+------+-----+-----+------ #   |@RID |@CLASS|action|out  |in   |status ----+-----+------+------+-----+-----+------ 0   |#36:0|LINK  |a     |#12:0|#30:0|NEW    ----+-----+------+------+-----+-----+------  1 item(s) found. Query executed in 0.001 sec(s).  orientdb {db=userdata}&gt; SELECT FROM LINK WHERE action = 'b';  0 item(s) found. Query executed in 0.001 sec(s). ```  EXPLAIN:  ``` Profiled command     '{fullySortedByIndex:false,compositeIndexUsed:1,involvedIndexes:[1],limit:-1,fetchingFromTargetElapsed:0,indexIsUsedInOrderBy:false,user:#5:0,elapsed:1.116033,resultType:collection,resultSize:0}' in 0,002000 sec(s): {"@type":"d","@version":0,"fullySortedByIndex":false,"compositeIndexUsed":1,"involvedIndexes":["LINK.action_status"],"limit":-1,"fetchingFromTargetElapsed":0,"indexIsUsedInOrderBy":false,"user":"#5:0","elapsed":1.116033,"resultType":"collection","resultSize":0,"@fieldTypes":"compositeIndexUsed=l,involvedIndexes=e,fetchingFromTargetElapsed=l,user=x,elapsed=f"}  ```  But -- if you SELECT it using IN() -- it's there (seems that the IN() operator doesn't use indexes anyway - another issue I've faced):  ``` orientdb {db=data}&gt; SELECT FROM LINK WHERE action in ['b'];  ----+-----+------+------+-----+-----+------ #   |@RID |@CLASS|action|out  |in   |status ----+-----+------+------+-----+-----+------ 0   |#37:7|LINK  |b     |#12:0|#30:0|NEW    ----+-----+------+------+-----+-----+------  1 item(s) found. Query executed in 0.002 sec(s). ```  EXPLAIN:  ``` Profiled command '{documentReads:1,current:#36:1,documentAnalyzedCompatibleClass:1,recordReads:1,limit:-1,fetchingFromTargetElapsed:0,evaluated:1,user:#5:0,elapsed:0.666479,resultType:collection,resultSize:1}' in 0,002000 sec(s): {"@type":"d","@version":0,"documentReads":1,"current":"#36:1","documentAnalyzedCompatibleClass":1,"recordReads":1,"limit":-1,"fetchingFromTargetElapsed":0,"evaluated":1,"user":"#5:0","elapsed":0.666479,"resultType":"collection","resultSize":1,"@fieldTypes":"documentReads=l,current=x,documentAnalyzedCompatibleClass=l,recordReads=l,fetchingFromTargetElapsed=l,evaluated=l,user=x,elapsed=f"} ```  Any suggestions on this? Thanks in advance. </body>
		<created>2016-04-15 18:00:13</created>
		<closed>2016-06-06 16:30:15</closed>
	</bug>
	<bug>
		<id>5990</id>
		<title>server.bat does not set ORIENTDB_HOME environment variable</title>
		<body>On a Windows 10 Pro 64 Bit machine, server.bat script does not set ORIENTDB_HOME variable. No difference whether the script was started with Administrator rights or not. Machine has latest Java SDK installed. </body>
		<created>2016-04-15 17:40:38</created>
		<closed>2016-04-25 09:08:34</closed>
	</bug>
	<bug>
		<id>5987</id>
		<title>ETL doesn't load documents on given cluster</title>
		<body>If a **cluster** is defined in ETL configuration, loader section, the cluster isn't created by the Loader. </body>
		<created>2016-04-15 13:31:25</created>
		<closed>2016-06-07 14:15:28</closed>
	</bug>
	<bug>
		<id>5976</id>
		<title>Error saving record - OSBTreeException: We reached max level of depth of SBTree but still found nothing, seems like tree is in corrupted state. You should rebuild index related to given query.</title>
		<body>We are running Orientdb 2.0.9 in embedded mode. We are running into the following exception when trying to insert db record. Not sure if  it is related, the setup for this issue is the same as another issue #5920 we reported. Both cases we had issue with inserting FilePerfData records, not of other types. Please see attached file for classes and indexes used. [info_class_index.txt](https://github.com/orientechnologies/orientdb/files/217658/info_class_index.txt)  Below is the stacktrace. Let me know if I can provide any information without providing customer DB?  Since we are running in embedded mode, do you suggest we rebuild the index as a workaround to this exception?  Thank you for your time!  -Bo  2016-04-13 16:36:00.837 [pool-7-thread-1]  com.orientechnologies.orient.core.index.OIndexException: Error during insertion of key in index         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:141) ~[OIndexMultiValues.class:2.0.9]         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:52) ~[OIndexMultiValues.class:2.0.9]         at com.orientechnologies.orient.core.tx.OTransactionNoTx.addIndexEntry(OTransactionNoTx.java:198) ~[OTransactionNoTx.class:2.0.9]         at com.orientechnologies.orient.core.index.OIndexTxAware.put(OIndexTxAware.java:97) ~[OIndexTxAware.class:2.0.9]         at com.orientechnologies.orient.core.index.OIndexTxAware.put(OIndexTxAware.java:41) ~[OIndexTxAware.class:2.0.9]         at com.orientechnologies.orient.core.index.OClassIndexManager.addIndexesEntries(OClassIndexManager.java:543) ~[OClassIndexManager.class:2.0.9]         at com.orientechnologies.orient.core.index.OClassIndexManager.onRecordAfterCreate(OClassIndexManager.java:310) ~[OClassIndexManager.class:2.0.9]         at com.orientechnologies.orient.core.hook.ODocumentHookAbstract.onTrigger(ODocumentHookAbstract.java:221) ~[ODocumentHookAbstract.class:2.0.9]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHooks(ODatabaseDocumentTx.java:980) ~[ODatabaseDocumentTx.class:2.0.9]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHookSuccess(ODatabaseDocumentTx.java:2798) ~[ODatabaseDocumentTx.class:2.0.9]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1769) ~[ODatabaseDocumentTx.class:2.0.9]         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:102) ~[OTransactionNoTx.class:2.0.9]         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2306) ~[ODatabaseDocumentTx.class:2.0.9]         at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:444) ~[OObjectDatabaseTx.class:2.0.9]         at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:379) ~[OObjectDatabaseTx.class:2.0.9]         at com.x.x.x.StatsDBObjectInstance.insertLogEvent(StatsDBObjectInstance.java:636) ~[StatsDBObjectInstance.class:3.1.4-172-g3b934cb]         at com.x.x.x.StatsDBService.gatherFilePerf(StatsDBService.java:636) ~[StatsDBService.class:3.1.4-172-g3b934cb]         at com.x.x.x.StatsDBService.gatherFilePerfStats(StatsDBService.java:778) ~[StatsDBService.class:3.1.4-172-g3b934cb]         at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source) ~[na:na]         at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[na:1.7.0_51]         at java.lang.reflect.Method.invoke(Unknown Source) ~[na:1.7.0_51]         at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:64) [ScheduledMethodRunnable.class:3.2.8.RELEASE]         at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:53) [DelegatingErrorHandlingRunnable.class:3.2.8.RELEASE]         at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) [na:1.7.0_51]         at java.util.concurrent.FutureTask.runAndReset(Unknown Source) [na:1.7.0_51]         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(Unknown Source) [na:1.7.0_51]         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(Unknown Source) [na:1.7.0_51]         at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) [na:1.7.0_51]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) [na:1.7.0_51]         at java.lang.Thread.run(Unknown Source) [na:1.7.0_51] Caused by: com.orientechnologies.orient.core.index.sbtree.local.OSBTreeException: We reached max level of depth of SBTree but still found nothing, seems like tree is in corrupted state. You should rebuild index related to given query.         at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.findBucket(OSBTree.java:1543) ~[OSBTree.class:2.0.9]         at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.get(OSBTree.java:193) ~[OSBTree.class:2.0.9]         at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.get(OSBTreeIndexEngine.java:225) ~[OSBTreeIndexEngine.class:2.0.9]         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:115) ~[OIndexMultiValues.class:2.0.9]         ... 29 common frames omitted </body>
		<created>2016-04-13 17:39:48</created>
		<closed>2016-05-03 20:03:00</closed>
	</bug>
	<bug>
		<id>5968</id>
		<title>Spring cannot create proxies for some OrientDb classes (see details below).</title>
		<body>I am using Spring to create a database connection bean by http request.  In order to do that, Spring creates a proxy on the bean (because I declared it with scope "request") but when the server started I got the below messages:  ``` 2016-04-10 02:33:22.688  INFO 14861 --- [           main] o.s.aop.framework.CglibAopProxy          : Unable to proxy method [public final com.tinkerpop.blueprints.impls.orient.OrientEdgeType com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getEdgeType(java.lang.String)] because it is final: All calls to this method via a proxy will NOT be routed to the target instance. 2016-04-10 02:33:22.689  INFO 14861 --- [           main] o.s.aop.framework.CglibAopProxy          : Unable to proxy method [public final com.tinkerpop.blueprints.impls.orient.OrientVertexType com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertexType(java.lang.String)] because it is final: All calls to this method via a proxy will NOT be routed to the target instance. 2016-04-10 02:33:22.689  INFO 14861 --- [           main] o.s.aop.framework.CglibAopProxy          : Unable to proxy method [public final void com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.dropVertexType(java.lang.String)] because it is final: All calls to this method via a proxy will NOT be routed to the target instance. 2016-04-10 02:33:22.689  INFO 14861 --- [           main] o.s.aop.framework.CglibAopProxy          : Unable to proxy method [public final void com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.dropEdgeType(java.lang.String)] because it is final: All calls to this method via a proxy will NOT be routed to the target instance.  ```  Is is possible to declare as NOT final the following methods?: - public final com.tinkerpop.blueprints.impls.orient.OrientEdgeType com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getEdgeType(java.lang.String) - public final com.tinkerpop.blueprints.impls.orient.OrientVertexType com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertexType(java.lang.String) - public final void com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.dropVertexType(java.lang.String) - public final void com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.dropEdgeType(java.lang.String) </body>
		<created>2016-04-11 18:40:18</created>
		<closed>2016-04-12 11:48:56</closed>
	</bug>
	<bug>
		<id>5962</id>
		<title>[ Regression on versions &gt;= 2.1.12 ] Regression or changed behaviour with stateless session based on the token.</title>
		<body>When i tried version 2.1.12 with a token based query i receive a NullPointerException from OrientDB:  ``` 2016-04-10 03:21:57:405 INFO  /127.0.0.1:50598 - Reading byte (1 byte)... [OChannelBinaryServer] 2016-04-10 03:21:57:405 INFO  /127.0.0.1:50598 - Read byte: 0 [OChannelBinaryServer] 2016-04-10 03:21:57:405 INFO  /127.0.0.1:50598 - Reading int (4 bytes)... [OChannelBinaryServer] 2016-04-10 03:21:57:405 INFO  /127.0.0.1:50598 - Read int: 9764864 [OChannelBinaryServer] 2016-04-10 03:21:57:405 INFO  /127.0.0.1:50598 - Closing socket... [OChannelBinaryServer]Error during sending an error to client java.lang.NullPointerException Error during sending an error to client java.lang.NullPointerException Exception in thread "OrientDB &lt;- BinaryClient (/127.0.0.1:50598)" java.lang.NullPointerException     at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinary.close(OChannelBinary.java:393)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.shutdown(OBinaryNetworkProtocolAbstract.java:114)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.shutdown(ONetworkProtocolBinary.java:149)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:85)  2016-04-10 03:21:57:438 INFO  {db=GratefulDeadConcerts} /127.0.0.1:50595 - Flush [OChannelBinaryServer] ```  I tried with version 2.1.15 also, same results. With preeceding versions all was fine.  This is the test that fails: https://github.com/mogui/pyorient/blob/master/tests/test_token_auth.py#L44  Please can you tell me if something is changed?  Let me know if you need more info. </body>
		<created>2016-04-10 02:49:36</created>
		<closed>2016-04-11 14:38:34</closed>
	</bug>
	<bug>
		<id>5960</id>
		<title>Unexpected behavior when SELECTing on a nonexistent field</title>
		<body>``` CREATE CLASS Entity &lt;... insert 100 Entity records ...&gt; SELECT nonexistent FROM Entity ```  Note that Entity does not have the field titled `nonexistent`. And yet, OrientDB says there is one record returned?!  ![screen shot 2016-04-08 at 2 20 28 pm](https://cloud.githubusercontent.com/assets/2348618/14393494/4a8cdf24-fd95-11e5-8023-c274788e6c19.png)  Before you say the above query is equivalent to running `SELECT null FROM Entity`, that query returns 100 results (or 20 due to the query limit in Studio).  This is on OrientDB 2.1.9. </body>
		<created>2016-04-08 18:24:41</created>
		<closed>2018-06-22 15:24:45</closed>
	</bug>
	<bug>
		<id>5951</id>
		<title>Orient 2.1.x clustering issue with replica node</title>
		<body>I have 2 nodes "master" and "slave" running Orient 2.1.15. "slave" node is set as replica. Both "autoDeploy" and "hotAlignment" are set to false. I copy the database on both nodes before starting them. I start "master" first and then the "slave".  When I perform updates in the "master" node, I see this error in "slave" node.  ``` java com.orientechnologies.orient.server.distributed.ODistributedException: Cannot execute write operation on node 'slave' because is non master     at com.orientechnologies.orient.server.distributed.ODistributedStorage.checkNodeIsMaster(ODistributedStorage.java:1617)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.updateRecord(ODistributedStorage.java:714)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1975)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:159)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2492)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:122)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759) ```  I have seen this work once, but now it is not working. When the node is set to "replica", cluster updates should work, but the direct update to "replica" is prevented, as expected. But, in this case, cluster updates don't go through. Not sure what I'm doing wrong here.  Here is the configs for both nodes: **default-distributed-db-config.json for "master" and "slave":**  ``` json {   "autoDeploy": false,   "hotAlignment": false,   "executionMode": "undefined",   "readQuorum": 1,   "writeQuorum": 2,   "failureAvailableNodesLessQuorum": false,   "readYourWrites": true,   "servers": {     "master": "master",     "slave": "replica"   },   "clusters": {     "internal": {     },     "index": {     },     "*": {       "servers": ["&lt;NEW_NODE&gt;"]     }   } } ```  **hazelcast.xml for "master" and "slave":**  ``` xml &lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;hazelcast     xsi:schemaLocation="http://www.hazelcast.com/schema/config hazelcast-config-3.0.xsd"     xmlns="http://www.hazelcast.com/schema/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;     &lt;group&gt;         &lt;name&gt;masterslave&lt;/name&gt;         &lt;password&gt;masterslave&lt;/password&gt;     &lt;/group&gt;     &lt;network&gt;         &lt;port auto-increment="true"&gt;2434&lt;/port&gt;         &lt;join&gt;             &lt;multicast enabled="false"&gt;                 &lt;multicast-group&gt;235.1.1.1&lt;/multicast-group&gt;                 &lt;multicast-port&gt;2434&lt;/multicast-port&gt;             &lt;/multicast&gt;             &lt;tcp-ip enabled="true"&gt;                 &lt;member&gt;192.168.161.41:2434&lt;/member&gt;                 &lt;member&gt;192.168.197.124:2434&lt;/member&gt;             &lt;/tcp-ip&gt;         &lt;/join&gt;     &lt;/network&gt;     &lt;executor-service&gt;         &lt;pool-size&gt;16&lt;/pool-size&gt;     &lt;/executor-service&gt; &lt;/hazelcast&gt; ```  **orientdb-server-config.xml for "master":**  ``` xml &lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt; &lt;orient-server&gt;     &lt;handlers&gt;         &lt;handler class="com.orientechnologies.orient.graph.handler.OGraphServerHandler"&gt;             &lt;parameters&gt;                 &lt;parameter value="true" name="enabled"/&gt;                 &lt;parameter value="50" name="graph.pool.max"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;handler class="com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter value="master" name="nodeName"/&gt;                 &lt;parameter value="true" name="enabled"/&gt;                 &lt;parameter value="conf/default-distributed-db-config.json" name="configuration.db.default"/&gt;                 &lt;parameter value="conf/hazelcast.xml" name="configuration.hazelcast"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OJMXPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter value="false" name="enabled"/&gt;                 &lt;parameter value="true" name="profilerManaged"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OAutomaticBackup"&gt;             &lt;parameters&gt;                 &lt;parameter value="false" name="enabled"/&gt;                 &lt;parameter value="4h" name="delay"/&gt;                 &lt;parameter value="23:00:00" name="firstTime"/&gt;                 &lt;parameter value="backup" name="target.directory"/&gt;                 &lt;parameter value="${DBNAME}-${DATE:yyyyMMddHHmmss}.zip" name="target.fileName"/&gt;                 &lt;parameter value="9" name="compressionLevel"/&gt;                 &lt;parameter value="1048576" name="bufferSize"/&gt;                 &lt;parameter value="" name="db.include"/&gt;                 &lt;parameter value="" name="db.exclude"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;handler class="com.orientechnologies.orient.server.handler.OServerSideScriptInterpreter"&gt;             &lt;parameters&gt;                 &lt;parameter value="true" name="enabled"/&gt;                 &lt;parameter value="SQL" name="allowedLanguages"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;handler class="com.orientechnologies.orient.server.token.OrientTokenHandler"&gt;             &lt;parameters&gt;                 &lt;parameter value="false" name="enabled"/&gt;                 &lt;parameter value="" name="oAuth2Key"/&gt;                 &lt;parameter value="60" name="sessionLength"/&gt;                 &lt;parameter value="HmacSHA256" name="encryptionAlgorithm"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;         &lt;handler class="com.orientechnologies.orient.server.plugin.livequery.OLiveQueryPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter value="false" name="enabled"/&gt;             &lt;/parameters&gt;         &lt;/handler&gt;     &lt;/handlers&gt;     &lt;network&gt;         &lt;sockets&gt;             &lt;socket implementation="com.orientechnologies.orient.server.network.OServerSSLSocketFactory" name="ssl"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.keyStore"/&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.trustStore"/&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;             &lt;socket implementation="com.orientechnologies.orient.server.network.OServerSSLSocketFactory" name="https"&gt;                 &lt;parameters&gt;                     &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.keyStore"/&gt;                     &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;                     &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.trustStore"/&gt;                     &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;                 &lt;/parameters&gt;             &lt;/socket&gt;         &lt;/sockets&gt;         &lt;protocols&gt;             &lt;protocol implementation="com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary" name="binary"/&gt;             &lt;protocol implementation="com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpDb" name="http"/&gt;         &lt;/protocols&gt;         &lt;listeners&gt;             &lt;listener protocol="binary" socket="default" port-range="2424-2430" ip-address="0.0.0.0"/&gt;             &lt;listener protocol="http" socket="default" port-range="2480-2490" ip-address="0.0.0.0"&gt;                 &lt;commands&gt;                     &lt;command implementation="com.orientechnologies.orient.server.network.protocol.http.command.get.OServerCommandGetStaticContent" pattern="GET|www GET|studio/ GET| GET|*.htm GET|*.html GET|*.xml GET|*.jpeg GET|*.jpg GET|*.png GET|*.gif GET|*.js GET|*.css GET|*.swf GET|*.ico GET|*.txt GET|*.otf GET|*.pjs GET|*.svg GET|*.json GET|*.woff GET|*.woff2 GET|*.ttf GET|*.svgz" stateful="false"&gt;                         &lt;parameters&gt;                             &lt;entry value="Cache-Control: no-cache, no-store, max-age=0, must-revalidate\r\nPragma: no-cache" name="http.cache:*.htm *.html"/&gt;                             &lt;entry value="Cache-Control: max-age=120" name="http.cache:default"/&gt;                         &lt;/parameters&gt;                     &lt;/command&gt;                     &lt;command implementation="com.orientechnologies.orient.graph.server.command.OServerCommandGetGephi" pattern="GET|gephi/*" stateful="false"/&gt;                 &lt;/commands&gt;                 &lt;parameters&gt;                     &lt;parameter value="utf-8" name="network.http.charset"/&gt;                     &lt;parameter value="true" name="network.http.jsonResponseError"/&gt;                 &lt;/parameters&gt;             &lt;/listener&gt;         &lt;/listeners&gt;     &lt;/network&gt;     &lt;storages/&gt;     &lt;users&gt;         &lt;user resources="*" password="password" name="root"/&gt;         &lt;user resources="connect,server.listDatabases,server.dblist" password="guest" name="guest"/&gt;         &lt;user resources="database.passthrough" password="password" name="replicator"/&gt;     &lt;/users&gt;     &lt;properties&gt;         &lt;entry value="1" name="db.pool.min"/&gt;         &lt;entry value="50" name="db.pool.max"/&gt;         &lt;entry value="true" name="profiler.enabled"/&gt;         &lt;entry value="info" name="log.console.level"/&gt;         &lt;entry value="fine" name="log.file.level"/&gt;     &lt;/properties&gt; &lt;/orient-server&gt; ```  **orientdb-server-config.xml for "slave", all same as "master" config except the nodeName:**  ``` xml &lt;parameter value="slave" name="nodeName"/&gt; ``` </body>
		<created>2016-04-07 14:24:06</created>
		<closed>2016-08-27 19:26:53</closed>
	</bug>
	<bug>
		<id>5950</id>
		<title>Update is not working with 2.1.15 </title>
		<body>Hi,  I was using version 2.1.8 and recently updated it to version 2.1.15 but the following query stopped working.  vehicle is a column of type "EMBEDDED" in user table. update user set user.vehicle[name='bmw'].color = 'red' where user.vehicle contains (name='bmw')  This query does not work with version 2.1.15  vehicle object is in the db in the following format. [{ name : 'bmw', color:'red' }, { name : 'audi' , color : 'blue' }]  Could somebody please guide me with this. What changes should i do to make this working with one single query.  Thanks, Pradnya </body>
		<created>2016-04-07 14:22:30</created>
		<closed>2016-12-28 12:16:49</closed>
	</bug>
	<bug>
		<id>5944</id>
		<title>delete binary records via sql problem in 2.1.15</title>
		<body>Dear @luigidellaquila  based on https://github.com/orientechnologies/orientdb/issues/5748 I'd tested it now in 2.1.15  when i was try to delete via delete from 15:0 command everything works well :+1:  but when i was trying to delete record from a select that contains a linked field that contains row id of my blobs , delete not working yet : `delete from (select Blob from FileItem)` also when i try to write another kind query does not working and returns error  `delete from cluster:BlobStorage where @rid in (select Blob from FileItem)` returns : `java.lang.ClassCastException: com.orientechnologies.orient.core.record.impl.ORecordBytes cannot be cast to com.orientechnologies.orient.core.record.impl.ODocument`  for clearing what was happened i tried to run `select @rid from cluster:BlobStorage` that returns nothing but when i run `select from cluster:BlobStorage` returns a binary record that have @ rid and @ version and a base64 encoded string field . i'm wondered now . is it a new bug ?  how can i delete binary record via a nested select where query ? please help me to write a true delete statement .  at the last : Actually i have an opinion for select from Binary Record in Select Command .  *it's better `select from blobstorage` returns record id and record bytes size for binary records . now `select from blobstorage` (binary records) returns nothing *  thnaks </body>
		<created>2016-04-06 13:10:44</created>
		<closed>2016-05-25 17:01:49</closed>
	</bug>
	<bug>
		<id>5938</id>
		<title>Index on edge link property causes exception in batch SQL</title>
		<body>If I have the following edge definition:  ``` sql create class rel extends E; create property rel.tx link V; create property rel.attr string; create index rel.tx on rel (tx) notunique; ```  And try to create an edge like so:  ``` sql let tx1 = create vertex V set tid=1; let bob = create vertex V set uid="bob"; let tom = create vertex V set uid="tom"; create edge rel from $bob to $tom set attr="knows",tx=$tx1; ```  The console fails with the exception:   ``` txt Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.create edge rel from $bob to $tom set attr="knows",tx=$tx1  Error: java.lang.ClassCastException: com.orientechnologies.orient.core.sql.filter.OSQLFilterItemVariable cannot be cast to com.orientechnologies.orient.core.db.record.OIdentifiable ```  Removing the `create index` command allows the batch SQL to succeed.  Version: OrientDB 2.1.13  [console_bug.txt](https://github.com/orientechnologies/orientdb/files/204768/console_bug.txt) </body>
		<created>2016-04-05 15:11:33</created>
		<closed>2016-06-08 08:33:22</closed>
	</bug>
	<bug>
		<id>5937</id>
		<title>vertex creation fails silently if field value is not quoted properly</title>
		<body>OrientDB 2.2.0-SNAPSHOT develop@r76eb89664869753ee518b741fd2009d2255877c8  i made a typo while trying to create a vertex using console. the field "id" value quote is not closed. the command silently completes without throwing any error but no record is created:  ``` sql orientdb {db=testdb}&gt; create vertex c1 set id="13  orientdb {db=testdb}&gt; select from c1   0 item(s) found. Query executed in 0.003 sec(s). orientdb {db=testdb}&gt; desc c1  CLASS 'C1'  Records..............: 0 Super classes........: [V] Default cluster......: c1 (id=17) Supported clusters...: c1(17), c1_1(18), c1_2(19), c1_3(20) Cluster selection....: round-robin Oversize.............: 0.0  ``` </body>
		<created>2016-04-05 09:50:44</created>
		<closed>2016-04-06 12:47:34</closed>
	</bug>
	<bug>
		<id>5934</id>
		<title>OrientJS: Create Binary record fails for 2MB Size in  2.1.14</title>
		<body>Hi  I have serious problem with binary records in 2.1.14 now .  when i create binary record with 2MB size , the orientdb server crashed and logging this output to shell :  &gt;  2016-04-05 13:37:51:996 INFO  {db=Dingo_Core_DB} Looking for last checkpoint... [OLocalPaginatedStorage] &gt; 2016-04-05 13:37:52:106 INFO  {db=Dingo_Core_DB} Found FUZZY checkpoint. [OLocalPaginatedStorage] &gt; 2016-04-05 13:37:52:108 INFO  {db=Dingo_Core_DB} Data restore procedure from FUZZY checkpoint is started. [OLocalPaginatedStorage] &gt; 2016-04-05 13:37:52:112 WARNI {db=Dingo_Core_DB} Record OFuzzyCheckpointStartRecord{lsn=OLogSequenceNumber{segment=0, position=19276756}} com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointStartRecord{lsn=null, previousCheckpoint=OLogSequenceNumber{segment=0, position=19193491}} will be skipped during data restore. [OLocalPaginatedStorage] &gt; 2016-04-05 13:37:52:113 WARNI {db=Dingo_Core_DB} Record com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OFuzzyCheckpointEndRecord{lsn=OLogSequenceNumber{segment=0, position=19276796}} will be skipped during data restore. [OLocalPaginatedStorage] &gt; 2016-04-05 13:37:52:114 INFO  {db=Dingo_Core_DB} Storage data recover was completed [OLocalPaginatedStorage]java.lang.OutOfMemoryError: GC overhead limit exceeded &gt; Dumping heap to java_pid13688.hprof ... &gt; Heap dump file created [606260451 bytes in 7.422 secs]  When i test this database with 2.1.13 there is no problem and every file or binary record can be created, but in 2.1.14 i got this error .  Is this a bug ? is there any trick to solve or patch this problem ? </body>
		<created>2016-04-05 09:20:17</created>
		<closed>2016-06-09 16:38:23</closed>
	</bug>
	<bug>
		<id>5933</id>
		<title>Teleporter fail to try (4/4) OrientDB importing:             0% [                    ]  </title>
		<body>OrientDB                    ---   ___  **/**  ____/__  /___  ____/__  __ _  __ __  **\**  **/**  ____/__  _ _ \    __  /  __  **/  __  / __  __/  __  /_/ /  / / /_  /_/ /_  /  __  __/  __  /_/ /  _  /   _  /_**  _  /___  /___  _  ____// /_/ /_  _, _/_  /   _  /___  _  _, _/   /_/    /_____/  /_____/_____/  /_/     ____/ /_/ |_| /_/    /_____/  /_/ |_|    ```                                               http://orientdb.com/teleporter ```  (1/4) Source DB Schema building:    100% [....................]  Elapsed: 00:00:48  Remaining: 00:00:00  Warnings: 5 (2/4) Graph Model building:         100% [....................]  Elapsed: 00:00:00  Remaining: 00:00:00  Warnings: 5 (3/4) OrientDB Schema writing:      100% [....................]  Elapsed: 00:30:02  Remaining: 00:00:00  Warnings: 13  ERROR: org.postgresql.util.PSQLException - El intento de conexin fall.  ERROR:  org.postgresql.util.PSQLException: El intento de conexin fall.     at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:249)     at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:66)     at org.postgresql.jdbc2.AbstractJdbc2Connection.&lt;init&gt;(AbstractJdbc2Connection.java:127)     at org.postgresql.jdbc3.AbstractJdbc3Connection.&lt;init&gt;(AbstractJdbc3Connection.java:29)     at org.postgresql.jdbc3g.AbstractJdbc3gConnection.&lt;init&gt;(AbstractJdbc3gConnection.java:21)     at org.postgresql.jdbc4.AbstractJdbc4Connection.&lt;init&gt;(AbstractJdbc4Connection.java:41)     at org.postgresql.jdbc4.Jdbc4Connection.&lt;init&gt;(Jdbc4Connection.java:24)     at org.postgresql.Driver.makeConnection(Driver.java:414)     at org.postgresql.Driver.connect(Driver.java:282)     at java.sql.DriverManager.getConnection(DriverManager.java:664)     at java.sql.DriverManager.getConnection(DriverManager.java:247)     at com.orientdb.teleporter.persistence.util.ODBSourceConnection.getConnection(ODBSourceConnection.java:65)     at com.orientdb.teleporter.importengine.rdbms.ODBQueryEngine.getRecordsByEntity(ODBQueryEngine.java:136)     at com.orientdb.teleporter.strategy.rdbms.ODBMSNaiveAggregationStrategy.executeImport(ODBMSNaiveAggregationStrategy.java:164)     at com.orientdb.teleporter.strategy.rdbms.ODBMSImportStrategy.executeStrategy(ODBMSImportStrategy.java:86)     at com.orientdb.teleporter.main.OTeleporter.execute(OTeleporter.java:258)     at com.orientdb.teleporter.main.OTeleporter.main(OTeleporter.java:193) Caused by: java.net.SocketException: Socket closed     at java.net.PlainSocketImpl.socketConnect(Native Method)     at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)     at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)     at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)     at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)     at java.net.Socket.connect(Socket.java:589)     at org.postgresql.core.PGStream.&lt;init&gt;(PGStream.java:61)     at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:121)     ... 16 more  ERROR: com.orientdb.teleporter.exception.OTeleporterRuntimeException - org.postgresql.util.PSQLException: El intento de conexin fall.  ERROR: java.lang.NullPointerException (4/4) OrientDB importing:             0% [                    ]  Elapsed: 00:00:00  Remaining: 00:00:00  Warnings: 13  Records: 0/470947  Importing complete in 00:31:01  SUMMARY  Source DB Schema Entities: 845 Relationships: 3218  OrientDB Schema Vertex Type: 748 Edge Type: 807 Indexes: 748  OrientDB Importing Analyzed Records: 0/470947 Added Vertices on OrientDB: 0 Updated Vertices on OrientDB: 0 Added Edges on OrientDB: 0  Warning Messages: The table 'c_hr_payselection_check_v' has not primary key constraints defined in the db schema, thus the correspondent Class Vertex in Orient will not have a default index on the property deriving from the original primary key. The original type 'timestamptz' is not convertible into any OrientDB type thus, in order to prevent data loss, it will be converted to the OrientDB Type String. It's not declared a primary key for the Entity t_reconciliation, this might lead to issues during the migration or the sync executions (the first importing is quite safe). The table 'fact_acct_summary' has not primary key constraints defined in the db schema, thus the correspondent Class Vertex in Orient will not have a default index on the property deriving from the original primary key. It's not declared a primary key for the Entity a_fundingmode_acct, this might lead to issues during the migration or the sync executions (the first importing is quite safe). The table 't_alter_column' has not primary key constraints defined in the db schema, thus the correspondent Class Vertex in Orient will not have a default index on the property deriving from the original primary key. The original type 'bpchar' is not convertible into any OrientDB type thus, in order to prevent data loss, it will be converted to the OrientDB Type String. It's not declared a primary key for the Entity fact_acct_summary, this might lead to issues during the migration or the sync executions (the first importing is quite safe). It's not declared a primary key for the Entity t_alter_column, this might lead to issues during the migration or the sync executions (the first importing is quite safe). The table 't_reconciliation' has not primary key constraints defined in the db schema, thus the correspondent Class Vertex in Orient will not have a default index on the property deriving from the original primary key. The original type 'name' is not convertible into any OrientDB type thus, in order to prevent data loss, it will be converted to the OrientDB Type String. It's not declared a primary key for the Entity c_hr_payselection_check_v, this might lead to issues during the migration or the sync executions (the first importing is quite safe). The table 'a_fundingmode_acct' has not primary key constraints defined in the db schema, thus the correspondent Class Vertex in Orient will not have a default index on the property deriving from the original primary key. </body>
		<created>2016-04-05 06:01:39</created>
		<closed>2016-04-15 09:03:19</closed>
	</bug>
	<bug>
		<id>5927</id>
		<title>Create class in distributed immediately after creating db</title>
		<body>How to reproduce: - Start two instances in distributed mode - create database from Studio - ensure that the db was replicated - create a class from Studio (SQL)  [edit, wrong stacktrace]  ``` 2016-04-04 11:46:56:452 SEVER Internal server error: com.orientechnologies.orient.server.distributed.ODistributedException: Error on executing distributed request (id=129 from=node1 task=command_sql(create class bazz) user=#5:0) against database 'bla.[]' to nodes [node1, node2] --&gt; com.orientechnologies.orient.server.distributed.ODistributedException: Quorum 2 not reached for request (id=129 from=node1 task=command_sql(create class bazz) user=#5:0). Elapsed=26ms Servers in timeout/conflict are:  - node2: 11 ``` </body>
		<created>2016-04-04 09:49:01</created>
		<closed>2016-04-23 16:15:12</closed>
	</bug>
	<bug>
		<id>5925</id>
		<title>Big disk fragmentation after data load</title>
		<body>After initial load of database, fragmentation of my disk was increased from 0 to 30% . We need to find reason of such big fragmentation and fix it. Otherwise it will cause noticeable degradation of full scan SQL queries. </body>
		<created>2016-04-04 09:15:25</created>
		<closed>2019-10-17 07:06:01</closed>
	</bug>
	<bug>
		<id>5922</id>
		<title>JDBC contract not supported</title>
		<body>The issue linked with https://github.com/orientechnologies/orientdb/issues/5820 . Orient JDBC driver MUST throw SQLException not OCommandExecutionException. See javadoc for java.sql.Statement </body>
		<created>2016-04-03 13:44:50</created>
		<closed>2016-04-14 15:28:01</closed>
	</bug>
	<bug>
		<id>5920</id>
		<title>Error on saving record in cluster caused by NPE</title>
		<body>We used orientdb 2.0.9 in embedded mode.  The DB runs into the following exception once a while and subsequent saves trigger the same error. Is this a known issue? Any fix or workaround is greatly appreciated. Thanks for your time!  com.orientechnologies.orient.core.exception.ODatabaseException: Error on saving record in cluster #11        at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1787)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:102)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2306)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:118)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1711)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1702)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:75)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:674)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:688)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeLinkCollection(ORecordSerializerBinaryV0.java:703)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:569)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:261)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:104)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2070)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:691)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1687)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:102)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2306)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:118)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1711)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1702)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:75)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:674)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:688)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeLinkCollection(ORecordSerializerBinaryV0.java:703)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:569)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:261)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:104)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2070)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:691)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1687)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:102)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2306)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:118)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1711)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1702)         at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:75)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:674)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:688)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:572)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:261)         at com.orientechnologies.orient.core.serialization.serializer.record.bin             ary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:104)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2070)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:691)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1687)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:102)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2306)         at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:444)         at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:379)         ... Caused by: java.lang.NullPointerException </body>
		<created>2016-04-03 00:09:41</created>
		<closed>2016-04-29 10:03:27</closed>
	</bug>
	<bug>
		<id>5912</id>
		<title>ClassCastException in OEmbeddedRidBag#next()</title>
		<body>Using orient-2.1.13 I am getting a ClassCastException when trying to delete a Vertex in Line 90 in OEmbeddedRidBag: `java.lang.ClassCastException: com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag$Tombstone cannot be cast to com.orientechnologies.orient.core.db.record.OIdentifiable     at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag$EntriesIterator.next(OEmbeddedRidBag.java:90)     at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag$EntriesIterator.next(OEmbeddedRidBag.java:66)     at com.orientechnologies.orient.core.iterator.OLazyWrapperIterator.hasNext(OLazyWrapperIterator.java:93)     at com.orientechnologies.common.collection.OMultiCollectionIterator.hasNext(OMultiCollectionIterator.java:82)     at com.befinesolutions.gem.orientdb.AdjacentOperationHandler.handle(AdjacentOperationHandler.java:44)     at com.befinesolutions.gem.orientdb.BaseOrientRepositoryImpl.delete(BaseOrientRepositoryImpl.java:408)     at com.befinesolutions.gem.orientdb.BaseOrientRepositoryImpl.deleteAdjacent(BaseOrientRepositoryImpl.java:425)     at com.befinesolutions.gem.orientdb.DeleteAdjacentOperationHandler.onAdjacentFound(DeleteAdjacentOperationHandler.java:29)     at com.befinesolutions.gem.orientdb.AdjacentOperationHandler.handle(AdjacentOperationHandler.java:49)     at com.befinesolutions.gem.orientdb.BaseOrientRepositoryImpl.delete(BaseOrientRepositoryImpl.java:408)     at com.befinesolutions.gem.orientdb.BaseOrientRepositoryImpl.delete(BaseOrientRepositoryImpl.java:371)     at com.befinesolutions.cryptshare.server.task.CleanupTask$1.perform(CleanupTask.java:302)     at com.befinesolutions.cryptshare.server.task.CleanupTask$1.perform(CleanupTask.java:1)     at com.befinesolutions.cryptshare.server.data.apl.repositories.OrientRepositoryImpl.performOnEach(OrientRepositoryImpl.java:133)     at com.befinesolutions.cryptshare.server.data.apl.repositories.OrientRepositoryImpl.performOnEach(OrientRepositoryImpl.java:113)     at com.befinesolutions.cryptshare.server.data.apl.repositories.TransferRepositoryImpl.loadLogRetentionExpired(TransferRepositoryImpl.java:76)     at com.befinesolutions.cryptshare.server.task.CleanupTask.archiveTransfers(CleanupTask.java:283)     at com.befinesolutions.cryptshare.server.task.CleanupTask.doRun(CleanupTask.java:173)     at com.befinesolutions.cryptshare.server.task.ServiceTask.start(ServiceTask.java:64)     at com.befinesolutions.cryptshare.server.task.SuspendableTask.start(SuspendableTask.java:42)     at com.befinesolutions.cryptshare.server.task.ServiceTask.run(ServiceTask.java:50)     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)     at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)     at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)     at java.lang.Thread.run(Thread.java:745) ` Debugging shows that the entries-array is filled with 'TombStone'-enums: ![2016-03-31_13h58_08](https://cloud.githubusercontent.com/assets/8393975/14175161/8976dc5a-f749-11e5-8aa2-1f53ba0888df.png) </body>
		<created>2016-03-31 12:05:20</created>
		<closed>2016-04-05 08:30:30</closed>
	</bug>
	<bug>
		<id>5911</id>
		<title>JSON escaping not supported</title>
		<body>I try to execute query: insert into Bookmark content {"isRead":"N","id":"06e3801f-7a75-4224-b3c1-5aab2357f654","isPrivate":"F","isShared":0,"url":"http:\/\/www.hibernate.org\/"}  The parameter "url" is escaped by standartd JSON way. (http://i.stack.imgur.com/CQk5q.gif).  but OrientDB throw exception:     &lt;error message="Lexical error at line 1, column 130.  Encountered: &amp;quot;/&amp;quot; (47), after : &amp;quot;\&amp;quot;http:\\&amp;quot;" type="com.orientechnologies.orient.core.sql.parser TokenMgrError"&gt;com.orientechnologies.orient.core.sql.parser.TokenMgrError: Lexical error at line 1, column 130.  Encountered: "/" (47), after : "\"http:\"        at com.orientechnologies.orient.core.sql.parser.OrientSqlTokenManager.getNextToken(OrientSqlTokenManager.java:5640)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_scan_token(OrientSql.java:24806)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_296(OrientSql.java:22868)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_106(OrientSql.java:22885)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_707(OrientSql.java:24082)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_611(OrientSql.java:24170)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_152(OrientSql.java:24184)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_291(OrientSql.java:24251)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3R_100(OrientSql.java:24438)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_3_49(OrientSql.java:24468)        at com.orientechnologies.orient.core.sql.parser.OrientSql.jj_2_49(OrientSql.java:16835)        at com.orientechnologies.orient.core.sql.parser.OrientSql.InsertStatement(OrientSql.java:3751)        at com.orientechnologies.orient.core.sql.parser.OrientSql.StatementInternal(OrientSql.java:685)        at com.orientechnologies.orient.core.sql.parser.OrientSql.Statement(OrientSql.java:570)        at com.orientechnologies.orient.core.sql.parser.OrientSql.parse(OrientSql.java:79)  Version of orientdb is 2.2.0-beta </body>
		<created>2016-03-31 10:25:50</created>
		<closed>2016-04-04 13:38:14</closed>
	</bug>
	<bug>
		<id>5910</id>
		<title>Problems with backups because of LuceneIndexes lock</title>
		<body>I'm not able to run a backup because of lucene index files  D:\orientdb-enterprise-2.1.11\databases\sftech\luceneIndexes\Ambito.ambito\write.lock  `- Compressing file luceneIndexes\Ambito.ambito\write.lock... [OAutomaticBackup$1$2] 2016-03-31 07:00:02:300 INFO  {db=sftech} error: java.io.IOException: El proceso no tiene acceso al archivo porque otro proceso tiene bloqueada una parte del archivo [OAutomaticBackup$1$2]{db=sftech} Cannot compress file: D:\orientdb-enterprise-2.1.11\databases\sftech\luceneIndexes\Ambito.ambito\write.lock java.io.IOException: El proceso no tiene acceso al archivo porque otro proceso tiene bloqueada una parte del archivo     at java.io.FileInputStream.readBytes(Native Method)     at java.io.FileInputStream.read(FileInputStream.java:272)     at com.orientechnologies.common.io.OIOUtils.copyStream(OIOUtils.java:170)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFile(OZIPCompressionUtil.java:186)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:141)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.compressDirectory(OZIPCompressionUtil.java:57)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.backup(OLocalPaginatedStorage.java:158)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.backup(ODatabaseDocumentTx.java:2816)     at com.orientechnologies.orient.server.handler.OAutomaticBackup$1.run(OAutomaticBackup.java:161)     at java.util.TimerThread.mainLoop(Timer.java:555)     at java.util.TimerThread.run(Timer.java:505) {db=sftech} [OAutomaticBackup] - Error on exporting database 'plocal:D:/orientdb-enterprise-2.1.11/databases/sftech' to file: backup/sftech-20160331070000.zip java.io.IOException: El proceso no tiene acceso al archivo porque otro proceso tiene bloqueada una parte del archivo     at java.io.FileInputStream.readBytes(Native Method)     at java.io.FileInputStream.read(FileInputStream.java:272)     at com.orientechnologies.common.io.OIOUtils.copyStream(OIOUtils.java:170)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFile(OZIPCompressionUtil.java:186)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:141)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.addFolder(OZIPCompressionUtil.java:127)     at com.orientechnologies.orient.core.compression.impl.OZIPCompressionUtil.compressDirectory(OZIPCompressionUtil.java:57)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OLocalPaginatedStorage.backup(OLocalPaginatedStorage.java:158)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.backup(ODatabaseDocumentTx.java:2816)     at com.orientechnologies.orient.server.handler.OAutomaticBackup$1.run(OAutomaticBackup.java:161)     at java.util.TimerThread.mainLoop(Timer.java:555)     at java.util.TimerThread.run(Timer.java:505)  2016-03-31 07:00:02:315 INFO  [OAutomaticBackup] Backup finished: 0 ok, 1 errors [OAutomaticBackup$1]`  How can I solve this?  Thank you in advance </body>
		<created>2016-03-31 07:11:59</created>
		<closed>2016-05-26 10:13:35</closed>
	</bug>
	<bug>
		<id>5908</id>
		<title>NPE in OAtomicOperation.startAtomicOperation</title>
		<body>orientdb 2.1.11  NPE during OAtomicOperation.startAtomicOperation.  I don't have a reproducable for this as it happens after a few days.  Caused by: com.orientechnologies.orient.core.exception.ODatabaseException: Error on deleting record in cluster #63         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeDeleteRecord(ODatabaseDocumentTx.java:2098)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.deleteRecord(OTransactionNoTx.java:189)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.delete(ODatabaseDocumentTx.java:2563)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.delete(ODatabaseDocumentTx.java:121)         at com.orientechnologies.orient.core.record.ORecordAbstract.delete(ORecordAbstract.java:293)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelete.result(OCommandExecutorSQLDelete.java:295)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.pushResult(OCommandExecutorSQLResultsetAbstract.java:267)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.addResult(OCommandExecutorSQLSelect.java:668)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.handleResult(OCommandExecutorSQLSelect.java:578)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearchRecord(OCommandExecutorSQLSelect.java:538)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchFromTarget(OCommandExecutorSQLSelect.java:1432)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.fetchValuesFromIndexCursor(OCommandExecutorSQLSelect.java:2056)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchForIndexes(OCommandExecutorSQLSelect.java:1929)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.searchInClasses(OCommandExecutorSQLSelect.java:874)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLResultsetAbstract.assignTarget(OCommandExecutorSQLResultsetAbstract.java:199)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.assignTarget(OCommandExecutorSQLSelect.java:474)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.executeSearch(OCommandExecutorSQLSelect.java:456)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.execute(OCommandExecutorSQLSelect.java:427)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1538)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1519)         at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:72)         at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelete.execute(OCommandExecutorSQLDelete.java:178)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1538)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1519)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:63)         at com.orientechnologies.orient.object.db.OCommandSQLPojoWrapper.execute(OCommandSQLPojoWrapper.java:50)         at com.progress.isq.ipqos.activity.ActivityDataAccess.delete(ActivityDataAccess.java:364)         at com.progress.isq.ipqos.activity.ActivityService.delete(ActivityService.java:283)         at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.processAndCollectData(DatabaseActivityProcessor.java:768)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processData(MultiActivityServiceAdapter.java:257)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processResponse(MultiActivityServiceAdapter.java:219)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:201)         at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.processActivities(DatabaseActivityProcessor.java:431)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:181)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.fetchAndStoreActivities(MultiActivityServiceAdapter.java:111)         at com.progress.isq.ipqos.resources.plugins.openedge.work.WorkRunnable.performPolling(WorkRunnable.java:60)         ... 6 more Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:148)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doDeleteRecord(OAbstractPaginatedStorage.java:2077)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.deleteRecord(OAbstractPaginatedStorage.java:1025)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeDeleteRecord(ODatabaseDocumentTx.java:2067) </body>
		<created>2016-03-30 13:29:31</created>
		<closed>2016-04-25 17:27:34</closed>
	</bug>
	<bug>
		<id>5907</id>
		<title>NPE creating index entry</title>
		<body>orientdb 2.1.11  Unfortunately I don't have a reproducable for this.  It takes 2-3 days for it to occur and it is somewhat random, but it eventually always occurs.  I suspect there might be another exception underneath this (possibly an OOM), but since the releaseExclusiveLock() is in the finally block and it is throwing NPE, the original exception is lost.  Looking at OCacheEntry I don't see why the dataPointer would be going null between the call to acquireExclusiveLock and releaseExclusiveLock.    com.progress.isq.ipqos.WorkErrorException: Error during insertion of key in index         at com.progress.isq.ipqos.resources.plugins.openedge.work.WorkRunnable.performPolling(WorkRunnable.java:64)         at com.progress.isq.ipqos.resources.plugins.openedge.work.DatabaseInstWork.doWork(DatabaseInstWork.java:85)         at com.progress.isq.ipqos.resources.plugins.database.DatabaseInstResource.doWork(DatabaseInstResource.java:526)         at com.progress.isq.ipqos.ScheduledWorkShell.run(ScheduledWorkShell.java:86)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)         at java.lang.Thread.run(Thread.java:744) Caused by: com.orientechnologies.orient.core.index.OIndexException: Error during insertion of key in index         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:162)         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:52)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.addIndexEntry(OTransactionNoTx.java:256)         at com.orientechnologies.orient.core.index.OIndexTxAware.put(OIndexTxAware.java:97)         at com.orientechnologies.orient.core.index.OIndexTxAware.put(OIndexTxAware.java:41)         at com.orientechnologies.orient.core.index.OClassIndexManager.addIndexEntry(OClassIndexManager.java:530)         at com.orientechnologies.orient.core.index.OClassIndexManager.addIndexesEntries(OClassIndexManager.java:517)         at com.orientechnologies.orient.core.index.OClassIndexManager.onRecordAfterCreate(OClassIndexManager.java:428)         at com.orientechnologies.orient.core.hook.ODocumentHookAbstract.onTrigger(ODocumentHookAbstract.java:229)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHooks(ODatabaseDocumentTx.java:1037)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHookSuccess(ODatabaseDocumentTx.java:3038)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1987)         at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:160)         at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2532)         at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:470)         at com.orientechnologies.orient.object.db.OObjectDatabaseTx.save(OObjectDatabaseTx.java:405)         at com.progress.isq.ipqos.activity.ActivityDataAccess.save(ActivityDataAccess.java:60)         at com.progress.isq.ipqos.activity.ActivityService.create(ActivityService.java:73)         at com.progress.isq.ipqos.activity.ActivityService.create(ActivityService.java:60)         at com.progress.isq.ipqos.activity.ServiceAdapter.storeActivities(ServiceAdapter.java:63)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processData(MultiActivityServiceAdapter.java:262)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processResponse(MultiActivityServiceAdapter.java:219)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:201)         at com.progress.isq.ipqos.resources.plugins.database.DatabaseActivityProcessor.processActivities(DatabaseActivityProcessor.java:431)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.processActivities(MultiActivityServiceAdapter.java:181)         at com.progress.isq.ipqos.activity.MultiActivityServiceAdapter.fetchAndStoreActivities(MultiActivityServiceAdapter.java:111)         at com.progress.isq.ipqos.resources.plugins.openedge.work.WorkRunnable.performPolling(WorkRunnable.java:60)         ... 6 more Caused by: java.lang.NullPointerException         at com.orientechnologies.orient.core.storage.cache.OCacheEntry.releaseExclusiveLock(OCacheEntry.java:81)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.commitChanges(OAtomicOperation.java:394)         at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:168)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitAtomicOperation(OAbstractPaginatedStorage.java:351)         at com.orientechnologies.orient.core.index.OIndexAbstract.commitStorageAtomicOperation(OIndexAbstract.java:928)         at com.orientechnologies.orient.core.index.OIndexMultiValues.put(OIndexMultiValues.java:157)         ... 32 more </body>
		<created>2016-03-30 13:10:03</created>
		<closed>2016-04-20 20:51:56</closed>
	</bug>
	<bug>
		<id>5901</id>
		<title>OrientDB 2.1.14-SNAPSHOT on Ubuntu: Failed Server KeepAlive and  NoKeepAliveTests</title>
		<body>`Ubuntu 14.04 LTS`  ``` Apache Maven 3.0.5 Maven home: /usr/share/maven Java version: 1.8.0_77, vendor: Oracle Corporation Java home: /usr/local/java/jdk1.8.0_77/jre Default locale: en_US, platform encoding: UTF-8 OS name: "linux", version: "3.13.0-24-generic", arch: "amd64", family: "unix" ```  ``` git clone https://github.com/orientechnologies/orientdb cd orientdb git checkout 2.1.x mvn -X clean install ```  `[INFO] Building OrientDB 2.1.14-SNAPSHOT` ...  ``` 2016-03-29 15:35:50:524 INFO  {db=httpdocument} Creating database memory:httpdocument [OServerCommandPostDatabase]Tests run: 47, Failures: 2, Errors: 0, Skipped: 0, Time elapsed: 17.464 sec &lt;&lt;&lt; FAILURE! - in TestSuite testConnectAutoDisconnectKeepAlive(com.orientechnologies.orient.server.network.http.HttpConnectionTest)  Time elapsed: 7.389 sec  &lt;&lt;&lt; FAILURE! java.lang.AssertionError: expected [200] but found [500]         at com.orientechnologies.orient.server.network.http.HttpConnectionTest.testConnectAutoDisconnect(HttpConnectionTest.java:83)         at com.orientechnologies.orient.server.network.http.HttpConnectionTest.testConnectAutoDisconnectKeepAlive(HttpConnectionTest.java:57)  testConnectAutoDisconnectNoKeepAlive(com.orientechnologies.orient.server.network.http.HttpConnectionTest)  Time elapsed: 5.894 sec  &lt;&lt;&lt; FAILURE! java.lang.AssertionError: expected [200] but found [500]         at com.orientechnologies.orient.server.network.http.HttpConnectionTest.testConnectAutoDisconnect(HttpConnectionTest.java:83)         at com.orientechnologies.orient.server.network.http.HttpConnectionTest.testConnectAutoDisconnectNoKeepAlive(HttpConnectionTest.java:63)  ```  Results :  ``` Failed tests:   HttpConnectionTest.testConnectAutoDisconnectKeepAlive:57-&gt;testConnectAutoDisconnect:83 expected [200] but found [500]   HttpConnectionTest.testConnectAutoDisconnectNoKeepAlive:63-&gt;testConnectAutoDisconnect:83 expected [200] but found [500] ```  `Tests run: 47, Failures: 2, Errors: 0, Skipped: 0`  ``` [INFO] ------------------------------------------------------------------------ [INFO] Reactor Summary: [INFO] [INFO] OrientDB .......................................... SUCCESS [1.245s] [INFO] OrientDB Test Commons ............................. SUCCESS [1.410s] [INFO] OrientDB Core ..................................... SUCCESS [1:39.684s] [INFO] OrientDB Enterprise ............................... SUCCESS [0.935s] [INFO] OrientDB Client ................................... SUCCESS [3.930s] [INFO] OrientDB Object ................................... SUCCESS [6.572s] [INFO] OrientDB Server ................................... FAILURE [27.643s] ```  It compiles ok without tests `mvn clean install -DskipTests`  I see that this goes on since 2.1.9 on Ubuntu https://github.com/orientechnologies/orientdb/issues/5615 but it has not been solved.  Is it safe to run the compiled bins in a production environment even without these tests being passed? </body>
		<created>2016-03-29 16:07:12</created>
		<closed>2017-08-05 09:21:18</closed>
	</bug>
	<bug>
		<id>5895</id>
		<title>case insensitive ISSUE</title>
		<body>Hi   I have two collections named book and user. User has field name which is case insensitive. Book has a linked class user. OrientDB version (2.1.10 and latest 2.1.13)  When I use  ``` sql SELECT * FROM user WHERE name LIKE "adam%" ```  I will get 1 record  ``` js { name: 'Adam Smith' } ```  When I try to find all book with query  ``` sql SELECT * FROM book WHERE user.name LIKE "adam%" ```  I will get 0 records.  But next query is working correctly  ``` sql SELECT * FROM book WHERE user.name LIKE "Adam%" ```  I will get 1 book.  I guess that orientdb has a bug because it will forget to use case insensitive search. </body>
		<created>2016-03-28 18:47:21</created>
		<closed>2016-04-05 13:11:01</closed>
	</bug>
	<bug>
		<id>5892</id>
		<title>Duplicate keys cause deadlock on unique indexes in case of distributed storage</title>
		<body>This could cause deadlocks even if threads are locking different resources. In the meanwhile I restored the original OLockManager in OIndexAbstract:  ``` java // protected final OLockManager&lt;Object&gt; keyLockManager = new OLockManager&lt;Object&gt;(true, -1, // OGlobalConfiguration.COMPONENTS_LOCK_CACHE.getValueAsInteger());  protected final ONewLockManager&lt;Object&gt; keyLockManager = new ONewLockManager&lt;Object&gt;(); ``` </body>
		<created>2016-03-28 01:25:29</created>
		<closed>2016-05-08 18:39:38</closed>
	</bug>
	<bug>
		<id>5889</id>
		<title>negative RecordID for version 2.1.12 (Urgent) </title>
		<body>I do have following error when try to insert data in batch.  Error: com.orientechnologies.orient.core.index.OIndexException: Error during insertion of key in index  Error: com.orientechnologies.orient.core.exception.ODatabaseException: RecordId cannot support negative cluster id. You've used: -4812  ---  ``` BEGIN  LET hotel = INSERT INTO hotel SET name = "Agriturismo Sur", category = "hotel", check_in = "2pm", check_out = "12pm", currency = "EUR", highest_rate = 80, lowest_rate = 70, rating = "0.0", source = 13870, website = "http://www.booking.com/hotel/it/agriturismo-suri.html", active = true, description = "This charming family-run farm-house, located in S.Andrea di Cassine, offers a welcoming hospitality in the quiet atmosphere of the vineyards of Barbera di Monferrato.", amenity = {"property":[],"room":[]}, policy = null, payment = null, creator = #16:5, price = 70, ctime = "2016-03-27T05:56:34+0000", mtime = "2016-03-27T05:56:34+0000"  LET place = INSERT INTO place cluster place_business SET city = "S.Andrea Di Cassine", state = null, country = "it", lat = "44.721930", lng = "8.501440", postal_code = "15016", address = "15016 S.Andrea Di Cassine, Italy", types = ["point_of_interest","accommodation","hotel"], creator = #16:5, address_components = [], photos = [], ctime = "2016-03-27T05:56:34+0000", mtime = "2016-03-27T05:56:34+0000", country_name = "Italy", locality = "S.Andrea Di Cassine, Italy"  LET list = CREATE EDGE list FROM #16:5 TO $hotel  LET locate = CREATE EDGE locate FROM $hotel TO $place  LET media_profile_0 = INSERT INTO media SET title = "", url = "http://aff.bstatic.com/images/hotel/max500/488/48855584.jpg", primary = true, config = "profile", channel = "hotel", type = "image", provider = "booking", creator = #16:5, size = 0, ctime = "2016-03-27T05:56:34+0000", mtime = "2016-03-27T05:56:34+0000"  LET upload_profile_0 = CREATE EDGE upload FROM $hotel TO $media_profile_0  LET media_thumbnail_0 = INSERT INTO media SET title = "", url = "http://aff.bstatic.com/images/hotel/max500/488/48855584.jpg", primary = false, config = "thumbnail", channel = "hotel", type = "image", provider = "booking", creator = #16:5, size = 0, ctime = "2016-03-27T05:56:34+0000", mtime = "2016-03-27T05:56:34+0000"  LET upload_thumbnail_0 = CREATE EDGE upload FROM $hotel TO $media_thumbnail_0 COMMIT RETURN $hotel  ``` </body>
		<created>2016-03-27 06:09:50</created>
		<closed>2016-06-22 17:34:28</closed>
	</bug>
	<bug>
		<id>5887</id>
		<title>SQL ALTER CLUSTER command doesn't manage backtik</title>
		<body>``` alter cluster `Client-Type` name `Client-Type_europe` ```  Creates a cluster with name `Client-Type_europe` on filesystem. </body>
		<created>2016-03-25 11:05:35</created>
		<closed>2016-03-25 11:58:30</closed>
	</bug>
	<bug>
		<id>5884</id>
		<title>[2.2 beta] out() and in() not working with Edge class hierarchy</title>
		<body>If you have a hierarchy of edge types and 2 vertices joined via the edge subclass then a select statement with out(super class) does not work.  This does however work in the 2.1 stream.  ie edge type of Sibling edge type of Brother with superclass as Sibling 2 vertices joined using Brother edge type select out('Brother') from Person will return results select out('Sibling') from Person returns nothing </body>
		<created>2016-03-24 15:31:32</created>
		<closed>2016-03-24 17:26:12</closed>
	</bug>
	<bug>
		<id>5876</id>
		<title>Unable to set timezone "Europe/Rome"</title>
		<body>I'm using OrientDB community edition 2.1.11 on a Ubuntu 14.04 server  From Studio I tried ALTER DATABASE TIMEZONE "Europe/Rome" and ALTER DATABASE TIMEZONE Europe/Rome but both these commands set the timezone to GMT.  I tried also ALTER DATABASE TIMEZONE GMT+1 and this works giving me GMT+1 (CET), but is not the same as "Europe/Rome" (CET/CEST). </body>
		<created>2016-03-23 17:12:28</created>
		<closed>2016-03-24 16:20:17</closed>
	</bug>
	<bug>
		<id>5875</id>
		<title>Threading deadlock with Edge unique indexes</title>
		<body>In 2.1.12, it is possible to create a thread deadlock when threads are inserting into an Edge class which has a property bound by a unique indexes.  Performance slows down and comes to a halt.  I will try to attach an example database later which can reproduce the issue.  Work-around for now is to simply remove the unique index. </body>
		<created>2016-03-23 13:30:54</created>
		<closed>2016-03-30 12:16:18</closed>
	</bug>
	<bug>
		<id>5870</id>
		<title>Issues with pivoting query on singleton Collections</title>
		<body>Hi, check the below example:  ``` SQL let v1 = create Vertex set label ="v1" let v2 = create Vertex set sameValue = true, diffValue = 0 let v3 = create Vertex set sameValue = true, diffValue = 1 create Edge E from $v1 To $v2 create Edge E from $v1 To $v3 let failed1 = select 'size() is not working after fetching the first object in a singleton collection.' as description, out('E')[diffValue=0][0].size() as size from $v1 let working1 = select 'size() works on a singleton collection.' as description, out('E')[diffValue=0].size() as size from $v1 let working2 = select 'size() works after fetching the first object in a non-singleton collection.' as description, out('E')[sameValue=true][0].size() as size from $v1 let working3 = select 'size() works after fetching the first object in a singleton collection which has been converted to a list.' as description, list(out('E')[diffValue=0])[0].size() as size from $v1  return [$failed1,$working1,$working2,$working3] ```  We expect size to be 1 in all queries, but as seen in the $failed1 there is a problem when there is just one object in the collection.   Though it seems to be a limited use case this becomes an issue when you don't know if there are multiple objects in the collection after pivoting or just one. The workaround is to always put the pivoted elements in a list, which I suppose will cause some overhead.   This issue occurred when we upgraded from orientdb 2.1.9 to 2.1.13. </body>
		<created>2016-03-22 11:16:24</created>
		<closed>2016-04-07 15:50:48</closed>
	</bug>
	<bug>
		<id>5865</id>
		<title>Allow to start manual transaction only if auto transactions are disabled in graph database</title>
		<body>If we run OrientGraph#begin method in many cases auto transaction is already started. As result during call of OrientGraph#commit method transaction is not committed and changes are not stored. </body>
		<created>2016-03-21 09:46:21</created>
		<closed>2016-03-24 10:33:34</closed>
	</bug>
	<bug>
		<id>5858</id>
		<title>Possible socket leak</title>
		<body>We saw the following issue on our standalone orientdb server which had been up and running for close to 1 day. OrientDB Server v2.1.13 (build 2.1.x@r9bc1a54a4a62c4de555fc5360357f446f8d2bc84; 2016-03-14 17:00:05+0000)  Reached maximum number of concurrent connections (max=1000, current=1001), reject incoming connection from /127.0.0.1:34796 [OServerNetworkListener]  Looking at the output of netstat -a we saw close to 500 connections stuck in CLOSED_WAIT on port 2424. The server was stuck in this state for a few hours, which means it wasn't a transient issue caused by too many requests at one time. In order to recover from the state we had to restart the orientdb server. </body>
		<created>2016-03-19 00:26:03</created>
		<closed>2016-05-09 12:04:12</closed>
	</bug>
	<bug>
		<id>5854</id>
		<title>skip not working when filtering edges by field</title>
		<body>We have found a pretty serious issue when querying edges filtered by properties:  `select expand(bothE('Knows)[name='john']) from V skip 2 limit 10`  This absolutely ignores the skip and always returns the same 10.   There is a solution which requires rewriting:  `select from (select expand(bothE('Knows')) from V) where name = 'john' skip 1 limit 10`  This seems to work fine, although is quite verbose. </body>
		<created>2016-03-17 19:19:22</created>
		<closed>2016-03-21 16:18:45</closed>
	</bug>
	<bug>
		<id>5853</id>
		<title>Database create does not successfully create a database on all nodes in a three node cluster.</title>
		<body>When creating a new database in a cluster that consists of three nodes, the database is successfully replicated to one of the 2 other nodes but not to the second. See attached what the web console displays for the node to which replication did not succeed. This is OrientDB version 2.1.12. ![schermafbeelding 2016-03-17 om 19 43 49](https://cloud.githubusercontent.com/assets/439695/13857632/028969b6-ec7b-11e5-9e66-5ae5e24ec3a5.png) </body>
		<created>2016-03-17 19:02:03</created>
		<closed>2016-05-08 18:03:16</closed>
	</bug>
	<bug>
		<id>5850</id>
		<title>Nullpointer exception when looping through vertices</title>
		<body>Hi,  Occasionally we get the following NullPointer exception when looping through the result of a vertex.getVertices(direction, edge label). It's pretty hard to reproduce and I can currently only fix it by restarting my application. I'm not really sure if it's related but until now I've only encountered this issue whilst working with a clustered orient setup (3 nodes).  ``` RuntimeException: Error while executing graph function. Cause: java.lang.NullPointerException, message: null, source: com.tinkerpop.blueprints.impls.orient.OrientVertexIterator.createGraphElement(OrientVertexIterator.java:68) com.tinkerpop.blueprints.impls.orient.OrientVertexIterator.createGraphElement(OrientVertexIterator.java:37) com.orientechnologies.orient.core.iterator.OLazyWrapperIterator.hasNext(OLazyWrapperIterator.java:93) com.orientechnologies.common.collection.OMultiCollectionIterator.getNextPartial(OMultiCollectionIterator.java:235) com.orientechnologies.common.collection.OMultiCollectionIterator.hasNext(OMultiCollectionIterator.java:73) com.tinkerpop.blueprints.util.wrappers.partition.PartitionVertexIterable$1.hasNext(PartitionVertexIterable.java:36) ```  Looking at the code it tries to retrieve the ummutableClass for the document which returns null:  ```    final OrientVertex v;     OImmutableClass immutableClass = ODocumentInternal.getImmutableSchemaClass(value);     if (immutableClass.isVertexType()) { // line 68: NullPointerException ```  I'm running orientdb 2.1.12. </body>
		<created>2016-03-17 15:52:17</created>
		<closed>2016-08-27 19:22:09</closed>
	</bug>
	<bug>
		<id>5844</id>
		<title>Record locking is broken in 2.2 version</title>
		<body>After implementation of scan of pages inside of storage record locking functionality is broken. In internal discussion we decided to introduce new keyword to lock records only if it is requested.  As @tglman correctly mentioned we already have lock record, so would be good to keep the same syntax add new keyword READ_LOCK RECORD.  I think to keep all project functionality working it should be done in 2.2 release. </body>
		<created>2016-03-17 11:30:11</created>
		<closed>2016-07-06 09:57:39</closed>
	</bug>
	<bug>
		<id>5841</id>
		<title>Read graph action throws com.orientechnologies.orient.core.exception.OStorageException: Error on executing command.</title>
		<body>This issues arrives when deploying orient in amazon instance and connecting it concurrently via api.. below is the stack trace contains variable information which is hard to derive what could be the actual root cause..but, on analyzing could guess it because of multiple retry happens for connection to database...  2016-03-07T16:37:20.772+0530 STDIO [ERROR] Mar 07, 2016 4:37:20 PM com.orientechnologies.common.log.OLogManager log SEVERE: Removing disconnected network channel 'ip:2424/database'... 2016-03-07T16:37:20.773+0530 STDIO [ERROR] Mar 07, 2016 4:37:20 PM com.orientechnologies.common.log.OLogManager log  also follows with   com.orientechnologies.orient.core.exception.OStorageException: Error on executing command: sql.SELECT EXPAND($c) LET $a = (SELECT FROM E), $b = (SELECT FROM V), $c = UNIONALL( $a, $b )  2016-03-07T16:37:20.782+0530 STDIO [ERROR] Caused by: java.lang.NullPointerException 2016-03-07T16:37:20.783+0530 STDIO [ERROR] at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryAsynchClient.setReadResponseTimeout(OChannelBinaryAsynchClient.java:415) 2016-03-07T16:37:20.783+0530 STDIO [ERROR] at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:216) 2016-03-07T16:37:20.783+0530 STDIO [ERROR] at com.orientechnologies.orient.enterprise.channel.binary.OChannelBinaryAsynchClient.beginResponse(OChannelBinaryAsynchClient.java:171) 2016-03-07T16:37:20.783+0530 STDIO [ERROR] at com.orientechnologies.orient.client.remote.OStorageRemote.beginResponse(OStorageRemote.java:1887) 2016-03-07T16:37:20.783+0530 STDIO [ERROR] at com.orientechnologies.orient.client.remote.OStorageRemote.command(OStorageRemote.java:986)  it links to same issue https://github.com/orientechnologies/orientdb/issues/4914 </body>
		<created>2016-03-17 07:22:25</created>
		<closed>2016-07-07 11:33:58</closed>
	</bug>
	<bug>
		<id>5839</id>
		<title>Commit for OrientDB 2.2 snapshot March10 not working for linklist</title>
		<body>I have a javascript function that creates a vertex and adds rids as a linklist for urls, phones, address, emailaddress. At the end of the function I execute gdb.commit() and call another function to query the newly created vertex and it returns the following result where the vertex rid that holds the linklist has the final rid but the linklist rids are either null or a temporary rid:  &lt;code&gt; [  ``` {     "@type": "d",     "@rid": "#-2:0",     "@version": 0,    **"rid": "#102:8",**     "birthday": "1985-01-01 00:00:00",     "firstName": "Camille",     "addressRID": [        ** null,         "#95:-29"**     ],     "gender": "F",     "prefix": "Ms.",     "phonesRID": [        ** null,         "#111:-42"**     ],     "emailAddressRID": [         **null,         "#104:-51"**     ],     "urlsRID": [        ** null,         "#118:-59"**     ],     "nickName": "Camille",     "company": "Test Co",     "category": "IT",     "@fieldTypes": "rid=x,birthday=t,addressRID=z,phonesRID=z,emailAddressRID=z,urlsRID=z" } ```  ] &lt;/code&gt;  When viewed in studio, after the function is executed, the vertex is created correctly and when I run the query function independently it returns the correct result with the final rids:  &lt;code&gt; [  ``` {     "@type": "d",     "@rid": "#-2:0",     "@version": 0,    **"rid": "#102:8",**     "birthday": "1985-01-01 00:00:00",     "firstName": "Camille",     "addressRID": [        ** "#95:16",         "#95:17"**     ],     "gender": "F",     "prefix": "Ms.",     "phonesRID": [        ** "#111:16",         "#111:17"**     ],     "emailAddressRID": [       **  "#104:16",         "#104:17"**     ],     "urlsRID": [        ** "#118:16",         "#118:17"**     ],     "nickName": "Camille",     "company": "Test Co",     "category": "IT",     "@fieldTypes": "rid=x,birthday=t,addressRID=z,phonesRID=z,emailAddressRID=z,urlsRID=z" } ```  ] &lt;/code&gt;  In the Orientdb 2.2 Alpha version, query after gdb.commit() returns the correct rids of the linklist. There were no changes in the functions from Orientdb 2.2 Alpha to functions I execute in Orientdb 2.2 snapshot March 10. </body>
		<created>2016-03-16 19:55:44</created>
		<closed>2016-05-26 20:52:19</closed>
	</bug>
	<bug>
		<id>5832</id>
		<title>Manual index entries not persisted through a server restart</title>
		<body>Create a manually created index: `CREATE INDEX md5 UNIQUE_HASH_INDEX;`  then manually population the index via inserts with keys and rids. Then querying the index  e.g.  `SELECT FROM INDEX:md5 WHERE key = '06700B2BD5AA941B9755B49C129BD66E'` returns the stored rid as expected, but if the server is restarted, nothing is returned. However  `SELECT COUNT(*) FROM INDEX:md5` will return the correct count for the previous inserts...  The type of index does not seem to matter.   </body>
		<created>2016-03-15 15:28:53</created>
		<closed>2016-03-16 09:34:51</closed>
	</bug>
	<bug>
		<id>5830</id>
		<title>Composite index issue</title>
		<body>using OrientDB 2.1.9  I have a record (E_Rel) with 3 fields : - SrcID (long) - RelID (long) - VTgtDef (EmbeddedList of Long)  and an index on record  CREATE INDEX RelTgtIDX ON E_Rel (SrcID , RelID , VTgtDef ) NOTUNIQUE  This query works as expected  : select  from index:RelTgtIDX where  Key  = [6,572]  The result is (from studio view)  OCompositeKey{keys=[6, 572, 472]} CompositeKey{keys=[6, 572, 472]} OCompositeKey{keys=[6, 572, 472]} OCompositeKey{keys=[6, 572, 472]} OCompositeKey{keys=[6, 572, 472]} OCompositeKey{keys=[6, 572, 472]} OCompositeKey{keys=[6, 572, 472]} OCompositeKey{keys=[6, 572, 472]}  but this one returns no results ! select  from index:RelTgtIDX where  Key  = [6,572,472]  Any idea ? </body>
		<created>2016-03-15 13:25:18</created>
		<closed>2016-03-17 15:29:01</closed>
	</bug>
	<bug>
		<id>5829</id>
		<title>Invalid JSON result on HTTP API request</title>
		<body>Hello,  When i send a REST request on an index containing multiple results, the json returned contains the list of expected vertices, but, the json is not valid. So, using a REST tool requester return me a parse error.  Example of request : http://orientb.mydomain.com/index/mydb/server.name/toto* JSON response format : [      {"key" : "value", ...}      {"key" : "value", ...}      {"key" : "value", ...} ]  as you can see, there is no comma separating the vertices.  Index is Fulltext / Lucene Orientdb version : 2.1.12  Thank you for your help. </body>
		<created>2016-03-15 10:17:38</created>
		<closed>2016-03-15 10:42:50</closed>
	</bug>
	<bug>
		<id>5828</id>
		<title>serious error for version 2.1.12 (urgent)</title>
		<body>{db=voyage} Error on creating record in cluster: plocal cluster: locate com.orientechnologies.orient.core.exception.OStorageException     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:434)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:1946)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:751)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1999)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2558)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.serialize(OEmbeddedRidBag.java:387)     at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.toStream(ORidBag.java:277)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:583)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1933)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2558)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:675)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:689)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:574)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1933)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2558)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.serialize(OEmbeddedRidBag.java:387)     at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.toStream(ORidBag.java:277)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:583)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:2426)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1189)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2679)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2648)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:284)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:157)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:102)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:91)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1530)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1511)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1323)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OStorageException: Error during creation of mapping between logical adn physical record position.     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.add(OClusterPositionMap.java:201)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:427)     ... 64 more Caused by: com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.ONestedRollbackException: Atomic operation was rolled back by internal component, exception which caused this rollback is : com.orientechnologies.orient.core.exception.OStorageException: File with name 'v.sbc' does not exist in storage 'voyage'     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.openFile(OWOWCache.java:327)     at com.orientechnologies.orient.core.storage.cache.local.O2QCache.openFile(O2QCache.java:190)     at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.openFile(OAtomicOperation.java:239)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.openFile(ODurableComponent.java:168)     at com.orientechnologies.orient.core.index.sbtreebonsai.local.OSBTreeBonsaiLocal.load(OSBTreeBonsaiLocal.java:443)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerShared.loadTree(OSBTreeCollectionManagerShared.java:111)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerAbstract.loadSBTree(OSBTreeCollectionManagerAbstract.java:98)     at com.orientechnologies.orient.core.db.record.ridbag.sbtree.OSBTreeCollectionManagerProxy.loadSBTree(OSBTreeCollectionManagerProxy.java:52)     at com.orientechnologies.orient.core.storage.impl.local.paginated.ORidBagUpdateSerializationOperation.loadTree(ORidBagUpdateSerializationOperation.java:76)     at com.orientechnologies.orient.core.storage.impl.local.paginated.ORidBagUpdateSerializationOperation.execute(ORidBagUpdateSerializationOperation.java:57)     at com.orientechnologies.orient.core.storage.impl.local.paginated.ORecordSerializationContext.executeOperations(ORecordSerializationContext.java:90)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doUpdateRecord(OAbstractPaginatedStorage.java:2026)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.updateRecord(OAbstractPaginatedStorage.java:932)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:2005)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2558)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:675)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:689)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:574)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:2426)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1189)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2679)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2648)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:284)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:157)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:102)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:91)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1530)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1511)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1323)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  ``` at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperationsManager.endAtomicOperation(OAtomicOperationsManager.java:161) at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.endAtomicOperation(ODurableComponent.java:107) at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.add(OClusterPositionMap.java:197) ... 65 more ``` </body>
		<created>2016-03-14 15:50:09</created>
		<closed>2016-04-04 07:27:50</closed>
	</bug>
	<bug>
		<id>5824</id>
		<title>[ OrientDB version 2.1.12 ] Compile failed</title>
		<body>OrientDB version 2.1.12 do not builds.  I tried with ubuntu and MacOsx El Capitan and got the following error:  ```     [javac] warning: [options] bootstrap class path not set in conjunction with -source 1.6     [javac] /var/www/PhpOrient/ci/environment/orientdb-2.1.12/core/src/test/java/com/orientechnologies/orient/core/record/impl/OJsonReadWriteTest.java:4: error: package org.junit does not exist     [javac] import org.junit.Test;     [javac]                 ^     [javac] /var/www/PhpOrient/ci/environment/orientdb-2.1.12/core/src/test/java/com/orientechnologies/orient/core/record/impl/OJsonReadWriteTest.java:13: error: cannot find symbol     [javac]   @Test     [javac]    ^     [javac]   symbol:   class Test     [javac]   location: class OJsonReadWriteTest     [javac] Note: Some input files use or override a deprecated API.     [javac] Note: Recompile with -Xlint:deprecation for details.     [javac] Note: Some input files use unchecked or unsafe operations.     [javac] Note: Recompile with -Xlint:unchecked for details.     [javac] 2 errors     [javac] 1 warning  BUILD FAILED /var/www/PhpOrient/ci/environment/orientdb-2.1.12/build.xml:133: The following error occurred while executing this line: /var/www/PhpOrient/ci/environment/orientdb-2.1.12/build.xml:21: The following error occurred while executing this line: /var/www/PhpOrient/ci/environment/orientdb-2.1.12/core/build.xml:51: Compile failed; see the compiler error output for details. ``` </body>
		<created>2016-03-13 23:42:25</created>
		<closed>2016-03-24 00:04:28</closed>
	</bug>
	<bug>
		<id>5821</id>
		<title>Server deadlock with multiple concurrent binary clients</title>
		<body>Using version 2.1.12, I have multiple concurrent threads, each using its own graph instance, reading, creating and updating records in the DB. After about 20.000 cycles, all clients hang. I debugged the server and noticed that_ all _binary clients threads (at the server) where stuck at:  ``` "OrientDB &lt;- BinaryClient (/10.1.100.22:61097)"     at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireWriteLock(OReadersWriterSpinLock.java:132)     at com.orientechnologies.common.concur.lock.OModificationLock.prohibitModifications(OModificationLock.java:96)     at com.orientechnologies.common.concur.lock.OModificationLock.prohibitModifications(OModificationLock.java:84)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.synch(OAbstractPaginatedStorage.java:1276)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkLowDiskSpaceAndFullCheckpointRequests(OAbstractPaginatedStorage.java:2894)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1150)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2679)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2648)     at com.tinkerpop.blueprints.impls.orient.OrientTransactionalGraph.commit(OrientTransactionalGraph.java:161)     at com.orientechnologies.orient.graph.sql.OGraphCommandExecutorSQLFactory.runInConfiguredTxMode(OGraphCommandExecutorSQLFactory.java:262)     at com.orientechnologies.orient.graph.sql.OCommandExecutorSQLCreateEdge.execute(OCommandExecutorSQLCreateEdge.java:153)     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1530)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1511)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1323)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77)  ```  I tried to reduce the transaction sizes to an absolute minimum without luck. In this situation I even cannot shutdown the server cleanly but have to do a kill -9 and restart to re-enable binary clients to connect to the server.  This might relate to #4613 </body>
		<created>2016-03-11 22:30:14</created>
		<closed>2016-04-04 07:13:26</closed>
	</bug>
	<bug>
		<id>5820</id>
		<title>Bug with sequnce</title>
		<body>If sequnce 'hibernate_sequence' is not exist in database  then query  "select sequence('hibernate_sequence').next()" returns 0.  But it must be a exception because the sequene not exists in database. </body>
		<created>2016-03-11 13:41:13</created>
		<closed>2016-03-11 16:10:17</closed>
	</bug>
	<bug>
		<id>5819</id>
		<title>include() stopped working with inline filtering</title>
		<body>Hi,  It seems that SQL's `include()` method stopped working  after inline filtering (e.g. `[name='John'].include(...)`)  in version `2.1.12` or possibly any version newer than `2.1.8`, which I am using at the moment  **Test Schema**  ``` create class Test extends V create class linked_to extends E  #creates record #12:0 insert into Test content { "name": "John Doe" }   #creates record #12:1 insert into Test content { "name": "Dohn Joe" }   create edge linked_to from #12:0 to #12:1 ```  **Queries**  ``` #1 WORKS select expand(out('linked_to').include('@rid')) from #12:0  #2 Does not work select expand(out('linked_to')[@class='Test'].include('@rid')) from #12:0  #3 Does not work select expand(outE('linked_to').inV()[@class='Test'].include('@rid')) from #12:0 ```  While **no.1** works well, the other 2 stopped working (they do work in `2.1.8` though).  **Workaround**  ``` select expand(@this.include('@rid')) from (    select expand(outE('linked_to').inV()[@class='Test']) from #12:0 ) ``` </body>
		<created>2016-03-11 06:11:06</created>
		<closed>2016-03-11 11:54:50</closed>
	</bug>
	<bug>
		<id>5817</id>
		<title>Problem with UPDATE, LOCK RECORD and LIMIT Together in query</title>
		<body>According to this site you should be allowed to use both UPDATE, LOCK RECORD and LIMIT in one command  ``` SQL update Address set primary = true WHERE  street = "some street" LOCK RECORD LIMIT 1 ```  But I get the following error:  &gt; com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Error parsing query:  &gt; select from Address WHERE  street = "some street" LOCK RECORD LIMIT 1 &gt; Encountered " &lt;LIMIT&gt; "LIMIT "" at line 1, column 114. &gt; Was expecting one of: &gt; ...  This works however:  ``` SQL update (select from Address WHERE  street = "some street" LIMIT 1) set primary = true LOCK RECORD ``` </body>
		<created>2016-03-10 09:33:46</created>
		<closed>2016-03-10 16:56:25</closed>
	</bug>
	<bug>
		<id>5815</id>
		<title>OETL randomly stucks</title>
		<body>OrientDB 2.1.12, Windows 7 64b, JAVA 1.8 I have simple table accounts with 7 columns. I want to import this table to orientdb. I've created a script for oetl and if I run this script without parallel access, all will work. But if I try to turn the paralelization on, it will often stuck randomly:  OrientDB etl v.2.1.12 (build 2.1.x@rb2f496fd6baa3b845b8f442c0ade5505249336cb; 2016-03-01 08:10:48+00 00) www.orientdb.com BEGIN ETL PROCESSOR [file] INFO Reading from file accounts_500k.csv with encoding UTF-8 Started parallel execution with 7 threads - extracted 3504 rows (0 rows/sec) - 3504 rows -&gt; loaded 1 vertices (0 vertices/sec) Total time: 1   015ms [0 warnings, 0 errors] - extracted 8696 rows (5120 rows/sec) - 8696 rows -&gt; loaded 5188 vertices (5115 vertices/sec) T   otal time: 2029ms [0 warnings, 0 errors] - extracted 11753 rows (2970 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (2970 vertices/sec)   Total time: 3058ms [0 warnings, 0 errors] - extracted 11753 rows (0 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (0 vertices/sec) Total t   ime: 4064ms [0 warnings, 0 errors] - extracted 11753 rows (0 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (0 vertices/sec) Total t   ime: 5078ms [0 warnings, 0 errors] - extracted 11753 rows (0 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (0 vertices/sec) Total t   ime: 6092ms [0 warnings, 0 errors] - extracted 11753 rows (0 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (0 vertices/sec) Total t   ime: 7106ms [0 warnings, 0 errors] - extracted 11753 rows (0 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (0 vertices/sec) Total t   ime: 8120ms [0 warnings, 0 errors] - extracted 11753 rows (0 rows/sec) - 11753 rows -&gt; loaded 8245 vertices (0 vertices/sec) Total t   ime: 9134ms [0 warnings, 0 errors] </body>
		<created>2016-03-10 07:50:03</created>
		<closed>2016-10-10 14:17:40</closed>
	</bug>
	<bug>
		<id>5810</id>
		<title>OrientDB 2.1.10 distributed mode: Autodeploy and Replication not happening!!</title>
		<body>Hi all, I am testing OrientDB v2.1.10 in distributed mode in a 2 node configuration over 2 different machines. Connection is happening flawlessly and the two nodes are up and running. However, Autodeploy and Replication is not happening. Given below are the configuration files: The hazelcast plugin section of the orient-server-config.xml file: `&lt;handler class="com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin"&gt;             &lt;parameters&gt;                 &lt;parameter value="true" name="enabled"/&gt;                 &lt;parameter value="${ORIENTDB_HOME}/config/default-distributed-db-config.json" name="configuration.db.default"/&gt;                 &lt;parameter value="${ORIENTDB_HOME}/config/hazelcast.xml" name="configuration.hazelcast"/&gt;                 &lt;parameter value="node1457502380127" name="nodeName"/&gt;             &lt;/parameters&gt; &lt;/handler&gt; ` The default-distributed-db-config.json file: `{     "autoDeploy": true,     "hotAlignment": false,     "executionMode": "undefined",     "readQuorum": 1,     "writeQuorum": 2,     "failureAvailableNodesLessQuorum": false,     "readYourWrites": true,     "servers": {         "*": "master"     },     "clusters": {         "internal": {         },         "index": {         },         "*": {             "servers" : [ "&lt;NEW_NODE&gt;" ]         }     } } ` The hazelcast.xml file: `&lt;hazelcast         xsi:schemaLocation="http://www.hazelcast.com/schema/config hazelcast-config-3.0.xsd"         xmlns="http://www.hazelcast.com/schema/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;         &lt;group&gt;                 &lt;name&gt;orientdb&lt;/name&gt;                 &lt;password&gt;orientdb&lt;/password&gt;         &lt;/group&gt;         &lt;network&gt;                 &lt;port auto-increment="true"&gt;2434&lt;/port&gt;                 &lt;join&gt;                         &lt;multicast enabled="true"&gt;                                 &lt;multicast-group&gt;235.1.1.1&lt;/multicast-group&gt;                                 &lt;multicast-port&gt;2434&lt;/multicast-port&gt;                         &lt;/multicast&gt;                 &lt;/join&gt;         &lt;/network&gt;         &lt;executor-service&gt;                 &lt;pool-size&gt;16&lt;/pool-size&gt;         &lt;/executor-service&gt; &lt;/hazelcast&gt; ` -   I first checked for Autodeploy using a database I created on the 1st node: testDistributedOrientConfig On running the 2nd node after the 1st node there is no entry for testDistributedOrientConfig in the 2nd node's startup log.  Hence, when I try to connect to it from the console of the 2nd node I get an error  orientdb&gt; connect remote:localhost/testDistributedOrientConfig admin admin  Connecting to database [remote:localhost/testDistributedOrientConfig] with user 'admin'... Error: com.orientechnologies.orient.core.exception.OConfigurationException: Database 'testDistributedOrientConfig' is not configured on server (home=/home/../orientdb-community-2.1.10/databases/) -   I checked the Replication on the default GratefulDeadConcerts database. On connecting to the database using the console on the 1st node, i don't get the entry for 2nd node in the members' section in the distributed config  orientdb&gt; connect remote:localhost/GratefulDeadConcerts admin admin         Connecting to database [remote:localhost/GratefulDeadConcerts] with user 'admin'...OK  DISTRIBUTED CONFIGURATION: {   "localName": "_hzInstance_1_orientdb",   "localId": "20b977ed-6e5a-4ae8-b41c-24bd977fb4d8",   "members": [     {       "id": "20b977ed-6e5a-4ae8-b41c-24bd977fb4d8",       "name": "node1457502380127",       "startedOn": "2016-03-09 06:46:47",       "status": "STARTING",       "listeners": [{"protocol":"ONetworkProtocolBinary","listen":"192.168.1.5:2424"},{"protocol":"ONetworkProtocolHttpDb","listen":"192.168.1.5:2480"}],       "databases": []     }   ] }  orientdb {db=GratefulDeadConcerts}&gt;   Similarly, for connecting to the db using 2nd node's console  orientdb&gt; connect remote:localhost/GratefulDeadConcerts admin admin  Connecting to database [remote:localhost/GratefulDeadConcerts] with user 'admin'...OK  DISTRIBUTED CONFIGURATION: {   "localName": "_hzInstance_1_orientdb",   "localId": "9a64e3e4-2bb1-4304-a489-91cf913125e9",   "members": [     {       "id": "9a64e3e4-2bb1-4304-a489-91cf913125e9",       "name": "node1457502436582",       "startedOn": "2016-03-09 06:48:03",       "status": "STARTING",       "listeners": [{"protocol":"ONetworkProtocolBinary","listen":"127.0.1.1:2424"},{"protocol":"ONetworkProtocolHttpDb","listen":"127.0.1.1:2480"}],       "databases": []     }   ] } orientdb {db=GratefulDeadConcerts}&gt;   Hence, when I do an insert from the 2nd node, using: orientdb {db=GratefulDeadConcerts}&gt; create vertex V set node=2  Created vertex 'V#9:811{node:2} v1' in 0.012000 sec(s).  orientdb {db=GratefulDeadConcerts}&gt; select from V where node=2    ----+------+------+---- # |@RID  |@CLASS|node  ----+------+------+---- 0   |#9:811|V     |2   ----+------+------+----  1 item(s) found. Query executed in 0.064 sec(s). I cannot find the same record at the 1st node: orientdb {db=GratefulDeadConcerts}&gt; select from V where node=2    0 item(s) found. Query executed in 0.106 sec(s).  Kindly, shed some light on the issue(s). Any help is much appreciated. Thanks. </body>
		<created>2016-03-09 07:12:26</created>
		<closed>2016-05-08 18:21:37</closed>
	</bug>
	<bug>
		<id>5802</id>
		<title>Unable to acquire db connections </title>
		<body>Orient db version 2.2 Beta  Both the below approaches do not seem to work while they work fine in 2.1.12  new OPartitionedDatabasePool("remote:localhost/Testing","admin","admin",10);   database = new ODatabaseDocumentTx("remote:localhost/Testing");         database.setProperty("minPool", 2);         database.setProperty("maxPool", 5);         database.open("admin", "admin")  Caused by: com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database url=remote:localhost/Testing     Storage URL="remote:localhost/Testing"     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:276) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool$DatabaseDocumentTxPolled.internalOpen(OPartitionedDatabasePool.java:140) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.openDatabase(OPartitionedDatabasePool.java:343) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.core.db.OPartitionedDatabasePool.acquire(OPartitionedDatabasePool.java:313) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at controllers.api.database.ODocumentTXConnection.getDB(ODocumentTXConnection.java:27) ~[classes/:na]     at controllers.api.model.PlanUpdateSubscription.subscribePlaUpdate(PlanUpdateSubscription.java:18) ~[classes/:na]     at controllers.api.services.PlanServices.getPlan(PlanServices.java:19) ~[classes/:na]     at api.Routes$$anonfun$routes$1$$anonfun$applyOrElse$1$$anonfun$apply$1.apply(Routes.scala:72) ~[classes/:na]     at api.Routes$$anonfun$routes$1$$anonfun$applyOrElse$1$$anonfun$apply$1.apply(Routes.scala:72) ~[classes/:na]     at play.core.routing.HandlerInvokerFactory$$anon$4.resultCall(HandlerInvoker.scala:157) ~[play_2.11-2.5.0-M2.jar:2.5.0-M2] Caused by: java.lang.NumberFormatException: For input string: "UNIQUE"     at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65) ~[na:1.8.0_66]     at java.lang.Integer.parseInt(Integer.java:580) ~[na:1.8.0_66]     at java.lang.Byte.parseByte(Byte.java:149) ~[na:1.8.0_66]     at java.lang.Byte.parseByte(Byte.java:175) ~[na:1.8.0_66]     at com.orientechnologies.orient.core.config.OStorageConfiguration.fromStream(OStorageConfiguration.java:438) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.core.config.OStorageConfiguration.fromStream(OStorageConfiguration.java:485) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.core.config.OStorageConfiguration.load(OStorageConfiguration.java:201) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.client.remote.OStorageRemote.open(OStorageRemote.java:238) ~[orientdb-client-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.client.remote.OStorageRemoteThread.open(OStorageRemoteThread.java:81) ~[orientdb-client-2.2.0-beta.jar:2.2.0-beta]     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:242) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta] </body>
		<created>2016-03-05 09:14:08</created>
		<closed>2016-03-29 11:10:51</closed>
	</bug>
	<bug>
		<id>5801</id>
		<title>No option to specify the superclass while creating a class from studio</title>
		<body>Orient db version - 2.2. beta ![image](https://cloud.githubusercontent.com/assets/5057060/13544721/9c2f4d9a-e2b4-11e5-98ae-1370e1d98b43.png) </body>
		<created>2016-03-05 01:29:34</created>
		<closed>2016-03-07 09:28:53</closed>
	</bug>
	<bug>
		<id>5800</id>
		<title>console batch mode doesn't work as documented</title>
		<body>The documentation here [http://orientdb.com/docs/2.1/Console-Commands.html](http://orientdb.com/docs/2.1/Console-Commands.html) says:   ``` java $ $ORIENTDB_HOME/bin/console.sh commands.txt ```  ...but when I try it, it treats the file name as a command:  ``` java [root@bwu4 /opt/orientdb]# orientdb-community-2.0/bin/console.sh commands.txt  OrientDB console v.2.0 (build UNKNOWN@r; 2015-01-20 16:41:17+0000) www.orientechnologies.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  orientdb&gt; commands.txt  !Unrecognized command: 'commands.txt' ``` </body>
		<created>2016-03-04 22:54:21</created>
		<closed>2016-03-07 12:12:14</closed>
	</bug>
	<bug>
		<id>5798</id>
		<title>mistake in expression computation</title>
		<body>&lt;pre&gt; select max( 79 - value,0) from  33:310 ==&gt;0  ----+------+---------------- #   |@CLASS|max ----+------+---------------- 0   |null  |0               ----+------+----------------  select max(( 79 - value),0) from  33:310 ==&gt;20  ----+------+---------------- #   |@CLASS|max ----+------+---------------- 0   |null  |20               ----+------+---------------- &lt;/pre&gt; </body>
		<created>2016-03-03 23:16:26</created>
		<closed>2016-10-03 13:32:31</closed>
	</bug>
	<bug>
		<id>5797</id>
		<title>JDBC Implementation</title>
		<body>Doesn't seem to be a full JDBC implementation -- tools that OrientDB recommends like DbVisualizer won't even load the driver.  SQLWorkbench will connect to it, but gives a threading error "Database instance is not set in current thread", when any attempt (MAC OSX) is made to access the tables.  Pentaho will connect to it, but chokes on attempting to set the SCHEMA setting to the database name.   What's missing that needs to be in place for common JDBC clients to be able to see the tables? </body>
		<created>2016-03-03 22:27:37</created>
		<closed>2016-03-14 12:54:06</closed>
	</bug>
	<bug>
		<id>5794</id>
		<title>SET SERVER USER console command giving exception on 2.2.0 beta</title>
		<body>On starting the Orient server, the "root" server user was successfully created and the password was hashed using PBKDF2WithHmacSHA256 as is expected for 2.2  However, now I'm trying to add more server users via the console and I'm getting the following message:  &gt; OrientDB console v.2.2.0-beta (build develop@r4cbc24a66f17f023a2e59da300a29b91fdb5d1fa; 2016-02-22 17:46:44+0000) www.orientdb.com &gt; Type 'help' to display all the supported commands. &gt; Installing extensions for GREMLIN language v.2.6.0 &gt;  &gt; orientdb&gt; set server user myuser myuser * &gt; Error on loading ..\config\orientdb-server-config.xml file: java.lang.IllegalArgumentException: **Algorithm '{PBKDF2WithHmacSHA1}' is not supported** &gt;  &gt; orientdb&gt;  Part of the problem appears to be in OSecurityManager.java, where there seems to be some problem with the curly braces matching in createHash(final String iInput, final String iAlgorithm, final boolean iIncludeAlgorithm) method.   In any case, why is console trying to use PBKDF2WithHmacSHA1? It should use PBKDF2WithHmacSHA256, correct?  I'm using Java 1.8.0_74 for both the server and the console.  </body>
		<created>2016-03-02 18:48:28</created>
		<closed>2016-05-23 17:25:31</closed>
	</bug>
	<bug>
		<id>5792</id>
		<title>OrientDB 2.2 Beta - Error on Alter Class Add Custom Properties</title>
		<body>This works in 2.2Alpha: &lt;code&gt; ALTER CLASS Person CUSTOM onCreate.identityType=role&lt;/code&gt;  It produces the error: &lt;code&gt;com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Error parsing query: ALTER CLASS Person CUSTOM onCreate.identityType=role Encountered " "ALTER "" at line 1, column 1. Was expecting one of:   ... ... ... ... ... ... ... ... ... ... ... ... &lt;/code&gt; </body>
		<created>2016-03-01 16:46:27</created>
		<closed>2016-03-01 17:43:34</closed>
	</bug>
	<bug>
		<id>5788</id>
		<title>OServerAdmin credentials are over-written after a connection to a database is acquired through a connection pool factory</title>
		<body>``` OServerAdmin serverAdmin = new OServerAdmin("192.168.1.5").                 connect("root", "somerootpassword");         OPartitionedDatabasePoolFactory factory = new OPartitionedDatabasePoolFactory(20);         System.out.println("list" + serverAdmin.listDatabases());         System.out.println("list" + serverAdmin.listDatabases());         ODatabaseDocumentTx dbtx = factory.get("remote:192.168.1.5/www.orga.com",                 "asthana.siddhartha", "password").acquire();         System.out.println("list" + serverAdmin.listDatabases()); ```  First 2 calls to list databases go through fine. The last line throws exception:  ``` com.orientechnologies.orient.core.exception.OSecurityAccessException: Server user not authenticated.  ``` </body>
		<created>2016-02-29 14:40:29</created>
		<closed>2016-05-09 11:59:20</closed>
	</bug>
	<bug>
		<id>5786</id>
		<title>select max(localdate) from sitedata</title>
		<body>Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select max(localdate) from sitedata  Error: java.lang.ArrayIndexOutOfBoundsException  When i Upgrade my Orientdb from 2.0 to 2.1.11 then is will shown error Why  when i execute this command on 2.0 it will work Fine !!! </body>
		<created>2016-02-29 05:47:11</created>
		<closed>2016-06-06 11:58:19</closed>
	</bug>
	<bug>
		<id>5785</id>
		<title>v2.2.0-Beta: Many edges not visible from the OUT vertex</title>
		<body>This is done on v2.2.0-Beta. I have 2 orientdb classes: DSRoot and DSTable. Only one instance of DSRoot and about 200 instances of DSTable. There's one edge (class 'rootTable') between the DSRoot vertex and each of the 200 vertices of DSTable. When all vertices and edges are created, DSRoot vertex sees only 27 vertices of DSTable (getEdges/getVertices navigating 'rootTable' edge return only 27 instance) while each DSTable vertices can navigate the 'rootTable' edge to the DSRoot vertex.  Is this a known issue? </body>
		<created>2016-02-26 16:10:18</created>
		<closed>2016-05-03 16:55:35</closed>
	</bug>
	<bug>
		<id>5784</id>
		<title>v2.1.11 : LiveQuery issue with remote Connections</title>
		<body>I set up an embedded OrientDB Server 2.1.11 (OLiveQuery Plugin enabled via settings) with remote access enabled.  So I can access the created Databases (document) via : plocal or remote:localhost URL. (I successfully created records with both connection URLs)  `OLiveQuery&lt;ODocument&gt; liveEventQuery = new OLiveQuery&lt;ODocument&gt;("LIVE SELECT FROM XXX", listener); List&lt;ODocument&gt; result = clusterDb.query(liveEventQuery);`  If I used a remote connection URL, the query for a simple "LIVE SELECT From XXX" never returns (blocked but nothing in logs...)  Used Connection Pool `connPool = new OPartitionedDatabasePool("remote:" + dbServerIp + "/dbName","writer", "writer", 20);`  If I used a plocal connection URL, the query "LIVE SELECT From XXX" returns immediately as expected. Used Connection Pool `connPool = new OPartitionedDatabasePool("plocal:" + dbPath,"writer", "writer", 20);`  Is there any restriction of using LiveQuery via a remote connection ? Is a specific restriction as I use an embedded server ? </body>
		<created>2016-02-26 11:15:40</created>
		<closed>2016-02-29 16:48:17</closed>
	</bug>
	<bug>
		<id>5781</id>
		<title>orientdb console bugs</title>
		<body>the "browse class" command seems to be caching too much information and the cache is not invalidated correctly when the state of the database is updated by another client.  For example: - if a 2nd client creates a schema, it does not appear in "browse class" without reconnecting to the server - if a 2nd client updates the record, the first client still sees the old record information with "browse class"  OrientDB console v.2.1.9-SNAPSHOT (build 2.1.x@r; 2016-01-07 10:51:24+0000) www.orientdb.com Type 'help' to display all the supported commands. Installing extensions for GREMLIN language v.2.6.0  under ubuntu 14.04 </body>
		<created>2016-02-25 20:03:51</created>
		<closed>2016-05-18 15:04:05</closed>
	</bug>
	<bug>
		<id>5778</id>
		<title>Support for Decimal Type</title>
		<body>Can't seem to get Decimal type working ever with OrientDB JDBC driver. </body>
		<created>2016-02-25 18:37:59</created>
		<closed>2016-03-02 16:31:30</closed>
	</bug>
	<bug>
		<id>5777</id>
		<title>OClusterPositionMapException: Error during creation of mapping between logical adn physical record position: java.lang.ArrayIndexOutOfBoundsException</title>
		<body>I got the following error when creating a vertex - after that, i cannot query the relevant class anymore and also rebuilding the relevant index fails:  ``` $ANSI{green {db=huebscher-kb}} Error on creating record in cluster: plocal cluster: ipattblpostbuch_2 com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record creation     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb"     Component Name="ipattblpostbuch_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:478)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:2899)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:898)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1935)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:238)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:172)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2480)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2324)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:118)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.createRecord(OBinaryNetworkProtocolAbstract.java:354)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createRecord(ONetworkProtocolBinary.java:1696)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:422)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:210)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error during creation of mapping between logical adn physical record position     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb"     Component Name="ipattblpostbuch_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.add(OClusterPositionMap.java:226)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:469)     ... 13 more Caused by: java.lang.ArrayIndexOutOfBoundsException: 117     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALPageChangesPortion.updateData(OWALPageChangesPortion.java:237)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALPageChangesPortion.setByteValue(OWALPageChangesPortion.java:60)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.setByteValue(ODurablePage.java:186)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMapBucket.add(OClusterPositionMapBucket.java:59)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.add(OClusterPositionMap.java:219)     ... 14 more $ANSI{green {db=huebscher-kb}} Error on creating record in cluster: plocal cluster: ipattblpostbuch_2 com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record creation     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb"     Component Name="ipattblpostbuch_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:478)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:2899)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:898)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1935)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:238)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:172)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2480)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2324)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:118)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.createRecord(OBinaryNetworkProtocolAbstract.java:354)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createRecord(ONetworkProtocolBinary.java:1696)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:422)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:210)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error during creation of mapping between logical adn physical record position     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb"     Component Name="ipattblpostbuch_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.add(OClusterPositionMap.java:226)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:469)     ... 13 more Caused by: java.lang.ArrayIndexOutOfBoundsException ```  ``` 2016-02-25 17:07:05:751 INFO  {db=huebscher-kb} - Rebuilding index huebscher-kb.iPatTblPostbuch.uid (estimated 699.804 items)... [OIndexRebuildOutputListener] 2016-02-25 17:07:11:771 INFO  {db=huebscher-kb} --&gt; OK, indexed 87.403 items in 6.021 ms [OIndexRebuildOutputListener] 2016-02-25 17:07:11:794 SEVER Internal server error: com.orientechnologies.orient.core.index.OIndexException: Error on rebuilding the index for clusters: [ipattblpostbuch, ipattblpostbuch_2, ipattblpostbuch_1, ipattblpostbuch_7, ipattblpostbuch_4, ipattblpostbuch_3, ipattblpostbuch_6, ipattblpostbuch_5]     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb" --&gt; java.lang.IndexOutOfBoundsException [ONetworkProtocolHttpDb]$ANSI{green {db=huebscher-kb}} Error on creating record in cluster: plocal cluster: ipattblpostbuch_2 com.orientechnologies.orient.core.exception.OPaginatedClusterException: Error during record creation     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb"     Component Name="ipattblpostbuch_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:478)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:2899)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:898)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1935)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveNew(OTransactionNoTx.java:238)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:172)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2480)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2324)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:118)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.createRecord(OBinaryNetworkProtocolAbstract.java:354)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.createRecord(ONetworkProtocolBinary.java:1696)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:422)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:210)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.orient.core.exception.OClusterPositionMapException: Error during creation of mapping between logical adn physical record position     Storage URL="plocal:/opt/orientdb/databases/huebscher-kb"     Component Name="ipattblpostbuch_2"     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPositionMap.add(OClusterPositionMap.java:226)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:469)     ... 13 more Caused by: java.lang.ArrayIndexOutOfBoundsException  ```  OrientDB Version is 2.2.0-beta </body>
		<created>2016-02-25 16:35:58</created>
		<closed>2016-03-30 19:46:34</closed>
	</bug>
	<bug>
		<id>5776</id>
		<title>Replication fails on first update after I restart orientdb cluster 2.2.0-beta</title>
		<body>Replication fails on first update after I've restarted orientdb cluster.  All updates afterwards works fine.  The first update is lost.  I tested by updating via the http orientdb server.  Using orientdb-community-2.2.0-beta in Linux. </body>
		<created>2016-02-25 15:13:20</created>
		<closed>2016-05-08 18:22:20</closed>
	</bug>
	<bug>
		<id>5775</id>
		<title>error while removing property's attribute "linkedType"</title>
		<body>Hi. my DB is 2.1.11  documentation is saying for linkedType Use NULL to remove an existing value.  But database return error on this query.  **create property testNull.embList embeddedList** Property created successfully with id=2  **alter property testNull.embList LINKEDtype STRING** Property updated successfully  **alter property testNull.embList LINKEDtype null** Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.alter property testNull.embList LINKEDtype null Error: java.lang.NullPointerException: Name is null  **alter property testNull.embList LINKEDtype NULL** Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.alter property testNull.embList LINKEDtype NULL Error: java.lang.NullPointerException: Name is null </body>
		<created>2016-02-25 12:43:42</created>
		<closed>2016-06-10 13:59:11</closed>
	</bug>
	<bug>
		<id>5774</id>
		<title>OutOfMemoryError (Java heap space) when using binary protocol w/ connection pool</title>
		<body>Just updated to 2.2.0-beta. Without the pooling option set, everything seems to be working fine.  ``` const OrientJS = require('orientjs'),     server = OrientJS({ host: 'localhost', port: 2424, pool: { max: 10 } }),     DB = server.use({ name: 'test', username: 'admin', password: 'admin' });  DB.query('select from v'); ```  &gt; [OServer]java.lang.OutOfMemoryError: Java heap space &gt; Dumping heap to java_pid2544.hprof ... &gt; Heap dump file created [12260579 bytes in 0.176 secs] &gt;  &gt; Unhandled rejection OrientDB.RequestError: Java heap space &gt;     at Operation.parseError (orientjs/lib/transport/binary/protocol33/operation.js:865:13) &gt;     at Operation.consume (orientjs/lib/transport/binary/protocol33/operation.js:455:35) &gt;     at Connection.process (orientjs/lib/transport/binary/connection.js:385:17) &gt;     at Connection.handleSocketData (orientjs/lib/transport/binary/connection.js:286:17)  Tested with:  &gt; OrientDB Server v2.2.0-beta &gt; Build: develop@r4cbc24a66f17f023a2e59da300a29b91fdb5d1fa; 2016-02-22 17:46:44+0000 &gt;  &gt; OrientJS: latest master branch &gt; OrientJS: latest 2.2.x branch </body>
		<created>2016-02-24 15:01:29</created>
		<closed>2016-06-09 16:42:52</closed>
	</bug>
	<bug>
		<id>5772</id>
		<title>OStorageException Issue (urgent)</title>
		<body>We are facing the following issue when upgraded from 2.1.10 to 21.11. Please help to solve it quickly as it bring a big glitch to our web application. haiz...  2016-02-24 19:55:55:908 INFO  OrientDB Server v2.1.11 (build UNKNOWN@rddb5c0b4761473ae9549c3ac94871ab56ef5af2c; 2016-02-15 10:49:20+0000) is active. [OServer]{db=voyage} Error on creating record in cluster: plocal cluster: act com.orientechnologies.orient.core.exception.OStorageException     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:434)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:1938)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:743)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1999)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2568)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.serialize(OEmbeddedRidBag.java:387)     at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.toStream(ORidBag.java:277)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:583)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1933)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2568)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:675)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:689)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:574)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:2418)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1181)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2689)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2658)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:284)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:157)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:102)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:91)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1522)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1503)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1323)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.common.directmemory.ODirectMemoryViolationException: Provided offset [422848] is more than size of allocated area  [65552]     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.rangeCheck(OUntrackedDirectMemoryPointer.java:236)     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.getInt(OUntrackedDirectMemoryPointer.java:107)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALChangesTree.getIntValue(OWALChangesTree.java:89)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALChangesTree$PointerWrapper.getInt(OWALChangesTree.java:783)     at com.orientechnologies.common.serialization.types.OIntegerSerializer.deserializeFromDirectMemory(OIntegerSerializer.java:125)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.getIntValue(ODurablePage.java:101)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPage.appendRecord(OClusterPage.java:103)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.addEntry(OPaginatedCluster.java:1482)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:423)     ... 49 more {db=voyage} Error on creating record in cluster: plocal cluster: list com.orientechnologies.orient.core.exception.OStorageException     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:434)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doCreateRecord(OAbstractPaginatedStorage.java:1938)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.createRecord(OAbstractPaginatedStorage.java:743)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1999)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2568)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.db.record.ridbag.embedded.OEmbeddedRidBag.serialize(OEmbeddedRidBag.java:387)     at com.orientechnologies.orient.core.db.record.ridbag.ORidBag.toStream(ORidBag.java:277)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:583)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1933)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.addRecord(OTransactionOptimistic.java:432)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.saveRecord(OTransactionOptimistic.java:363)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2568)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:81)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.recursiveLinkSave(ORecordSerializerBinaryV0.java:675)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeOptimizedLink(ORecordSerializerBinaryV0.java:689)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.writeSingleValue(ORecordSerializerBinaryV0.java:574)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.serialize(ORecordSerializerBinaryV0.java:260)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.toStream(ORecordSerializerBinary.java:105)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2296)     at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commitEntry(OAbstractPaginatedStorage.java:2418)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1181)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:606)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2689)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2658)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQLScript(OCommandExecutorScript.java:284)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeSQL(OCommandExecutorScript.java:157)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.executeInContext(OCommandExecutorScript.java:102)     at com.orientechnologies.orient.core.command.script.OCommandExecutorScript.execute(OCommandExecutorScript.java:91)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1522)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1503)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1323)     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) Caused by: com.orientechnologies.common.directmemory.ODirectMemoryViolationException: Provided offset [469272] is more than size of allocated area  [65552]     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.rangeCheck(OUntrackedDirectMemoryPointer.java:236)     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.getInt(OUntrackedDirectMemoryPointer.java:107)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALChangesTree.getIntValue(OWALChangesTree.java:89)     at com.orientechnologies.orient.core.storage.impl.local.paginated.wal.OWALChangesTree$PointerWrapper.getInt(OWALChangesTree.java:783)     at com.orientechnologies.common.serialization.types.OIntegerSerializer.deserializeFromDirectMemory(OIntegerSerializer.java:125)     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurablePage.getIntValue(ODurablePage.java:101)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OClusterPage.appendRecord(OClusterPage.java:103)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.addEntry(OPaginatedCluster.java:1482)     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.createRecord(OPaginatedCluster.java:423)     ... 49 more </body>
		<created>2016-02-24 12:34:18</created>
		<closed>2016-05-25 12:35:35</closed>
	</bug>
	<bug>
		<id>5770</id>
		<title>Binary compatibility test is failing on 2.2.x </title>
		<body></body>
		<created>2016-02-24 08:01:13</created>
		<closed>2016-05-11 13:12:47</closed>
	</bug>
	<bug>
		<id>5767</id>
		<title>Web interface places LIMIT 20 on DELETE VERTEX command</title>
		<body>Repro, in the web interface: - create more than 20 records of any vertex class, call it T - run `DELETE VERTEX T` - observe that the returned value of the deletion command is 20, and that the db still has vertices of type T - increase the limit in the web interface to 20000 - observe that more than 20 records are now deleted </body>
		<created>2016-02-23 21:41:28</created>
		<closed>2016-04-13 16:01:33</closed>
	</bug>
	<bug>
		<id>5758</id>
		<title>getting old version of vertex after update :</title>
		<body>steps:  1. get vertex by id  2. in transactions update vertex properties 3. calling get vertex by id from another thread return the old data (when we do the call in the same thread the data is correct - the updated) </body>
		<created>2016-02-22 13:45:32</created>
		<closed>2016-03-01 07:55:16</closed>
	</bug>
	<bug>
		<id>5752</id>
		<title>out().&lt;field&gt; converts embedded json to array in OrientDB 2.1.10</title>
		<body>This query:  ``` sql select from V where label = 'snapshot' and ((out('derivedFrom').data.id contains 'e3e3a92a-8dd2-4963-89fd-8386cc2b0cf8') and (data.stage = 'dev')) ```  Yields a result in OrientDB 2.1.5, but fails for me in 2.1.10.  The reason is, that given a vertex with a field that contains an embedded json object, if one traverses the graph with the `out()` function, the object ends up being converted to an array, dropping the property names.   To reproduce, create a two-vertex graph with an edge between them, give one vertex the field `label = "foo"` and the other one an embedded json field `data = {"bar": "baz", "quux": 1}`.  ``` sql select out().data from (select from V where label = 'foo') ```  Yields `[{"bar": "baz", "quux": 1}]` in 2.1.5 but `["baz", 1]` in 2.1.10.  Is this behaviour intended?  </body>
		<created>2016-02-19 14:02:49</created>
		<closed>2016-05-13 13:51:57</closed>
	</bug>
	<bug>
		<id>5748</id>
		<title>delete binary records via sql problem</title>
		<body>Hi , i have an issue with the binary records  .  when i create or read a binary record everything is ok . but when i want to delete some binary record from console or studio i achieve nothing to happended .  My Scenario is : ODB : 2.1.11, 1. Create Class BlobStorage. 2. Create some Binary records .(154 binary record was created in my case) 3. Select From BlobStorage returns nothing (i recommend return size and rid of binary records ) . 4. Delete From BlobStorage return 0 (also i tried with Delete From Cluster:blobstorage) . 5. Truncate Class BlobStorage returns 154 (it's ok and works true)    6.Truncate Record #15:7(it's ok and works true)    Is there any way to delete binary records ? </body>
		<created>2016-02-18 07:36:05</created>
		<closed>2016-08-04 15:57:51</closed>
	</bug>
	<bug>
		<id>5745</id>
		<title>Select with projection paramenter value as label</title>
		<body>with as simple select:`select :par` the result field depends on the value, so for example if i run the query with as paramenter value `a` the result will be `{'a':'a'}` like i ran `select 'a'` what i expect instead is `{'par':'a'}`. </body>
		<created>2016-02-18 02:43:10</created>
		<closed>2018-06-22 15:19:27</closed>
	</bug>
	<bug>
		<id>5743</id>
		<title>Changed superclass causes objects to be unqueryable with index</title>
		<body>On OrientDB 2.1.9:  ``` CREATE CLASS Main ABSTRACT CREATE PROPERTY Main.uuid String CREATE INDEX Main.uuid UNIQUE_HASH_INDEX  CREATE CLASS Base EXTENDS Main ABSTRACT  CREATE CLASS Derived EXTENDS Main INSERT INTO Derived SET uuid='abcdef'  SELECT * FROM Derived WHERE uuid='abcdef'  // returns the one object  ALTER CLASS Derived SUPERCLASSES Base SELECT * FROM Derived WHERE uuid='abcdef'  // returns no objects!!  REBUILD INDEX Main.uuid SELECT * FROM Derived WHERE uuid='abcdef'  // returns no objects!!  DROP INDEX Main.uuid SELECT * FROM Derived WHERE uuid='abcdef'  // returns the one object, but there's no index -- table scan  CREATE INDEX Main.uuid UNIQUE_HASH_INDEX SELECT * FROM Derived WHERE uuid='abcdef'  // returns no objects!! ```  This is quite obviously incorrect behavior -- the results should never be different depending on whether an index is used or not. </body>
		<created>2016-02-17 18:24:55</created>
		<closed>2016-02-25 16:08:41</closed>
	</bug>
	<bug>
		<id>5739</id>
		<title>Crash test was failed</title>
		<body>http://helios.orientdb.com/view/develop/job/orientdb-develop-crash-tests/lastCompletedBuild/com.orientechnologies$orientdb-server/testReport/com.orientechnologies.orient.core.storage.impl.local.paginated/LocalPaginatedStorageSmallCacheBigRecordsCrashRestoreIT/testDocumentCreation/ </body>
		<created>2016-02-17 10:16:44</created>
		<closed>2016-04-11 17:20:37</closed>
	</bug>
	<bug>
		<id>5737</id>
		<title>array parameter passed as string in Function</title>
		<body>select check(['a','b'])  where check(t){return t;}  t is a String , not a Array </body>
		<created>2016-02-16 21:46:09</created>
		<closed>2017-01-31 10:45:06</closed>
	</bug>
	<bug>
		<id>5736</id>
		<title>probable bug in sql function</title>
		<body>Sorry maybe i dont understand correctly the way for passing parameters in a sql function  but it seams a bug considering different attempts executed language: sql function test(a) body : return $a;  select test(1)  it dont return anything.  body : return a;  exception : so it implies $a is correct.   body : return 1; it returns correctly result. I hope i submited a bug usefull to fix to loveable orientdb:)  </body>
		<created>2016-02-16 11:50:02</created>
		<closed>2016-06-09 15:03:57</closed>
	</bug>
	<bug>
		<id>5722</id>
		<title>ODatabaseDocumentTx isClosed returns false after server shutdown</title>
		<body>the code  ``` import com.orientechnologies.orient.client.remote.OServerAdmin; import com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx; import com.orientechnologies.orient.server.OServerMain;  public class ODatabaseDocumentTx_isClosed_Test {     private static String url = "remote:localhost";     private static String user = "root";     private static String pass = "somepass";     private static String dbName = "db-test-failing";     private static String dbType = "graph";     private static String dbStorage = "memory";      private static void createDb() throws Exception {         new OServerAdmin(url)                 .connect(user, pass)                 .createDatabase(dbName, dbType, dbStorage).close();     }      private static void startServer() throws Exception { OServerMain.main(new String[0]); }     private static void stopServer() { OServerMain.server().shutdown(); }  //config/orientdb-server-config.xml needs to be present for OServerMain      public static void main(String [] args) throws Exception {         startServer();         createDb();          ODatabaseDocumentTx db = new ODatabaseDocumentTx(url + "/" + dbName);         db.open(user, pass);          stopServer();          try {             boolean closed = db.isClosed();             System.out.println(closed);         } catch (Exception e) {             e.printStackTrace();         }     } } ```  as @laa suggested "...we have to remove databases with closed connections from the pool . I will provide fix for next 2.1 hotfix ?" </body>
		<created>2016-02-14 19:50:33</created>
		<closed>2016-02-16 12:45:00</closed>
	</bug>
	<bug>
		<id>5719</id>
		<title>bug in lucene select</title>
		<body>version 2.10  &lt;pre&gt; index: c.name_list  FULLTEXT    ["name","list"]     LUCENE   insert into c set list = ['a','b']   select from index:c.name_list where key  LUCENE "list:b"   ----+------+----------------------------+----- #   |@CLASS|key                         |rid   ----+------+----------------------------+----- 0   |null  |OCompositeKey{keys=[list:b]}|#56:1 ----+------+----------------------------+-----  select from index:c.name_list where key  LUCENE "list:a"  0 item(s) found. Query executed in 0.002 sec(s).   &lt;/pre&gt;   It seams it add just last element. In lucene arrays are handled natevely adding many fields with same name as many elements </body>
		<created>2016-02-13 21:09:03</created>
		<closed>2016-10-31 15:51:19</closed>
	</bug>
	<bug>
		<id>5714</id>
		<title>Inconsistent behavior when querying with explicit gremlin</title>
		<body>With OrientDB 2.1.9 and a database that has some data (both vertices and edges, specifics are not relevant):  ``` select * from V where count(gremlin('g.V.next()')) = 0 ```  This returns no records.  ``` select * from V where count(gremlin('g.V.next()')) &gt; 0 ```  This returns all the vertices in the database.  ``` g.V.next() ```  In Studio, this returns one vertex.  ``` select gremlin('g.V.next()') ```  This throws:  ``` java.lang.IllegalArgumentException: Cannot determine the graph element type because the document class is null. Probably this is a projection, use the EXPAND() function ```  ``` select count(gremlin('g.V.next()')) ```  This throws the same error as above.  ``` select expand(gremlin('g.V.next()')) ```  This returns no records.  There are several problems here: - The queries are internally inconsistent -- the count can't be both invalid and greater than 0. - The perfectly valid `select gremlin(...)` query doesn't work when the gremlin query entered directly works fine. - I'd expect `expand` to throw an error if the argument it's called with is invalid, not return no records and swallow the problem. </body>
		<created>2016-02-11 23:02:33</created>
		<closed>2017-01-31 10:59:13</closed>
	</bug>
	<bug>
		<id>5713</id>
		<title>Database does not open (no upgrade was made)</title>
		<body>Hello,  I am not able to open my database via console or studio and get the following error:   ``` Connecting to database [remote:localhost/DB] with user 'root'... Error: com.orientechnologies.common.exception.OException: Error on creation of shared resource  Error: com.orientechnologies.orient.core.exception.OSchemaException: Cannot add base class 'Dining', because of parameter conflict: zip (type=INTEGER) vs zip (type=INTEGER) ```  This happened over night. I made no changes to the database nor to the server. I am unable to open the database to back it up or export it to adjust the json.  Thanks </body>
		<created>2016-02-11 22:25:50</created>
		<closed>2016-05-25 12:44:44</closed>
	</bug>
	<bug>
		<id>5708</id>
		<title>Lucene Manual Index with multiple keys</title>
		<body>http://stackoverflow.com/questions/35308834/orientdb-how-to-search-over-specified-field-in-manual-lucene-index </body>
		<created>2016-02-10 17:55:13</created>
		<closed>2016-02-12 11:03:12</closed>
	</bug>
	<bug>
		<id>5707</id>
		<title>Cannot open local storage with mode=rw</title>
		<body>Hi all,  I am trying to connect to server with remote mode [as mentioned troubleshooting page](https://github.com/orientechnologies/orientdb-docs/blob/master/Troubleshooting.md#error-comorientechnologiesorientcoreexceptionostorageexception-cannot-open-local-storage-tmpdatabasesdemo-with-moderw) but no luck.  I am checking with `ps aux | grep -i orient` and `ps aux | grep -i server.sh` if there is any other working instance but there is not.  I am stopping and starting server and then trying to connect via console or web but no luck. Still same error.  &gt; Connecting to database [remote:xxx.xxx.xxx.xxx/ViaApi] with user 'admin'... &gt; Error: com.orientechnologies.orient.core.exception.OStorageException: Cannot open local storage '/opt/orientdb-community-2.1.8/databases/DemoDB' with mode=rw &gt;  &gt; Error: java.lang.NullPointerException  I am checking with `lsof +D /opt/orientdb-community-2.1.8/databases/DemoDB -t` but i am getting only one PID.  Any idea?  Thanks. </body>
		<created>2016-02-10 09:31:59</created>
		<closed>2016-04-04 07:29:36</closed>
	</bug>
	<bug>
		<id>5700</id>
		<title>serCustom method not run outside database</title>
		<body>Version: orientdb-community-2.1.9  bug description: when using the graph database. ie schema changes are automatically run outside the current transaction. But in the setCustom method (both on vertex as well as property) that is not the case. it is throwing exception saying you cant make schema changes during a transaction. The rest of the graph schema changes like creating class, adding property does not have a problem as it is automatically run outside a transaction.  To recreate:  ``` OrientGraphFactory factory = new OrientGraphFactory("plocal:"+, , ).setupPool(1, 1); graph=factory.getTx(); OrientVertexType typedef=graph.getVertexType(param.File.name()); prop = def.createProperty("attribute name", OType.LINK, OType.STRING); prop.setCustom("someparam","param value"); ```  Workaround:  ``` prop=graph.executeOutsideTx(new OCallable&lt;OProperty, OrientBaseGraph&gt;() {      @Override      public OProperty call(final OrientBaseGraph g) {           OProperty prop=def.getProperty("attrname");           return prop.setCustom("someparam","param value");      } }, ""); ``` </body>
		<created>2016-02-09 00:33:27</created>
		<closed>2016-02-11 14:36:15</closed>
	</bug>
	<bug>
		<id>5696</id>
		<title>Delete Multiple Records</title>
		<body>Hi, I have tried to delete multiple records from a class with the following command e.g.  `TRUNCATE RECORD [12:2, 12:6, 12:7]`  Command is executed successfully and deletes three **existing** records  And it returns  `{{"result":[{"@type":"d","@version":0,"value":3}]},200}`  Now if I repeat the same command on these three **non-existing** records I am getting back the same response `{{"result":[{"@type":"d","@version":0,"value":3}]},200}`  Isn't it `value:0` in this case ?  BTW: Class on cluster 12 extends Vertex </body>
		<created>2016-02-05 19:41:54</created>
		<closed>2016-02-06 23:40:04</closed>
	</bug>
	<bug>
		<id>5695</id>
		<title>error in conversion from Pojo to ODocument</title>
		<body>v2.1.9  Class A where there is a field x boolean   A a = db.newInstance(A.class) a.setX(false); db.save(a);  the document saved in db has property x = null  the problem seams just with false ==&gt; null  and true ==&gt; false </body>
		<created>2016-02-05 09:54:02</created>
		<closed>2016-02-17 11:01:19</closed>
	</bug>
	<bug>
		<id>5694</id>
		<title>Find References on link within an embedded object</title>
		<body>Hi,   I'm using the "FIND REFERENCES [@rid]" orientdb query to find if an object is used before removing it.   I'm facing a problem when the object is linked in a property of an embedded object, the "FIND REFERENCES" query doesn't catch this reference.   Am I doing something wrong or is there a work around to get a similar query on embedded object?   Thanks for you help,   Andrea </body>
		<created>2016-02-05 09:10:26</created>
		<closed>2016-02-09 10:04:30</closed>
	</bug>
	<bug>
		<id>5693</id>
		<title>Transaction propagation is not working </title>
		<body>``` function1(){     OrientGraph db = factory.openDatabase() ; // which will give active graph on current thread     db.begin();     function2();     // save some data      db.commit(); } function2(){     OrientGraph db = factory.openDatabase() ; // which will give active graph on current thread     db.begin();     // save some data      db.commit(); // this commit is saving the data into db  } ```  here function2 commit is saving the data even though its part of function1 .   sample code :  https://gist.github.com/anonymous/54cd70a1e53d0381658a </body>
		<created>2016-02-05 08:24:56</created>
		<closed>2016-03-17 09:29:04</closed>
	</bug>
	<bug>
		<id>5689</id>
		<title>Explain command fails with wildcard in fetchplan</title>
		<body>working with 2.1.9 release.  when i run this command, i have an issue :  ``` explain SELECT FROM Def fetchplan *:2 [*]in_*:-2 ```  ``` com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Error parsing query:  SELECT FROM Def fetchplan *:2 [*]in_*:-2 Encountered " "*" "* "" at line 1, column 32. Was expecting one of:     &lt;INTEGER_LITERAL&gt; ...     "-" ...     "-" ...     &lt;INTEGER_LITERAL&gt; ... ```  the query (without explain) works fine.  the problem is : `[*]in_*:-2`  if i change [_]in__:-2 by [**1**]in_*:-2 it works as expected </body>
		<created>2016-02-04 13:50:54</created>
		<closed>2016-02-12 17:13:02</closed>
	</bug>
	<bug>
		<id>5678</id>
		<title>NullPointerException on new ORecordIteratorClass if no connection</title>
		<body>to reproduce:  ``` import com.orientechnologies.orient.client.remote.OServerAdmin; import com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx; import com.orientechnologies.orient.core.iterator.ORecordIteratorClass; import com.orientechnologies.orient.server.OServerMain;  public class ORecordIteratorClassNullPointerExceptionTest {     private static String url = "remote:localhost";     private static String user = "root";     private static String pass = "somepass";     private static String dbName = "db-test-failing";     private static String dbType = "graph";     private static String dbStorage = "memory";      private static void createDb() throws Exception {         new OServerAdmin(url)             .connect(user, pass)             .createDatabase(dbName, dbType, dbStorage).close();     }      private static void startServer() throws Exception { OServerMain.main(new String[0]); }     private static void stopServer() { OServerMain.server().shutdown(); }  //config/orientdb-server-config.xml needs to be present for OServerMain      public static void main(String [] args) throws Exception {         startServer();         createDb();          ODatabaseDocumentTx db = new ODatabaseDocumentTx(url + "/" + dbName);         db.open(user, pass);          stopServer();          // this will throw a NullPointerException :(         try {             new ORecordIteratorClass(db, db, "V", true);         } catch (Exception e) {             // ;(             e.printStackTrace();             /*     java.lang.NullPointerException     at com.orientechnologies.common.concur.lock.ODistributedCounter.updateCounter(ODistributedCounter.java:71)     at com.orientechnologies.common.concur.lock.ODistributedCounter.increment(ODistributedCounter.java:45)     at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:67)     at com.orientechnologies.orient.client.remote.OStorageRemote.getPhysicalClusterNameById(OStorageRemote.java:1559)     at com.orientechnologies.orient.client.remote.OStorageRemoteThread.getPhysicalClusterNameById(OStorageRemoteThread.java:534)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.getClusterNameById(ODatabaseDocumentTx.java:1260)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.readableClusters(OClassImpl.java:132)     at com.orientechnologies.orient.core.iterator.ORecordIteratorClass.&lt;init&gt;(ORecordIteratorClass.java:79)     at com.orientechnologies.orient.core.iterator.ORecordIteratorClass.&lt;init&gt;(ORecordIteratorClass.java:63)     at com.orientechnologies.orient.core.iterator.ORecordIteratorClass.&lt;init&gt;(ORecordIteratorClass.java:53)     at ORecordIteratorClassNullPointerExceptionTest.main(ORecordIteratorClassNullPointerExceptionTest.java:36)              */         }     } } ``` </body>
		<created>2016-02-03 03:00:42</created>
		<closed>2016-02-16 12:45:40</closed>
	</bug>
	<bug>
		<id>5676</id>
		<title>OrientGraphFactory.getNoTx keeps warning on IO errors</title>
		<body>The application uses OrientDB 2.1.8. I setup the connection pool with:  ``` java private OrientGraphFactory graphFactory = new OrientGraphFactory("remote:localhost/mydb", "admin", "admin").setupPool(1, 10) ```  Sometimes I request TX connections (`graphFactory.getTx()`) other times I need NOTX connections (`graphFactory.getNoTx()`).   When the application starts everything works as expected. If I don't use the application for a while (let's say a couple of hours) every time I get a NOTX connection I see the following warnings:  ``` 2016-02-02 23:19:06.312  WARN 99988 --- [io-8080-exec-10] c.o.orient.client.remote.OStorageRemote  : Caught I/O errors from Not connected (local socket=?), trying to reconnect (error: java.io.IOException: Channel is closed) 2016-02-02 23:19:06.315  WARN 99988 --- [io-8080-exec-10] c.o.orient.client.remote.OStorageRemote  : Connection re-acquired transparently after 3ms and 1 retries to server '127.0.0.1:2424/mydb': no errors will be thrown at application level ```  With TX connection I see the same warning only the first time a stale connection from the pool it's used. It seems that stale TX connections are correctly replaced but the same doesn't work if the connection is NOTX. </body>
		<created>2016-02-02 23:41:38</created>
		<closed>2016-08-18 09:37:58</closed>
	</bug>
	<bug>
		<id>5673</id>
		<title>Unique index problem in case of update</title>
		<body>In case of ORecordDuplicatedException during an update operation, the update operation is not reverted correctly. </body>
		<created>2016-02-02 11:49:29</created>
		<closed>2016-02-02 11:50:12</closed>
	</bug>
	<bug>
		<id>5671</id>
		<title>Method not working in select expressions</title>
		<body>Hi , I have a serious problem with 2.1.9 . I guess there is a sql parsing  bug in this release, that returns some missing in functionalities  for example :  `select '1'.asLong() + 1  as newID from E ` returns nothing in GratefulDeadConcerts DB . or when i working  on Link .include() method nothing returns . is there any idea ? </body>
		<created>2016-02-02 09:00:17</created>
		<closed>2016-05-28 09:55:37</closed>
	</bug>
	<bug>
		<id>5666</id>
		<title>collection [] method broken in 2.1.9 for ranges</title>
		<body>I've got these classes in my schema:  ``` create class hour extends V create class minute extends V create class tdindex extends V  create property hour.hour integer create property hour.minute linkmap minute  create property minute.index linkset tdindex  ```  When I query single values from 'hour' linkmap I get different 'minute' records than when I query ranges:  ```  orientdb {db=rawxp}&gt; select expand(minute[29]) from hour where hour=7     ----+-------+------+----- #   |@RID   |@CLASS|index ----+-------+------+----- 0   |#13:449|minute|[281] ----+-------+------+-----  1 item(s) found. Query executed in 0.002 sec(s). orientdb {db=rawxp}&gt; select expand(minute[30]) from hour where hour=7  ----+-------+------+----- #   |@RID   |@CLASS|index ----+-------+------+----- 0   |#13:450|minute|[289] ----+-------+------+-----  1 item(s) found. Query executed in 0.002 sec(s). orientdb {db=rawxp}&gt; select expand(minute[29-30]) from hour where hour=7  ----+-------+------+----- #   |@RID   |@CLASS|index ----+-------+------+----- 0   |#13:448|minute|[287] 1   |#13:451|minute|[283] ----+-------+------+-----  2 item(s) found. Query executed in 0.002 sec(s). ```  When I take a look at the records, #13:449 and #13:450 are the correct results that I'd expect for that last query.  Here's another query result:  ```  orientdb {db=rawxp}&gt; select expand(minute[29,30]) from hour where hour=7   ----+-------+------+----- #   |@RID   |@CLASS|index ----+-------+------+----- 0   |#13:449|minute|[281] 1   |#13:450|minute|[289] ----+-------+------+-----  2 item(s) found. Query executed in 0.023 sec(s). ```  That looks correct, so the comma operator appears to work ok.  Here's a link to a copy of the database that exhibits this bug: [https://drive.google.com/folderview?id=0B7gmW6cqkVoHWnNVMnhLaGJkYzA&amp;usp=sharing](url) (in both bz2 and gz compression). </body>
		<created>2016-02-01 15:54:13</created>
		<closed>2018-06-22 15:17:30</closed>
	</bug>
	<bug>
		<id>5665</id>
		<title>critical   error : no delection executed</title>
		<body>v2.1.9-SNAPSHOT  &lt;pre&gt;  delete from (select rid from  index:A.b_c where key =[#38:10,#33:96])  Delete record(s) '1' in 0,001000 sec(s).    select rid from   index:A.b_c where key =[#38:10,#33:96]                                 ----+------+------ #   |@CLASS|rid    ----+------+------ 0   |null  |#54:76 ----+------+------  &lt;/pre&gt; </body>
		<created>2016-02-01 13:10:05</created>
		<closed>2016-04-04 07:30:02</closed>
	</bug>
	<bug>
		<id>5664</id>
		<title>exception in number promotion or no existence of number type suffix for constants</title>
		<body>I was executing this command :   update #34:86 set last = max(91,ifnull(last,0))   where last is a long field.   this query gives a error   Error: java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Long  the error seams generated by 0 in ifnull or if .  Instead   update #34:86 set last = max(91,last)  is working   so i imagine that if consider 0 as integer and converting it to Long (argument of max) gives exception.  0l is not working, 0.asLong() is not working. </body>
		<created>2016-02-01 12:01:53</created>
		<closed>2016-02-01 14:35:33</closed>
	</bug>
	<bug>
		<id>5661</id>
		<title>Studio and creating databases with a space in the name</title>
		<body>Is it supposed to be possible to create database names with two words?   If yes, it doesn't work with Studio.  If no, the system should error out better.   Currently Studio goes about its business showing the new database (with a two word name), however, it is impossible to log into that database.   Scott </body>
		<created>2016-01-31 10:46:51</created>
		<closed>2016-02-03 14:40:08</closed>
	</bug>
	<bug>
		<id>5660</id>
		<title>Using partitioned graphs gives "restricted access" error on updating own edge</title>
		<body>I'm trying to use partitioned graphs instead of multiple databases (since want to setup a distributed database) to separate customer data. According to the docs, partitioned graphs is the recommended way.   However, I'm getting error when trying to create vertices and edges between them in the same transaction. Actually, I'm getting a "the resource has restricted access" even if I commit the transaction after creating the vertices and after that tries to add an edge between them. I'm using version 2.1.4.  I have updated the V and E and they both have "ORestricted" as superclass and created a user with "writer" Role using the following statement: `INSERT INTO ouser SET name = "user", status = 'ACTIVE', password = "password", roles = ( select @rid from ORole where name='writer' )`  I have already created the vertex types "Test1" and "Test2" extending V and the Edge type "Edge1" extending E.  First unit test (which is what I am doing in my application):  ```     @Test     public void testPartitionedGraphVertexEdgeInSameTx() throws Exception {         String url = "remote:localhost/partitionedgraph";         OPartitionedDatabasePool pool = new OPartitionedDatabasePool(url,                  "user", "password", 10);           OrientGraph graph = new OrientGraph(pool.acquire());         graph.setRequireTransaction(true);         Vertex v1, v2 = null;         Edge e = null;         try {             v1 = graph.addVertex("class:Test1");             v2 = graph.addVertex("class:Test2");             e = graph.addEdge(null, v1, v2, "Edge1");         } finally {             graph.commit();         }          graph.shutdown();         logger.debug("Edge created: " + e);     } ```  Throws the exception `com.orientechnologies.orient.core.exception.OSecurityException: Cannot update record #14:-4: the resource has restricted access`  Second unit test I created to try to work around this problem:  ```     @Test     public void testPartitionedGraphVertexEdgeCommitBetween() throws Exception {         String url = "remote:localhost/partitionedgraph";         OPartitionedDatabasePool pool = new OPartitionedDatabasePool(url,                 "user", "password", 10);           OrientGraph graph = new OrientGraph(pool.acquire());         graph.setRequireTransaction(true);         Vertex v1, v2 = null;         Edge e = null;         try {             v1 = graph.addVertex("class:Test1");             v2 = graph.addVertex("class:Test2");         } finally {             graph.commit();         }         try {             e = graph.addEdge(null, v1, v2, "Edge1");         } finally {             graph.commit();         }          logger.debug("Edge created: " + e);         graph.shutdown();     } ```  Throws the exception  `com.orientechnologies.orient.core.exception.OSecurityException: Cannot update record #13:16: the resource has restricted access`  I cannot see that I'm doing anything wrong here, at least not what I have found in the docs. This is a real showstopper for us. Assistance please! </body>
		<created>2016-01-31 09:55:42</created>
		<closed>2016-09-30 16:08:55</closed>
	</bug>
	<bug>
		<id>5659</id>
		<title>Issue importing database into 2.1.9</title>
		<body>Getting the following exception while trying to export from 2.1.2 and importing into 2.1.9.  Importing database schema...Error on importing schema com.orientechnologies.orient.core.exception.OSchemaException:  Class:'ORole' has  already class:'OIdentity' as superclass         at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addSuper ClassInternal(OClassImpl.java:506)         at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addSuper Class(OClassImpl.java:480)         at com.orientechnologies.orient.core.metadata.schema.OClassImpl.set(OCla ssImpl.java:1549) </body>
		<created>2016-01-31 06:47:59</created>
		<closed>2016-02-28 07:37:41</closed>
	</bug>
	<bug>
		<id>5657</id>
		<title>UNWIND returning empty resultset</title>
		<body>##### my local machine is running 2.1.9 (upgraded from 2.1.6). The following query returns empty results (In Studio and when using orientJS).  ``` SELECT   id,   out('posted_to').name as page FROM post  UNWIND   page ```  &lt;img width="1409" alt="screen shot 2016-01-29 at 7 13 24 pm" src="https://cloud.githubusercontent.com/assets/7966496/12692973/d0ebd3a0-c6bc-11e5-81cb-28dfc5e15a8a.png"&gt; ##### When I remove the 'UNWIND', i get data back, but the name field is an empty array.  &lt;img width="1393" alt="screen shot 2016-01-29 at 7 14 37 pm" src="https://cloud.githubusercontent.com/assets/7966496/12692981/e7a92d7c-c6bc-11e5-986e-0f24fda3842c.png"&gt; ##### I have tried the same query on a remote server (running 2.1.7) and it returns data correctly.  &lt;img width="1410" alt="screen shot 2016-01-29 at 7 12 53 pm" src="https://cloud.githubusercontent.com/assets/7966496/12692965/aaefeaa6-c6bc-11e5-96d1-71b5e8606a7f.png"&gt; </body>
		<created>2016-01-30 02:18:16</created>
		<closed>2016-02-01 12:03:38</closed>
	</bug>
	<bug>
		<id>5653</id>
		<title>distributed server in orientdb-community-2.1.9</title>
		<body>I am trying to set up a distributed server so my coworkers and I can share the same databases. I am using the orientdb-community-2.1.9 out of the box (no new databases or anything) and following the instructions: run dserver.sh on one of the nodes (zestar), scp the orientdb_community folder to another machine(empire), run dserver.sh on the second machine with dserver.sh still running on the first. For some reason the second machine thinks it's the first, so it's not adding itself as a new node. Everything 100% vanilla, no changes to hazelcast.xml or any of the other xml's in the config directory. When I go into orientdb-server-config.xml on the second machine and change the nodeName from zestar to empire (it was zestar because I scp'ed the whole orientdb_community) i get an error:  ``` ---------- [OHazelcastPlugin] 2016-01-28 11:33:25:077 INFO  [empire] Saving distributed configuration file for database 'GratefulDeadConcerts' to: /Users/ioana/Downloads/orientdb-community/databases/GratefulDeadConcerts/distributed-config.json [OHazelcastPlugin] 2016-01-28 11:33:25:087 INFO  [empire] found no previous messages in queue orientdb.node.empire.GratefulDeadConcerts.request [OHazelcastDistributedMessageService] 2016-01-28 11:33:25:566 INFO  [empire] Publishing online status for database empire.GratefulDeadConcerts... [OHazelcastDistributedDatabase] 2016-01-28 11:33:25:591 INFO  [empire] received new status empire.GratefulDeadConcerts=ONLINE [OHazelcastPlugin] 2016-01-28 11:33:25:595 INFO  [empire] class 'sung_by', creation of new local cluster 'sung_by_empire' (id=-1) [OHazelcastPlugin] 2016-01-28 11:33:25:719 SEVER [empire] error on creating cluster 'sung_by_empire' in class 'sung_by':  [OHazelcastPlugin][empire] Error on starting distributed plugin com.orientechnologies.orient.server.distributed.ODistributedException: Error on creating cluster 'sung_by_empire' in class 'sung_by'     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installLocalClusterPerClass(OHazelcastPlugin.java:1631)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installDbClustersForLocalNode(OHazelcastPlugin.java:1300)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.loadDistributedDatabases(OHazelcastPlugin.java:1441)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:187)     at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:979)     at com.orientechnologies.orient.server.OServer.activate(OServer.java:346)     at com.orientechnologies.orient.server.OServerMain.main(OServerMain.java:41) Caused by: com.orientechnologies.orient.server.distributed.ODistributedException: Quorum cannot be reached because there are no nodes available     at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.calculateQuorum(OHazelcastDistributedDatabase.java:369)     at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.send2Nodes(OHazelcastDistributedDatabase.java:119)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.sendRequest(OHazelcastPlugin.java:367)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.command(ODistributedStorage.java:333)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.addCluster(ODistributedStorage.java:1334)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.addCluster(ODatabaseDocumentTx.java:1291)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.createClusterIfNeeded(OClassImpl.java:2108)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addCluster(OClassImpl.java:1074)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installLocalClusterPerClass(OHazelcastPlugin.java:1624)     ... 6 more ```  I am running Darwin Kernel Version 15.3.0 RELEASE_X86_64 x86_64 on both computers.   Thank you in advance! </body>
		<created>2016-01-28 17:40:44</created>
		<closed>2016-04-23 09:53:32</closed>
	</bug>
	<bug>
		<id>5649</id>
		<title>question for new batch functionality (if block) - exception </title>
		<body>orientdb version: 2.1.9 i tried to use in console with script sql  if block but it gives a exception In documentation it is written available since 2.1.7 example   &lt;pre&gt; script sql                      [Started multi-line command. Type just 'end' to finish and execute] orientdb {db=a}&gt; let a = select  from 33:700 orientdb {db=a}&gt; if($a.size()&gt;0) {          orientdb {db=a}&gt; return 1; orientdb {db=a}&gt; } orientdb {db=a}&gt; end  Error: com.orientechnologies.orient.core.command.OCommandExecutorNotFoundException: Cannot find a command executor for the command request: sql.if($a.size()&gt;0) {;return 1;} &lt;/pre&gt; </body>
		<created>2016-01-28 10:13:17</created>
		<closed>2016-02-02 12:05:24</closed>
	</bug>
	<bug>
		<id>5643</id>
		<title>[2.2.0-beta] PLocal instance crashes randomly when opening a transaction</title>
		<body>Hello everyone,  we are making extensive use of the 2.2.0-beta version of OrientDB, in PLocal mode. We are quite happy with it, but there's one nasty bug that keeps popping up randomly (after about 30 minutes). The error occurs when a transaction is being opened. It's caused by a NullPointerException deep inside the OrientDB codebase. I had a look at the specific line, it appears that a Map-typed member variable is being accessed with "object.map.get(...)", but the map is null, for what reason I cannot tell.  Here's the stack trace:  ```    com.orientechnologies.orient.core.exception.ODatabaseException: Cannot open database url=plocal:/var/cache/tomcat/temp/graph/989590abeabe4e2e986038ac9515bc8a  at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:276) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getDatabase(OrientGraphFactory.java:132) ~[orientdb-graphdb-2.2.0-beta.jar:2.2.0-beta]  at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getDatabase(OrientGraphFactory.java:111) ~[orientdb-graphdb-2.2.0-beta.jar:2.2.0-beta]  at com.tinkerpop.blueprints.impls.orient.OrientGraphFactory.getTx(OrientGraphFactory.java:71) ~[orientdb-graphdb-2.2.0-beta.jar:2.2.0-beta]  // snip, parts of our server code  at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) [spring-context-4.1.6.RELEASE.jar:4.1.6.RELEASE]  at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81) [spring-context-4.1.6.RELEASE.jar:4.1.6.RELEASE]  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_45]  at java.util.concurrent.FutureTask.run(FutureTask.java:266) [na:1.8.0_45]  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_45]  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [na:1.8.0_45]  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_45]  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_45]  at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45]  Caused by: java.lang.NullPointerException: null  at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation$FileChanges.access$100(OAtomicOperation.java:454) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.storage.impl.local.paginated.atomicoperations.OAtomicOperation.getChangesTree(OAtomicOperation.java:181) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.getChangesTree(ODurableComponent.java:118) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.getEntries(OPaginatedCluster.java:1062) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.count(OAbstractPaginatedStorage.java:705) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.count(OAbstractPaginatedStorage.java:682) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.countClusterElements(ODatabaseDocumentTx.java:729) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.metadata.OMetadataDefault.load(OMetadataDefault.java:90) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.initAtFirstOpen(ODatabaseDocumentTx.java:2824) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta]  at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:254) ~[orientdb-core-2.2.0-beta.jar:2.2.0-beta] ... 17 common frames omitted ```  We hope that this helps.  Kind regards,  Alan </body>
		<created>2016-01-26 12:22:16</created>
		<closed>2017-01-30 21:37:28</closed>
	</bug>
	<bug>
		<id>5641</id>
		<title>SQL parse error when a semi-colon ";" is used in a property name.</title>
		<body>When a semi-colon `;` is used in a class property name, some functionality (SQL statements using that property name) are lost, throw errors.  This bug is easy to reproduce. **Warning: the only way to recover from this bug, back to normal, is to drop the class. You must use the web Studio, Browse tab, to enter your SQL statements.**  In any database, such as the demo greatfuldeadconcerts, create a new property with any name, rename that property to a new name with a `;` at the end of that new name. Now you are screwed because you have no way to refer to that property name even when using the escape character `\;` or with quotes around the property name. The parser doesn't ignore the escaped or quoted semi-colon and thinks it is the end of the SQL statement.  example SQL (must use the OrientDB Studio, Browse tab)  ``` sql CREATE PROPERTY V.test1 String ALTER PROPERTY V.test1 NAME messedup; //note the semi-colon on the end ```  ``` sql SELECT 'messedup;' FROM V  //error SELECT 'messedup\;' FROM V  //error SELECT messedup\; FROM V  //error ALTER PROPERTY V.'messedup;' NAME newName; //error DROP PROPERTY V.'messedup;' //error ```  Probably the same with CREATE CLASS but I don't dare try it because you won't be able to drop the class to recover from the bug.  I'm using OrientDB v2.1.9 </body>
		<created>2016-01-25 22:45:37</created>
		<closed>2016-05-18 16:34:48</closed>
	</bug>
	<bug>
		<id>5633</id>
		<title>Server throws OOM and crashes on heavy load</title>
		<body>I'm running orientdb standalone server on a machine with 64gb ram and 4g swap space. Database has more than 300 millions edges and around 70 million vertices. I'm running the server with following jvm options -XX:+UseG1GC -Xmx8g -Djna.nosys=true -XX:+HeapDumpOnOutOfMemoryError   -Dstorage.diskCache.bufferSize=30480 -Denvironment.dumpCfgAtStartup=true -Dindex.embeddedToSbtreeBonsaiThreshold=-1  -Dnetwork.maxConcurrentSessions=10000  I am connecting remotely to the server using java apis. For creating connections using the OrientGraphFactory with min and max pool size as 100 and 200. Each client performs insert/read/delete at around 10k qps(all combined). I have multiple such clients connecting to the server.   When qps is over 50k, the orientdb server crashes with Out of Memory(OOM) exception. Sample error  There is insufficient memory for the Java Runtime Environment to continue. # Native memory allocation (mmap) failed to map 12288 bytes for committing reserved memory.  Though there is enough ram available during the time of crash. Memory: 4k page, physical 66064704k(262280k free), swap 4194300k(4162808k free)  Please suggest how to fix this problem.  Attaching the heap dump files created after each crash.   [hs_err_pid597.txt](https://github.com/orientechnologies/orientdb/files/102371/hs_err_pid597.txt) [hs_err_pid31001.txt](https://github.com/orientechnologies/orientdb/files/102372/hs_err_pid31001.txt) [hs_err_pid47978.txt](https://github.com/orientechnologies/orientdb/files/102373/hs_err_pid47978.txt) </body>
		<created>2016-01-24 14:49:14</created>
		<closed>2016-03-11 15:38:14</closed>
	</bug>
	<bug>
		<id>5626</id>
		<title>error in lucene query (NumberFormatException)</title>
		<body>&lt;pre&gt; select expand(rid) from index:A.lucene1 where key LUCENE '(a:"ROME" and parent:"#38:9") and index:3'         Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select expand(rid) from index:A.lucene1 where key LUCENE   Error: java.lang.NumberFormatException: For input string: "(a:"ROME" and parent:"#38:9") and index:3"  &lt;/pre&gt;  same error if i replace 3 with [3 TO 3]  It seams the error is created when you create index with a numeric field </body>
		<created>2016-01-22 14:02:25</created>
		<closed>2016-01-30 10:53:49</closed>
	</bug>
	<bug>
		<id>5621</id>
		<title>Avoid System.exit on distributed plugin startup fatal error</title>
		<body>HzPlugin does a System.exit(1) if something goes wrong during startup.  Get rid o this and throw a RuntimeException instead. </body>
		<created>2016-01-21 10:59:57</created>
		<closed>2016-01-26 14:03:24</closed>
	</bug>
	<bug>
		<id>5614</id>
		<title>transaction blocked in java code when there is a binary node inside to delete</title>
		<body>considering the bug # 5613  there is another bug related to previous one  in my java code   i have a transaction deleting  a binary document A   and a document B with a link to A.   commit function block indefinitely the thread executing the code  specular  transaction for inserting /updating works well. The problems seams in delection.   </body>
		<created>2016-01-20 15:07:53</created>
		<closed>2016-05-19 03:09:13</closed>
	</bug>
	<bug>
		<id>5605</id>
		<title>DELETE EDGE not removing all identical lightweightEdges</title>
		<body>Two vertices, two identical edges between them, DELETE EDGE removes only one at a time. Initially I suspected LIMIT defaults to 1, but apparently that is not the case. This is only the case when _useLightweightEdges_ is enabled  ``` orientdb {db=test}&gt; ALTER DATABASE CUSTOM useLightweightEdges=true  Database updated successfully  orientdb {db=test}&gt; CREATE VERTEX V ; CREATE VERTEX V  Created vertex 'V#9:0 v1' Created vertex 'V#9:1 v1'  orientdb {db=test}&gt; CREATE EDGE E FROM #9:0 TO #9:1 ; CREATE EDGE E FROM #9:0 TO #9:1  Created edge '[E{in:#9:1,out:#9:0}]' Created edge '[E{in:#9:1,out:#9:0}]'  orientdb {db=test}&gt; DELETE EDGE FROM #9:0 TO #9:1 LIMIT 2  Delete record(s) '1'  orientdb {db=test}&gt; DELETE EDGE FROM #9:0 TO #9:1  Delete record(s) '1'  ``` </body>
		<created>2016-01-19 09:05:36</created>
		<closed>2016-02-04 17:28:37</closed>
	</bug>
	<bug>
		<id>5601</id>
		<title>can't clear intent in console with OrientDB 2.1.9</title>
		<body>According to the [online documentation](http://orientdb.com/docs/2.1/Console-Command-Declare-Intent.html), one should be able to clear a set intent at the console using DECLARE INTENT NULL. When I tried doing so with OrientDB 2.1.9, however, the following error occurred:  ``` Declaring intent 'NULL'... Error: java.lang.IllegalArgumentException: Intent 'null' not supported. Available ones are: massiveinsert, massiveread ``` </body>
		<created>2016-01-17 23:32:38</created>
		<closed>2016-02-04 17:28:38</closed>
	</bug>
	<bug>
		<id>5599</id>
		<title>How to fix illegal state in vertex field</title>
		<body>I am trying to delete old data from a graph database.  The command I use is this:  ``` orientdb {db=app}&gt; delete vertex RG where (out('HF') is null or in('BT') is null or out('LIA') is null or out(LIA').size() = 0) ```  And it works most of the times but some vertices seem to be corrupt:  ``` Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Error on execution of command: sql.select from `RG`  WHERE (out('HF') is null OR in('BT') is null OR out('LIA') is null OR out('LIA').size() = 0 )  Error: java.lang.IllegalStateException: Invalid content found in out_HF field ```  My issue is I can't seem to find a way to get rid of them. I can't remove the vertice since querying it causes an IllegalStateException. I reckon if I was able to somehow get a hold on the rid it would be possible to delete it, but I can't think of a way to get the rid.  Any pointers on how I can deal with the invalid content? </body>
		<created>2016-01-15 10:37:46</created>
		<closed>2016-01-15 14:25:12</closed>
	</bug>
	<bug>
		<id>5598</id>
		<title>NullPointerException on export and browse class on version 2.1.0</title>
		<body>I was running an export on a database and found error on when is trying to export class `user` and it happen when i try to `Browse class user` too. I'm running on OrientDB server version is 2.1.0  ``` - Cluster 'user' (id=11)..... java.lang.NullPointerException     at com.orientechnologies.orient.core.db.record.ORecordLazySet.add(ORecordLazySet.java:131)     at com.orientechnologies.orient.core.db.record.ORecordLazySet.add(ORecordLazySet.java:52)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.readLinkCollection(ORecordSerializerBinaryV0.java:451)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.readSingleValue(ORecordSerializerBinaryV0.java:348)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinaryV0.deserialize(ORecordSerializerBinaryV0.java:193)     at com.orientechnologies.orient.core.serialization.serializer.record.binary.ORecordSerializerBinary.fromStream(ORecordSerializerBinary.java:74)     at com.orientechnologies.orient.core.record.impl.ODocument.deserializeFields(ODocument.java:1774)     at com.orientechnologies.orient.core.record.impl.ODocument.checkForFields(ODocument.java:2354)     at com.orientechnologies.orient.core.record.impl.ODocument.fieldNames(ODocument.java:729)     at com.orientechnologies.orient.core.fetch.OFetchHelper.processRecord(OFetchHelper.java:289)     at com.orientechnologies.orient.core.fetch.OFetchHelper.fetch(OFetchHelper.java:82)     at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerJSON.toString(ORecordSerializerJSON.java:338)     at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerStringAbstract.toString(ORecordSerializerStringAbstract.java:666)     at com.orientechnologies.orient.core.record.ORecordAbstract.toJSON(ORecordAbstract.java:192)     at com.orientechnologies.orient.core.db.tool.ODatabaseExport.exportRecord(ODatabaseExport.java:573)     at com.orientechnologies.orient.core.db.tool.ODatabaseExport.exportRecords(ODatabaseExport.java:201)     at com.orientechnologies.orient.core.db.tool.ODatabaseExport.exportDatabase(ODatabaseExport.java:126)     at com.orientechnologies.orient.console.OConsoleDatabaseApp.exportDatabase(OConsoleDatabaseApp.java:1803)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:606)     at com.orientechnologies.common.console.OConsoleApplication.execute(OConsoleApplication.java:392)     at com.orientechnologies.common.console.OConsoleApplication.executeCommands(OConsoleApplication.java:253)     at com.orientechnologies.common.console.OConsoleApplication.run(OConsoleApplication.java:142)     at com.orientechnologies.orient.graph.console.OGremlinConsole.main(OGremlinConsole.java:64) ```  **Browse Class User**  ```  browse class user  Error: java.lang.NullPointerException ``` </body>
		<created>2016-01-15 03:32:40</created>
		<closed>2016-02-24 23:53:19</closed>
	</bug>
	<bug>
		<id>5592</id>
		<title>ETL test NPE</title>
		<body>``` code orientechnologies.orient.etl.transformer.OFlowTransformerTest Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.112 sec - in com.orientechnologies.orient.etl.transformer.OFlowTransformerTest Running com.orientechnologies.orient.etl.extractor.OJsonRandomExtractorTest Exception in thread "OrientDB ETL pipeline-1" java.lang.NullPointerException     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.getOrCreateClass(OOrientDBLoader.java:512)     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.init(OOrientDBLoader.java:410)     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.begin(OOrientDBLoader.java:305)     at com.orientechnologies.orient.etl.OETLPipeline.begin(OETLPipeline.java:66)     at com.orientechnologies.orient.etl.OETLProcessor$2.run(OETLProcessor.java:326)     at java.lang.Thread.run(Thread.java:745) Exception in thread "OrientDB ETL pipeline-2" java.lang.NullPointerException     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.getOrCreateClass(OOrientDBLoader.java:512)     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.init(OOrientDBLoader.java:410)     at com.orientechnologies.orient.etl.loader.OOrientDBLoader.begin(OOrientDBLoader.java:305)     at com.orientechnologies.orient.etl.OETLPipeline.begin(OETLPipeline.java:66)     at com.orientechnologies.orient.etl.OETLProcessor$2.run(OETLProcessor.java:326)     at java.lang.Thread.run(Thread.java:745) Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 12.141 sec - in com.orientechnologies.orient.etl.extractor.OJsonRandomExtractorTest Running com.orientechnologies.orient.etl.extractor.OJsonExtractorTest Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.062 sec - in com.orientechnologies.orient.etl.extractor.OJsonExtractorTest Running com.orientechnologies.orient.etl.extractor.OCSVExtractorTest Tests run: 31, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.458 sec - in com.orientechnologies.orient.etl.extractor.OCSVExtractorTest Running com.orientechnologies.orient.etl.OETLProcessorTest Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.97 sec - in com.orientechnologies.orient.etl.OETLProcessorTest Running com.orientechnologies.orient.etl.loader.OOrientDBLoaderTest ``` </body>
		<created>2016-01-12 20:57:58</created>
		<closed>2016-01-26 14:02:59</closed>
	</bug>
	<bug>
		<id>5591</id>
		<title>Can't migrate database from DB 2.1.5 to 2.1.9</title>
		<body>I copied database files from 2.1.5 to 2.1.9 and when I tried to open it I received the following error:  2016-01-12 11:37:26:773 SEVER Internal server error: com.orientechnologies.common.exception.OException: Error on creation of shared resource --&gt; com.orientechnologies.orient.core.exception.OSchemaException: Duplicate superclass:'OIdentity' [ONetworkProtocolHttpDb]  In DB version 2.1.7 there was no problem.  Info: I'm not sure if it is related to the problem, but analyzed the OIdentity class, which contains documents both for the REST API [OUser] and for the Binary API [ORole](since we use both), so the user names are duplicated. </body>
		<created>2016-01-12 10:58:58</created>
		<closed>2016-01-12 12:12:50</closed>
	</bug>
	<bug>
		<id>5590</id>
		<title>Failed to create Class property results in property created.</title>
		<body>Having the following snippet:  ``` SQL CREATE CLASS Test CREATE CLASS TestMap CREATE PROPERTY Test.map LINKMAP String ```  Will result in the following exception on the last line:  **com.orientechnologies.orient.core.exception.OSchemaException: Linked type is not supported for type: LINKMAP**  This is because string is not a supported linked type. And this is correct.  After this, if I try to recreate the property using the correct type **TestMap**, i get this:  **com.orientechnologies.orient.core.exception.OCommandExecutionException: Property 'Test.map' already exists. Remove it before to retry.**  This is because the first creation of the **map** property on the class **Test** ( even if it raised the exception above) resulted in the creation of an "empty" map property.  The following screenshot demonstrates this behaviour:  ![image](https://cloud.githubusercontent.com/assets/2829667/12259892/e886c166-b918-11e5-9a6d-2c0e6ca12466.png)  Regards </body>
		<created>2016-01-12 09:41:51</created>
		<closed>2016-01-13 14:41:00</closed>
	</bug>
	<bug>
		<id>5589</id>
		<title>A query gets a parsing error with LIMIT statement</title>
		<body>Hi,  I am migrating from version 1.7.8 to version 2.1.8, the SQL below does not working any more  ``` SQL SELECT eval('$TotalListsQuery[0].Count') AS TotalLists    LET $TotalListsQuery = ( SELECT Count(1) AS Count FROM ContactList WHERE Account=#20:1 AND EntityInfo.State=0)  LIMIT 1 ```  It is working if remove "LIMIT 1"  My Best, Hung Tran </body>
		<created>2016-01-12 09:36:26</created>
		<closed>2016-01-15 11:36:16</closed>
	</bug>
	<bug>
		<id>5587</id>
		<title>LinkMap Key inconsistency between insert and select</title>
		<body>The Linkmap type supports key range lookups by writing queries like  ``` SQL SELECT map["1-10"] from X ```  But what if the key itself is "1-10"? this force us to convert all minus sign in our map's key to underscore  to avoid this behaviour.    If the key is "A-1" then the query will result in a NumberFormatException because "A" it's not a number  The following snippet rises the exception  ``` SQL CREATE CLASS Test; CREATE CLASS TestMap; CREATE PROPERTY Test.map LINKMAP TestMap;  INSERT INTO TestMap (name) VALUES ('ciao'); INSERT INTO Test (map) VALUES ({'A-1': &lt;#RID of the previous record&gt;}); SELECT map['A-1'] FROM Test; ```  the last line results in: **java.lang.NumberFormatException: For input string: "A"**  Would it be better if the parser could do **exact key match** if the key is between quotes  and perform **range queries** if the map key is not between quotes?  Ex  ``` SQL SELECT map["A-1"] from X ```  For an exact key match or:  ``` SQL SELECT map[1-3] from X ```  for a key range lookup? (This could be linked also to #5588)  Regards </body>
		<created>2016-01-12 08:08:21</created>
		<closed>2018-06-22 15:10:40</closed>
	</bug>
	<bug>
		<id>5586</id>
		<title>ArrayIndexOutOfBoundsException on dropVertexType/dropClass</title>
		<body>I have a test that is failing after an upgrade from 2.0.9 to 2.1.9.  On the Java client I am getting:  ``` com.companyname.persistence.exception.PersistenceException: java.lang.ArrayIndexOutOfBoundsException     at java.lang.System.arraycopy(Native Method)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.removePolymorphicClusterId(OClassImpl.java:2425)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.removePolymorphicClusterId(OClassImpl.java:2431)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.removePolymorphicClusterId(OClassImpl.java:2431)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.removePolymorphicClusterIds(OClassImpl.java:2416)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.removeBaseClassInternal(OClassImpl.java:1182)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.dropClassInternal(OSchemaShared.java:1167)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.dropClass(OSchemaShared.java:551)     at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.dropClass(OSchemaProxy.java:156)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$6.call(OrientBaseGraph.java:1357)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph$6.call(OrientBaseGraph.java:1354)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.executeOutsideTx(OrientBaseGraph.java:1782)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.dropVertexType(OrientBaseGraph.java:1354) ```  Using 2.0.9 of the client library (orientdb-graphdb and orientdb-client) does not have this issue.  Tinkerpop (blueprints-core) is at 2.6.0 for both.  This is from a unit test running in a memory database. </body>
		<created>2016-01-11 21:09:42</created>
		<closed>2016-02-15 16:53:51</closed>
	</bug>
	<bug>
		<id>5583</id>
		<title>LinkMap Key misbehaving when contains "]"</title>
		<body>Hello Orient Team,  We are using OrientDB V 2.1.7  We have a structure similar to the one described in [Time Series](http://orientdb.com/docs/2.1/Time-series-use-case.html).  We recently have had problems with the key of one of our linkmaps. it seems like the character "_]_" is not supported inside map's key.  We have a very "bad" key like [123_abc_#1239#1___'0571234'512354128|||] .  We have no problem in adding it to the map, but we do have problems while retrieving its value.  A Simple   ``` SQL SELECT code["[123_abc_#1239#1___'0571234'512354128|||]"] from TransitsCode ```  Returns nothing: ![image](https://cloud.githubusercontent.com/assets/2829667/12236631/45924220-b87b-11e5-8fb7-9ffdc82294bc.png)  And also the count is wrong  Actually, the returning count is as I would have run   ``` SQL SELECT from TransitsCode ```  If I try to insert in the map a key like [123_abc_#1239#1___'0571234'512354128||| (without the ending closed square bracket ) then the query works properly.  Any ideas?  It seems like the closed square bracket breaks the SQL Parser.  Our workaround is to convert our map key to HEX to avoid this issue, but this increases dramatically the difficulty of writing queries by hand (in the studio, for instance).   Regards </body>
		<created>2016-01-11 15:03:29</created>
		<closed>2016-06-09 15:14:39</closed>
	</bug>
	<bug>
		<id>5581</id>
		<title>Tons of warning "Maximum amount of pinned pages is reached , given page..."</title>
		<body>Logs are full of these messages. In a client's log I found thousands of it. See below. Can we: - understand why pinned pages are over and new are needed? - disable the message after the first time  Log snippet:  ``` 2015-12-09 09:35:44:012 WARNI {db=beeyond} Maximum amount of pinned pages is reached , given page OReadCacheEntry{fileId=5968942061020256167, pageIndex=0, dataPointer=OCachePointer{referrersCount=1, usagesCount=0, dataPointer=com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer@1be20981}, dirty=false, usagesCount=1} will not be marked as pinned which may lead to performance degradation. You may consider to increase percent of pined pages by changing of property storage.diskCache.pinnedPages [O2QCache] 2015-12-09 09:35:44:014 WARNI {db=beeyond} Maximum amount of pinned pages is reached , given page OReadCacheEntry{fileId=5968942061020256169, pageIndex=0, dataPointer=OCachePointer{referrersCount=1, usagesCount=0, dataPointer=com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer@1be309a1}, dirty=false, usagesCount=1} will not be marked as pinned which may lead to performance degradation. You may consider to increase percent of pined pages by changing of property storage.diskCache.pinnedPages [O2QCache] 2015-12-09 09:35:44:015 WARNI {db=beeyond} Maximum amount of pinned pages is reached , given page OReadCacheEntry{fileId=5968942061020256171, pageIndex=0, dataPointer=OCachePointer{referrersCount=1, usagesCount=0, dataPointer=com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer@1be409c1}, dirty=false, usagesCount=1} will not be marked as pinned which may lead to performance degradation. You may consider to increase percent of pined pages by changing of property storage.diskCache.pinnedPages [O2QCache] 2015-12-09 09:35:44:016 WARNI {db=beeyond} Maximum amount of pinned pages is reached , given page OReadCacheEntry{fileId=5968942061020256173, pageIndex=0, dataPointer=OCachePointer{referrersCount=1, usagesCount=0, dataPointer=com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer@1be509e1}, dirty=false, usagesCount=1} will not be marked as pinned which may lead to performance degradation. You may consider to increase percent of pined pages by changing of property storage.diskCache.pinnedPages [O2QCache] ``` </body>
		<created>2016-01-11 10:48:16</created>
		<closed>2017-06-15 09:38:17</closed>
	</bug>
	<bug>
		<id>5580</id>
		<title>Console: ROLLBACK not working</title>
		<body>``` orientdb {db=test}&gt; BEGIN;CREATE VERTEX V;COMMIT  Transaction 1 is running Created vertex 'V#9:3 v1' in 0.008000 sec(s). Transaction 1 has been committed in 0ms ```  ``` orientdb {db=test}&gt; BEGIN;CREATE VERTEX V;ROLLBACK  Transaction 2 is running Created vertex 'V#9:4 v1' in 0.005000 sec(s). Transaction 2 has been rollbacked in 2ms ```  ``` orientdb {db=test}&gt; SELECT FROM V  ----+----+------ #   |@RID|@CLASS ----+----+------ 0   |#9:3|V 1   |#9:4|V ----+----+------  2 item(s) found. Query executed in 0.004 sec(s). ```  ``` orientdb {db=test}&gt; BEGIN;DELETE VERTEX #9:4;ROLLBACK  Transaction 4 is running Delete record(s) '1' in 0.006000 sec(s). Transaction 4 has been rollbacked in 0ms ```  ``` orientdb {db=test}&gt; SELECT FROM #9:4  0 item(s) found. Query executed in 0.003 sec(s). ``` </body>
		<created>2016-01-11 10:15:49</created>
		<closed>2016-05-23 15:08:50</closed>
	</bug>
	<bug>
		<id>5579</id>
		<title>'Cannot serialize record' over 'ONetworkProtocolBinary': 'Error on unmarshalling record'</title>
		<body>Some queries that I am running via pyorient (python driver via the binary protocal) are causing the error below in the server console (the error is happening in orientdb, not pyorient). I can reproduce this with the following clean database and orientdb version 2.1.9.  ``` create Vertex V create Vertex V create Edge E from #9:0 to #9:1 ```  Performing the following query via pyorient causes the error in the server console seen at the bottom.   ``` SELECT expand(unionall($foo, $bar)) LET $foo = (SELECT *, $bar as bar FROM #9:0 LET $bar = (SELECT expand(out('E')) FROM $current)), $bar = (SELECT *, $baz as baz FROM (select expand(bar) from $foo) LET $baz = (SELECT expand(in('E')) FROM $current)) ```  Note this query runs fine in Studio, and in fact it works via pyorient if you `expand($foo)` or `expand($bar)` instead of `expand(unionall($foo, $bar))`.  ``` 2016-01-11 13:25:48:156 WARNI {db=gittest} Cannot serialize record: V#9:1{in_:[#9:0],baz:[1]} v2 [ONetworkProtocolBinary]{db=gittest} Error on unmarshalling record #9:1 (com.orientechnologies.orient.c ore.exception.ODatabaseException: Impossible save a record during network serialization) com.orientechnologies.orient.core.exception.ODatabaseException: Impossible save a record during network serialization         at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerCSVAbstract.linkToStream(ORecordSerializerCSVAbstract.java:125)         at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerCSVAbstract.fieldToStream(ORecordSerializerCSVAbstract.java:418)         at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerSchemaAware2CSV.toString(ORecordSerializerSchemaAware2CSV.java:506)         at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerStringAbstract.toStream(ORecordSerializerStringAbstract.java:689)         at com.orientechnologies.orient.core.serialization.serializer.record.string.ORecordSerializerSchemaAware2CSV.toStream(ORecordSerializerSchemaAware2CSV.java:268)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:2290)         at com.orientechnologies.orient.core.record.impl.ODocument.toStream(ODocument.java:671)         at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.getRecordBytes(OBinaryNetworkProtocolAbstract.java:432)         at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.writeRecord(OBinaryNetworkProtocolAbstract.java:451)         at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.writeIdentifiable(OBinaryNetworkProtocolAbstract.java:141)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.serializeValue(ONetworkProtocolBinary.java:1393)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1341)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)         at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ``` </body>
		<created>2016-01-11 05:44:41</created>
		<closed>2016-10-03 13:54:31</closed>
	</bug>
	<bug>
		<id>5576</id>
		<title>DELETE: multiple vertices</title>
		<body>How has https://github.com/orientechnologies/orientdb/issues/3177 been solved?  ``` orientdb {db=test}&gt; DELETE VERTEX [#13:2, #13:3] ```  &gt; Error: com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Class '[#13:2, #13:3]' was not found  ``` orientdb {db=test}&gt; DELETE VERTEX FROM [#13:2, #13:3] ```  &gt; Error: com.orientechnologies.orient.core.command.OCommandExecutorNotFoundException: Cannot find a command executor for the command request: sql.  ``` orientdb {db=test}&gt; DELETE VERTEX FROM (SELECT FROM [#13:2, #13:3]) ```  &gt; Delete record(s) '2' in 0.015000 sec(s). </body>
		<created>2016-01-10 20:29:06</created>
		<closed>2018-06-22 15:09:13</closed>
	</bug>
	<bug>
		<id>5573</id>
		<title>A Sub-query in FROM clause does not work any more</title>
		<body>Hi,  I am migrating from version 1.7.8 to version 2.1.8, I get an error with such query in version 2.1.8  ``` SQL SELECT referredBy.size() FROM (FIND REFERENCES #15:4) ```  the error is  ``` Java com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Error parsing query: SELECT referredBy.size() FROM (FIND REFERENCES #15:4) Encountered " &lt;FROM&gt; "FROM "" at line 1, column 26.  Was expecting one of:  &lt;EOF&gt;   &lt;TIMEOUT&gt; ...  &lt;AS&gt; ...  &lt;FETCHPLAN&gt; ...  &lt;LOCK&gt; ...  &lt;LET&gt; ...  &lt;NOCACHE&gt; ...  &lt;PARALLEL&gt; ...  &lt;UNWIND&gt; ...  ";" ...  "," ...  &lt;AS&gt; ...  "," ... ```  Remarks, the query is only working if strictSQL is unset. What's the correct syntax in this case when strictSQL is set?  My Best, Hung Tran </body>
		<created>2016-01-08 18:00:07</created>
		<closed>2016-01-12 14:49:09</closed>
	</bug>
	<bug>
		<id>5572</id>
		<title>Cannot use + or append() for string operations in naming parameters</title>
		<body>Hi,  I am migrating from version 1.7.8 to version 2.1.8, I get an error with such query in version 2.1.8  ``` SQL select from User where Account.Name like :name + '%' ```  it's also getting same error with  ``` SQL select from User where Account.Name like :name.append('%') ```  it's only working with this  ``` SQL select from User where Account.Name like :name ```  Remarks, all style queries are working if strictSql is unset, what's the correct syntax in this case when strictSQL is set?  My Best, Hung Tran </body>
		<created>2016-01-08 17:45:29</created>
		<closed>2016-05-25 10:02:17</closed>
	</bug>
	<bug>
		<id>5570</id>
		<title>SIGTERM issue</title>
		<body>Here is a summary: We have 10 nodes running OrientDB 2.1.7. One of them runs the Workbench. All nodes were restarted on 12/30. However, on 12/31, 7 nodes running the server were down automatically. The trigger of the shutdown was a SIGTERM signal, according to the log. Any idea where that signal was from?  Later that day:  This morning I logged on the Workbench, only node 1 and 9 were still running. Other nodes went offline on 12/31 for some reason and the connections were not restored automatically. Will check the log on these servers and see what was going on. FYI.  Seems the OS killed the JVM. This can happen when the process goes out of memory (and no swap is configured).   Hi found Luigi's email a few a weeks ago about this problem: "This could have happened for an OutOfMemory, from the logs I see you have a quite small heap memory. Probably increasing it to at least 1GB will help (please ignore the hints in the logs, sometimes they are definitely misleading)"  Did you change the RAM settings?  5.1.15 Response:  I checked the log file on the server. It shows the heap size was 910MB (see below) when OrientDB was started. It is not exactly 1GB but close to that. Can that be the cause of the issue? Please let me know.  2015-12-30 17:42:25:812 INFO  OrientDB auto-config DISKCACHE=3,407MB (heap=910MB os=15,947MB disk=6,814MB) [orientechnologies] 2015-12-30 17:42:25:813 SEVER Can not change cache size in runtime because storage engine plocal was not registered [OGlobalConfiguration$1] 2015-12-30 17:42:25:938 INFO  Loading configuration from: /opt/orientdb-enterprise-2.1.7/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml] 2015-12-30 17:42:26:113 INFO  OrientDB Server v2.1.7 (build 2.1.x@r; 2015-12-08 16:49:51+0000) is starting up... [OServer] 2015-12-30 17:42:26:119 INFO  Databases directory: /opt/orientdb-enterprise-2.1.7/databases [OServer] 2015-12-30 17:42:26:149 INFO  Listening binary connections on 0.0.0.0:2424 (protocol v.32, socket=default) [OServerNetworkListener] 2015-12-30 17:42:26:153 INFO  Listening http connections on 0.0.0.0:2480 (protocol v.10, socket=default) [OServerNetworkListener] 2015-12-30 17:42:26:166 INFO  Installing dynamic plugin 'studio-2.1.zip'... [OServerPluginManager] 2015-12-30 17:42:26:228 INFO  Installing dynamic plugin 'agent-2.1.7.zip'... [OServerPluginManager] 2015-12-30 17:42:26:246 INFO  Profiler is recording metrics with configuration: 60,24 [OEnterpriseProfiler] 2015-12-30 17:42:26:279 INFO  Installing GREMLIN language v.2.6.0 - graph.pool.max=50 [OGraphServerHandler] 2015-12-30 17:42:26:359 INFO  Configuring Hazelcast from '/opt/orientdb-enterprise-2.1.7/config/hazelcast.xml'. [FileSystemXmlConfig] 2015-12-30 17:42:26:449 WARNI Name of the hazelcast schema location incorrect using default [AbstractXmlConfigHelper] 2015-12-30 17:42:26:807 INFO  [LOCAL] [orientdb] [3.5.3] Interfaces is disabled, trying to pick one address from TCP-IP config addresses: [10.16.145.39, 10.1 6.145.114, 10.16.145.48, 10.16.145.109, 10.16.144.209, 10.16.144.208, 10.16.144.207, 10.16.144.206, 10.16.145.108] [DefaultAddressPicker] 2015-12-30 17:42:26:808 INFO  [LOCAL] [orientdb] [3.5.3] Prefer IPv4 stack is true. [DefaultAddressPicker] 2015-12-30 17:42:26:815 INFO  [LOCAL] [orientdb] [3.5.3] Picked Address[10.16.144.207]:2434, using socket ServerSocket[addr=/0:0:0:0:0:0:0:0,localport=2434], bind any local is true [DefaultAddressPicker] 2015-12-30 17:42:27:025 INFO  [10.16.144.207]:2434 [orientdb] [3.5.3] Backpressure is disabled [OperationService] 2015-12-30 17:42:27:038 INFO  [10.16.144.207]:2434 [orientdb] [3.5.3] Starting with 2 generic operation threads and 4 partition operation threads. [ClassicOp erationExecutor] 2015-12-30 17:42:27:389 INFO  [10.16.144.207]:2434 [orientdb] [3.5.3] Hazelcast 3.5.3 (20151011 - 64c663a) starting at Address[10.16.144.207]:2434 [system] 2015-12-30 17:42:27:389 INFO  [10.16.144.207]:2434 [orientdb] [3.5.3] Copyright (c) 2008-2015, Hazelcast, Inc. All Rights Reserved. [system] 2015-12-30 17:42:27:389 INFO  [10.16.144.207]:2434 [orientdb] [3.5.3] Creating TcpIpJoiner [Node] 2015-12-30 17:42:27:391 INFO  [10.16.144.207]:2434 [orientdb] [3.5.3] Address[10.16.144.207]:2434 is STARTING [LifecycleService]  8.1.2015 LucaG responds:  The OS that is running OrientDB has any SWAP space configured? I see on your HD only 6,814MB are available, could it be the OS is running out of space? </body>
		<created>2016-01-08 10:00:38</created>
		<closed>2016-01-21 12:13:16</closed>
	</bug>
	<bug>
		<id>5564</id>
		<title>UPDATE CONTENT adding ORestricted properties</title>
		<body>**UPDATE CONTENT** seems to be adding record security properties to records even when the target records do not belong to the ORestricted class.  ``` orientdb {db=test}&gt; CREATE VERTEX V Created vertex 'V#9:0 v1' in 0.013000 sec(s).  orientdb {db=test}&gt; UPDATE #9:0 MERGE {"a":1} Updated record(s) '1' in 0.003000 sec(s).  orientdb {db=test}&gt; SELECT FROM #9:0 ----+----+------+---- #   |@RID|@CLASS|a ----+----+------+---- 0   |#9:0|V     |1 ----+----+------+----  orientdb {db=test}&gt; UPDATE #9:0 CONTENT {"a":2} Updated record(s) '1' in 0.007000 sec(s).  orientdb {db=test}&gt; SELECT FROM #9:1 ----+----+------+----+------------+------------+----------+------ #   |@RID|@CLASS|a   |_allowUpdate|_allowDelete|_allowRead|_allow ----+----+------+----+------------+------------+----------+------ 0   |#9:0|V     |2   |null        |null        |null      |null ----+----+------+----+------------+------------+----------+------ ```  Version: OrientDB Server v2.1.8 (build 2.1.x@r; 2015-12-17 10:18:05+0000) </body>
		<created>2016-01-07 14:56:15</created>
		<closed>2016-05-25 09:55:32</closed>
	</bug>
	<bug>
		<id>5563</id>
		<title>Opening Document Database in Windows with UNC path is not working</title>
		<body>Version 2.1.8 GA. Following program in Windows gives an Exception:  ``` java public class UNCTest {   public static void main(String[] args)   {     String url = "plocal:\\\\srv\\db\\Database";     ODatabaseDocumentTx db = null;      try     {       db = new ODatabaseDocumentTx(url).open("admin", "admin");       System.out.println("Database is opened");     }     finally     {       if(db != null)         db.close();     }   } } ```  Changing URL to the Unix style "plocal://srv/db/Database" doesn't help.  It seems that special handling for Windows inside of the `loadStorage()` function comes too early. </body>
		<created>2016-01-07 09:36:31</created>
		<closed>2016-03-21 14:56:42</closed>
	</bug>
	<bug>
		<id>5560</id>
		<title>JPA - Problem with register class</title>
		<body>Hey there,  I try to use orientDb with jpa. So far the most things work out. But I have one Pojo which is named "System". I tried both ways the register the entity (like http://orientdb.com/docs/2.1/JPA-Configuration.html) and used the complete package name of the class. But both times orientDb says:  com.orientechnologies.orient.core.exception.OSerializationException: Type system cannot be serialized because is not part of registered entities. To fix this error register this class  When I rename the class everything works fine. Is it forbidden to use a Pojo with the name "system"? </body>
		<created>2016-01-06 16:13:21</created>
		<closed>2016-06-09 12:31:11</closed>
	</bug>
	<bug>
		<id>5554</id>
		<title>orientdb-workbench-2.1.6 cannot started</title>
		<body>When i tried to start a workbench 2.1.6 it show these error. Any help please.  2559-01-05 16:42:32:955 INFO  OrientDB auto-config DISKCACHE=4,302MB (heap=1,815MB os=8,166MB disk=8,237MB) [orientechnologies] 2559-01-05 16:42:33:028 INFO  Loading configuration from: D:/orientdb-workbench-2.1.6/config/workbench-config.xml... [OServerConfigurationLoaderXml] 2559-01-05 16:42:33:185 INFO  OrientDB Server v2.1.6 (build @BUILD@) is starting up... [OServer] 2559-01-05 16:42:33:189 INFO  Databases directory: D:\orientdb-workbench-2.1.6\databases [OServer] 2559-01-05 16:42:33:203 INFO  Listening http connections on 0.0.0.0:2491 (protocol v.10, socket=default) [OServerNetworkListener] 2559-01-05 16:42:33:208 INFO  Installing dynamic plugin 'orientdb-workbench.jar'... [OServerPluginManager]Error on installing dynamic plugin 'workbench' java.lang.reflect.InvocationTargetException     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:497)     at com.orientechnologies.orient.server.plugin.OServerPluginManager.startPluginClass(OServerPluginManager.java:272)     at com.orientechnologies.orient.server.plugin.OServerPluginManager.installDynamicPlugin(OServerPluginManager.java:352)     at com.orientechnologies.orient.server.plugin.OServerPluginManager.updatePlugin(OServerPluginManager.java:202)     at com.orientechnologies.orient.server.plugin.OServerPluginManager.updatePlugins(OServerPluginManager.java:292)     at com.orientechnologies.orient.server.plugin.OServerPluginManager.startup(OServerPluginManager.java:93)     at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:939)     at com.orientechnologies.orient.server.OServer.activate(OServer.java:346)     at com.orientechnologies.orient.server.OServerMain.main(OServerMain.java:41) Caused by: com.orientechnologies.orient.core.exception.OSecurityAccessException: User or password not valid for database: 'monitor'     at com.orientechnologies.orient.core.metadata.security.OSecurityShared.authenticate(OSecurityShared.java:165)     at com.orientechnologies.orient.core.metadata.security.OSecurityProxy.authenticate(OSecurityProxy.java:87)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:268)     at com.orientechnologies.workbench.OWorkbenchPlugin.loadConfiguration(OWorkbenchPlugin.java:294)     at com.orientechnologies.workbench.OWorkbenchPlugin.startup(OWorkbenchPlugin.java:133)     ... 12 more  Thanks in advance, Anurak </body>
		<created>2016-01-05 09:52:59</created>
		<closed>2016-05-26 21:18:33</closed>
	</bug>
	<bug>
		<id>5543</id>
		<title>java.lang.IllegalArgumentException: Cluster 1018 is null [ONetworkProtocolHttpDb]</title>
		<body>2015-12-31 18:56:58:876 SEVER Internal server error: java.lang.IllegalArgumentException: Cluster 1018 is null [ONetworkProtocolHttpDb]  After DB restart this happens every time (only cluster ID is different). I have over 1000 clusters related to single class.  Tested with: - 2.1.8 - 1.7.9 </body>
		<created>2015-12-31 15:59:54</created>
		<closed>2016-08-27 19:18:00</closed>
	</bug>
	<bug>
		<id>5541</id>
		<title>OSBTreeIndexEngine#OSBTreeIndexCursor does not use nextEntry properly</title>
		<body>I am trying to use an iterator over entries in an ODictionary. Small test class looks like this:  ``` java public class OrientDBTesting {     public static void main(String[] args) {         ODatabaseDocumentTx db = new ODatabaseDocumentTx("memory:test").create();         ODictionary dictionary = db.getDictionary();          dictionary.put("user0", new ODocument());         dictionary.put("user1", new ODocument());         dictionary.put("user2", new ODocument());          OIndexCursor entries = dictionary.getIndex().iterateEntriesMajor("user0", true, true);         while (entries.hasNext()) {             System.out.println(entries.nextEntry().getKey());         }     } } ```  I'm using this dependency through Maven:  ``` xml &lt;dependency&gt;     &lt;groupId&gt;com.orientechnologies&lt;/groupId&gt;     &lt;artifactId&gt;orientdb-client&lt;/artifactId&gt;     &lt;version&gt;2.1.8&lt;/version&gt; &lt;/dependency&gt; ```  The output looks like this:  ``` Dec 30, 2015 1:55:44 PM com.orientechnologies.common.log.OLogManager log INFO: OrientDB auto-config DISKCACHE=10,695MB (heap=3,641MB os=16,384MB disk=62,946MB) user1 user2 Exception in thread "main" java.lang.NullPointerException     at com.kruth.orientdb.OrientDBTesting.main(OrientDBTesting.java:22)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:606)     at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) ```  There seems to be two issues here: 1. The iterator doesn't start at 'user0'. 2. The iterator runs into nulls at the end instead of ending properly.  From what I can see, both issues stem from OSBTreeIndexEngine#OSBTreeIndexCursor not using `nextEntry`. This class extends OIndexAbstractCursor which maintains iterator state with `nextEntry` as you can see here: https://github.com/orientechnologies/orientdb/blob/master/core/src/main/java/com/orientechnologies/orient/core/index/OIndexAbstractCursor.java#L80-L100. So, OSBTreeIndexEngine#OSBTreeIndexCursor should use nextEntry also, or potentially override hasNext() and next().  I did not look to see if any of the other OIndexCursor implementations have the same issue. </body>
		<created>2015-12-30 20:11:11</created>
		<closed>2016-01-28 14:32:58</closed>
	</bug>
	<bug>
		<id>5537</id>
		<title>[Proposal] Don't allow to create an entity (class, class's field) if its name consists of one of the keywords</title>
		<body>Hi there. I'm using the latest version of OrientDB at the moment (2.1.8). The problem I've just run into is that you can create for example a class with the Orient studio which name would be `Cluster`.  Later, if you try to perform a simple query like `select from Cluster` it'll blow up with an exception which is not very informative. There's the same problem with property creation. You can create a class property named `cluster`, for example. If you try to query an entity like so:  `select from Entity where cluster = "something"`  it'll again blow up with an exception.  Maybe, it would be more appropriate to throw an exception at the class or class property creation time (registering an entity and generation the schema) rather than at the time where the actual query is performed?  By the way, [here's](https://github.com/maseev/orient/blob/master/src/test/java/orientdb/OrientDbTest.java#L145) a simple test case which you can run in order to reproduce the problem. Run it with `mvn test -Dtest=orientdb.OrientDbTest#registeringABrokenEntityShouldThrowAnException` </body>
		<created>2015-12-30 13:47:00</created>
		<closed>2016-05-25 08:30:46</closed>
	</bug>
	<bug>
		<id>5536</id>
		<title>Query could return wrong result if composite index defined on a class</title>
		<body>I have Person class and index created like this  ``` person.createIndex("Person_name_birthday_btree", OClass.INDEX_TYPE.NOTUNIQUE, "name", "birthday"); ```  I also have two persons in DB. One with name 'Shah Rukh Khan' and birthday != null another with name = 'Lakshman .' and birthday == null  Then I issue query  ``` select from Person where name = 'Shah Rukh Khan' ```  I get my person back. But when i query  ``` select from Person where name = 'Lakshman .' ```  I get null as a result.  My workaround for this is create index with `METADATA { ignoreNullValues : false }` </body>
		<created>2015-12-30 11:27:56</created>
		<closed>2016-05-25 08:23:25</closed>
	</bug>
	<bug>
		<id>5534</id>
		<title>Unexpected behavoir of "asList()" with and EMBEDDED ODocument as an argument</title>
		<body>I ran into this issue while trying to work around #5532.  In that issue there is a case where the same query is either returning a HashSet or an ODocument.  I was trying to use the "asList()" method as a workaround to ensure that in either case, the value returned would be a list.  While I did always get a list returned, the values in the list were not as expected when the query returned an ODocument (It did work fine for a HashSet).  The "asList()" function (OSQLMethodAsList.java) seems to be intended to convert various collections and single items to a list.  The documentation states that if a single element is passed to this method, a new list will be created with the single element in it.  On line 44, the class checks to see if the value is already a list.  If so, it just returns it.  On line 50 it checks for null, and returns an empty list.  On line 56, it checks to see if the value is a collection and uses the "addAll" constructor of ArrayList to create a new list with all the elements.  On line 62, the class detects an Iterable, and iterates over the value, adding each element to a new list.  Lastly, on line 73 the class assumes that the value is a single element and adds it to a new list.  The problem here is that ODocument itself implements Iterable&lt;Entry&lt;String, Object&gt;&gt;.  Therefore instead of getting a list with a single ODocument init, the caller winds up with a List of Entry&lt;String, Object&gt;.  I suppose there could be a rare case where this is desired, however I believe that the user would expect a list with a document in it.  For all other types, Dates, Numbers, Strings, and even Sets / Lists of documents, you will wind up with the values intact, just in a list.  Pulling apart the document itself into a list, seems strange.  For example, I would not expect the asList method to turn a String into a list of individual characters.  If this is actually the indented behavior, then I would suggest updating the documentation to explicitly state that the ODocument will be converted into a list of Key Value pairs.  In either case, I would be more than willing to either update the code, or the documentation based on your thoughts.  I didn't want to move ahead with either until I understand what the expected behavior is.  Keep up the good work! </body>
		<created>2015-12-30 07:45:31</created>
		<closed>2015-12-31 03:49:02</closed>
	</bug>
	<bug>
		<id>5533</id>
		<title>ClassCastException from ODocument.field(String, OType) with EMBEDDEDLIST</title>
		<body>There seems to be a small issue with the logic in the ODocument.field(String, OType) method.  This is related to issue #5532.  In that issue, one of the fields (named "subs") in a select query is sometimes coming back as a HashSet and some times as an ODocument.  We were trying to call document.field("subs", OType.EMBEDDEDLIST).  The "subs" field is defined as an EMBEDDEDLIST in the schema.  Note: All line numbers are relative to the develop branch.  In the ODocument.field(String, OType)  method, on or about line 891 the following line exists:  ``` Java else if ((iFieldType == OType.EMBEDDEDLIST || iFieldType == OType.LINKLIST) &amp;&amp; value instanceof Set)         newValue = Collections.unmodifiableList((List&lt;?&gt;) ODocumentHelper.convertField(this, iFieldName, iFieldType, null, value)); ```  The OType being passed in is indeed EMBEDDEDLIST.  So when the field was being returned as a HashSet, this evaluated to true and the set was converted to a list.  When the value returned was an ODocument instead, this check would evaluate to false.  Instead the branch on or about line 895 will be taken:  ``` Java else     newValue = OType.convert(value, iFieldType.getDefaultJavaType()); ```  This calls the static OType.convert(final Object iValue, final Class&lt;?&gt; iTargetClass).  iValue will be an instance of ODocument.  iTargetClass will be List, the default java class for EMBEDDEDLIST.  The if logic in this method will bring us to OType line 415:  ``` Java  else if (!(iValue instanceof Collection&lt;?&gt;) &amp;&amp; Collection.class.isAssignableFrom(iTargetClass)) {         final Set&lt;Object&gt; set = new HashSet&lt;Object&gt;();         set.add(iValue);         return set;        } ```  Indeed iValue is not an instance of Collection and iTargetClass (List) isAssignableFrom Collection.  Essentially, this is saying, if iValue is not a collection, and the caller wants a collection do this.  Unfortunately, what is done is to put the single value in a HashSet and return it.  So the user has asked for an EMBEDDEDLIST, and would be expecting the result to be a subclass of java.util.List.  However they are going to wind up with a HashSet, which will likely cause a ClassCastException.  For example:  ``` Java    List&lt;Object&gt; list3 = document.field("subs", OType.EMBEDDEDLIST); ```  It seems like the logic in the OType.convert method is to generic.  It essentially is saying if the caller asked for any type of collection, regardless of what it was, give them a HashSet.  However, there is no guarantee that what they asked for was a set.  It seems that since OrientDB supports EMBEDDED/LINKED Sets, Lists, and Maps, then this conversion should be sensitive to these three types, and not just assume any request for a collection can be handled with a Set.  The following Gist demonstrates the issue:  https://gist.github.com/mmacfadden/54ab17d39743a2da8d22 </body>
		<created>2015-12-30 07:28:22</created>
		<closed>2016-05-25 17:22:26</closed>
	</bug>
	<bug>
		<id>5525</id>
		<title>OrientDB generates CUSTOM field type instead of LINK</title>
		<body>It looks like you guys lost some code related to that ticket https://github.com/orientechnologies/orientdb/issues/3604. I can't find it in the current code repository version. Have a look at this test [method](https://github.com/maseev/orient/blob/master/src/test/java/orientdb/OrientDbTest.java#L109).   You can run it with `mvn test -Dtest=orientdb.OrientDbTest#linkToSingleEntityShouldWorkWithoutExceptions` and you'd get an exception, because the Person class is empty. Notice, Person class implements the Serializable interface. Try to remove it and run the test again - everything would work just fine.  The problem is lurking somewhere [here](https://github.com/orientechnologies/orientdb/blob/7e6e319fa04378c3b02c1ecc6bb49adb89aef457/object/src/main/java/com/orientechnologies/orient/object/metadata/schema/OSchemaProxyObject.java#L303). Because Person class is registered after Citizen class, OrientDB can't find it through the entityManager and because Person is implementing the Serializable interface, the result type remains CUSTOM, but it has to be LINK. </body>
		<created>2015-12-28 13:15:28</created>
		<closed>2016-02-29 01:27:35</closed>
	</bug>
	<bug>
		<id>5521</id>
		<title>2.1.8 java.lang.OutOfMemoryError: null</title>
		<body>Hello every one!  After upgrade library from 2.1.5 -&gt; 2.1.8 we get OOM exception and application quit.   We use 130GB server with 40G heap + other RAM for lucene indexes etc...   ``` Caused by: java.lang.OutOfMemoryError: null     at sun.misc.Unsafe.allocateMemory(Native Method) ~[na:1.8.0_66]     at com.orientechnologies.common.directmemory.OUnsafeMemory.allocate(OUnsafeMemory.java:85) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.common.directmemory.OUntrackedDirectMemoryPointer.&lt;init&gt;(OUntrackedDirectMemoryPointer.java:75) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.common.directmemory.ODirectMemoryPointerFactory.createPointer(ODirectMemoryPointerFactory.java:115) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.cacheFileContent(OWOWCache.java:1202) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.cache.local.OWOWCache.load(OWOWCache.java:596) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.cache.local.O2QCache.updateCache(O2QCache.java:794) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.cache.local.O2QCache.doLoad(O2QCache.java:364) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.cache.local.O2QCache.load(O2QCache.java:327) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.impl.local.paginated.base.ODurableComponent.loadPage(ODurableComponent.java:131) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.impl.local.paginated.OPaginatedCluster.readRecord(OPaginatedCluster.java:551) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.doReadRecord(OAbstractPaginatedStorage.java:2152) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:1879) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:851) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3224) ~[orientdb-core-2.1.8.jar:2.1.8]     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1844) ~[orientdb-core-2.1.8.jar:2.1.8]     ... 19 common frames omitted ``` </body>
		<created>2015-12-28 08:06:50</created>
		<closed>2016-05-23 11:10:20</closed>
	</bug>
	<bug>
		<id>5517</id>
		<title>Error on database import (2.1.8)</title>
		<body>We are using OrientDB using Docker containers in two different environments (development &amp; production). The docker build process also loads the database schema.  We want to push an updated database schema (added one class of edges) to the production environment, while preserving the data. To minimize downtime I first wanted to test this locally before changing the production server.  I did a database export on the running production instance `export database &lt;file-url&gt;', and wanted to import this again on a test instance (with updated schema) using`import database &lt;file-url&gt; -merge=true -preserveClusterIDs=false` , but this gives the following error and no records are imported:  ``` Importing database schema...ERROR (20 entries): com.orientechnologies.orient.core.exception.OSchemaException: 'Internal' schema modification methods can be used only inside of embedded database ```  Any ideas on how to solve this issue?  Thanks! </body>
		<created>2015-12-26 09:13:58</created>
		<closed>2016-08-11 13:20:02</closed>
	</bug>
	<bug>
		<id>5497</id>
		<title>Server process gets killed abruptly upon connecting</title>
		<body>Hey Guys,                  Using OrientDB Server v2.1.2. This problem started to occur after a big document and associated properties creation script brought the server down a couple of times. Post these shutdowns, whenever I start the server process now, the server starts fine but as soon as I connect to the database from the console or studio, it shuts down as if a kill command was issued. Console debug of the server process attached. [server console debug.txt](https://github.com/orientechnologies/orientdb/files/68411/server.console.debug.txt)  I can see that the server tries to re-build the indexes of the database as soon as the connection is made and soon dies in this process. [orient-server.log.0.txt](https://github.com/orientechnologies/orientdb/files/68412/orient-server.log.0.txt) Not sure what is going on. I have attached the server console log and the log.0 file from the /logs directory. Can you please help me?  Here is the script that brought the server down a couple of times in the first place. I tried executing this over [script.txt](https://github.com/orientechnologies/orientdb/files/68419/script.txt)   studio.  thanks Chandra </body>
		<created>2015-12-21 12:01:42</created>
		<closed>2016-03-10 14:18:59</closed>
	</bug>
	<bug>
		<id>5496</id>
		<title>v2.1.8 produces lots of warnings</title>
		<body>After upgrading from v2.1.7 to v2.1.8 I'm seeing a lot of errors like this:  ``` 2015-12-21 12:46:08:784 WARNI -&gt;xx.xx.xx.xx: Error on invalid content:   [ONetworkProtocolHttpDb] ```  Looking through the code I see that the invalid content is actually appended to the log message, but it seems to be empty in this case. I have no idea what is causing this, but I have disabled all loadbalanced traffic to the node. So this seems to be caused by some internal processes e.G. hazelcast maybe?  Note that everything seems to work fine, it's just that my log is full of WARNINGs. </body>
		<created>2015-12-21 11:48:56</created>
		<closed>2016-06-22 15:25:37</closed>
	</bug>
	<bug>
		<id>5493</id>
		<title>LIMIT and SKIP not working with named parameters.</title>
		<body>I'm using the following code:  ```         HashMap&lt;String, String&gt; params = new HashMap&lt;String, String&gt;();         params.put("title", "SQL");         params.put("limit", "10");          return db.command(new OSQLSynchQuery&lt;Book&gt;("select * from Book where title = :title SKIP 20 LIMIT :limit")).execute(params) ```  but this doesn't work. It results in the following stacktrace:  ``` com.orientechnologies.orient.core.sql.OCommandSQLParsingException: Error on parsing command at position #0: Error parsing query:  select * from Book where title = :title SKIP 20 LIMIT :limit Encountered " &lt;LIMIT&gt; "limit "" at line 1, column 56. Was expecting one of:     &lt;TO&gt; ...     &lt;VALUES&gt; ...     &lt;SET&gt; ...     &lt;ADD&gt; ...     &lt;PUT&gt; ...     &lt;MERGE&gt; ...     &lt;CONTENT&gt; ...     &lt;REMOVE&gt; ...     &lt;ORDER&gt; ...     &lt;GROUP&gt; ...     &lt;OFFSET&gt; ...     &lt;RECORD&gt; ...     &lt;LUCENE&gt; ...     &lt;NEAR&gt; ...     &lt;WITHIN&gt; ...     &lt;EXCEPTION&gt; ...     &lt;IN&gt; ...     &lt;KEY&gt; ...     &lt;IDENTIFIER&gt; ...     &lt;QUOTED_IDENTIFIER&gt; ...     &lt;IDENTIFIER&gt; ...     &lt;IN&gt; ...     &lt;SET&gt; ...     &lt;PUT&gt; ...     &lt;ADD&gt; ...     &lt;REMOVE&gt; ...     &lt;MERGE&gt; ...     &lt;CONTENT&gt; ...     &lt;ORDER&gt; ...     &lt;KEY&gt; ...     &lt;OFFSET&gt; ...     &lt;GROUP&gt; ...     &lt;VALUES&gt; ...     &lt;RECORD&gt; ...     &lt;TO&gt; ...     &lt;LUCENE&gt; ...     &lt;NEAR&gt; ...     &lt;WITHIN&gt; ...     &lt;EXCEPTION&gt; ...     &lt;QUOTED_IDENTIFIER&gt; ...      at com.orientechnologies.orient.core.sql.OCommandExecutorSQLAbstract.throwParsingException(OCommandExecutorSQLAbstract.java:102) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLAbstract.preParse(OCommandExecutorSQLAbstract.java:238) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.parse(OCommandExecutorSQLSelect.java:218) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLSelect.parse(OCommandExecutorSQLSelect.java:84) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.parse(OCommandExecutorSQLDelegate.java:76) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.parse(OCommandExecutorSQLDelegate.java:42) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1517) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.query.OSQLQuery.run(OSQLQuery.java:72) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.sql.query.OSQLSynchQuery.run(OSQLSynchQuery.java:85) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.core.query.OQueryAbstract.execute(OQueryAbstract.java:33) ~[orientdb-core-2.1.6.jar:2.1.6]     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1319) ~[na:na]     at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:396) ~[na:na]     at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223) ~[na:na]     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ~[orientdb-core-2.1.6.jar:2.1.6] ```  I've found the following discussion, https://groups.google.com/forum/#!topic/orient-database/o4f4JEiJneo which mentions that it should be fixed since 2014, but I'm using OrientDB 2.1.5, and it doesn't seem to be fixed. Any suggestions? </body>
		<created>2015-12-20 10:35:37</created>
		<closed>2015-12-21 13:38:16</closed>
	</bug>
	<bug>
		<id>5491</id>
		<title>incorrect calculation of disk free space causing failure</title>
		<body>``` [info]   com.orientechnologies.orient.core.exception.OLowDiskSpaceException: Error occurred while executing a write operation to database 'graph-2.0' due to limited free space on the disk (0 MB). The database is now working in read-only mode. Please close the database (or stop OrientDB), make room on your hard drive and then reopen the database. The minimal required space is 100 MB. Required space is now set to 100MB (you can change it by setting parameter storage.diskCache.diskFreeSpaceLimit) . ```  but  ``` df -h /tmp/ Filesystem      Size  Used Avail Use% Mounted on /dev/sdb5       7.4G  105M  6.9G   2% /tmp ``` </body>
		<created>2015-12-19 18:50:40</created>
		<closed>2016-02-22 11:28:32</closed>
	</bug>
	<bug>
		<id>5485</id>
		<title>Import command throws an exception</title>
		<body>I've just run into the problem when OrientDb simply can't perform the import command. Here's the stack trace which I get when I'm trying to run the import command:  ``` com.orientechnologies.orient.core.db.tool.ODatabaseExportException: Error on importing database 'tmpdb' from file: streaming.json      at com.orientechnologies.orient.core.db.tool.ODatabaseImport.importDatabase(ODatabaseImport.java:471)     at orientdb.OrientDbTest.exportImportShouldWorkWithoutExceptions(OrientDbTest.java:92)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:497)     at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)     at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)     at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)     at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)     at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)     at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)     at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)     at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)     at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)     at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)     at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)     at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)     at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)     at org.junit.runners.ParentRunner.run(ParentRunner.java:363)     at org.junit.runner.JUnitCore.run(JUnitCore.java:137)     at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)     at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)     at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:497)     at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) Caused by: com.orientechnologies.orient.core.exception.OSchemaException: Class 'ODocumentWrapper' cannot be dropped because it has sub classes. Remove the dependencies before trying to drop it again     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.dropClass(OSchemaShared.java:532)     at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.dropClass(OSchemaProxy.java:156)     at com.orientechnologies.orient.core.db.tool.ODatabaseImport.removeDefaultNonSecurityClasses(ODatabaseImport.java:638)     at com.orientechnologies.orient.core.db.tool.ODatabaseImport.importDatabase(ODatabaseImport.java:419)     ... 29 more ```  And here's the test I'm running - https://github.com/maseev/orient/blob/master/src/test/java/orientdb/OrientDbTest.java#L70. You can execute it with `mvn test -Dtest=orientdb.OrientDbTest#exportImportShouldWorkWithoutExceptions`  It turned out, that the problem is lurking somewhere here - https://github.com/orientechnologies/orientdb/blob/master/core/src/main/java/com/orientechnologies/orient/core/db/tool/ODatabaseImport.java#L613.   OrientDB is trying to drop every class except for ORole, OUser and OIdentity. But it doesn't filter out the ODocumentWrapper class which is a superclass for OIdentity and a transitive superclass for OUser and ORole (through the OIdentity).  In the end, OrientDb is trying to drop ODocumentWrapper class which obviously has several subclasses. As a result, we get an exception. </body>
		<created>2015-12-18 12:57:25</created>
		<closed>2016-02-01 16:08:52</closed>
	</bug>
	<bug>
		<id>5482</id>
		<title>SErVER Can not change cache size in runtime because storage engine plocal was not registered</title>
		<body>any idea for following issue when start orientdb server for 2.1.7 version.   SErVER Can not change cache size in runtime because storage engine plocal was not registered </body>
		<created>2015-12-18 10:56:27</created>
		<closed>2016-03-17 13:01:52</closed>
	</bug>
	<bug>
		<id>5478</id>
		<title>OrientGraph.getVertex() throws IllegalArgumentException when cluster is not defined.</title>
		<body>Using 2.1.8 build.  If you call graph.getVertex with a cluster that isnt defined, it throws an IllegalArgumentException, while previously it just return null, which seems to be like the wanted behaviour. This is the exception we get:  ```  com.orientechnologies.orient.core.exception.ORecordNotFoundException: The record with id '#4654:0' was not found      at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:848)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx$SimpleRecordReader.readRecord(ODatabaseDocumentTx.java:3224)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeReadRecord(ODatabaseDocumentTx.java:1844)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:243)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:217)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.loadRecord(OTransactionOptimistic.java:347)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:1588)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.load(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.id.ORecordId.getRecord(ORecordId.java:324)     at com.tinkerpop.blueprints.impls.orient.OrientBaseGraph.getVertex(OrientBaseGraph.java:768) .... Caused by: java.lang.IllegalArgumentException: Cluster segment #4654 does not exist in database 'test'     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.checkClusterSegmentIndexRange(OAbstractPaginatedStorage.java:2505)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.getClusterById(OAbstractPaginatedStorage.java:1360)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.readRecord(OAbstractPaginatedStorage.java:846)     ... 115 more ```  ``` ``` </body>
		<created>2015-12-17 08:45:25</created>
		<closed>2015-12-17 09:17:30</closed>
	</bug>
	<bug>
		<id>5477</id>
		<title>REGRESSION in 2.1.8 hotfix - Filter by $depth does not work anymore</title>
		<body>``` sql select * from (traverse out('BroughtIntoRight', 'BroughtIntoLeft') from (select from Node WHERE Mid = '566f54dbfc35c33412723766' ) ) where $depth &gt;= 0 and $depth &lt;= 15 ```  Result  ``` sql [] ```  but this works:  ``` sql SELECT * FROM (TRAVERSE out('BroughtIntoRight', 'BroughtIntoLeft') FROM (SELECT FROM Node WHERE Mid = '566f54dbfc35c33412723766' ) WHILE $depth &lt;= 3 ) ```  Works in 2.1.7 </body>
		<created>2015-12-16 16:13:51</created>
		<closed>2015-12-18 09:32:33</closed>
	</bug>
	<bug>
		<id>5476</id>
		<title>import database doesn't work with spatial type</title>
		<body>here is the definition for the index from *.export file {"name":"place.distance_spatial","type":"SPATIAL","algorithm":"LUCENE"}  but i have the following error for 2.1.7 version  Index 'place.distance_spatial'...Error on database import happened just before line 0, column 41233 com.orientechnologies.orient.core.index.OIndexException: Index with type SPATIAL and algorithm SBTREE does not exist.         at com.orientechnologies.orient.core.index.OIndexes.getFactory(OIndexes.java:130)         at com.orientechnologies.orient.core.index.OIndexDefinitionFactory.createMultipleFieldIndexDefinition(OIndexDefinitionFactory.java:88)         at com.orientechnologies.orient.core.index.OIndexDefinitionFactory.createIndexDefinition(OIndexDefinitionFactory.java:65)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLCreateIndex.execute(OCommandExecutorSQLCreateIndex.java:271)         at com.orientechnologies.orient.core.sql.OCommandExecutorSQLDelegate.execute(OCommandExecutorSQLDelegate.java:90)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.executeCommand(OAbstractPaginatedStorage.java:1547)         at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.command(OAbstractPaginatedStorage.java:1528)         at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.command(ONetworkProtocolBinary.java:1323)         at com.orientechnologies.orient.server.network.protocol.binary.ONetworkProtocolBinary.executeRequest(ONetworkProtocolBinary.java:400)         at com.orientechnologies.orient.server.network.protocol.binary.OBinaryNetworkProtocolAbstract.execute(OBinaryNetworkProtocolAbstract.java:223)         at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) </body>
		<created>2015-12-16 16:05:38</created>
		<closed>2016-05-04 08:05:41</closed>
	</bug>
	<bug>
		<id>5473</id>
		<title>EmbeddedMap is broken</title>
		<body>I was trying to save and then query an entity which contains an embedded map (`Map&lt;String, Car&gt;` to be precise). Here's a model that represents the database structure - https://github.com/maseev/orient/tree/master/src/main/java/orientdb/model. And here's the test where I'm trying to query an entity that was previously saved to the database - https://github.com/maseev/orient/blob/master/src/test/java/orientdb/OrientDbTest.java#L46.  The problem I faced to is instead of the entity that I save to the database I get the entity with an embedded map, where all values of the HashMap are equal to the first Car object that I put to the map. So, placeToCar map contains:  ```  "USA" -&gt; Car("Cadillac Escalade", 1990)  "Japan" -&gt; Car("Cadillac Escalade", 1990)  "UK" -&gt; Car("Cadillac Escalade", 1990) ```  instead of:  ```  "USA" -&gt; Car("Cadillac Escalade", 1990)  "Japan" -&gt; Car("Nissan Skyline", 2001)  "UK" -&gt; Car("Jaguar XR", 2007) ```  You can run `mvn test` to run the test. I clearly remember that way back when I was using OrientDb (it was 1.7 version) this functionality worked perfectly. </body>
		<created>2015-12-15 20:06:44</created>
		<closed>2016-01-26 11:36:51</closed>
	</bug>
	<bug>
		<id>5472</id>
		<title>ETL CSV extrctor maps wrong columns and types</title>
		<body>ETL-CSV extractor maps columns of every line in wrong order </body>
		<created>2015-12-15 14:39:55</created>
		<closed>2015-12-15 14:42:07</closed>
	</bug>
	<bug>
		<id>5467</id>
		<title>NPE while commiting unique index</title>
		<body>iSingleValue is of type ORecordId value==null  Caused by: java.lang.NullPointerException     at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:76)     at com.orientechnologies.orient.core.index.OIndexUnique.put(OIndexUnique.java:35)     at com.orientechnologies.orient.core.index.OIndexAbstract.putInSnapshot(OIndexAbstract.java:845)     at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:1022)     at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:706)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic$CommitIndexesCallback.run(OTransactionOptimistic.java:98)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1334)     ... 43 more </body>
		<created>2015-12-15 09:16:40</created>
		<closed>2016-03-21 12:53:50</closed>
	</bug>
	<bug>
		<id>5465</id>
		<title>ClassCastException when save a ODocument:OSBTreeException: Error during removing key OCompositeKey</title>
		<body>Yesterday, my chat application raised exception when I tried to remove someone from one group chat session. Today, I have debugged but the issue seem to be gone. I viewed log and found:  ```     com.orientechnologies.orient.core.index.OIndexException: Error during removal of entry by key     at com.orientechnologies.orient.core.index.OIndexMultiValues.remove(OIndexMultiValues.java:218)     at com.orientechnologies.orient.core.index.OIndexAbstract.removeFromSnapshot(OIndexAbstract.java:984)     at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:1170)     at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:776)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic$CommitIndexesCallback.run(OTransactionOptimistic.java:101)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1202)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:609)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2653)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2622)     at mypackage...removeUsers(GroupChatModel.java:3066)     ....     Caused by: java.lang.ClassCastException ```  and   ``` com.orientechnologies.orient.core.index.sbtree.local.OSBTreeException: Error during removing key OCompositeKey{keys=[1, 1449109800000, 1449220665360, 1895]} from sbtree task.state_user     at com.orientechnologies.orient.core.index.sbtree.local.OSBTree.remove(OSBTree.java:603)     at com.orientechnologies.orient.core.index.engine.OSBTreeIndexEngine.remove(OSBTreeIndexEngine.java:186)     at com.orientechnologies.orient.core.index.OIndexAbstract.remove(OIndexAbstract.java:490)     at com.orientechnologies.orient.core.index.OIndexAbstract.remove(OIndexAbstract.java:471)     at com.orientechnologies.orient.core.index.OIndexAbstract.removeFromSnapshot(OIndexAbstract.java:984)     at com.orientechnologies.orient.core.index.OIndexAbstract.applyIndexTxEntry(OIndexAbstract.java:1170)     at com.orientechnologies.orient.core.index.OIndexAbstract.addTxOperation(OIndexAbstract.java:776)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic$CommitIndexesCallback.run(OTransactionOptimistic.java:101)     at com.orientechnologies.orient.core.storage.impl.local.OAbstractPaginatedStorage.commit(OAbstractPaginatedStorage.java:1202)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.doCommit(OTransactionOptimistic.java:609)     at com.orientechnologies.orient.core.tx.OTransactionOptimistic.commit(OTransactionOptimistic.java:156)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2653)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.commit(ODatabaseDocumentTx.java:2622)     at mypackage...removeUsers(GroupChatModel.java:3066)     ...     at mypackage...onWebSocketText(ChatSocket.java:655)     Caused by: java.lang.ClassCastException ```  This is a automatic index and and don't have any code which change the index directly. So I think it's maybe a bug of orientdb. The index is created with:  ``` java clzz.createIndex("task.state_user", OClass.INDEX_TYPE.UNIQUE, "state" (BYTE),             "users"(LINKSET), "time"(LONG),"reg"(LONG),"no"(INTEGER)); ```  When a user has been removed from group chat session, loop all tasks of session and do:  ``` java ODocument task = db.load(taskid,..); Set&lt;ORID&gt; users = task.field("users"); if(users.contains(theUSER)){     users.remove(theUSER);     if(users.isEmpty()) task.removeFiled("users");     else task.setDirty();    task.save();       } ```  OS:Centos 6.6x64 OrientDB 2.1.6 Java:Oracle 1.8.0_66 </body>
		<created>2015-12-15 02:38:22</created>
		<closed>2016-03-28 20:42:38</closed>
	</bug>
	<bug>
		<id>5464</id>
		<title>Cannot create database with 2.1.7 release</title>
		<body>Hello, I download http://orientdb.com/download.php?email=unknown@unknown.com&amp;file=orientdb-community-2.1.7.tar.gz&amp;os=linux and try to create a database but I got a server error. A database with the name `null` is created!  with 2.1.6 http://orientdb.com/download.php?email=unknown@unknown.com&amp;file=orientdb-community-2.1.6.tar.gz&amp;os=linux it works.  Perhaps this is helpful:  ``` sql  2015-12-14 23:28:20:826 WARNI Not enough physical memory available for DISKCACHE: 2,001MB (heap=494MB). Set lower Maximum Heap (-Xmx setting on JVM) and restart OrientDB. Now running with DISKCACHE=256MB [orientechnologies] 2015-12-14 23:28:20:833 SEVER Can not change cache size in runtime because storage engine plocal was not registered [OGlobalConfiguration$1] ``` </body>
		<created>2015-12-14 23:42:03</created>
		<closed>2015-12-16 08:29:03</closed>
	</bug>
	<bug>
		<id>5461</id>
		<title>Trying to add property or index to class - Execution Exception</title>
		<body>Hi,  as part of our test with OrientDB we've come across this weird behaviour: - import a User class (with 8 cluster) with millions of vertexes - try and add a property ( same thing happened with a multi field index, though) - get an error during the execution  ```  create property User.name STRING  Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: Property 'User.name' already exists. Remove it before to retry.  orientdb {db=graphDb}&gt; info class User                                                                                CLASS 'User'  Super classes........: [V] Default cluster......: user (id=11) Supported clusters...: user(11), user_1(12), user_2(13), user_3(14), user_4(15), user_5(16), user_6(17), user_7(18) Cluster selection....: round-robin Oversize.............: 0.0  PROPERTIES -------------------------------+-------------+-------------------------------+-----------+----------+----------+-----------+-----------+----------+  NAME                          | TYPE        | LINKED TYPE/CLASS             | MANDATORY | READONLY | NOT NULL |    MIN    |    MAX    | COLLATE  | -------------------------------+-------------+-------------------------------+-----------+----------+----------+-----------+-----------+----------+  username                      | STRING      | null                          | false     | false    | false    |           |           | default  |  email                         | STRING      | null                          | false     | false    | false    |           |           | default  |  lastName                      | STRING      | null                          | false     | false    | false    |           |           | default  |  uid                          | STRING      | null                          | false     | false    | false    |           |           | default  |  firstName                     | STRING      | null                          | false     | false    | false    |           |           | default  | -------------------------------+-------------+-------------------------------+-----------+----------+----------+-----------+-----------+----------+  INDEXES (1 altogether) -------------------------------+----------------+  NAME                          | PROPERTIES     | -------------------------------+----------------+  User.uid                     | uid           | -------------------------------+----------------+ orientdb {db=graphDb}&gt; select from user limit 10;  ----+-----+------+---------------+---------------+--------+---------------------------+---------+--------+------+------+------------+----------+--------- #   |@RID |@CLASS|uid           |lastName       |username|email                      |firstName|birthday|userId|gender|birthdayYear|out_Friend|in_Friend ----+-----+------+---------------+---------------+--------+---------------------------+---------+--------+------+------+------------+----------+--------- 0   |#11:0|User  |1234     |null           |        |email@email.com        |First |00-00   |1   |null  |0           |null      |null      ```  Same thing happened when I tried and create an index with:  ``` create index User.name on User (firstName,lastName) FULLTEXT ENGINE LUCENE ``` </body>
		<created>2015-12-13 18:17:23</created>
		<closed>2017-02-20 10:38:20</closed>
	</bug>
	<bug>
		<id>5457</id>
		<title>Error about changing cache size when starting 2.1.7 in embedded mode</title>
		<body>When starting OrientDB 2.1.7 in embedded mode we now see this error logged:  ``` ERROR com.orientechnologies.orient.core.config.OGlobalConfiguration$1 - Can not change cache size in runtime because storage engine plocal was not registered ```  This didn't happen in 2.1.6 and appears to be related to 9268493 which added a change-listener for the disk-cache configuration item. Unfortunately this change-listener appears to be triggered by OrientDB's `autoConfig` mechanism:  ```     at com.orientechnologies.orient.core.config.OGlobalConfiguration$1.change(OGlobalConfiguration.java:98)     at com.orientechnologies.orient.core.config.OGlobalConfiguration.setValue(OGlobalConfiguration.java:812)     at com.orientechnologies.orient.core.config.OGlobalConfiguration.autoConfigDiskCacheSize(OGlobalConfiguration.java:772)     at com.orientechnologies.orient.core.config.OGlobalConfiguration.autoConfig(OGlobalConfiguration.java:737)     at com.orientechnologies.orient.core.config.OGlobalConfiguration.&lt;clinit&gt;(OGlobalConfiguration.java:640)     at com.orientechnologies.common.profiler.OProfilerStub.&lt;init&gt;(OProfilerStub.java:38)     at com.orientechnologies.orient.core.Orient.startup(Orient.java:199)     at com.orientechnologies.orient.core.Orient.&lt;clinit&gt;(Orient.java:87) ```  Since `OLocalPaginatedStorage` reads the value of `DISK_CACHE_SIZE` at initialization it seems odd to have `OGlobalConfiguration` log an error, especially when this is OrientDB itself auto-configuring the disk cache.  The simplest fix is to remove this error; I'm not sure it's actually that useful and setting the value before the 'plocal' storage is initialized will work because 'plocal' will read this setting when it initializes. The alternative would be to update the change-listener so it doesn't fire during the `autoConfig` phase. </body>
		<created>2015-12-11 14:02:16</created>
		<closed>2015-12-24 11:30:58</closed>
	</bug>
	<bug>
		<id>5456</id>
		<title>create property with linkbag type doesn't allow linkedclass</title>
		<body></body>
		<created>2015-12-11 12:36:57</created>
		<closed>2016-03-17 04:15:43</closed>
	</bug>
	<bug>
		<id>5454</id>
		<title>Import database fail in distributed</title>
		<body>Import database fail to create cluster if run in distributed with two nodes in write quorun at 1  </body>
		<created>2015-12-10 17:14:58</created>
		<closed>2016-01-18 18:00:09</closed>
	</bug>
	<bug>
		<id>5451</id>
		<title>Filtering on edge property returns NO results</title>
		<body>using orient db 2.1.6  Running following query returns no result:  ``` sql select expand(out("RUNS_ON").in("EXECUTED_ON")[JobSubmitted between '2015-12-09 00:00:00' and '2015-12-09 23:59:59']) from JOBS WHERE JobID = '3' ``` </body>
		<created>2015-12-10 16:31:49</created>
		<closed>2016-02-16 09:53:41</closed>
	</bug>
	<bug>
		<id>5449</id>
		<title>Problem autodeploy new database on node join</title>
		<body>On autodeploy, at the second node start, the distributed database install get stack.   stack trace:  ``` Found one Java-level deadlock: ============================= "OrientDB Auditing Logging Thread - GratefulDeadConcerts":   waiting for ownable synchronizer 0x00000000eb496b08, (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock),   which is held by "main" "main":   waiting to lock monitor 0x00007f7a00011b18 (object 0x00000000eaf2d548, a java.util.HashMap),   which is held by "OrientDB Auditing Logging Thread - GratefulDeadConcerts"  Java stack information for the threads listed above: =================================================== "OrientDB Auditing Logging Thread - GratefulDeadConcerts":     at sun.misc.Unsafe.park(Native Method)     - parking to wait for  &lt;0x00000000eb496b08&gt; (a com.orientechnologies.common.concur.lock.OReadersWriterSpinLock)     at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)     at com.orientechnologies.common.concur.lock.OReadersWriterSpinLock.acquireReadLock(OReadersWriterSpinLock.java:80)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.acquireSchemaReadLock(OSchemaShared.java:616)     at com.orientechnologies.orient.core.metadata.schema.OSchemaShared.getClasses(OSchemaShared.java:828)     at com.orientechnologies.orient.core.metadata.schema.OSchemaProxy.getClasses(OSchemaProxy.java:181)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installDbClustersLocalStrategy(OHazelcastPlugin.java:1304)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.onOpen(OHazelcastPlugin.java:442)     - locked &lt;0x00000000eaf2d548&gt; (a java.util.HashMap)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callOnOpenListeners(ODatabaseDocumentTx.java:345)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.open(ODatabaseDocumentTx.java:279)     at com.orientechnologies.agent.auditing.OAuditingLoggingThread.openDatabase(OAuditingLoggingThread.java:86)     at com.orientechnologies.agent.auditing.OAuditingLoggingThread.run(OAuditingLoggingThread.java:52) "main":     at com.orientechnologies.orient.server.distributed.ODistributedAbstractPlugin.getDatabaseConfiguration(ODistributedAbstractPlugin.java:308)     - waiting to lock &lt;0x00000000eaf2d548&gt; (a java.util.HashMap)     at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.send2Nodes(OHazelcastDistributedDatabase.java:110)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.sendRequest(OHazelcastPlugin.java:359)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.command(ODistributedStorage.java:307)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.addCluster(ODistributedStorage.java:1269)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.addCluster(ODatabaseDocumentTx.java:1263)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.createClusterIfNeeded(OClassImpl.java:2091)     at com.orientechnologies.orient.core.metadata.schema.OClassImpl.addCluster(OClassImpl.java:1058)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installLocalClusterPerClass(OHazelcastPlugin.java:1615)     - locked &lt;0x00000000eaf28288&gt; (a com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installDbClustersForLocalNode(OHazelcastPlugin.java:1291)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$2.call(OHazelcastPlugin.java:1125)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin$2.call(OHazelcastPlugin.java:1122)     at com.orientechnologies.orient.server.hazelcast.OHazelcastDistributedDatabase.configureDatabase(OHazelcastDistributedDatabase.java:239)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installDatabaseFromNetwork(OHazelcastPlugin.java:1122)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.requestDatabase(OHazelcastPlugin.java:964)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installDatabase(OHazelcastPlugin.java:901)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.installNewDatabases(OHazelcastPlugin.java:1459)     at com.orientechnologies.orient.server.hazelcast.OHazelcastPlugin.startup(OHazelcastPlugin.java:184)     at com.orientechnologies.orient.server.OServer.registerPlugins(OServer.java:979)     at com.orientechnologies.orient.server.OServer.activate(OServer.java:346)     at com.orientechnologies.orient.server.OServerMain.main(OServerMain.java:41)  Found 1 deadlock. ```  Reproduced on AWS T2.small   machine info:    ``` uname -a Linux ip-10-128-1-243 3.10.0-229.14.1.el7.x86_64 #1 SMP Tue Sep 15 15:05:51 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux ```  ``` CentOS Linux release 7.1.1503 (Core) NAME="CentOS Linux" VERSION="7 (Core)" ID="centos" ID_LIKE="rhel fedora" VERSION_ID="7" PRETTY_NAME="CentOS Linux 7 (Core)" ANSI_COLOR="0;31" CPE_NAME="cpe:/o:centos:centos:7" HOME_URL="https://www.centos.org/" BUG_REPORT_URL="https://bugs.centos.org/"  CENTOS_MANTISBT_PROJECT="CentOS-7" CENTOS_MANTISBT_PROJECT_VERSION="7" REDHAT_SUPPORT_PRODUCT="centos" REDHAT_SUPPORT_PRODUCT_VERSION="7"  CentOS Linux release 7.1.1503 (Core) CentOS Linux release 7.1.1503 (Core) ```  source ami:`ami-33734044`   java version: openjdk 1.8   </body>
		<created>2015-12-10 12:49:35</created>
		<closed>2016-02-04 18:00:46</closed>
	</bug>
	<bug>
		<id>5448</id>
		<title>ORecordDuplicatedException upon new record after cluster has been truncated but index still has it</title>
		<body>``` java com.orientechnologies.orient.core.storage.ORecordDuplicatedException: Cannot index record Some_Class{xxxxx}: found duplicated key 'xxxxx' in index 'some_key' previously assigned to the record #28:0 RID=#28:0     at com.orientechnologies.orient.core.index.OIndexTxAwareOneValue.checkEntry(OIndexTxAwareOneValue.java:224)     at com.orientechnologies.orient.core.index.OClassIndexManager.checkIndexedPropertiesOnCreation(OClassIndexManager.java:341)     at com.orientechnologies.orient.core.index.OClassIndexManager.checkIndexes(OClassIndexManager.java:585)     at com.orientechnologies.orient.core.index.OClassIndexManager.onRecordBeforeCreate(OClassIndexManager.java:410)     at com.orientechnologies.orient.core.hook.ODocumentHookAbstract.onTrigger(ODocumentHookAbstract.java:226)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.callbackHooks(ODatabaseDocumentTx.java:1069)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.executeSaveRecord(ODatabaseDocumentTx.java:1966)     at com.orientechnologies.orient.core.tx.OTransactionNoTx.saveRecord(OTransactionNoTx.java:159)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:2568)     at com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx.save(ODatabaseDocumentTx.java:121)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1768)     at com.orientechnologies.orient.core.record.impl.ODocument.save(ODocument.java:1759) ```  We face this issue when we truncate the clusters upon application restart and we add a record which previously existed(meaning a new record with same key as before) but it fails because index still has the record from past.   For our application it is okay to clear the index upon start, so we can solve the issue currently by clearing the index using   ``` java OIndex.clear(); ```  Though we have solution for us but issue seems important in general. </body>
		<created>2015-12-10 10:32:00</created>
		<closed>2016-03-01 14:52:42</closed>
	</bug>
	<bug>
		<id>5442</id>
		<title>Empty list/set results in distributed setup gives out an exception.</title>
		<body>OrientDB version : 2.1.7 distributed mode on two servers.  Following commands work correctly.  ``` sql SELECT null FROM V        /* result: field named "null" with value of null :D */ SELECT list(name) FROM V  /* name is existing field */ SELECT set(name) FROM V   /* name is existing field */ ```  Following will give out Exceptions. (note: following will work in non-distributed server)  ``` sql SELECT list(null) FROM V    /* not usefull, but should work */ SELECT set(null) FROM V     /* not usefull, but should work */ SELECT list(foobar) FROM V  /* foobar is non-existing field */ SELECT set(foobar) FROM V   /* foobar is non-existing field */ ```  ``` java 2015-12-09 15:30:42:596 SEVER Internal server error: com.orientechnologies.orient.core.exception.OStorageException: Cannot route COMMAND operation to the distributed node --&gt; java.lang.IndexOutOfBoundsException: Index: 0, Size: 0 [ONetworkProtocolHttpDb]Cannot route COMMAND operation to the distributed node java.lang.IndexOutOfBoundsException: Index: 0, Size: 0     at java.util.ArrayList.rangeCheck(ArrayList.java:653)     at java.util.ArrayList.get(ArrayList.java:429)     at com.orientechnologies.orient.core.sql.functions.coll.OSQLFunctionList.mergeDistributedResult(OSQLFunctionList.java:95)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.mergeResultByAggregation(ODistributedStorage.java:449)     at com.orientechnologies.orient.server.distributed.ODistributedStorage.command(ODistributedStorage.java:306)     at com.orientechnologies.orient.core.command.OCommandRequestTextAbstract.execute(OCommandRequestTextAbstract.java:67)     at com.orientechnologies.orient.server.network.protocol.http.command.post.OServerCommandPostCommand.execute(OServerCommandPostCommand.java:81)     at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.service(ONetworkProtocolHttpAbstract.java:180)     at com.orientechnologies.orient.server.network.protocol.http.ONetworkProtocolHttpAbstract.execute(ONetworkProtocolHttpAbstract.java:627)     at com.orientechnologies.common.thread.OSoftThread.run(OSoftThread.java:77) ```  / Aki R. </body>
		<created>2015-12-09 14:39:22</created>
		<closed>2017-01-31 14:48:49</closed>
	</bug>
	<bug>
		<id>5441</id>
		<title>GratefulDeadConcerts DB broken? or OrientDB bug?</title>
		<body>i'm running OrientDB 2.1.7 just built from source and running some 'select' queries against GratefulDeadConcerts DB. There are no configuration changes or modifications to DB.  when i query some of the vertices using the console, it shows a size of "-1" for the edge fields. what does it mean to have a [size "-1"] for a field? is is due to a broken DB or OrientDB bug?  ``` orientdb {db=GratefulDeadConcerts}&gt; select from #9:25  ----+-----+------+--------------+---------+----+--------------- #   |@RID |@CLASS|in_followed_by|name     |type|out_followed_by ----+-----+------+--------------+---------+----+--------------- 0   |#9:25|V     |[size=-1]     |BIRD SONG|song|[size=-1] ----+-----+------+--------------+---------+----+---------------  1 item(s) found. Query executed in 0.005 sec(s).  ```  it is also strange that adding "unwind in_followed_by" clause to the query gives 60 results! if there are indeed 60 vertices, the first select query should have returned size=60 instead of -1 ??  ``` orientdb {db=GratefulDeadConcerts}&gt; select from #9:25 unwind in_followed_by  ----+------+--------------+---------+----+--------------- #   |@CLASS|in_followed_by|name     |type|out_followed_by ----+------+--------------+---------+----+--------------- 0   |V     |#11:78        |BIRD SONG|song|[size=-1] 1   |V     |#11:79        |BIRD SONG|song|[size=-1] 2   |V     |#11:80        |BIRD SONG|song|[size=-1] 3   |V     |#11:81        |BIRD SONG|song|[size=-1] 4   |V     |#11:82        |BIRD SONG|song|[size=-1] 5   |V     |#11:83        |BIRD SONG|song|[size=-1] 6   |V     |#11:84        |BIRD SONG|song|[size=-1] 7   |V     |#11:85        |BIRD SONG|song|[size=-1] 8   |V     |#11:1177      |BIRD SONG|song|[size=-1] 9   |V     |#11:1178      |BIRD SONG|song|[size=-1] 10  |V     |#11:1179      |BIRD SONG|song|[size=-1] 11  |V     |#11:1180      |BIRD SONG|song|[size=-1] 12  |V     |#11:1181      |BIRD SONG|song|[size=-1] 13  |V     |#11:1182      |BIRD SONG|song|[size=-1] 14  |V     |#11:1183      |BIRD SONG|song|[size=-1] 15  |V     |#11:1184      |BIRD SONG|song|[size=-1] 16  |V     |#11:1185      |BIRD SONG|song|[size=-1] 17  |V     |#11:1186      |BIRD SONG|song|[size=-1] 18  |V     |#11:1711      |BIRD SONG|song|[size=-1] 19  |V     |#11:1712      |BIRD SONG|song|[size=-1] ----+------+--------------+---------+----+--------------- LIMIT EXCEEDED: resultset contains more items not displayed (limit=20)  20 item(s) found. Query executed in 0.064 sec(s).  orientdb {db=GratefulDeadConcerts}&gt; select count(*) from (select from #9:25 unwind in_followed_by)  ----+------+----- #   |@CLASS|count ----+------+----- 0   |null  |60 ----+------+-----  1 item(s) found. Query executed in 0.04 sec(s).  ``` </body>
		<created>2015-12-09 14:21:44</created>
		<closed>2016-03-22 09:40:42</closed>
	</bug>
	<bug>
		<id>5440</id>
		<title>NPE upon starting OrientDB 2.1.7</title>
		<body>I just built 2.1.7 from source and when starting the DB, received this NPE:  `````` ./bin/server.sh            .           .`        `           ,      `:.          `,`    ,:`          .,.   :,,          .,,  ,,,     .    .,.:::::  ````                                 :::::::::     :::::::::     ,`   .::,,,,::.,,,,,,`;;                      .:    ::::::::::    :::    :::     `,.  ::,,,,,,,:.,,.`  `                       .:    :::      :::  :::     :::      ,,:,:,,,,,,,,::.   `        `         ``     .:    :::      :::  :::     :::       ,,:.,,,,,,,,,: `::, ,,   ::,::`   : :,::`  ::::   :::      :::  :::    :::        ,:,,,,,,,,,,::,:   ,,  :.    :   ::    :   .:    :::      :::  :::::::         :,,,,,,,,,,:,::   ,,  :      :  :     :   .:    :::      :::  :::::::::   `     :,,,,,,,,,,:,::,  ,, .::::::::  :     :   .:    :::      :::  :::     :::   `,...,,:,,,,,,,,,: .:,. ,, ,,         :     :   .:    :::      :::  :::     :::     .,,,,::,,,,,,,:  `: , ,,  :     `   :     :   .:    :::      :::  :::     :::       ...,::,,,,::.. `:  .,,  :,    :   :     :   .:    :::::::::::   :::     :::            ,::::,,,. `:   ,,   :::::    :     :   .:    :::::::::     ::::::::::            ,,:` `,,.           ,,,    .,`          ,,.     `,                                          GRAPH DATABASE        ``        `.                  ``                                          orientdb.com                  ` java.lang.NullPointerException         at com.orientechnologies.orient.core.config.OGlobalConfiguration$2.change(OGlobalConfiguration.java:397)         at com.orientechnologies.orient.core.config.OGlobalConfiguration.setValue(OGlobalConfiguration.java:811)         at com.orientechnologies.orient.core.config.OGlobalConfiguration.readConfiguration(OGlobalConfiguration.java:728)         at com.orientechnologies.orient.core.config.OGlobalConfiguration.&lt;clinit&gt;(OGlobalConfiguration.java:638)         at com.orientechnologies.common.profiler.OProfilerStub.&lt;init&gt;(OProfilerStub.java:38)         at com.orientechnologies.orient.core.Orient.startup(Orient.java:199)         at com.orientechnologies.orient.core.Orient.&lt;clinit&gt;(Orient.java:87)         at com.orientechnologies.orient.server.OServer.&lt;init&gt;(OServer.java:132)         at com.orientechnologies.orient.server.OServer.&lt;init&gt;(OServer.java:115)         at com.orientechnologies.orient.server.OServerMain.create(OServerMain.java:26)         at com.orientechnologies.orient.server.OServerMain.main(OServerMain.java:40)  2015-12-09 19:12:09:188 INFO  OrientDB auto-config DISKCACHE=493MB (heap=455MB os=2,996MB disk=2,162MB) [orientechnologies] 2015-12-09 19:12:09:189 SEVER Can not change cache size in runtime because storage engine plocal was not registered [OGlobalConfiguration$1] 2015-12-09 19:12:09:290 INFO  Loading configuration from: /home/nagu/src/orientdb/releases/orientdb-community-2.1.7/config/orientdb-server-config.xml... [OServerConfigurationLoaderXml] 2015-12-09 19:12:09:457 INFO  OrientDB Server v2.1.7 (build UNKNOWN@r; 2015-12-09 08:15:57+0000) is starting up... [OServer] 2015-12-09 19:12:09:478 INFO  Databases directory: /home/nagu/src/orientdb/releases/orientdb-community-2.1.7/databases [OServer] 2015-12-09 19:12:09:514 INFO  Port 0.0.0.0:2424 busy, trying the next available... [OServerNetworkListener] 2015-12-09 19:12:09:515 INFO  Listening binary connections on 0.0.0.0:2425 (protocol v.32, socket=default) [OServerNetworkListener] 2015-12-09 19:12:09:519 INFO  Port 0.0.0.0:2480 busy, trying the next available... [OServerNetworkListener] 2015-12-09 19:12:09:521 INFO  Listening http connections on 0.0.0.0:2481 (protocol v.10, socket=default) [OServerNetworkListener]  +---------------------------------------------------------------+ |                WARNING: FIRST RUN CONFIGURATION               | +---------------------------------------------------------------+ | This is the first time the server is running. Please type a   | | password of your choice for the 'root' user or leave it blank | | to auto-generate it.                                          | |                                                               | | To avoid this message set the environment variable or JVM     | | setting ORIENTDB_ROOT_PASSWORD to the root password to use.   | +---------------------------------------------------------------+  Root password [BLANK=auto generate it]: iwonttellyou  2015-12-09 19:26:09:802 INFO  Installing dynamic plugin 'studio-2.1.zip'... [OServerPluginManager] 2015-12-09 19:26:09:889 INFO  Installing GREMLIN language v.2.6.0 - graph.pool.max=50 [OGraphServerHandler] 2015-12-09 19:26:09:890 INFO  [OVariableParser.resolveVariables] Error on resolving property: distributed [orientechnologies] 2015-12-09 19:26:09:891 INFO  Installing Script interpreter. WARN: authenticated clients can execute any kind of code into the server by using the following allowed languages: [sql] [OServerSi deScriptInterpreter] 2015-12-09 19:26:09:892 INFO  OrientDB Server v2.1.7 (build UNKNOWN@r; 2015-12-09 08:15:57+0000) is active. [OServer]  `````` </body>
		<created>2015-12-09 13:59:27</created>
		<closed>2015-12-09 15:21:00</closed>
	</bug>
