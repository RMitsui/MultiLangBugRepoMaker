<?xml version="1.0" encoding="ISO-8859-1"?>

<bugrepository name="canal">
	<bug id="1343" opendate="2018-12-26 03:42:40" fixdate="2018-12-28 05:47:18">
		<buginformation>
			<summary>从canal v1.1.1升级到1.1.2 canal.log报错</summary>
			<description>### environment  * canal version 1.1.2 * mysql version 8.0.3 * docker version 18.x ### Issue Description 2018-12-26 11:36:30.202 [destination = chess , address = mysql/10.0.0.5:3306 , EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - ---&gt; begin to find start position, it will be long time for reset or first position 2018-12-26 11:36:30.202 [destination = chess , address = mysql/10.0.0.5:3306 , EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-12-26 11:36:30.204 [destination = chess , address = mysql/10.0.0.5:3306 , EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address mysql/10.0.0.5:3306 has an error, retrying. caused by  java.lang.IllegalArgumentException: Invalid charset id: 255         at com.taobao.tddl.dbsync.binlog.CharsetConversion.getEntry(CharsetConversion.java:41) ~[canal.parse.dbsync-1.1.2.jar:na]         at com.taobao.tddl.dbsync.binlog.CharsetConversion.getJavaCharset(CharsetConversion.java:299) ~[canal.parse.dbsync-1.1.2.jar:na]         at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.&lt;init&gt;(QueryLogEvent.java:503) ~[canal.parse.dbsync-1.1.2.jar:na]         at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:168) ~[canal.parse.dbsync-1.1.2.jar:na]         at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:111) ~[canal.parse.dbsync-1.1.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.seek(MysqlConnection.java:137) ~[canal.parse-1.1.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:743) ~[canal.parse-1.1.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findEndPositionWithMasterIdAndTimestamp(MysqlEventParser.java:392) ~[canal.parse-1.1.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:447) ~[canal.parse-1.1.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:366) ~[canal.parse-1.1.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:186) ~[canal.parse-1.1.2.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] 2018-12-26 11:36:30.205 [destination = chess , address = mysql/10.0.0.5:3306 , EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:chess[java.lang.IllegalArgumentException: Invalid charset id: 255         at com.taobao.tddl.dbsync.binlog.CharsetConversion.getEntry(CharsetConversion.java:41)         at com.taobao.tddl.dbsync.binlog.CharsetConversion.getJavaCharset(CharsetConversion.java:299)         at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.&lt;init&gt;(QueryLogEvent.java:503)         at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:168)         at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:111)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.seek(MysqlConnection.java:137)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:743)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findEndPositionWithMasterIdAndTimestamp(MysqlEventParser.java:392)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:447)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:366)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:186)         at java.lang.Thread.run(Thread.java:748) ]  ### Steps to reproduce 因为生产上数据库8.0.3，故从1.1.1升级到1.1.2,结果报这样的错，请问是哪里配置出问题？另外mysql在docker环境下，禁止ping</description>
		</buginformation>
		<fixedfiles>
			<file>dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/CharsetConversion.java</file>
		</fixedfiles>
	</bug>
	<bug id="350" opendate="2017-07-27 07:36:11" fixdate="2017-08-03 13:15:47">
		<buginformation>
			<summary>canal解析json类型出错</summary>
			<description>和#330中提到的问题一致，mysql版本是5.7 sql如下： a='"a"'+',"a"'*30000 sql="insert into canal_json_test(j_json) values('[%s]')" % (a) 即一个json字段的值为'["a","a","a"……]' 共30001个a，可以正常插入mysql，但是canal解析这个出错了</description>
		</buginformation>
		<fixedfiles>
			<file>parse/src/main/java/com/alibaba/otter/canal/parse/inbound/AbstractEventParser.java</file>
			<file>dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/event/RowsLogBuffer.java</file>
			<file>dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/JsonConversion.java</file>
		</fixedfiles>
	</bug>
<bugrepository>
