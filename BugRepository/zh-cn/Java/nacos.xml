<?xml version="1.0" encoding="ISO-8859-1"?>

<bugrepository name="nacos">
	<bug id="3687" opendate="2020-08-26 01:15:43" fixdate="2020-09-09 08:40:22">
		<buginformation>
			<summary>服务列表查询接口调用失败</summary>
			<description>版本： 1.2.1  1.3  环境：windows server 2016 问题：请求接口 /nacos/v1/ns/catalog/services?hasIpCount=false&amp;withInstances=false&amp;pageNo=1&amp;pageSize=10&amp;serviceNameParam=&amp;groupNameParam=&amp;accessToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTU5NzczNzAwOH0.1F9w9KRM0EQdkP96gH50MoUhsaUZDYg64klpUN9GFes&amp;namespaceId=  时，httpcode 500，response 返回： java.lang.ArrayIndexOutOfBoundsException: 1； 重启服务问题仍然存在。nacos日志中未找到错误信息。 ![微信图片_20200826091404](https://user-images.githubusercontent.com/19761319/91243460-aea17800-e77c-11ea-9bcb-c3e9ed1c8d1d.png) ![微信图片_20200826091445](https://user-images.githubusercontent.com/19761319/91243465-b06b3b80-e77c-11ea-9eb6-7eb97d1a9a6a.png)     </description>
		</buginformation>
		<fixedfiles>
			<file>api/src/main/java/com/alibaba/nacos/api/naming/utils/NamingUtils.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/controllers/InstanceController.java</file>
		</fixedfiles>
	</bug>
	<bug id="3617" opendate="2020-08-17 11:41:26" fixdate="2020-09-03 13:14:24">
		<buginformation>
			<summary>配置管理导入已经存在的配置覆盖不了旧的配置</summary>
			<description>nacos服务器版本：nacos-server-1.3.2 操作系统：centos 7   ![image](https://user-images.githubusercontent.com/8179656/90392170-f7906700-e0c0-11ea-8a68-d6366fc8204f.png)   我就有是疑惑，选项里面有覆盖，为何操作的是是insert。如果不想覆盖，那就去掉覆盖选项，或者需要覆盖，那就改成update.</description>
		</buginformation>
		<fixedfiles>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/component/DistroComponentHolder.java</file>
			<file>api/src/main/java/com/alibaba/nacos/api/naming/pojo/Instance.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/task/engine/AbstractNacosTaskExecuteEngine.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/raft/RaftPeerSet.java</file>
			<file>naming/src/test/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/DistroConsistencyServiceImplTest.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/component/DistroFailedTaskHandler.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/impl/NamingSnapshotOperation.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/processor/DumpProcessor.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/HttpUtils.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/task/NacosTask.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/raft/RaftCore.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/misc/SwitchDomain.java</file>
			<file>api/src/main/java/com/alibaba/nacos/api/naming/pojo/Service.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/model/RequestHttpEntity.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/delay/DistroDelayTaskProcessor.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/misc/HttpClient.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/merge/MergeDataTask.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/DistroConfig.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/repository/embedded/StandaloneDatabaseOperateImpl.java</file>
			<file>config/src/test/java/com/alibaba/nacos/config/server/manager/TaskManagerTest.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/DistroConsistencyServiceImpl.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/delay/DistroDelayTaskExecuteEngine.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/load/DistroLoadDataTask.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/client/NacosAsyncRestTemplate.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/component/DistroDataStorageImpl.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/pojo/Record.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/storage/kv/FileKVStorage.java</file>
			<file>test/src/test/java/com/alibaba/nacos/test/common/NacosRestTemplate_ITCase.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/tls/TlsSystemConfig.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/entity/DistroKey.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/component/DistroDataStorage.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/impl/BatchReadResponse.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/tls/TlsFileWatcher.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/task/DumpAllTagTask.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/DelegateConsistencyServiceImpl.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/core/Cluster.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/cluster/lookup/StandaloneMemberLookup.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/client/NacosRestTemplate.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/processor/DumpChangeProcessor.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/task/DumpChangeTask.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/BaseHttpMethod.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/core/Instance.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/utils/GlobalExecutor.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/tls/SelfTrustManager.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/manager/TaskManager.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/misc/GlobalConfig.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/component/DistroTransportAgent.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/combined/DistroHttpCombinedKey.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/DistroHttpData.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/task/engine/NacosTaskExecuteEngine.java</file>
			<file>api/src/main/java/com/alibaba/nacos/api/selector/AbstractSelector.java</file>
			<file>api/src/main/java/com/alibaba/nacos/api/naming/pojo/healthcheck/AbstractHealthChecker.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/raft/RaftStore.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/combined/DistroHttpCombinedKeyTaskFailedHandler.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/net/NamingHttpClientManager.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/notify/NotifyTaskProcessor.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/entity/DistroData.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/storage/kv/KvStorage.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/DistroProtocol.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/utils/Loggers.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/controllers/DistroController.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/utils/BiConsumer.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/task/DumpAllTask.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/combined/DistroHttpCombinedKeyExecuteTask.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/raft/RaftConsistencyServiceImpl.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/config/utils/ParamUtils.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/repository/embedded/BaseDatabaseOperate.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/execute/DistroSyncChangeTask.java</file>
			<file>test/src/test/java/com/alibaba/nacos/test/common/NacosAsyncRestTemplate_ITCase.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/controllers/InstanceController.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/processor/DumpAllTagProcessor.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/cluster/MemberUtils.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/AbstractHttpClientFactory.java</file>
			<file>common/src/test/java/com/alibaba/nacos/common/task/engine/NacosDelayTaskExecuteEngineTest.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/notify/DefaultPublisher.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/raft/RaftListener.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/merge/MergeTaskProcessor.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/config/http/ServerHttpAgent.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/execute/DistroExecuteWorkersManager.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/Datum.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/impl/BatchWriteRequest.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ValueChangeEvent.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/config/impl/SpasAdapter.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/execute/DistroExecuteWorker.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/tls/SelfHostnameVerifier.java</file>
			<file>test/src/test/java/com/alibaba/nacos/test/common/NacosRestTemplate_Interceptors_ITCase.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/AbstractApacheHttpClientFactory.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/processor/DumpAllBetaProcessor.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/combined/DistroHttpCombinedKeyDelayTask.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/ClusterVersionJudgement.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/impl/PersistentServiceProcessor.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/notify/NotifySingleService.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/repository/embedded/DatabaseOperate.java</file>
			<file>consistency/src/main/java/com/alibaba/nacos/consistency/SerializeFactory.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/notify/NotifyTask.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/storage/kv/MemoryKVStorage.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/controllers/RaftController.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/task/AbstractExecuteTask.java</file>
			<file>istio/src/main/java/com/alibaba/nacos/istio/mcp/NacosMcpService.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/PersistentNotifier.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/DumpService.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/misc/NamingProxy.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/security/SecurityProxy.java</file>
			<file>naming/src/test/java/com/alibaba/nacos/naming/consistency/persistent/ClusterVersionJudgementTest.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/core/Service.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/component/DistroHttpAgent.java</file>
			<file>api/src/main/java/com/alibaba/nacos/api/naming/pojo/Cluster.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/delay/DistroDelayTask.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/raft/JRaftServer.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/misc/GlobalExecutor.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/client/request/JdkHttpClientRequest.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/tls/TlsHelper.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/storage/StorageFactory.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/ephemeral/distro/combined/DistroHttpDelayTaskProcessor.java</file>
			<file>naming/src/test/java/com/alibaba/nacos/naming/core/ServiceManagerTest.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/execute/AbstractDistroExecuteTask.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/exception/DistroException.java</file>
			<file>core/src/test/java/com/alibaba/nacos/core/storage/RocksStorageTest.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/DistroTaskEngineHolder.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/utils/DiskUtils.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/repository/embedded/EmbeddedStoragePersistServiceImpl.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/component/DistroCallback.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/net/HttpClient.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/task/DumpAllBetaTask.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/healthcheck/ClientBeatCheckTask.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/param/Header.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/task/verify/DistroVerifyTask.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/task/DumpTask.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/task/engine/NacosDelayTaskExecuteEngine.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/distro/component/DistroDataProcessor.java</file>
			<file>config/src/main/java/com/alibaba/nacos/config/server/service/dump/processor/DumpAllProcessor.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/utils/SignUtil.java</file>
			<file>test/src/test/java/com/alibaba/nacos/test/naming/NamingBase.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/core/HostReactor.java</file>
		</fixedfiles>
	</bug>
	<bug id="3324" opendate="2020-07-14 09:27:15" fixdate="2020-07-15 06:12:45">
		<buginformation>
			<summary>1.3.1 注销服务异常</summary>
			<description>异常如下，HttpClientBeanHolder类中Logger LOGGER = LoggerFactory.getLogger(HttpClientManager.class);写错了，应该是Logger LOGGER = LoggerFactory.getLogger(HttpClientBeanHolder.class);使用addShutdownHook关闭NacosRestTemplate，发生在请求 /nacos/v1/ns/instance 之前，然后...... ``` 2020-07-14 17:17:09.221  WARN 17487 --- [      Thread-22] c.a.nacos.common.http.HttpClientManager  : [HttpClientBeanFactory] Start destroying NacosRestTemplate 2020-07-14 17:17:09.227  WARN 17487 --- [      Thread-22] c.a.nacos.common.http.HttpClientManager  : [HttpClientBeanFactory] Destruction of the end 2020-07-14 17:17:09.228  INFO 17487 --- [      Thread-14] o.s.s.c.ThreadPoolTaskScheduler          : Shutting down ExecutorService 'Nacso-Watch-Task-Scheduler' 2020-07-14 17:17:09.254  INFO 17487 --- [      Thread-14] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now... 2020-07-14 17:17:09.265 ERROR 17487 --- [      Thread-14] c.a.c.n.registry.NacosServiceRegistry    : ERR_NACOS_DEREGISTER, de-register failed...  com.alibaba.nacos.api.exception.NacosException: failed to req API:/nacos/v1/ns/instance after all servers tried: java.lang.IllegalStateException: Connection pool shut down ```</description>
		</buginformation>
		<fixedfiles>
			<file>client/src/main/java/com/alibaba/nacos/client/security/SecurityProxy.java</file>
			<file>common/src/main/java/com/alibaba/nacos/common/http/HttpClientBeanHolder.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/net/NamingProxy.java</file>
			<file>test/src/test/java/com/alibaba/nacos/test/naming/NamingBase.java</file>
			<file>client/src/main/java/com/alibaba/nacos/client/naming/net/NamingHttpClientManager.java</file>
		</fixedfiles>
	</bug>
	<bug id="3110" opendate="2020-06-18 09:57:08" fixdate="2020-06-28 01:14:28">
		<buginformation>
			<summary>nacosV1.3.0集群问题</summary>
			<description>nacos部署一主两从集群模式，当从节点出现宕机后，主从之间频繁发送心跳请求。通过curl调用beat的api无法获取到正常节点的返回值，此时注册的应用在服务器中kill掉，在nacos的监控器中不能正常下线。依然显示应用健康状态为正常，此时客户端负载调用注册的服务接口会出现调用不成功的问题</description>
		</buginformation>
		<fixedfiles>
			<file>naming/src/main/java/com/alibaba/nacos/naming/cluster/ServerListManager.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/cluster/MemberChangeListener.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/file/WatchFileCenter.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/core/DistroMapper.java</file>
			<file>test/src/test/java/com/alibaba/nacos/test/core/cluster/ServerMemberManager_ITCase.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/cluster/ServerMemberManager.java</file>
			<file>naming/src/main/java/com/alibaba/nacos/naming/consistency/persistent/raft/RaftPeerSet.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/cluster/Member.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/controller/NacosClusterController.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/cluster/MemberUtils.java</file>
			<file>core/src/main/java/com/alibaba/nacos/core/distributed/ProtocolManager.java</file>
		</fixedfiles>
	</bug>
<bugrepository>
